<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Netpanzer-cvs] r1089 - in trunk/netpanzer: nbproject	src/NetPanzer/Interfaces src/NetPanzer/System	src/NetPanzer/Views/Components src/NetPanzer/Views/Game	src/NetPanzer/Views/MainMenu src/NetPanzer/Views/MainMenu/Multi	src/NetPanzer/Views/MainMenu/Options
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/netpanzer-cvs/2009-January/index.html" >
   <LINK REL="made" HREF="mailto:netpanzer-cvs%40lists.berlios.de?Subject=Re%3A%20%5BNetpanzer-cvs%5D%20r1089%20-%20in%20trunk/netpanzer%3A%20nbproject%0A%09src/NetPanzer/Interfaces%20src/NetPanzer/System%0A%09src/NetPanzer/Views/Components%20src/NetPanzer/Views/Game%0A%09src/NetPanzer/Views/MainMenu%20src/NetPanzer/Views/MainMenu/Multi%0A%09src/NetPanzer/Views/MainMenu/Options&In-Reply-To=%3C200901301334.n0UDYxVO025489%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000120.html">
   
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Netpanzer-cvs] r1089 - in trunk/netpanzer: nbproject	src/NetPanzer/Interfaces src/NetPanzer/System	src/NetPanzer/Views/Components src/NetPanzer/Views/Game	src/NetPanzer/Views/MainMenu src/NetPanzer/Views/MainMenu/Multi	src/NetPanzer/Views/MainMenu/Options</H1>
    <B>kromxp at mail.berlios.de</B> 
    <A HREF="mailto:netpanzer-cvs%40lists.berlios.de?Subject=Re%3A%20%5BNetpanzer-cvs%5D%20r1089%20-%20in%20trunk/netpanzer%3A%20nbproject%0A%09src/NetPanzer/Interfaces%20src/NetPanzer/System%0A%09src/NetPanzer/Views/Components%20src/NetPanzer/Views/Game%0A%09src/NetPanzer/Views/MainMenu%20src/NetPanzer/Views/MainMenu/Multi%0A%09src/NetPanzer/Views/MainMenu/Options&In-Reply-To=%3C200901301334.n0UDYxVO025489%40sheep.berlios.de%3E"
       TITLE="[Netpanzer-cvs] r1089 - in trunk/netpanzer: nbproject	src/NetPanzer/Interfaces src/NetPanzer/System	src/NetPanzer/Views/Components src/NetPanzer/Views/Game	src/NetPanzer/Views/MainMenu src/NetPanzer/Views/MainMenu/Multi	src/NetPanzer/Views/MainMenu/Options">kromxp at mail.berlios.de
       </A><BR>
    <I>Fri Jan 30 14:34:59 CET 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="000120.html">[Netpanzer-cvs] r1088 - in trunk/netpanzer/src: Lib/2D	NetPanzer/Interfaces NetPanzer/Particles NetPanzer/Views	NetPanzer/Views/Components NetPanzer/Views/Game	NetPanzer/Views/MainMenu NetPanzer/Views/MainMenu/Multi	NetPanzer/Views/MainMenu/Options
</A></li>
        
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#121">[ date ]</a>
              <a href="thread.html#121">[ thread ]</a>
              <a href="subject.html#121">[ subject ]</a>
              <a href="author.html#121">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: kromxp
Date: 2009-01-30 14:34:05 +0100 (Fri, 30 Jan 2009)
New Revision: 1089

Removed:
   trunk/netpanzer/src/NetPanzer/Views/Game/ResignView.cpp
   trunk/netpanzer/src/NetPanzer/Views/Game/ResignView.hpp
   trunk/netpanzer/src/NetPanzer/Views/MainMenu/Multi/UnitColorView.cpp
   trunk/netpanzer/src/NetPanzer/Views/MainMenu/Multi/UnitColorView.hpp
Modified:
   trunk/netpanzer/nbproject/Makefile-mac-debug.mk
   trunk/netpanzer/nbproject/Makefile-mac-release.mk
   trunk/netpanzer/nbproject/configurations.xml
   trunk/netpanzer/src/NetPanzer/Interfaces/GameManager.cpp
   trunk/netpanzer/src/NetPanzer/Interfaces/PlayerGameManager.cpp
   trunk/netpanzer/src/NetPanzer/System/SDLVideo.cpp
   trunk/netpanzer/src/NetPanzer/Views/Components/Button.cpp
   trunk/netpanzer/src/NetPanzer/Views/Components/Button.hpp
   trunk/netpanzer/src/NetPanzer/Views/Components/Component.cpp
   trunk/netpanzer/src/NetPanzer/Views/Components/Component.hpp
   trunk/netpanzer/src/NetPanzer/Views/Components/Desktop.cpp
   trunk/netpanzer/src/NetPanzer/Views/Components/Desktop.hpp
   trunk/netpanzer/src/NetPanzer/Views/Components/View.cpp
   trunk/netpanzer/src/NetPanzer/Views/Components/View.hpp
   trunk/netpanzer/src/NetPanzer/Views/Game/AreYouSureExitView.cpp
   trunk/netpanzer/src/NetPanzer/Views/Game/CodeStatsView.cpp
   trunk/netpanzer/src/NetPanzer/Views/Game/CodeStatsView.hpp
   trunk/netpanzer/src/NetPanzer/Views/Game/DisconectedView.cpp
   trunk/netpanzer/src/NetPanzer/Views/Game/DisconectedView.hpp
   trunk/netpanzer/src/NetPanzer/Views/Game/GameView.cpp
   trunk/netpanzer/src/NetPanzer/Views/Game/LibView.cpp
   trunk/netpanzer/src/NetPanzer/Views/Game/LibView.hpp
   trunk/netpanzer/src/NetPanzer/Views/Game/LoadingView.cpp
   trunk/netpanzer/src/NetPanzer/Views/Game/LoadingView.hpp
   trunk/netpanzer/src/NetPanzer/Views/Game/VehicleSelectionView.cpp
   trunk/netpanzer/src/NetPanzer/Views/MainMenu/MenuTemplateView.cpp
   trunk/netpanzer/src/NetPanzer/Views/MainMenu/Multi/FlagSelectionView.cpp
   trunk/netpanzer/src/NetPanzer/Views/MainMenu/Multi/FlagSelectionView.hpp
   trunk/netpanzer/src/NetPanzer/Views/MainMenu/Multi/HostOptionsView.cpp
   trunk/netpanzer/src/NetPanzer/Views/MainMenu/Multi/HostOptionsView.hpp
   trunk/netpanzer/src/NetPanzer/Views/MainMenu/Multi/MapSelectionView.cpp
   trunk/netpanzer/src/NetPanzer/Views/MainMenu/Multi/MapSelectionView.hpp
   trunk/netpanzer/src/NetPanzer/Views/MainMenu/Multi/ServerListView.cpp
   trunk/netpanzer/src/NetPanzer/Views/MainMenu/Multi/ServerListView.hpp
   trunk/netpanzer/src/NetPanzer/Views/MainMenu/Options/InterfaceView.cpp
   trunk/netpanzer/src/NetPanzer/Views/MainMenu/Options/InterfaceView.hpp
   trunk/netpanzer/src/NetPanzer/Views/MainMenu/Options/SoundView.cpp
   trunk/netpanzer/src/NetPanzer/Views/MainMenu/Options/SoundView.hpp
Log:
- Removed unused UnitColorView and ResignView 
- Re-enabled the directx support in windows, is needed by some systems configuration.
- All text buttons (cButton) has been converted to Button


Modified: trunk/netpanzer/nbproject/Makefile-mac-debug.mk
===================================================================
--- trunk/netpanzer/nbproject/Makefile-mac-debug.mk	2009-01-29 08:30:59 UTC (rev 1088)
+++ trunk/netpanzer/nbproject/Makefile-mac-debug.mk	2009-01-30 13:34:05 UTC (rev 1089)
@@ -102,7 +102,6 @@
 	${OBJECTDIR}/src/NetPanzer/Classes/OpcodeDebugger.o \
 	${OBJECTDIR}/src/NetPanzer/System/DummySound.o \
 	${OBJECTDIR}/src/Lib/lua/lfunc.o \
-	${OBJECTDIR}/src/NetPanzer/Views/MainMenu/Multi/UnitColorView.o \
 	${OBJECTDIR}/src/NetPanzer/Units/UnitState.o \
 	${OBJECTDIR}/src/NetPanzer/Resources/ResourceManager.o \
 	${OBJECTDIR}/src/NetPanzer/Particles/SmolderParticleSystem2D.o \
@@ -252,7 +251,6 @@
 	${OBJECTDIR}/src/Lib/optionmm/option.o \
 	${OBJECTDIR}/src/Lib/lua/lobject.o \
 	${OBJECTDIR}/src/Lib/lua/llex.o \
-	${OBJECTDIR}/src/NetPanzer/Views/Game/ResignView.o \
 	${OBJECTDIR}/src/Lib/Util/Log.o \
 	${OBJECTDIR}/src/Lib/optionmm/command_line.o \
 	${OBJECTDIR}/src/NetPanzer/Views/Components/MiniMap.o \
@@ -686,11 +684,6 @@
 	${RM} $@.d
 	$(COMPILE.c) -g -Wall -DPHYSFS_SUPPORTS_ZIP=1 -DZ_PREFIX=1 -I. -Isrc/Lib -Isrc/NetPanzer -Isrc/Lib/physfs -Isrc/Lib/physfs/zlib123 -I/Library/Frameworks/SDL.framework/Versions/A/Headers -I/Library/Frameworks/SDL_mixer.framework/Versions/A/Headers -MMD -MP -MF $@.d -o ${OBJECTDIR}/src/Lib/lua/lfunc.o src/Lib/lua/lfunc.c
 
-${OBJECTDIR}/src/NetPanzer/Views/MainMenu/Multi/UnitColorView.o: src/NetPanzer/Views/MainMenu/Multi/UnitColorView.cpp 
-	${MKDIR} -p ${OBJECTDIR}/src/NetPanzer/Views/MainMenu/Multi
-	${RM} $@.d
-	$(COMPILE.cc) -g -Wall -DPHYSFS_SUPPORTS_ZIP=1 -DZ_PREFIX=1 -I. -Isrc/Lib -Isrc/NetPanzer -Isrc/Lib/physfs -Isrc/Lib/physfs/zlib123 -I/Library/Frameworks/SDL.framework/Versions/A/Headers -I/Library/Frameworks/SDL_mixer.framework/Versions/A/Headers -MMD -MP -MF $@.d -o ${OBJECTDIR}/src/NetPanzer/Views/MainMenu/Multi/UnitColorView.o src/NetPanzer/Views/MainMenu/Multi/UnitColorView.cpp
-
 ${OBJECTDIR}/src/NetPanzer/Units/UnitState.o: src/NetPanzer/Units/UnitState.cpp 
 	${MKDIR} -p ${OBJECTDIR}/src/NetPanzer/Units
 	${RM} $@.d
@@ -1436,11 +1429,6 @@
 	${RM} $@.d
 	$(COMPILE.c) -g -Wall -DPHYSFS_SUPPORTS_ZIP=1 -DZ_PREFIX=1 -I. -Isrc/Lib -Isrc/NetPanzer -Isrc/Lib/physfs -Isrc/Lib/physfs/zlib123 -I/Library/Frameworks/SDL.framework/Versions/A/Headers -I/Library/Frameworks/SDL_mixer.framework/Versions/A/Headers -MMD -MP -MF $@.d -o ${OBJECTDIR}/src/Lib/lua/llex.o src/Lib/lua/llex.c
 
-${OBJECTDIR}/src/NetPanzer/Views/Game/ResignView.o: src/NetPanzer/Views/Game/ResignView.cpp 
-	${MKDIR} -p ${OBJECTDIR}/src/NetPanzer/Views/Game
-	${RM} $@.d
-	$(COMPILE.cc) -g -Wall -DPHYSFS_SUPPORTS_ZIP=1 -DZ_PREFIX=1 -I. -Isrc/Lib -Isrc/NetPanzer -Isrc/Lib/physfs -Isrc/Lib/physfs/zlib123 -I/Library/Frameworks/SDL.framework/Versions/A/Headers -I/Library/Frameworks/SDL_mixer.framework/Versions/A/Headers -MMD -MP -MF $@.d -o ${OBJECTDIR}/src/NetPanzer/Views/Game/ResignView.o src/NetPanzer/Views/Game/ResignView.cpp
-
 ${OBJECTDIR}/src/Lib/Util/Log.o: src/Lib/Util/Log.cpp 
 	${MKDIR} -p ${OBJECTDIR}/src/Lib/Util
 	${RM} $@.d

Modified: trunk/netpanzer/nbproject/Makefile-mac-release.mk
===================================================================
--- trunk/netpanzer/nbproject/Makefile-mac-release.mk	2009-01-29 08:30:59 UTC (rev 1088)
+++ trunk/netpanzer/nbproject/Makefile-mac-release.mk	2009-01-30 13:34:05 UTC (rev 1089)
@@ -102,7 +102,6 @@
 	${OBJECTDIR}/src/NetPanzer/Classes/OpcodeDebugger.o \
 	${OBJECTDIR}/src/NetPanzer/System/DummySound.o \
 	${OBJECTDIR}/src/Lib/lua/lfunc.o \
-	${OBJECTDIR}/src/NetPanzer/Views/MainMenu/Multi/UnitColorView.o \
 	${OBJECTDIR}/src/NetPanzer/Units/UnitState.o \
 	${OBJECTDIR}/src/NetPanzer/Resources/ResourceManager.o \
 	${OBJECTDIR}/src/NetPanzer/Particles/SmolderParticleSystem2D.o \
@@ -252,7 +251,6 @@
 	${OBJECTDIR}/src/Lib/optionmm/option.o \
 	${OBJECTDIR}/src/Lib/lua/lobject.o \
 	${OBJECTDIR}/src/Lib/lua/llex.o \
-	${OBJECTDIR}/src/NetPanzer/Views/Game/ResignView.o \
 	${OBJECTDIR}/src/Lib/Util/Log.o \
 	${OBJECTDIR}/src/Lib/optionmm/command_line.o \
 	${OBJECTDIR}/src/NetPanzer/Views/Components/MiniMap.o \
@@ -686,11 +684,6 @@
 	${RM} $@.d
 	$(COMPILE.c) -O2 -Wall -DPHYSFS_SUPPORTS_ZIP=1 -DZ_PREFIX=1 -I. -Isrc/Lib -Isrc/NetPanzer -Isrc/Lib/physfs -Isrc/Lib/physfs/zlib123 -I/Library/Frameworks/SDL.framework/Versions/A/Headers -I/Library/Frameworks/SDL_mixer.framework/Versions/A/Headers -MMD -MP -MF $@.d -o ${OBJECTDIR}/src/Lib/lua/lfunc.o src/Lib/lua/lfunc.c
 
-${OBJECTDIR}/src/NetPanzer/Views/MainMenu/Multi/UnitColorView.o: src/NetPanzer/Views/MainMenu/Multi/UnitColorView.cpp 
-	${MKDIR} -p ${OBJECTDIR}/src/NetPanzer/Views/MainMenu/Multi
-	${RM} $@.d
-	$(COMPILE.cc) -O2 -Wall -DPHYSFS_SUPPORTS_ZIP=1 -DZ_PREFIX=1 -I. -Isrc/Lib -Isrc/NetPanzer -Isrc/Lib/physfs -Isrc/Lib/physfs/zlib123 -I/Library/Frameworks/SDL.framework/Versions/A/Headers -I/Library/Frameworks/SDL_mixer.framework/Versions/A/Headers -MMD -MP -MF $@.d -o ${OBJECTDIR}/src/NetPanzer/Views/MainMenu/Multi/UnitColorView.o src/NetPanzer/Views/MainMenu/Multi/UnitColorView.cpp
-
 ${OBJECTDIR}/src/NetPanzer/Units/UnitState.o: src/NetPanzer/Units/UnitState.cpp 
 	${MKDIR} -p ${OBJECTDIR}/src/NetPanzer/Units
 	${RM} $@.d
@@ -1436,11 +1429,6 @@
 	${RM} $@.d
 	$(COMPILE.c) -O2 -Wall -DPHYSFS_SUPPORTS_ZIP=1 -DZ_PREFIX=1 -I. -Isrc/Lib -Isrc/NetPanzer -Isrc/Lib/physfs -Isrc/Lib/physfs/zlib123 -I/Library/Frameworks/SDL.framework/Versions/A/Headers -I/Library/Frameworks/SDL_mixer.framework/Versions/A/Headers -MMD -MP -MF $@.d -o ${OBJECTDIR}/src/Lib/lua/llex.o src/Lib/lua/llex.c
 
-${OBJECTDIR}/src/NetPanzer/Views/Game/ResignView.o: src/NetPanzer/Views/Game/ResignView.cpp 
-	${MKDIR} -p ${OBJECTDIR}/src/NetPanzer/Views/Game
-	${RM} $@.d
-	$(COMPILE.cc) -O2 -Wall -DPHYSFS_SUPPORTS_ZIP=1 -DZ_PREFIX=1 -I. -Isrc/Lib -Isrc/NetPanzer -Isrc/Lib/physfs -Isrc/Lib/physfs/zlib123 -I/Library/Frameworks/SDL.framework/Versions/A/Headers -I/Library/Frameworks/SDL_mixer.framework/Versions/A/Headers -MMD -MP -MF $@.d -o ${OBJECTDIR}/src/NetPanzer/Views/Game/ResignView.o src/NetPanzer/Views/Game/ResignView.cpp
-
 ${OBJECTDIR}/src/Lib/Util/Log.o: src/Lib/Util/Log.cpp 
 	${MKDIR} -p ${OBJECTDIR}/src/Lib/Util
 	${RM} $@.d

Modified: trunk/netpanzer/nbproject/configurations.xml
===================================================================
--- trunk/netpanzer/nbproject/configurations.xml	2009-01-29 08:30:59 UTC (rev 1088)
+++ trunk/netpanzer/nbproject/configurations.xml	2009-01-30 13:34:05 UTC (rev 1089)
@@ -556,8 +556,6 @@
             &lt;itemPath&gt;src/NetPanzer/Views/Game/MiniMapView.hpp&lt;/itemPath&gt;
             &lt;itemPath&gt;src/NetPanzer/Views/Game/RankView.cpp&lt;/itemPath&gt;
             &lt;itemPath&gt;src/NetPanzer/Views/Game/RankView.hpp&lt;/itemPath&gt;
-            &lt;itemPath&gt;src/NetPanzer/Views/Game/ResignView.cpp&lt;/itemPath&gt;
-            &lt;itemPath&gt;src/NetPanzer/Views/Game/ResignView.hpp&lt;/itemPath&gt;
             &lt;itemPath&gt;src/NetPanzer/Views/Game/VehicleSelectionView.cpp&lt;/itemPath&gt;
             &lt;itemPath&gt;src/NetPanzer/Views/Game/VehicleSelectionView.hpp&lt;/itemPath&gt;
           &lt;/logicalFolder&gt;
@@ -593,8 +591,6 @@
               &lt;itemPath&gt;src/NetPanzer/Views/MainMenu/Multi/PlayerNameView.hpp&lt;/itemPath&gt;
               &lt;itemPath&gt;src/NetPanzer/Views/MainMenu/Multi/ServerListView.cpp&lt;/itemPath&gt;
               &lt;itemPath&gt;src/NetPanzer/Views/MainMenu/Multi/ServerListView.hpp&lt;/itemPath&gt;
-              &lt;itemPath&gt;src/NetPanzer/Views/MainMenu/Multi/UnitColorView.cpp&lt;/itemPath&gt;
-              &lt;itemPath&gt;src/NetPanzer/Views/MainMenu/Multi/UnitColorView.hpp&lt;/itemPath&gt;
               &lt;itemPath&gt;src/NetPanzer/Views/MainMenu/Multi/UnitSelectionView.cpp&lt;/itemPath&gt;
               &lt;itemPath&gt;src/NetPanzer/Views/MainMenu/Multi/UnitSelectionView.hpp&lt;/itemPath&gt;
             &lt;/logicalFolder&gt;
@@ -2161,12 +2157,6 @@
       &lt;item path=&quot;src/NetPanzer/Views/Game/RankView.hpp&quot;&gt;
         &lt;itemTool&gt;3&lt;/itemTool&gt;
       &lt;/item&gt;
-      &lt;item path=&quot;src/NetPanzer/Views/Game/ResignView.cpp&quot;&gt;
-        &lt;itemTool&gt;1&lt;/itemTool&gt;
-      &lt;/item&gt;
-      &lt;item path=&quot;src/NetPanzer/Views/Game/ResignView.hpp&quot;&gt;
-        &lt;itemTool&gt;3&lt;/itemTool&gt;
-      &lt;/item&gt;
       &lt;item path=&quot;src/NetPanzer/Views/Game/VehicleSelectionView.cpp&quot;&gt;
         &lt;itemTool&gt;1&lt;/itemTool&gt;
       &lt;/item&gt;
@@ -2275,12 +2265,6 @@
       &lt;item path=&quot;src/NetPanzer/Views/MainMenu/Multi/ServerListView.hpp&quot;&gt;
         &lt;itemTool&gt;3&lt;/itemTool&gt;
       &lt;/item&gt;
-      &lt;item path=&quot;src/NetPanzer/Views/MainMenu/Multi/UnitColorView.cpp&quot;&gt;
-        &lt;itemTool&gt;1&lt;/itemTool&gt;
-      &lt;/item&gt;
-      &lt;item path=&quot;src/NetPanzer/Views/MainMenu/Multi/UnitColorView.hpp&quot;&gt;
-        &lt;itemTool&gt;3&lt;/itemTool&gt;
-      &lt;/item&gt;
       &lt;item path=&quot;src/NetPanzer/Views/MainMenu/Multi/UnitSelectionView.cpp&quot;&gt;
         &lt;itemTool&gt;1&lt;/itemTool&gt;
       &lt;/item&gt;
@@ -3894,12 +3878,6 @@
       &lt;item path=&quot;src/NetPanzer/Views/Game/RankView.hpp&quot;&gt;
         &lt;itemTool&gt;3&lt;/itemTool&gt;
       &lt;/item&gt;
-      &lt;item path=&quot;src/NetPanzer/Views/Game/ResignView.cpp&quot;&gt;
-        &lt;itemTool&gt;1&lt;/itemTool&gt;
-      &lt;/item&gt;
-      &lt;item path=&quot;src/NetPanzer/Views/Game/ResignView.hpp&quot;&gt;
-        &lt;itemTool&gt;3&lt;/itemTool&gt;
-      &lt;/item&gt;
       &lt;item path=&quot;src/NetPanzer/Views/Game/VehicleSelectionView.cpp&quot;&gt;
         &lt;itemTool&gt;1&lt;/itemTool&gt;
       &lt;/item&gt;
@@ -4008,12 +3986,6 @@
       &lt;item path=&quot;src/NetPanzer/Views/MainMenu/Multi/ServerListView.hpp&quot;&gt;
         &lt;itemTool&gt;3&lt;/itemTool&gt;
       &lt;/item&gt;
-      &lt;item path=&quot;src/NetPanzer/Views/MainMenu/Multi/UnitColorView.cpp&quot;&gt;
-        &lt;itemTool&gt;1&lt;/itemTool&gt;
-      &lt;/item&gt;
-      &lt;item path=&quot;src/NetPanzer/Views/MainMenu/Multi/UnitColorView.hpp&quot;&gt;
-        &lt;itemTool&gt;3&lt;/itemTool&gt;
-      &lt;/item&gt;
       &lt;item path=&quot;src/NetPanzer/Views/MainMenu/Multi/UnitSelectionView.cpp&quot;&gt;
         &lt;itemTool&gt;1&lt;/itemTool&gt;
       &lt;/item&gt;
@@ -5627,12 +5599,6 @@
       &lt;item path=&quot;src/NetPanzer/Views/Game/RankView.hpp&quot;&gt;
         &lt;itemTool&gt;3&lt;/itemTool&gt;
       &lt;/item&gt;
-      &lt;item path=&quot;src/NetPanzer/Views/Game/ResignView.cpp&quot;&gt;
-        &lt;itemTool&gt;1&lt;/itemTool&gt;
-      &lt;/item&gt;
-      &lt;item path=&quot;src/NetPanzer/Views/Game/ResignView.hpp&quot;&gt;
-        &lt;itemTool&gt;3&lt;/itemTool&gt;
-      &lt;/item&gt;
       &lt;item path=&quot;src/NetPanzer/Views/Game/VehicleSelectionView.cpp&quot;&gt;
         &lt;itemTool&gt;1&lt;/itemTool&gt;
       &lt;/item&gt;
@@ -5741,12 +5707,6 @@
       &lt;item path=&quot;src/NetPanzer/Views/MainMenu/Multi/ServerListView.hpp&quot;&gt;
         &lt;itemTool&gt;3&lt;/itemTool&gt;
       &lt;/item&gt;
-      &lt;item path=&quot;src/NetPanzer/Views/MainMenu/Multi/UnitColorView.cpp&quot;&gt;
-        &lt;itemTool&gt;1&lt;/itemTool&gt;
-      &lt;/item&gt;
-      &lt;item path=&quot;src/NetPanzer/Views/MainMenu/Multi/UnitColorView.hpp&quot;&gt;
-        &lt;itemTool&gt;3&lt;/itemTool&gt;
-      &lt;/item&gt;
       &lt;item path=&quot;src/NetPanzer/Views/MainMenu/Multi/UnitSelectionView.cpp&quot;&gt;
         &lt;itemTool&gt;1&lt;/itemTool&gt;
       &lt;/item&gt;
@@ -7360,12 +7320,6 @@
       &lt;item path=&quot;src/NetPanzer/Views/Game/RankView.hpp&quot;&gt;
         &lt;itemTool&gt;3&lt;/itemTool&gt;
       &lt;/item&gt;
-      &lt;item path=&quot;src/NetPanzer/Views/Game/ResignView.cpp&quot;&gt;
-        &lt;itemTool&gt;1&lt;/itemTool&gt;
-      &lt;/item&gt;
-      &lt;item path=&quot;src/NetPanzer/Views/Game/ResignView.hpp&quot;&gt;
-        &lt;itemTool&gt;3&lt;/itemTool&gt;
-      &lt;/item&gt;
       &lt;item path=&quot;src/NetPanzer/Views/Game/VehicleSelectionView.cpp&quot;&gt;
         &lt;itemTool&gt;1&lt;/itemTool&gt;
       &lt;/item&gt;
@@ -7474,12 +7428,6 @@
       &lt;item path=&quot;src/NetPanzer/Views/MainMenu/Multi/ServerListView.hpp&quot;&gt;
         &lt;itemTool&gt;3&lt;/itemTool&gt;
       &lt;/item&gt;
-      &lt;item path=&quot;src/NetPanzer/Views/MainMenu/Multi/UnitColorView.cpp&quot;&gt;
-        &lt;itemTool&gt;1&lt;/itemTool&gt;
-      &lt;/item&gt;
-      &lt;item path=&quot;src/NetPanzer/Views/MainMenu/Multi/UnitColorView.hpp&quot;&gt;
-        &lt;itemTool&gt;3&lt;/itemTool&gt;
-      &lt;/item&gt;
       &lt;item path=&quot;src/NetPanzer/Views/MainMenu/Multi/UnitSelectionView.cpp&quot;&gt;
         &lt;itemTool&gt;1&lt;/itemTool&gt;
       &lt;/item&gt;

Modified: trunk/netpanzer/src/NetPanzer/Interfaces/GameManager.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Interfaces/GameManager.cpp	2009-01-29 08:30:59 UTC (rev 1088)
+++ trunk/netpanzer/src/NetPanzer/Interfaces/GameManager.cpp	2009-01-30 13:34:05 UTC (rev 1089)
@@ -73,7 +73,6 @@
 #include &quot;Views/MainMenu/Multi/GetSessionView.hpp&quot;
 #include &quot;Views/MainMenu/Multi/UnitSelectionView.hpp&quot;
 #include &quot;Views/MainMenu/Multi/FlagSelectionView.hpp&quot;
-#include &quot;Views/MainMenu/Multi/UnitColorView.hpp&quot;
 #include &quot;Views/MainMenu/Multi/HostOptionsView.hpp&quot;
 #include &quot;Views/MainMenu/Multi/MapSelectionView.hpp&quot;
 #include &quot;Views/MainMenu/Multi/PlayerNameView.hpp&quot;
@@ -87,7 +86,6 @@
 #include &quot;Views/Game/CodeStatsView.hpp&quot;
 #include &quot;Views/Game/LibView.hpp&quot;
 #include &quot;Views/Game/HelpScrollView.hpp&quot;
-#include &quot;Views/Game/ResignView.hpp&quot;
 #include &quot;Views/Game/AreYouSureResignView.hpp&quot;
 #include &quot;Views/Game/AreYouSureExitView.hpp&quot;
 #include &quot;Views/Game/GameView.hpp&quot;

Modified: trunk/netpanzer/src/NetPanzer/Interfaces/PlayerGameManager.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Interfaces/PlayerGameManager.cpp	2009-01-29 08:30:59 UTC (rev 1088)
+++ trunk/netpanzer/src/NetPanzer/Interfaces/PlayerGameManager.cpp	2009-01-30 13:34:05 UTC (rev 1089)
@@ -68,7 +68,6 @@
 #include &quot;Views/MainMenu/Multi/GetSessionView.hpp&quot;
 #include &quot;Views/MainMenu/Multi/UnitSelectionView.hpp&quot;
 #include &quot;Views/MainMenu/Multi/FlagSelectionView.hpp&quot;
-#include &quot;Views/MainMenu/Multi/UnitColorView.hpp&quot;
 #include &quot;Views/MainMenu/Multi/HostOptionsView.hpp&quot;
 #include &quot;Views/MainMenu/Multi/MapSelectionView.hpp&quot;
 #include &quot;Views/MainMenu/Multi/PlayerNameView.hpp&quot;
@@ -84,7 +83,6 @@
 #include &quot;Views/Game/CodeStatsView.hpp&quot;
 #include &quot;Views/Game/LibView.hpp&quot;
 #include &quot;Views/Game/HelpScrollView.hpp&quot;
-#include &quot;Views/Game/ResignView.hpp&quot;
 #include &quot;Views/Game/AreYouSureResignView.hpp&quot;
 #include &quot;Views/Game/AreYouSureExitView.hpp&quot;
 #include &quot;Views/Game/GameView.hpp&quot;
@@ -199,7 +197,6 @@
     Desktop::add(new FlagSelectionView());
     Desktop::add(new HostOptionsView());
     Desktop::add(new PlayerNameView());
-    Desktop::add(new ResignView());
     Desktop::add(new AreYouSureResignView());
     Desktop::add(new AreYouSureExitView());
     Desktop::add(new DisconectedView());
@@ -232,7 +229,7 @@
 {
     screen-&gt;lock();
 
-    Desktop::draw(*screen);
+    Desktop::draw();
 
     MouseInterface::draw(*screen);
 

Modified: trunk/netpanzer/src/NetPanzer/System/SDLVideo.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/System/SDLVideo.cpp	2009-01-29 08:30:59 UTC (rev 1088)
+++ trunk/netpanzer/src/NetPanzer/System/SDLVideo.cpp	2009-01-30 13:34:05 UTC (rev 1089)
@@ -33,7 +33,7 @@
         : frontBuffer(0), backBuffer(0)
 {
     // disable directx feature for now
-#if 0
+#if 1
   #ifdef _WIN32
     if ( gameconfig-&gt;usedirectx ) {
         putenv(&quot;SDL_VIDEODRIVER=directx&quot;);

Modified: trunk/netpanzer/src/NetPanzer/Views/Components/Button.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Views/Components/Button.cpp	2009-01-29 08:30:59 UTC (rev 1088)
+++ trunk/netpanzer/src/NetPanzer/Views/Components/Button.cpp	2009-01-30 13:34:05 UTC (rev 1089)
@@ -18,6 +18,7 @@
 #include &lt;config.h&gt;
 
 #include &quot;Views/Components/Button.hpp&quot;
+#include &quot;Views/Components/View.hpp&quot;
 #include &quot;Util/Log.hpp&quot;
 
 #include &quot;MouseEvent.hpp&quot;
@@ -62,17 +63,26 @@
 void Button::actionPerformed(const mMouseEvent &amp;me)
 {
     if (me.getID() == mMouseEvent::MOUSE_EVENT_ENTERED
-                || me.getID() == mMouseEvent::MOUSE_EVENT_RELEASED) {
+                || me.getID() == mMouseEvent::MOUSE_EVENT_RELEASED)
+    {
         bstate = BOVER;
         textColor = Color::red;
         dirty = true; // draw text in red
-    } else if (me.getID() == mMouseEvent::MOUSE_EVENT_EXITED) {
+    }
+    else if (me.getID() == mMouseEvent::MOUSE_EVENT_EXITED)
+    {
         bstate = BNORMAL;
         textColor = Color::white;
         dirty = true; // draw defaults;
-    } else if (me.getID() == mMouseEvent::MOUSE_EVENT_PRESSED) {
+    }
+    else if (me.getID() == mMouseEvent::MOUSE_EVENT_PRESSED)
+    {
         bstate = BPRESSED;
         textColor = Color::yellow;
         dirty = true;
     }
+    else if (me.getID() == mMouseEvent::MOUSE_EVENT_CLICKED)
+    {
+        ((View *)parent)-&gt;onComponentClicked(this);
+    }
 } // end Button::actionPerformed

Modified: trunk/netpanzer/src/NetPanzer/Views/Components/Button.hpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Views/Components/Button.hpp	2009-01-29 08:30:59 UTC (rev 1088)
+++ trunk/netpanzer/src/NetPanzer/Views/Components/Button.hpp	2009-01-30 13:34:05 UTC (rev 1089)
@@ -67,6 +67,21 @@
     virtual ~Button()
     {}
 
+    static Button * createTextButton(   std::string cname,
+                                        std::string label,
+                                        iXY loc,
+                                        int bwidth,
+                                        int customcode = -1)
+    {
+        Button * b = new Button(cname);
+        b-&gt;setLabel(label);
+        b-&gt;setLocation(loc);
+        b-&gt;setTextButtonSize(bwidth);
+        b-&gt;setCustomCode(customcode);
+        b-&gt;setNormalBorder();
+        return b;
+    }
+
     void setLabel(const std::string&amp; l)
     {
         label = l;
@@ -90,6 +105,7 @@
     
     void setUnitSelectionBorder()
     {
+        setExtraBorder();
         borders[0][0] = Color::darkGray;
         borders[0][1] = Color::darkGray;
         borders[1][0] = Color::red;
@@ -101,6 +117,7 @@
     
     void setNormalBorder()
     {
+        setExtraBorder();
         borders[0][0] = topLeftBorderColor;
         borders[0][1] = bottomRightBorderColor;
         borders[1][0] = topLeftBorderColor;
@@ -110,6 +127,17 @@
         dirty=true;
     }
 
+    void setRedGreenBorder()
+    {
+        setExtraBorder();
+        borders[0][0] = 0;
+        borders[0][1] = 0;
+        borders[1][0] = Color::red;
+        borders[1][1] = Color::darkRed;
+        borders[2][0] = Color::green;
+        borders[2][1] = Color::darkGreen;
+    }
+
     void clearBorder()
     {
         memset(borders, 0, sizeof(borders));
@@ -120,17 +148,28 @@
     {
         Component::setSize(x+(extraBorder*2), y+(extraBorder*2));
     }
+
+    void setTextButtonSize(int xsize)
+    {
+        Component::setSize(xsize+(extraBorder*2), Surface::getFontHeight() + 4 + (extraBorder*2));
+    }
     
     void setExtraBorder()
     {
-        extraBorder = 1;
-        setSize( size.x, size.y);
+        if ( !extraBorder )
+        {
+            extraBorder = 1;
+            setSize( size.x, size.y);
+        }
     }
     
     void clearExtraBorder()
     {
-        extraBorder = 0;
-        setSize( size.x, size.y);
+        if ( extraBorder )
+        {
+            extraBorder = 0;
+            setSize( size.x, size.y);
+        }
     }
 
     const std::string&amp; getLabel() const

Modified: trunk/netpanzer/src/NetPanzer/Views/Components/Component.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Views/Components/Component.cpp	2009-01-29 08:30:59 UTC (rev 1088)
+++ trunk/netpanzer/src/NetPanzer/Views/Components/Component.cpp	2009-01-30 13:34:05 UTC (rev 1089)
@@ -35,7 +35,7 @@
     visible    = true;
     parent     = 0;
     surface.free();
-
+    customCode = -1;
 } // end Component::reset
 
 // contains

Modified: trunk/netpanzer/src/NetPanzer/Views/Components/Component.hpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Views/Components/Component.hpp	2009-01-29 08:30:59 UTC (rev 1088)
+++ trunk/netpanzer/src/NetPanzer/Views/Components/Component.hpp	2009-01-30 13:34:05 UTC (rev 1089)
@@ -47,6 +47,8 @@
 
     void reset();
 
+    int     customCode;
+
 public:
     Component *next;
     Component *prev;
@@ -55,6 +57,9 @@
 
     void setParent(void *parent);
 
+    void setCustomCode(int n) { customCode = n; }
+    int getCustomCode() { return customCode; }
+
     enum
     {
         BOTTOM_ALIGNMENT,
@@ -116,6 +121,7 @@
     void setLocation(int x, int y);
     void setLocation(const iXY &amp;p) { setLocation(p.x, p.y); }
     void setName(const std::string&amp; name) { Component::componentName = name; }
+    std::string getName() { return componentName; };
 
     virtual void draw(int posx, int posy, Surface &amp;dest)
     {

Modified: trunk/netpanzer/src/NetPanzer/Views/Components/Desktop.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Views/Components/Desktop.cpp	2009-01-29 08:30:59 UTC (rev 1088)
+++ trunk/netpanzer/src/NetPanzer/Views/Components/Desktop.cpp	2009-01-30 13:34:05 UTC (rev 1089)
@@ -341,12 +341,12 @@
 //--------------------------------------------------------------------------
 // Purpose:
 //--------------------------------------------------------------------------
-void Desktop::draw(Surface&amp; surface)
+void Desktop::draw()
 {
     std::vector&lt;View*&gt;::reverse_iterator i;
     for(i = views.rbegin(); i != views.rend(); i++)
     {
-        (*i)-&gt;draw(surface);
+        (*i)-&gt;draw();
     }
 } // end draw
 

Modified: trunk/netpanzer/src/NetPanzer/Views/Components/Desktop.hpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Views/Components/Desktop.hpp	2009-01-29 08:30:59 UTC (rev 1088)
+++ trunk/netpanzer/src/NetPanzer/Views/Components/Desktop.hpp	2009-01-30 13:34:05 UTC (rev 1089)
@@ -85,7 +85,7 @@
     static void setVisibilityNoDoAnything(const char *viewName, int isVisible);
     static void add(View *view, bool autoActivate = true);
     static void remove(View *view);
-    static void draw(Surface&amp; surface);
+    static void draw();
 
     static iXY      getMouseActionOffset  ()
     {

Modified: trunk/netpanzer/src/NetPanzer/Views/Components/View.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Views/Components/View.cpp	2009-01-29 08:30:59 UTC (rev 1088)
+++ trunk/netpanzer/src/NetPanzer/Views/Components/View.cpp	2009-01-30 13:34:05 UTC (rev 1089)
@@ -31,6 +31,7 @@
 #include &quot;Interfaces/GameConfig.hpp&quot;
 #include &quot;Views/GameViewGlobals.hpp&quot;
 #include &quot;2D/Palette.hpp&quot;
+#include &quot;Classes/ScreenSurface.hpp&quot;
 
 const int RESIZE_WIDTH = 10;
 const int RESIZE_XMIN  = RESIZE_WIDTH;
@@ -51,7 +52,6 @@
 // View
 //---------------------------------------------------------------------------
 View::View()
-    : currentscreen(0)
 {
     reset();
 } // end View::View
@@ -138,10 +138,10 @@
 //---------------------------------------------------------------------------
 // Purpose: Draws the borders of the window.
 //---------------------------------------------------------------------------
-void View::drawBorder(Surface &amp;viewArea)
+void View::drawBorder()
 {
     assert(this != 0);
-    currentscreen-&gt;drawRect(iRect(min, max), Color::darkGray);
+    screen-&gt;drawRect(iRect(min, max), Color::darkGray);
 } // end drawBorder
 
 // drawTitle
@@ -149,20 +149,20 @@
 // Purpose: Draws the title of the view and colors the move area background
 //          depending on whether the view is active.
 //---------------------------------------------------------------------------
-void View::drawTitle(Surface &amp;viewArea)
+void View::drawTitle()
 {
     assert(this != 0);
 
     iRect r(borderSize, borderSize, getSizeX() - borderSize, borderSize + moveAreaHeight - 1);
     r.translate(min);
 
-    viewArea.fillRect(r, getActive() ? activeWindowTitleBodyColor : inactiveWindowTitleBodyColor);
+    screen-&gt;fillRect(r, getActive() ? activeWindowTitleBodyColor : inactiveWindowTitleBodyColor);
 
     char strBuf[256];
 
     sprintf(strBuf, &quot;%s%s&quot;, title, subTitle);
 
-    viewArea.bltStringCenteredInRect(r, strBuf, getActive() ? activeWindowTitleTextColor : inactiveWindowTitleTextColor);
+    screen-&gt;bltStringCenteredInRect(r, strBuf, getActive() ? activeWindowTitleTextColor : inactiveWindowTitleTextColor);
 
     if (getResize()) {
         {
@@ -170,40 +170,40 @@
             iXY verticalPos(min.x + borderSize, min.y + getSizeY() - borderSize - moveAreaHeight + 1);
             iXY horizontalPos(min.x + borderSize + moveAreaHeight - 1, min.y + getSizeY() - borderSize);
 
-            viewArea.drawLine(verticalPos, horizontalPos, Color::white);
+            screen-&gt;drawLine(verticalPos, horizontalPos, Color::white);
             verticalPos.y++;
             horizontalPos.x--;
-            viewArea.drawLine(verticalPos, horizontalPos, Color::gray224);
+            screen-&gt;drawLine(verticalPos, horizontalPos, Color::gray224);
             verticalPos.y++;
             horizontalPos.x--;
-            viewArea.drawLine(verticalPos, horizontalPos, Color::gray192);
+            screen-&gt;drawLine(verticalPos, horizontalPos, Color::gray192);
             verticalPos.y++;
             horizontalPos.x--;
-            viewArea.drawLine(verticalPos, horizontalPos, Color::gray160);
+            screen-&gt;drawLine(verticalPos, horizontalPos, Color::gray160);
             verticalPos.y++;
             horizontalPos.x--;
-            viewArea.drawLine(verticalPos, horizontalPos, Color::gray160);
+            screen-&gt;drawLine(verticalPos, horizontalPos, Color::gray160);
             verticalPos.y++;
             horizontalPos.x--;
-            viewArea.drawLine(verticalPos, horizontalPos, Color::gray160);
+            screen-&gt;drawLine(verticalPos, horizontalPos, Color::gray160);
             verticalPos.y++;
             horizontalPos.x--;
-            viewArea.drawLine(verticalPos, horizontalPos, Color::gray160);
+            screen-&gt;drawLine(verticalPos, horizontalPos, Color::gray160);
             verticalPos.y++;
             horizontalPos.x--;
-            viewArea.drawLine(verticalPos, horizontalPos, Color::gray160);
+            screen-&gt;drawLine(verticalPos, horizontalPos, Color::gray160);
             verticalPos.y++;
             horizontalPos.x--;
-            viewArea.drawLine(verticalPos, horizontalPos, Color::gray160);
+            screen-&gt;drawLine(verticalPos, horizontalPos, Color::gray160);
             verticalPos.y++;
             horizontalPos.x--;
-            viewArea.drawLine(verticalPos, horizontalPos, Color::gray160);
+            screen-&gt;drawLine(verticalPos, horizontalPos, Color::gray160);
             verticalPos.y++;
             horizontalPos.x--;
-            viewArea.drawLine(verticalPos, horizontalPos, Color::gray160);
+            screen-&gt;drawLine(verticalPos, horizontalPos, Color::gray160);
             verticalPos.y++;
             horizontalPos.x--;
-            viewArea.drawLine(verticalPos, horizontalPos, Color::gray160);
+            screen-&gt;drawLine(verticalPos, horizontalPos, Color::gray160);
             verticalPos.y++;
             horizontalPos.x--;
         }
@@ -213,40 +213,40 @@
             iXY verticalPos(min.x + borderSize, min.y + borderSize + moveAreaHeight - 1);
             iXY horizontalPos(min.x + borderSize + moveAreaHeight - 1, min.y + borderSize);
 
-            viewArea.drawLine(verticalPos, horizontalPos, Color::white);
+            screen-&gt;drawLine(verticalPos, horizontalPos, Color::white);
             verticalPos.y--;
             horizontalPos.x--;
-            viewArea.drawLine(verticalPos, horizontalPos, Color::gray224);
+            screen-&gt;drawLine(verticalPos, horizontalPos, Color::gray224);
             verticalPos.y--;
             horizontalPos.x--;
-            viewArea.drawLine(verticalPos, horizontalPos, Color::gray192);
+            screen-&gt;drawLine(verticalPos, horizontalPos, Color::gray192);
             verticalPos.y--;
             horizontalPos.x--;
-            viewArea.drawLine(verticalPos, horizontalPos, Color::gray160);
+            screen-&gt;drawLine(verticalPos, horizontalPos, Color::gray160);
             verticalPos.y--;
             horizontalPos.x--;
-            viewArea.drawLine(verticalPos, horizontalPos, Color::gray160);
+            screen-&gt;drawLine(verticalPos, horizontalPos, Color::gray160);
             verticalPos.y--;
             horizontalPos.x--;
-            viewArea.drawLine(verticalPos, horizontalPos, Color::gray160);
+            screen-&gt;drawLine(verticalPos, horizontalPos, Color::gray160);
             verticalPos.y--;
             horizontalPos.x--;
-            viewArea.drawLine(verticalPos, horizontalPos, Color::gray160);
+            screen-&gt;drawLine(verticalPos, horizontalPos, Color::gray160);
             verticalPos.y--;
             horizontalPos.x--;
-            viewArea.drawLine(verticalPos, horizontalPos, Color::gray160);
+            screen-&gt;drawLine(verticalPos, horizontalPos, Color::gray160);
             verticalPos.y--;
             horizontalPos.x--;
-            viewArea.drawLine(verticalPos, horizontalPos, Color::gray160);
+            screen-&gt;drawLine(verticalPos, horizontalPos, Color::gray160);
             verticalPos.y--;
             horizontalPos.x--;
-            viewArea.drawLine(verticalPos, horizontalPos, Color::gray160);
+            screen-&gt;drawLine(verticalPos, horizontalPos, Color::gray160);
             verticalPos.y--;
             horizontalPos.x--;
-            viewArea.drawLine(verticalPos, horizontalPos, Color::gray160);
+            screen-&gt;drawLine(verticalPos, horizontalPos, Color::gray160);
             verticalPos.y--;
             horizontalPos.x--;
-            viewArea.drawLine(verticalPos, horizontalPos, Color::gray160);
+            screen-&gt;drawLine(verticalPos, horizontalPos, Color::gray160);
             verticalPos.y--;
             horizontalPos.x--;
         }
@@ -256,40 +256,40 @@
             iXY verticalPos(min.x + getSizeX() - borderSize, min.y + borderSize + moveAreaHeight - 1);
             iXY horizontalPos(min.x + getSizeX() - borderSize - moveAreaHeight, min.y + borderSize - 1);
 
-            viewArea.drawLine(verticalPos, horizontalPos, Color::white);
+            screen-&gt;drawLine(verticalPos, horizontalPos, Color::white);
             verticalPos.y--;
             horizontalPos.x++;
-            viewArea.drawLine(verticalPos, horizontalPos, Color::gray224);
+            screen-&gt;drawLine(verticalPos, horizontalPos, Color::gray224);
             verticalPos.y--;
             horizontalPos.x++;
-            viewArea.drawLine(verticalPos, horizontalPos, Color::gray192);
+            screen-&gt;drawLine(verticalPos, horizontalPos, Color::gray192);
             verticalPos.y--;
             horizontalPos.x++;
-            viewArea.drawLine(verticalPos, horizontalPos, Color::gray160);
+            screen-&gt;drawLine(verticalPos, horizontalPos, Color::gray160);
             verticalPos.y--;
             horizontalPos.x++;
-            viewArea.drawLine(verticalPos, horizontalPos, Color::gray160);
+            screen-&gt;drawLine(verticalPos, horizontalPos, Color::gray160);
             verticalPos.y--;
             horizontalPos.x++;
-            viewArea.drawLine(verticalPos, horizontalPos, Color::gray160);
+            screen-&gt;drawLine(verticalPos, horizontalPos, Color::gray160);
             verticalPos.y--;
             horizontalPos.x++;
-            viewArea.drawLine(verticalPos, horizontalPos, Color::gray160);
+            screen-&gt;drawLine(verticalPos, horizontalPos, Color::gray160);
             verticalPos.y--;
             horizontalPos.x++;
-            viewArea.drawLine(verticalPos, horizontalPos, Color::gray160);
+            screen-&gt;drawLine(verticalPos, horizontalPos, Color::gray160);
             verticalPos.y--;
             horizontalPos.x++;
-            viewArea.drawLine(verticalPos, horizontalPos, Color::gray160);
+            screen-&gt;drawLine(verticalPos, horizontalPos, Color::gray160);
             verticalPos.y--;
             horizontalPos.x++;
-            viewArea.drawLine(verticalPos, horizontalPos, Color::gray160);
+            screen-&gt;drawLine(verticalPos, horizontalPos, Color::gray160);
             verticalPos.y--;
             horizontalPos.x++;
-            viewArea.drawLine(verticalPos, horizontalPos, Color::gray160);
+            screen-&gt;drawLine(verticalPos, horizontalPos, Color::gray160);
             verticalPos.y--;
             horizontalPos.x++;
-            viewArea.drawLine(verticalPos, horizontalPos, Color::gray160);
+            screen-&gt;drawLine(verticalPos, horizontalPos, Color::gray160);
             verticalPos.y--;
             horizontalPos.x++;
         }
@@ -299,40 +299,40 @@
             iXY verticalPos(min.x + getSizeX() - borderSize, min.y + getSizeY() - borderSize - moveAreaHeight + 1);
             iXY horizontalPos(min.x + getSizeX() - borderSize - moveAreaHeight + 1, min.y + getSizeY() - borderSize);
 
-            viewArea.drawLine(verticalPos, horizontalPos, Color::white);
+            screen-&gt;drawLine(verticalPos, horizontalPos, Color::white);
             verticalPos.y++;
             horizontalPos.x++;
-            viewArea.drawLine(verticalPos, horizontalPos, Color::gray224);
+            screen-&gt;drawLine(verticalPos, horizontalPos, Color::gray224);
             verticalPos.y++;
             horizontalPos.x++;
-            viewArea.drawLine(verticalPos, horizontalPos, Color::gray192);
+            screen-&gt;drawLine(verticalPos, horizontalPos, Color::gray192);
             verticalPos.y++;
             horizontalPos.x++;
-            viewArea.drawLine(verticalPos, horizontalPos, Color::gray160);
+            screen-&gt;drawLine(verticalPos, horizontalPos, Color::gray160);
             verticalPos.y++;
             horizontalPos.x++;
-            viewArea.drawLine(verticalPos, horizontalPos, Color::gray160);
+            screen-&gt;drawLine(verticalPos, horizontalPos, Color::gray160);
             verticalPos.y++;
             horizontalPos.x++;
-            viewArea.drawLine(verticalPos, horizontalPos, Color::gray160);
+            screen-&gt;drawLine(verticalPos, horizontalPos, Color::gray160);
             verticalPos.y++;
             horizontalPos.x++;
-            viewArea.drawLine(verticalPos, horizontalPos, Color::gray160);
+            screen-&gt;drawLine(verticalPos, horizontalPos, Color::gray160);
             verticalPos.y++;
             horizontalPos.x++;
-            viewArea.drawLine(verticalPos, horizontalPos, Color::gray160);
+            screen-&gt;drawLine(verticalPos, horizontalPos, Color::gray160);
             verticalPos.y++;
             horizontalPos.x++;
-            viewArea.drawLine(verticalPos, horizontalPos, Color::gray160);
+            screen-&gt;drawLine(verticalPos, horizontalPos, Color::gray160);
             verticalPos.y++;
             horizontalPos.x++;
-            viewArea.drawLine(verticalPos, horizontalPos, Color::gray160);
+            screen-&gt;drawLine(verticalPos, horizontalPos, Color::gray160);
             verticalPos.y++;
             horizontalPos.x++;
-            viewArea.drawLine(verticalPos, horizontalPos, Color::gray160);
+            screen-&gt;drawLine(verticalPos, horizontalPos, Color::gray160);
             verticalPos.y++;
             horizontalPos.x++;
-            viewArea.drawLine(verticalPos, horizontalPos, Color::gray160);
+            screen-&gt;drawLine(verticalPos, horizontalPos, Color::gray160);
             verticalPos.y++;
             horizontalPos.x++;
         }
@@ -342,12 +342,11 @@
 
 // draw
 //---------------------------------------------------------------------------
-void View::draw(Surface&amp; surface)
+void View::draw()
 {
     if (!getVisible())
         return;
 
-    currentscreen = &surface; // hack
     doDraw();
 } // end draw
 
@@ -395,7 +394,7 @@
 void View::doDraw()
 {
     if (getShowStatus()) {
-        drawStatus(*currentscreen);
+        drawStatus();
     }
 
     drawDefinedButtons();
@@ -407,18 +406,18 @@
     ComponentsIterator i;
     for ( i=components.begin(); i != components.end(); i++) {
         if (*i != focusComponent) {
-            (*i)-&gt;draw(clientRect.min.x, clientRect.min.y, *currentscreen);
+            (*i)-&gt;draw(clientRect.min.x, clientRect.min.y, *screen);
         }
     }
 
     // Now draw the selected component.
     if (focusComponent != 0) {
-        focusComponent-&gt;draw(clientRect.min.x, clientRect.min.y, *currentscreen);
+        focusComponent-&gt;draw(clientRect.min.x, clientRect.min.y, *screen);
     }
 
     if (getBordered()) {
-        drawTitle(*currentscreen);
-        drawBorder(*currentscreen);
+        drawTitle();
+        drawBorder();
     }
 } // end View::doDraw
 
@@ -905,7 +904,7 @@
     std::vector&lt;cButton*&gt;::iterator i;
     for(i = buttons.begin(); i != buttons.end(); i++) {
         cButton* button = *i;
-        button-&gt;topSurface.blt(*currentscreen, clientRect.min + button-&gt;getBounds().min);
+        button-&gt;topSurface.blt(*screen, clientRect.min + button-&gt;getBounds().min);
     }
 } // end drawDefinedButtons
 
@@ -921,7 +920,7 @@
         } else {
             inputFields[num]-&gt;draw();
         }
-        inputFields[num]-&gt;inputFieldSurface.blt(*currentscreen,
+        inputFields[num]-&gt;inputFieldSurface.blt(*screen,
                             clientRect.min.x + inputFields[num]-&gt;bounds.min.x,
                             clientRect.min.y + inputFields[num]-&gt;bounds.min.y);
     }
@@ -939,7 +938,7 @@
         return;
     } else if (buttons[highlightedButton]-&gt;topSurface.getFrameCount() &lt; 2) {
         cButton* button = buttons[highlightedButton];
-        currentscreen-&gt;drawRect(iRect(clientRect.min.x + button-&gt;getBounds().min.x,
+        screen-&gt;drawRect(iRect(clientRect.min.x + button-&gt;getBounds().min.x,
                                   clientRect.min.y + button-&gt;getBounds().min.y,
                                   clientRect.max.x + button-&gt;getBounds().max.x,
                                   clientRect.max.y + button-&gt;getBounds().max.y),
@@ -957,7 +956,7 @@
 
     // Change to the highlight button frame.
     buttons[highlightedButton]-&gt;topSurface.setFrame(1);
-    buttons[highlightedButton]-&gt;topSurface.blt(*currentscreen,
+    buttons[highlightedButton]-&gt;topSurface.blt(*screen,
             iXY(clientRect.min.x + buttons[highlightedButton]-&gt;getBounds().min.x,
                 clientRect.min.y + buttons[highlightedButton]-&gt;getBounds().min.y));
     buttons[highlightedButton]-&gt;topSurface.setFrame(0);
@@ -971,21 +970,6 @@
     buttons.push_back(button);
 }
 
-// addButtonCenterText
-//---------------------------------------------------------------------------
-// Purpose: Adds a centered type button to the list of buttons.
-//---------------------------------------------------------------------------
-void View::addButtonCenterText(const iXY &amp;pos,
-                               const int &amp;xSize,
-                               const char *name,
-                               const char *toolTip,
-                               ITEM_FUNC leftClickFunc)
-{
-    cButton* button = new cButton;
-    button-&gt;createCenterText(pos, xSize, name, toolTip, leftClickFunc);
-    buttons.push_back(button);
-} // end addButtonCenterText
-
 // setSearchName
 //---------------------------------------------------------------------------
 // Purpose: Sets the title of the window.
@@ -1063,16 +1047,16 @@
 
 // drawStatus
 //---------------------------------------------------------------------------
-void View::drawStatus(Surface &amp;dest)
+void View::drawStatus()
 {
     iRect r( min.x, max.y - DEFAULT_STATUS_BAR_HEIGHT, max.x, max.y);
 
-    currentscreen-&gt;fillRect(r, Color::gray192);
+    screen-&gt;fillRect(r, Color::gray192);
 
     // Draw the status text.
     if (statusText != 0) {
         int pos = (DEFAULT_STATUS_BAR_HEIGHT - Surface::getFontHeight()) &gt;&gt; 1;
-        currentscreen-&gt;bltString(r.min.x + pos, r.min.y + pos, statusText, Color::black);
+        screen-&gt;bltString(r.min.x + pos, r.min.y + pos, statusText, Color::black);
     }
 } // end View::drawStatus
 
@@ -1125,7 +1109,7 @@
 
     // Chage to the highlight button frame.
     buttons[pressedButton]-&gt;topSurface.setFrame(2);
-    buttons[pressedButton]-&gt;topSurface.blt(*currentscreen,
+    buttons[pressedButton]-&gt;topSurface.blt(*screen,
             iXY(clientRect.min.x + buttons[pressedButton]-&gt;getBounds().min.x,
                 clientRect.min.y + buttons[pressedButton]-&gt;getBounds().min.y));
     buttons[pressedButton]-&gt;topSurface.setFrame(0);
@@ -1363,13 +1347,13 @@
 {
     x += clientRect.min.x;
     y += clientRect.min.y;
-    currentscreen-&gt;bltString(x, y, str, color);
+    screen-&gt;bltString(x, y, str, color);
 }
 
 void
 View::drawStringCenter(const char* string, PIX color)
 {
-    currentscreen-&gt;bltStringCenteredInRect(clientRect, string, color);
+    screen-&gt;bltStringCenteredInRect(clientRect, string, color);
 }
 
 void
@@ -1377,7 +1361,7 @@
 {
     iRect r(rect);
     r.translate(clientRect.min);
-    currentscreen-&gt;bltStringInBox(r, string, color, gapSpace, drawBox);
+    screen-&gt;bltStringInBox(r, string, color, gapSpace, drawBox);
 }
 
 void
@@ -1385,19 +1369,19 @@
 {
     x += clientRect.min.x;
     y += clientRect.min.y;
-    currentscreen-&gt;bltStringShadowed( x, y, str, textColor, shadowColor);
+    screen-&gt;bltStringShadowed( x, y, str, textColor, shadowColor);
 }
 
 void
 View::drawImage( Surface &amp;s, int x, int y)
 {
-    s.blt(*currentscreen, clientRect.min.x + x, clientRect.min.y + y );
+    s.blt(*screen, clientRect.min.x + x, clientRect.min.y + y );
 }
 
 void
 View::drawImageTrans( Surface &amp;s, int x, int y)
 {
-    s.bltTrans(*currentscreen, clientRect.min.x + x, clientRect.min.y + y );
+    s.bltTrans(*screen, clientRect.min.x + x, clientRect.min.y + y );
 }
 
 void
@@ -1405,34 +1389,34 @@
 {
     iRect r(destRect);
     r.translate(clientRect.min);
-    currentscreen-&gt;bltLookup(r,table);
+    screen-&gt;bltLookup(r,table);
 }
 
 void
 View::drawButtonBorder(iRect bounds, PIX topLeftColor, PIX bottomRightColor)
 {
     bounds.translate(clientRect.min);
-    currentscreen-&gt;drawButtonBorder(bounds, topLeftColor, bottomRightColor);
+    screen-&gt;drawButtonBorder(bounds, topLeftColor, bottomRightColor);
 }
 
 void
 View::fill(const PIX&amp; color)
 {
-    currentscreen-&gt;fillRect(clientRect, color);
+    screen-&gt;fillRect(clientRect, color);
 }
 
 void
 View::drawRect(iRect bounds, const PIX&amp; color)
 {
     bounds.translate(clientRect.min);
-    currentscreen-&gt;drawRect(bounds, color);
+    screen-&gt;drawRect(bounds, color);
 }
 
 void
 View::fillRect(iRect bounds, const PIX&amp; color)
 {
     bounds.translate(clientRect.min);
-    currentscreen-&gt;fillRect(bounds, color);
+    screen-&gt;fillRect(bounds, color);
 }
 
 void
@@ -1440,15 +1424,15 @@
 {
     if (gameconfig-&gt;viewdrawbackgroundmode == VIEW_BACKGROUND_DARK_GRAY_BLEND)
     {
-        currentscreen-&gt;bltLookup(*this, Palette::darkGray256.getColorArray());
+        screen-&gt;bltLookup(*this, Palette::darkGray256.getColorArray());
     }
     else if (gameconfig-&gt;viewdrawbackgroundmode == VIEW_BACKGROUND_LIGHT_GRAY_BLEND)
     {
-        currentscreen-&gt;bltLookup(*this, Palette::gray256.getColorArray());
+        screen-&gt;bltLookup(*this, Palette::gray256.getColorArray());
     }
     else if (gameconfig-&gt;viewdrawbackgroundmode == VIEW_BACKGROUND_SOLID_BLACK)
     {
-        currentscreen-&gt;fillRect(*this, Color::black);
+        screen-&gt;fillRect(*this, Color::black);
     }
     else if (gameconfig-&gt;viewdrawbackgroundmode == VIEW_BACKGROUND_TRANSPARENT)
     {

Modified: trunk/netpanzer/src/NetPanzer/Views/Components/View.hpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Views/Components/View.hpp	2009-01-29 08:30:59 UTC (rev 1088)
+++ trunk/netpanzer/src/NetPanzer/Views/Components/View.hpp	2009-01-30 13:34:05 UTC (rev 1089)
@@ -179,6 +179,8 @@
     void drawViewBackground();
     void fill(const PIX &amp;color);
     void fillRect(iRect bounds, const PIX &amp;color);
+
+    virtual void onComponentClicked(Component *c) { (void)c; }
     
 protected:
     virtual void     actionPerformed(mMouseEvent )
@@ -243,7 +245,6 @@
 
     // cButton Functions.
     void addButtonPackedSurface(const iXY &amp;pos, PackedSurface &amp;source, const char *toolTip, ITEM_FUNC leftClickFunc);
-    void addButtonCenterText(const iXY &amp;pos, const int &amp;xSize, const char *nName, const char *nToolTip, ITEM_FUNC nLeftClickFunc);
     /*!FIXME!*/ void drawDefinedButtons   ();
     void drawHighlightedButton();
     void drawPressedButton();
@@ -255,7 +256,7 @@
     void  setSearchName(const char *searchName);
     void  setTitle(const char *title);
     void  setSubTitle(const char *subTitle);
-    void  drawTitle(Surface &amp;windowArea);
+    void  drawTitle();
 
     // Input Field Functions
     cInputField* addInputField(const iXY &amp;pos, cInputFieldString *string, const char *excludedCharacters, const bool &amp;isSelected);
@@ -263,9 +264,9 @@
     void drawInputFields();
 
     /////////////////////////////////
-    void draw(Surface&amp; drawon);
+    void draw();
     void showStatus(const char *string);
-    void drawStatus(Surface &amp;dest);
+    void drawStatus();
     virtual void checkResolution(iXY oldResolution, iXY newResolution);
     void checkArea(iXY viewarea);
     void toggleView();
@@ -274,7 +275,7 @@
     /////////////////////////////////
 
     // These options can be modified on a per View type basis
-    virtual void drawBorder(Surface &amp;windowArea);
+    virtual void drawBorder();
     virtual void doDraw();
     virtual void doActivate();
     virtual void doDeactivate();
@@ -306,7 +307,6 @@
     int borderSize;
     int snapToTolerance;
 
-    Surface* currentscreen; // HACK
     iRect clientRect;
 };
 

Modified: trunk/netpanzer/src/NetPanzer/Views/Game/AreYouSureExitView.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Views/Game/AreYouSureExitView.cpp	2009-01-29 08:30:59 UTC (rev 1088)
+++ trunk/netpanzer/src/NetPanzer/Views/Game/AreYouSureExitView.cpp	2009-01-30 13:34:05 UTC (rev 1089)
@@ -35,7 +35,6 @@
 static void bNO()
 {
     Desktop::setVisibility(&quot;AreYouSureExitView&quot;, false);
-    //Desktop::setVisibility(&quot;ResignView&quot;, true);
 }
 
 // AreYouSureExitView

Modified: trunk/netpanzer/src/NetPanzer/Views/Game/CodeStatsView.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Views/Game/CodeStatsView.cpp	2009-01-29 08:30:59 UTC (rev 1088)
+++ trunk/netpanzer/src/NetPanzer/Views/Game/CodeStatsView.cpp	2009-01-30 13:34:05 UTC (rev 1089)
@@ -25,6 +25,7 @@
 #include &quot;Interfaces/PathScheduler.hpp&quot;
 #include &quot;Interfaces/PlayerInterface.hpp&quot;
 #include &quot;Units/UnitInterface.hpp&quot;
+#include &quot;Views/Components/Button.hpp&quot;
 
 enum{ _display_mode_network_stats,
       _display_mode_pathing_stats,
@@ -35,71 +36,17 @@
 int gPacketSize = 0;
 int display_mode;
 
-
-/*
-static void bPlusPacketSize( void )
- {
-  gPacketSize++ 
- }
- 
-static void bMinusPacketSize( void )
- {
-  gPacketSize--;
- }
- 
-static void bSend( void )
- {
- 
- }
-*/
-
-static void buttonNetwork( void )
+enum
 {
-    display_mode = _display_mode_network_stats;
+    BTN_NETWORK,
+    BTN_SORTER,
+    BTN_UNIT,
+    BTN_PATHING,
+    BTN_DEBUG,
+    BTN_SAMPLE,
+    BTN_NETLOG
+};
 
-}
-
-static void buttonSorter( void )
-{
-    display_mode = _display_mode_sorter_stats;
-}
-
-static void buttonPathing( void )
-{
-    display_mode = _display_mode_pathing_stats;
-}
-
-static void buttonDebug( void )
-{
-    static bool previous_flag = false;
-
-    if ( previous_flag == false ) {
-        PathScheduler::setLongPatherDebug( true );
-        // XXX if needed change for new MiniMap.hpp
-        //MiniMapInterface::setPathingDebugMode( true );
-        previous_flag = true;
-    } else {
-        PathScheduler::setLongPatherDebug( false );
-        //MiniMapInterface::setPathingDebugMode( false );
-        previous_flag = false;
-    }
-}
-
-static void buttonSample( void )
-{
-    PathScheduler::sampleLongPather( );
-}
-
-static void buttonUnit( void )
-{
-    display_mode = _display_mode_unit_stats;
-}
-
-static void bNetLog( void )
-{
-    NetworkState::logNetworkStats();
-}
-
 static long INFO_AREA_Y_OFFSET = 60;
 
 CodeStatsView::CodeStatsView() : GameTemplateView()
@@ -122,18 +69,18 @@
     resize(area_size);
 
     bXOffset = area_size.x / 3;
-    addButtonCenterText(iXY(0, INFO_AREA_Y_OFFSET), bXOffset,  &quot;Net&quot;, &quot;&quot;, buttonNetwork);
-    addButtonCenterText(iXY(bXOffset, INFO_AREA_Y_OFFSET), bXOffset, &quot;Sprite&quot;, &quot;&quot;, buttonSorter);
-    addButtonCenterText(iXY(bXOffset*2, INFO_AREA_Y_OFFSET), bXOffset, &quot;Unit&quot;, &quot;&quot;, buttonUnit);
+    add( Button::createTextButton( &quot;net&quot;, &quot;Net&quot;, iXY(0, INFO_AREA_Y_OFFSET), bXOffset, BTN_NETWORK));
+    add( Button::createTextButton( &quot;sprite&quot;, &quot;Sprite&quot;, iXY(bXOffset, INFO_AREA_Y_OFFSET), bXOffset, BTN_SORTER));
+    add( Button::createTextButton( &quot;unit&quot;, &quot;Unit&quot;, iXY(bXOffset*2, INFO_AREA_Y_OFFSET), bXOffset, BTN_UNIT));
 
     INFO_AREA_Y_OFFSET += 18;
-    addButtonCenterText(iXY(0, INFO_AREA_Y_OFFSET), area_size.x, &quot;Path&quot;, &quot;&quot;, buttonPathing);
+    add( Button::createTextButton( &quot;path&quot;, &quot;Path&quot;, iXY(0, INFO_AREA_Y_OFFSET), area_size.x, BTN_PATHING));
 
     INFO_AREA_Y_OFFSET += 18;
     bXOffset = area_size.x / 3;
-    addButtonCenterText(iXY(0, INFO_AREA_Y_OFFSET), bXOffset,  &quot;Debug&quot;, &quot;&quot;, buttonDebug);
-    addButtonCenterText(iXY(bXOffset, INFO_AREA_Y_OFFSET), bXOffset, &quot;Sample&quot;, &quot;&quot;, buttonSample);
-    addButtonCenterText(iXY(bXOffset*2, INFO_AREA_Y_OFFSET), bXOffset, &quot;NetLog&quot;, &quot;&quot;, bNetLog );
+    add( Button::createTextButton( &quot;debug&quot;, &quot;Debug&quot;, iXY(0, INFO_AREA_Y_OFFSET), bXOffset, BTN_DEBUG));
+    add( Button::createTextButton( &quot;sample&quot;, &quot;Sample&quot;, iXY(bXOffset, INFO_AREA_Y_OFFSET), bXOffset, BTN_SAMPLE));
+    add( Button::createTextButton( &quot;netlog&quot;, &quot;NetLog&quot;, iXY(bXOffset*2, INFO_AREA_Y_OFFSET), bXOffset, BTN_NETLOG));
 
     INFO_AREA_Y_OFFSET += 18;
     /*
@@ -371,3 +318,40 @@
     str_loc.y += 12;
 
 }
+
+void
+CodeStatsView::onComponentClicked(Component* c)
+{
+    switch ( c-&gt;getCustomCode() )
+    {
+        case BTN_NETWORK:
+            display_mode = _display_mode_network_stats;
+            break;
+
+        case BTN_SORTER:
+            display_mode = _display_mode_sorter_stats;
+            break;
+
+        case BTN_UNIT:
+            display_mode = _display_mode_unit_stats;
+            break;
+
+        case BTN_PATHING:
+            display_mode = _display_mode_pathing_stats;
+            break;
+
+        case BTN_DEBUG:
+            static bool previous_flag = false;
+            previous_flag = !previous_flag;
+            PathScheduler::setLongPatherDebug(previous_flag);
+            break;
+
+        case BTN_SAMPLE:
+            PathScheduler::sampleLongPather();
+            break;
+
+        case BTN_NETLOG:
+            NetworkState::logNetworkStats();
+            break;
+    }
+}

Modified: trunk/netpanzer/src/NetPanzer/Views/Game/CodeStatsView.hpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Views/Game/CodeStatsView.hpp	2009-01-29 08:30:59 UTC (rev 1088)
+++ trunk/netpanzer/src/NetPanzer/Views/Game/CodeStatsView.hpp	2009-01-30 13:34:05 UTC (rev 1089)
@@ -34,6 +34,7 @@
     void drawSorterStats();
     void drawPathingStats();
     void drawUnitStats();
+    void onComponentClicked(Component *c);
 
 public:
     CodeStatsView();

Modified: trunk/netpanzer/src/NetPanzer/Views/Game/DisconectedView.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Views/Game/DisconectedView.cpp	2009-01-29 08:30:59 UTC (rev 1088)
+++ trunk/netpanzer/src/NetPanzer/Views/Game/DisconectedView.cpp	2009-01-30 13:34:05 UTC (rev 1089)
@@ -30,80 +30,13 @@
 #include &quot;Classes/ScreenSurface.hpp&quot;
 
 #include &quot;Util/Log.hpp&quot;
+#include &quot;Views/Components/Button.hpp&quot;
 
-
-void
-DisconectedView::buttonOk()
+enum
 {
-    if(gameconfig-&gt;quickConnect == true) {
-        GameManager::exitNetPanzer();
-        return;
-    }
-    
-    GameManager::drawTextCenteredOnScreen(&quot;Loading Main View...&quot;, Color::white);
-    sprintf(MenuTemplateView::currentMultiView, &quot;GetSessionView&quot;);
+    BTN_OK
+};
 
-    // Vlad put all code in here for shutdown.
-    //----------------------
-    GameManager::quitNetPanzerGame();
-    //----------------------
-
-    // Swap to the menu resolution.
-    //GameManager::setVideoMode(iXY(640, 480), false);
-
-    GameManager::drawTextCenteredOnScreen(&quot;Loading Main View...&quot;, Color::white);
-
-    GameManager::loadPalette(&quot;netpmenu&quot;);
-
-    // Must remove the gameView first so that the initButtons detects that
-    // and loads the correct buttons.
-    Desktop::setVisibilityAllWindows(false);
-    Desktop::setVisibility(&quot;MainView&quot;, true);
-
-    View *v = Desktop::getView(&quot;OptionsView&quot;);
-
-    if (v != 0) {
-        ((OptionsTemplateView *)v)-&gt;initButtons();
-        ((OptionsTemplateView *)v)-&gt;setAlwaysOnBottom(true);
-    } else {
-        assert(false);
-    }
-
-    v = Desktop::getView(&quot;SoundView&quot;);
-    if (v != 0) {
-        ((SoundView *)v)-&gt;initButtons();
-        ((OptionsTemplateView *)v)-&gt;setAlwaysOnBottom(true);
-    } else {
-        assert(false);
-    }
-
-    v = Desktop::getView(&quot;ControlsView&quot;);
-    if (v != 0) {
-        ((ControlsView *)v)-&gt;initButtons();
-        ((OptionsTemplateView *)v)-&gt;setAlwaysOnBottom(true);
-    } else {
-        assert(false);
-    }
-
-    v = Desktop::getView(&quot;VisualsView&quot;);
-    if (v != 0) {
-        ((VisualsView *)v)-&gt;initButtons();
-        ((OptionsTemplateView *)v)-&gt;setAlwaysOnBottom(true);
-    } else {
-        assert(false);
-    }
-
-    v = Desktop::getView(&quot;InterfaceView&quot;);
-    if (v != 0) {
-        ((InterfaceView *)v)-&gt;initButtons();
-        ((OptionsTemplateView *)v)-&gt;setAlwaysOnBottom(true);
-    } else {
-        assert(false);
-    }
-    LOGGER.warning(&quot;DisconectedView:: finished disconection&quot;);
-}
-
-
 DisconectedView::DisconectedView() : SpecialButtonView()
 {
     setSearchName(&quot;DisconectedView&quot;);
@@ -123,9 +56,9 @@
     moveTo(0,0);
 
     int bsize = Surface::getTextLength(&quot; &quot;) * 8;
-    addButtonCenterText(iXY((getClientRect().getSizeX()/2)-(bsize/2),
+    add( Button::createTextButton( &quot;btok&quot;, &quot;Ok&quot;, iXY((getClientRect().getSizeX()/2)-(bsize/2),
                 (getClientRect().getSizeY()/2)+(Surface::getFontHeight() * 2)),
-                bsize, &quot;Ok&quot;, &quot;&quot;, buttonOk);
+                bsize, BTN_OK) );
 }
 
 void
@@ -143,3 +76,78 @@
     init();
     Desktop::setActiveView(this);
 }
+
+void
+DisconectedView::onComponentClicked(Component* c)
+{
+    if ( c-&gt;getCustomCode() == BTN_OK )
+    {
+        if(gameconfig-&gt;quickConnect == true)
+        {
+            GameManager::exitNetPanzer();
+            return;
+        }
+
+        GameManager::drawTextCenteredOnScreen(&quot;Loading Main View...&quot;, Color::white);
+        sprintf(MenuTemplateView::currentMultiView, &quot;GetSessionView&quot;);
+
+        // Vlad put all code in here for shutdown.
+        //----------------------
+        GameManager::quitNetPanzerGame();
+        //----------------------
+
+        // Swap to the menu resolution.
+        //GameManager::setVideoMode(iXY(640, 480), false);
+
+        GameManager::drawTextCenteredOnScreen(&quot;Loading Main View...&quot;, Color::white);
+
+        GameManager::loadPalette(&quot;netpmenu&quot;);
+
+        // Must remove the gameView first so that the initButtons detects that
+        // and loads the correct buttons.
+        Desktop::setVisibilityAllWindows(false);
+        Desktop::setVisibility(&quot;MainView&quot;, true);
+
+        View *v = Desktop::getView(&quot;OptionsView&quot;);
+
+        if (v != 0) {
+            ((OptionsTemplateView *)v)-&gt;initButtons();
+            ((OptionsTemplateView *)v)-&gt;setAlwaysOnBottom(true);
+        } else {
+            assert(false);
+        }
+
+        v = Desktop::getView(&quot;SoundView&quot;);
+        if (v != 0) {
+            ((SoundView *)v)-&gt;initButtons();
+            ((OptionsTemplateView *)v)-&gt;setAlwaysOnBottom(true);
+        } else {
+            assert(false);
+        }
+
+        v = Desktop::getView(&quot;ControlsView&quot;);
+        if (v != 0) {
+            ((ControlsView *)v)-&gt;initButtons();
+            ((OptionsTemplateView *)v)-&gt;setAlwaysOnBottom(true);
+        } else {
+            assert(false);
+        }
+
+        v = Desktop::getView(&quot;VisualsView&quot;);
+        if (v != 0) {
+            ((VisualsView *)v)-&gt;initButtons();
+            ((OptionsTemplateView *)v)-&gt;setAlwaysOnBottom(true);
+        } else {
+            assert(false);
+        }
+
+        v = Desktop::getView(&quot;InterfaceView&quot;);
+        if (v != 0) {
+            ((InterfaceView *)v)-&gt;initButtons();
+            ((OptionsTemplateView *)v)-&gt;setAlwaysOnBottom(true);
+        } else {
+            assert(false);
+        }
+        LOGGER.warning(&quot;DisconectedView:: finished disconection&quot;);
+    }
+}

Modified: trunk/netpanzer/src/NetPanzer/Views/Game/DisconectedView.hpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Views/Game/DisconectedView.hpp	2009-01-29 08:30:59 UTC (rev 1088)
+++ trunk/netpanzer/src/NetPanzer/Views/Game/DisconectedView.hpp	2009-01-30 13:34:05 UTC (rev 1089)
@@ -28,9 +28,11 @@
 {
 private:
     void init();
-    static void buttonOk();
     std::string disconectMsg;
 
+protected:
+    void onComponentClicked(Component *c);
+    
 public:
     DisconectedView();
 

Modified: trunk/netpanzer/src/NetPanzer/Views/Game/GameView.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Views/Game/GameView.cpp	2009-01-29 08:30:59 UTC (rev 1088)
+++ trunk/netpanzer/src/NetPanzer/Views/Game/GameView.cpp	2009-01-30 13:34:05 UTC (rev 1089)
@@ -103,7 +103,7 @@
     if (gDrawSolidBackground) {
         fill(250);
     } else {
-        drawMap(*currentscreen);
+        drawMap(*screen);
     }
 
     // Added for debugging, accesible through LibView.
@@ -125,14 +125,14 @@
     ObjectiveInterface::offloadGraphics( SPRITE_SORTER );
     PowerUpInterface::offloadGraphics( SPRITE_SORTER );
 
-    SPRITE_SORTER.blitLists(currentscreen);
+    SPRITE_SORTER.blitLists(screen);
 
-    VehicleSelectionView::drawMiniProductionStatus(*currentscreen);
+    VehicleSelectionView::drawMiniProductionStatus(*screen);
 
     COMMAND_PROCESSOR.draw();
 
     // Make sure the console info is the last thing drawn.
-    ConsoleInterface::update(*currentscreen);
+    ConsoleInterface::update(*screen);
     
     View::doDraw();
 } // end GameView::doDraw

Modified: trunk/netpanzer/src/NetPanzer/Views/Game/LibView.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Views/Game/LibView.cpp	2009-01-29 08:30:59 UTC (rev 1088)
+++ trunk/netpanzer/src/NetPanzer/Views/Game/LibView.cpp	2009-01-30 13:34:05 UTC (rev 1089)
@@ -17,6 +17,8 @@
 */
 #include &lt;config.h&gt;
 
+#include &quot;Views/Components/Button.hpp&quot;
+
 #include &quot;LibView.hpp&quot;
 #include &quot;Views/Components/Desktop.hpp&quot;
 #include &quot;Particles/ParticleSystem2D.hpp&quot;
@@ -36,26 +38,13 @@
 bool gDrawGameTiles = true;
 bool gDrawUnitTips  = false;
 
-
-int LibView::displayMode = LIBVIEW_MODE_SURFACE_INFO;
-
-static void bSurfaceInfo()
+enum
 {
-    LibView::displayMode = LIBVIEW_MODE_SURFACE_INFO;
-}
+    BTN_SURFACE,
+    BTN_PARTICLE,
+    BTN_ENVIRONMENT
+};
 
-static void bParticleInfo()
-{
-    LibView::displayMode = LIBVIEW_MODE_PARTICLE_INFO;
-}
-
-
-static void bEnvironmentInfo()
-{
-    LibView::displayMode = LIBVIEW_MODE_ENVIRONMENT_INFO;
-}
-
-
 // LibView
 //---------------------------------------------------------------------------
 LibView::LibView() : GameTemplateView()
@@ -72,9 +61,9 @@
     moveTo(0, 0);
     resize(325, 375);
 
-    addButtonCenterText(iXY((getClientRect().getSize().x / 3) * 0, 0), getClientRect().getSize().x / 3, &quot;Surface&quot;, &quot;&quot;, bSurfaceInfo);
-    addButtonCenterText(iXY((getClientRect().getSize().x / 3) * 1, 0), getClientRect().getSize().x / 3, &quot;Particles&quot;, &quot;&quot;, bParticleInfo);
-    addButtonCenterText(iXY((getClientRect().getSize().x / 3) * 2, 0), getClientRect().getSize().x / 3, &quot;Environment&quot;, &quot;&quot;, bEnvironmentInfo);
+    add( Button::createTextButton(&quot;surface&quot;, &quot;Surface&quot;, iXY((clientRect.getSizeX() / 3) * 0, 0), clientRect.getSizeX() / 3, BTN_SURFACE));
+    add( Button::createTextButton(&quot;particles&quot;, &quot;Particles&quot;, iXY((clientRect.getSizeX() / 3) * 1, 0), clientRect.getSizeX() / 3, BTN_PARTICLE));
+    add( Button::createTextButton(&quot;environment&quot;, &quot;Environment&quot;, iXY((clientRect.getSizeX() / 3) * 2, 0), clientRect.getSizeX() / 3, BTN_ENVIRONMENT));
 
     checkBoxAllowParticleGeneration = new CheckBox();
     checkBoxAllowParticleGeneration-&gt;setLabel(&quot;Allow Particle Generation&quot;);
@@ -124,6 +113,8 @@
     checkBoxDrawExplosionParticleCount-&gt;setState(ParticleInterface::gDrawExplosionParticleCount);
     add(checkBoxDrawExplosionParticleCount);
 
+    displayMode = LIBVIEW_MODE_SURFACE_INFO;
+
 } // end LibView::LibView
 
 // doDraw
@@ -135,6 +126,7 @@
     int x       =   5;
     int y       = 135;
     //int yOffset =  15;
+    drawViewBackground();
 
     switch(displayMode) {
     case LIBVIEW_MODE_SURFACE_INFO: {
@@ -340,3 +332,22 @@
     }
 
 } // end LibView::actionPerformed
+
+void
+LibView::onComponentClicked(Component* c)
+{
+    switch ( c-&gt;getCustomCode() )
+    {
+        case BTN_SURFACE:
+            displayMode = LIBVIEW_MODE_SURFACE_INFO;
+            break;
+
+        case BTN_PARTICLE:
+            displayMode = LIBVIEW_MODE_PARTICLE_INFO;
+            break;
+
+        case BTN_ENVIRONMENT:
+            displayMode = LIBVIEW_MODE_ENVIRONMENT_INFO;
+            break;
+    }
+}

Modified: trunk/netpanzer/src/NetPanzer/Views/Game/LibView.hpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Views/Game/LibView.hpp	2009-01-29 08:30:59 UTC (rev 1088)
+++ trunk/netpanzer/src/NetPanzer/Views/Game/LibView.hpp	2009-01-30 13:34:05 UTC (rev 1089)
@@ -49,6 +49,9 @@
     CheckBox * checkBoxSolidBackground;
     CheckBox * checkBoxDrawExplosionParticleCount;
 
+    void onComponentClicked(Component *c);
+    int displayMode;
+
 public:
     LibView();
     virtual ~LibView()
@@ -58,8 +61,6 @@
     virtual void rMouseDrag(const iXY &amp;downPos, const iXY &amp;prevPos, const iXY &amp;newPos);
     virtual void doActivate();
     virtual void actionPerformed(mMouseEvent me);
-
-    static int displayMode;
 }; // end LibView
 
 #endif // end __LibView_hpp__

Modified: trunk/netpanzer/src/NetPanzer/Views/Game/LoadingView.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Views/Game/LoadingView.cpp	2009-01-29 08:30:59 UTC (rev 1088)
+++ trunk/netpanzer/src/NetPanzer/Views/Game/LoadingView.cpp	2009-01-30 13:34:05 UTC (rev 1089)
@@ -15,22 +15,16 @@
 #include &quot;Classes/ScreenSurface.hpp&quot;
 #include &quot;Interfaces/GameManager.hpp&quot;
 #include &quot;Views/Components/Desktop.hpp&quot;
+#include &quot;Views/Components/Button.hpp&quot;
 
 list&lt;string&gt; LoadingView::lines;
 bool LoadingView::dirty = true;
 
-static void bAbort()
+enum
 {
-    if(gameconfig-&gt;quickConnect) {
-        GameManager::exitNetPanzer();
-        return;
-    }
-    sound-&gt;stopTankIdle();
-    Desktop::setVisibilityAllWindows(false);
-    Desktop::setVisibility(&quot;MainView&quot;, true);
-}
+    BTN_ABORT
+};
 
-
 void
 LoadingView::init()
 {
@@ -46,7 +40,7 @@
 
     resize(640, 480);
     
-    addButtonCenterText(iXY(628 - 60, 302 - 15), 60, &quot;Abort&quot;, &quot;Cancel the joining of this game.&quot;, bAbort);
+    add( Button::createTextButton(&quot;abort&quot;,&quot;Abort&quot;, iXY(628 - 60, 302 - 15), 60, BTN_ABORT) );
     
 }
 
@@ -102,3 +96,19 @@
     backgroundSurface.free();
     surface.free();
 }
+
+void
+LoadingView::onComponentClicked(Component* c)
+{
+    if ( c-&gt;getCustomCode() == BTN_ABORT )
+    {
+        if(gameconfig-&gt;quickConnect)
+        {
+            GameManager::exitNetPanzer();
+            return;
+        }
+        sound-&gt;stopTankIdle();
+        Desktop::setVisibilityAllWindows(false);
+        Desktop::setVisibility(&quot;MainView&quot;, true);
+    }
+}

Modified: trunk/netpanzer/src/NetPanzer/Views/Game/LoadingView.hpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Views/Game/LoadingView.hpp	2009-01-29 08:30:59 UTC (rev 1088)
+++ trunk/netpanzer/src/NetPanzer/Views/Game/LoadingView.hpp	2009-01-30 13:34:05 UTC (rev 1089)
@@ -95,6 +95,9 @@
     virtual void doDraw();
     void render();
     
+protected:
+    void onComponentClicked(Component *c);
+
 private:
     static list&lt;string&gt; lines;
     static bool dirty;

Deleted: trunk/netpanzer/src/NetPanzer/Views/Game/ResignView.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Views/Game/ResignView.cpp	2009-01-29 08:30:59 UTC (rev 1088)
+++ trunk/netpanzer/src/NetPanzer/Views/Game/ResignView.cpp	2009-01-30 13:34:05 UTC (rev 1089)
@@ -1,103 +0,0 @@
-/*
-Copyright (C) 1998 Pyrosoft Inc. (www.pyrosoftgames.com), Matthew Bogue
- 
-This program is free software; you can redistribute it and/or modify
-it under the terms of the GNU General Public License as published by
-the Free Software Foundation; either version 2 of the License, or
-(at your option) any later version.
- 
-This program is distributed in the hope that it will be useful,
-but WITHOUT ANY WARRANTY; without even the implied warranty of
-MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-GNU General Public License for more details.
- 
-You should have received a copy of the GNU General Public License
-along with this program; if not, write to the Free Software
-Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
-*/
-#include &lt;config.h&gt;
-
-#include &quot;ResignView.hpp&quot;
-#include &quot;Views/Components/Desktop.hpp&quot;
-#include &quot;2D/Palette.hpp&quot;
-#include &quot;AreYouSureResignView.hpp&quot;
-#include &quot;AreYouSureExitView.hpp&quot;
-
-//---------------------------------------------------------------------------
-static void bResign()
-{
-    Desktop::setVisibility(&quot;ResignView&quot;, false);
-    Desktop::setVisibility(&quot;AreYouSureResignView&quot;, true);
-}
-
-//---------------------------------------------------------------------------
-static void bReturnToGame()
-{
-    Desktop::setVisibility(&quot;ResignView&quot;, false);
-}
-
-//---------------------------------------------------------------------------
-static void bExitNetPanzer()
-{
-    Desktop::setVisibility(&quot;ResignView&quot;, false);
-    Desktop::setVisibility(&quot;AreYouSureExitView&quot;, true);
-}
-
-
-// ResignView
-//---------------------------------------------------------------------------
-ResignView::ResignView() : View()
-{
-    setSearchName(&quot;ResignView&quot;);
-    setTitle(&quot;Resign&quot;);
-    setSubTitle(&quot;&quot;);
-
-} // end ResignView::ResignView
-
-// init
-//---------------------------------------------------------------------------
-void ResignView::init()
-{
-    removeAllButtons();
-
-    setBordered(false);
-    setAllowResize(false);
-    setDisplayStatusBar(false);
-
-    resize(iXY(480, 80));
-
-    iXY buttonSize(150, 15);
-    //int BUTTON_COUNT = 2;
-    int x            = (getClientRect().getSize().x - buttonSize.x) / 2;
-    int y;
-    int yOffset      = buttonSize.y * 2;
-
-    y = 0;
-    addButtonCenterText(iXY(x, y), buttonSize.x, &quot;Resign&quot;, &quot;Returns to the MainView.&quot;, bResign);
-    y += yOffset;
-    addButtonCenterText(iXY(x, y), buttonSize.x, &quot;Exit netPanzer&quot;, &quot;Exits to Windows.&quot;, bExitNetPanzer);
-    y += yOffset;
-    addButtonCenterText(iXY(x, y), buttonSize.x, &quot;Return To Game&quot;, &quot;&quot;, bReturnToGame);
-
-} // end ResignView::init
-
-// doDraw
-//---------------------------------------------------------------------------
-void ResignView::doDraw()
-{
-    //iRect r(0, 0, currentscreen-&gt;getWidth(), currentscreen-&gt;getHeight());
-
-    drawTransRect(*this, Palette::darkGray256.getColorArray());
-    drawButtonBorder(*this, Color::lightGreen, Color::darkGreen);
-
-    View::doDraw();
-} // end ResignView::doDraw
-
-// doActivate
-//---------------------------------------------------------------------------
-void ResignView::doActivate()
-{
-    init();
-    Desktop::setActiveView(this);
-
-} // end ResignView::doActivate

Deleted: trunk/netpanzer/src/NetPanzer/Views/Game/ResignView.hpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Views/Game/ResignView.hpp	2009-01-29 08:30:59 UTC (rev 1088)
+++ trunk/netpanzer/src/NetPanzer/Views/Game/ResignView.hpp	2009-01-30 13:34:05 UTC (rev 1089)
@@ -1,37 +0,0 @@
-/*
-Copyright (C) 1998 Pyrosoft Inc. (www.pyrosoftgames.com), Matthew Bogue
- 
-This program is free software; you can redistribute it and/or modify
-it under the terms of the GNU General Public License as published by
-the Free Software Foundation; either version 2 of the License, or
-(at your option) any later version.
- 
-This program is distributed in the hope that it will be useful,
-but WITHOUT ANY WARRANTY; without even the implied warranty of
-MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-GNU General Public License for more details.
- 
-You should have received a copy of the GNU General Public License
-along with this program; if not, write to the Free Software
-Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
-*/
-#ifndef __ResignView_hpp__
-#define __ResignView_hpp__
-
-#include &quot;Views/Components/View.hpp&quot;
-#include &quot;2D/Surface.hpp&quot;
-
-//---------------------------------------------------------------------------
-class ResignView : public View
-{
-private:
-    void init();
-
-public:
-    ResignView();
-
-    virtual void doDraw();
-    virtual void doActivate();
-}; // end ResignView
-
-#endif // end __ResignView_hpp__

Modified: trunk/netpanzer/src/NetPanzer/Views/Game/VehicleSelectionView.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Views/Game/VehicleSelectionView.cpp	2009-01-29 08:30:59 UTC (rev 1088)
+++ trunk/netpanzer/src/NetPanzer/Views/Game/VehicleSelectionView.cpp	2009-01-30 13:34:05 UTC (rev 1089)
@@ -172,7 +172,7 @@
     moveTo(iXY(0, 0));
 
     const int yOffset  = 15;
-    const int gapSpace =  1;
+    const int gapSpace =  2;
 
     resize(48 * 5 + gapSpace * 4, 198 + 84);
 

Modified: trunk/netpanzer/src/NetPanzer/Views/MainMenu/MenuTemplateView.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Views/MainMenu/MenuTemplateView.cpp	2009-01-29 08:30:59 UTC (rev 1088)
+++ trunk/netpanzer/src/NetPanzer/Views/MainMenu/MenuTemplateView.cpp	2009-01-30 13:34:05 UTC (rev 1089)
@@ -232,7 +232,7 @@
 
         //titlePackedSurface.blt(clientArea, bodyTextRect.min.x, 390);
         //titlePackedSurface.bltBlend(clientArea, bodyTextRect.min.x, 390, Palette::colorTable6040);
-        titlePackedSurface.bltBlend(*currentscreen, min.x + 40, min.y+390, Palette::colorTable6040);
+        titlePackedSurface.bltBlend(*screen, min.x + 40, min.y+390, Palette::colorTable6040);
     }
 
     View::doDraw();

Modified: trunk/netpanzer/src/NetPanzer/Views/MainMenu/Multi/FlagSelectionView.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Views/MainMenu/Multi/FlagSelectionView.cpp	2009-01-29 08:30:59 UTC (rev 1088)
+++ trunk/netpanzer/src/NetPanzer/Views/MainMenu/Multi/FlagSelectionView.cpp	2009-01-30 13:34:05 UTC (rev 1089)
@@ -33,49 +33,7 @@
 string FlagSelectionView::playerFlagSelected = &quot;&quot;;
 Surface FlagSelectionView::playerFlag;
 
-class FlagButton : public Button
-{
-protected:
-    string fname;
-public:
-    FlagButton(int x, int y, const string &amp;flagname)
-        : Button(&quot;flag&quot;)
-    {
-        setLocation(x, y);
-        setSize(20,14);
-        string fullname(DEFAULT_FLAGS_PATH);
-        fullname += flagname;
-        //setSize(s.getWidth(), s.getHeight());
-//        try
-//        {
-            bimage.loadBMP(fullname.c_str());
-            bimage.mapFromPalette(&quot;netp&quot;);
-//        }
-//        catch (Exception e)
-//        {
-//            
-//        }
-        fname = flagname;
-        
-        setExtraBorder();
-        borders[1][0] = Color::red;
-        borders[1][1] = Color::darkRed;
-        borders[2][0] = Color::green;
-        borders[2][1] = Color::darkGreen;
-    }
-    
-    void actionPerformed( const mMouseEvent &amp;e)
-    {
-        if ( e.getID() == mMouseEvent::MOUSE_EVENT_CLICKED )
-        {
-            FlagSelectionView::setSelectedFlag(fname);
-        }
-        else
-        {
-            Button::actionPerformed(e);
-        }
-    }
-};
+#define FLAGBUTTONCODE 0xabba
 
 // FlagSelectionView
 //---------------------------------------------------------------------------
@@ -127,6 +85,7 @@
     filesystem::freeList(list);
 
     sort(filenames.begin(), filenames.end());
+    Surface buttonimg;
 
     // Now load in the sorted BMP names.
     for (unsigned int i = 0; i &lt; filenames.size(); i++)
@@ -136,8 +95,19 @@
         //flag.mapFromPalette(&quot;netp&quot;);
         try
         {
-            add( new FlagButton( x, y, filenames[i]) );
+            string fullname(DEFAULT_FLAGS_PATH);
+            fullname += filenames[i];
+            buttonimg.loadBMP(fullname.c_str());
+            buttonimg.mapFromPalette(&quot;netp&quot;);
 
+            Button * newButton = new Button(filenames[i]);
+            newButton-&gt;setCustomCode(FLAGBUTTONCODE);
+            newButton-&gt;setLocation(x, y);
+            newButton-&gt;setImage(buttonimg);
+            newButton-&gt;setRedGreenBorder();
+
+            add(newButton);
+
             x += 20 + 2; // 20 is the with of flag
 
             if (x &gt; flagStartOffset.x + getClientRect().getSizeX() - BORDER_SPACE - 20) // 20 is the width of flag
@@ -170,16 +140,17 @@
     int CHAR_XPIX = 8; // XXX hardcoded
     
     drawStringShadowed(
-            min.x + BORDER_SPACE,
-            min.y + BORDER_SPACE + (playerFlag.getHeight() - Surface::getFontHeight()) / 2,
+            BORDER_SPACE,
+            BORDER_SPACE + (playerFlag.getHeight() - Surface::getFontHeight()) / 2,
             strBuf, windowTextColor, windowTextColorShadow);
     
-    drawImage(playerFlag, min.x + BORDER_SPACE + strlen(strBuf) * CHAR_XPIX + BORDER_SPACE, min.y + BORDER_SPACE);
+    drawImage(playerFlag, strlen(strBuf) * CHAR_XPIX + (BORDER_SPACE*2), BORDER_SPACE);
 
 
     View::doDraw();
 
 } // end FlagSelectionView::doDraw
+
 void
 FlagSelectionView::setSelectedFlag(string &amp;fname)
 {
@@ -198,4 +169,14 @@
         LOGGER.warning(&quot;Error loading flag '%s', using blank flag&quot;, fname.c_str());
         playerFlag.copy(*ResourceManager::getEmptyImage());
     }
-}
\ No newline at end of file
+}
+
+void
+FlagSelectionView::onComponentClicked(Component* c)
+{
+    if ( c-&gt;getCustomCode() == FLAGBUTTONCODE )
+    {
+        string n = c-&gt;getName();
+        setSelectedFlag(n);
+    }
+}

Modified: trunk/netpanzer/src/NetPanzer/Views/MainMenu/Multi/FlagSelectionView.hpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Views/MainMenu/Multi/FlagSelectionView.hpp	2009-01-29 08:30:59 UTC (rev 1088)
+++ trunk/netpanzer/src/NetPanzer/Views/MainMenu/Multi/FlagSelectionView.hpp	2009-01-30 13:34:05 UTC (rev 1089)
@@ -31,7 +31,9 @@
     static Surface playerFlag;
     
     enum { BORDER_SPACE = 4 };
-
+protected:
+    void onComponentClicked(Component * c);
+    
 public:
     FlagSelectionView();
     virtual ~FlagSelectionView()

Modified: trunk/netpanzer/src/NetPanzer/Views/MainMenu/Multi/HostOptionsView.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Views/MainMenu/Multi/HostOptionsView.cpp	2009-01-29 08:30:59 UTC (rev 1088)
+++ trunk/netpanzer/src/NetPanzer/Views/MainMenu/Multi/HostOptionsView.cpp	2009-01-30 13:34:05 UTC (rev 1089)
@@ -31,6 +31,20 @@
 std::string HostOptionsView::cloudCoverageString;
 std::string HostOptionsView::windSpeedString;
 
+enum
+{
+    DEC_PLAYERCOUNT,
+    INC_PLAYERCOUNT,
+    DEC_MAXUNITS,
+    INC_MAXUNITS,
+    DEC_OBJPERCENT,
+    INC_OBJPERCENT,
+    DEC_TIMELIMIT,
+    INC_TIMELIMIT,
+    DEC_FRAGLIMIT,
+    INC_FRAGLIMIT
+};
+
 static int getCurMaxPlayersCount()
 {
     return gameconfig-&gt;maxplayers;
@@ -41,30 +55,6 @@
     return gameconfig-&gt;maxunits;
 }
 
-static void bDecreasePlayerCount()
-{
-    if(gameconfig-&gt;maxplayers - 1 &gt;= gameconfig-&gt;maxplayers.getMin())
-        gameconfig-&gt;maxplayers = gameconfig-&gt;maxplayers - 1;
-}
-
-static void bIncreasePlayerCount()
-{
-    if(gameconfig-&gt;maxplayers + 1 &lt;= gameconfig-&gt;maxplayers.getMax())
-        gameconfig-&gt;maxplayers = gameconfig-&gt;maxplayers + 1;
-}
-
-static void bDecreaseMaxUnitCount()
-{
-    if(gameconfig-&gt;maxunits - 5 &gt;= gameconfig-&gt;maxunits.getMin())
-        gameconfig-&gt;maxunits = gameconfig-&gt;maxunits - 5;
-}
-
-static void bIncreaseMaxUnitCount()
-{
-    if(gameconfig-&gt;maxunits + 5 &lt;= gameconfig-&gt;maxunits.getMax())
-        gameconfig-&gt;maxunits = gameconfig-&gt;maxunits + 5;
-}
-
 void HostOptionsView::updateGameConfigCloudCoverage()
 {
     // Make sure the cloud settings are the same for different size
@@ -155,18 +145,6 @@
     return( &quot;Unknown&quot; );
 }
 
-static void bIncreaseTimeLimit()
-{
-    if(gameconfig-&gt;timelimit + 5 &lt;= gameconfig-&gt;timelimit.getMax())
-        gameconfig-&gt;timelimit = gameconfig-&gt;timelimit + 5;
-}
-
-static void bDecreaseTimeLimit()
-{
-    if(gameconfig-&gt;timelimit - 5 &gt;= gameconfig-&gt;timelimit.getMin())
-        gameconfig-&gt;timelimit = gameconfig-&gt;timelimit - 5;
-}
-
 static int getTimeLimitHours()
 {
     return gameconfig-&gt;timelimit / 60;
@@ -177,18 +155,6 @@
     return gameconfig-&gt;timelimit % 60;
 }
 
-static void bIncreaseFragLimit()
-{
-    if(gameconfig-&gt;fraglimit + 5 &lt;= gameconfig-&gt;fraglimit.getMax())
-        gameconfig-&gt;fraglimit = gameconfig-&gt;fraglimit + 5;
-}
-
-static void bDecreaseFragLimit()
-{
-    if(gameconfig-&gt;fraglimit - 5 &gt;= gameconfig-&gt;fraglimit.getMin())
-        gameconfig-&gt;fraglimit = gameconfig-&gt;fraglimit - 5;
-}
-
 static int getFragLimit()
 {
     return gameconfig-&gt;fraglimit;
@@ -236,23 +202,6 @@
     return gameconfig-&gt;objectiveoccupationpercentage;
 }
 
-static void bIncreaseObjectiveCapturePercent()
-{
-    if(gameconfig-&gt;objectiveoccupationpercentage + 5 &lt;=
-            gameconfig-&gt;objectiveoccupationpercentage.getMax())
-        gameconfig-&gt;objectiveoccupationpercentage =
-            gameconfig-&gt;objectiveoccupationpercentage + 5;
-}
-
-static void bDecreaseObjectiveCapturePercent()
-{
-    if(gameconfig-&gt;objectiveoccupationpercentage - 5 &gt;=
-            gameconfig-&gt;objectiveoccupationpercentage.getMin())
-        gameconfig-&gt;objectiveoccupationpercentage = 
-            gameconfig-&gt;objectiveoccupationpercentage - 5;
-}
-
-
 // HostOptionsView
 //---------------------------------------------------------------------------
 HostOptionsView::HostOptionsView() : RMouseHackView()
@@ -302,18 +251,21 @@
 
     x = xTextStart;
     add( new Label(x, y, &quot;Max Players&quot;, windowTextColor, windowTextColorShadow, true) );
+
     x += xControlStart;
-    addButtonCenterText(iXY(x - 1, y), arrowButtonWidth, &quot;&lt;&quot;, &quot;&quot;, bDecreasePlayerCount);
+    add( Button::createTextButton(&quot;decplayer&quot;,&quot;&lt;&quot;,iXY(x - 1, y),arrowButtonWidth, DEC_PLAYERCOUNT));
     x += arrowButtonWidth + meterWidth;
-    addButtonCenterText(iXY(x + 1, y), arrowButtonWidth, &quot;&gt;&quot;, &quot;&quot;, bIncreasePlayerCount);
+    add( Button::createTextButton(&quot;incplayer&quot;,&quot;&gt;&quot;,iXY(x + 1, y),arrowButtonWidth, INC_PLAYERCOUNT));
+
     y += yOffset;
 
     x = xTextStart;
     add( new Label(x, y, &quot;Game Max Unit Count&quot;, windowTextColor, windowTextColorShadow, true) );
     x += xControlStart;
-    addButtonCenterText(iXY(x - 1, y), arrowButtonWidth, &quot;&lt;&quot;, &quot;&quot;, bDecreaseMaxUnitCount);
+    add( Button::createTextButton(&quot;decunits&quot;,&quot;&lt;&quot;,iXY(x - 1, y),arrowButtonWidth, DEC_MAXUNITS));
     x += arrowButtonWidth + meterWidth;
-    addButtonCenterText(iXY(x + 1, y), arrowButtonWidth, &quot;&gt;&quot;, &quot;&quot;, bIncreaseMaxUnitCount);
+    add( Button::createTextButton(&quot;incunits&quot;,&quot;&gt;&quot;,iXY(x + 1, y),arrowButtonWidth, INC_MAXUNITS));
+
     y += yOffset;
     /*
     	x = xTextStart;
@@ -343,25 +295,25 @@
     x = xTextStart;
     add( new Label( x, y, &quot;Objective Capture Percent&quot;, windowTextColor, windowTextColorShadow, true) );
     x += xControlStart;
-    addButtonCenterText(iXY(x - 1, y), arrowButtonWidth, &quot;&lt;&quot;, &quot;&quot;, bDecreaseObjectiveCapturePercent);
+    add( Button::createTextButton(&quot;decobjpercent&quot;,&quot;&lt;&quot;,iXY(x - 1, y),arrowButtonWidth, DEC_OBJPERCENT));
     x += arrowButtonWidth + meterWidth;
-    addButtonCenterText(iXY(x + 1, y), arrowButtonWidth, &quot;&gt;&quot;, &quot;&quot;, bIncreaseObjectiveCapturePercent);
+    add( Button::createTextButton(&quot;incobjpercent&quot;,&quot;&gt;&quot;,iXY(x + 1, y),arrowButtonWidth, INC_OBJPERCENT));
     y += yOffset;
 
     x = xTextStart;
     add( new Label( x, y, &quot;Time Limit&quot;, windowTextColor, windowTextColorShadow, true) );
     x += xControlStart;
-    addButtonCenterText(iXY(x - 1, y), arrowButtonWidth, &quot;&lt;&quot;, &quot;&quot;, bDecreaseTimeLimit);
+    add( Button::createTextButton(&quot;dectime&quot;,&quot;&lt;&quot;,iXY(x - 1, y),arrowButtonWidth, DEC_TIMELIMIT));
     x += arrowButtonWidth + meterWidth;
-    addButtonCenterText(iXY(x + 1, y), arrowButtonWidth, &quot;&gt;&quot;, &quot;&quot;, bIncreaseTimeLimit);
+    add( Button::createTextButton(&quot;inctime&quot;,&quot;&gt;&quot;,iXY(x + 1, y),arrowButtonWidth, INC_TIMELIMIT));
     y += yOffset;
 
     x = xTextStart;
     add( new Label( x, y, &quot;Frag Limit&quot;, windowTextColor, windowTextColorShadow, true) );
     x += xControlStart;
-    addButtonCenterText(iXY(x - 1, y), arrowButtonWidth, &quot;&lt;&quot;, &quot;&quot;, bDecreaseFragLimit);
+    add( Button::createTextButton(&quot;decfrag&quot;,&quot;&lt;&quot;,iXY(x - 1, y),arrowButtonWidth, DEC_FRAGLIMIT));
     x += arrowButtonWidth + meterWidth;
-    addButtonCenterText(iXY(x + 1, y), arrowButtonWidth, &quot;&gt;&quot;, &quot;&quot;, bIncreaseFragLimit);
+    add( Button::createTextButton(&quot;incfrag&quot;,&quot;&gt;&quot;,iXY(x + 1, y),arrowButtonWidth, INC_FRAGLIMIT));
     y += yOffset;
 
     const int minWidth = 150;
@@ -546,3 +498,84 @@
         }
     }
 } // end HostOptionsView::actionPerformed
+
+void
+HostOptionsView::onComponentClicked(Component* c)
+{
+    switch ( c-&gt;getCustomCode() )
+    {
+        case DEC_PLAYERCOUNT:
+            if(gameconfig-&gt;maxplayers - 1 &gt;= gameconfig-&gt;maxplayers.getMin())
+            {
+                gameconfig-&gt;maxplayers = gameconfig-&gt;maxplayers - 1;
+            }
+            break;
+
+        case INC_PLAYERCOUNT:
+            if(gameconfig-&gt;maxplayers + 1 &lt;= gameconfig-&gt;maxplayers.getMax())
+            {
+                gameconfig-&gt;maxplayers = gameconfig-&gt;maxplayers + 1;
+            }
+            break;
+
+        case DEC_MAXUNITS:
+            if(gameconfig-&gt;maxunits - 5 &gt;= gameconfig-&gt;maxunits.getMin())
+            {
+                gameconfig-&gt;maxunits = gameconfig-&gt;maxunits - 5;
+            }
+            break;
+
+        case INC_MAXUNITS:
+            if(gameconfig-&gt;maxunits + 5 &lt;= gameconfig-&gt;maxunits.getMax())
+            {
+                gameconfig-&gt;maxunits = gameconfig-&gt;maxunits + 5;
+            }
+            break;
+
+        case DEC_OBJPERCENT:
+            if(gameconfig-&gt;objectiveoccupationpercentage - 5 &gt;=
+                            gameconfig-&gt;objectiveoccupationpercentage.getMin())
+            {
+                gameconfig-&gt;objectiveoccupationpercentage =
+                                gameconfig-&gt;objectiveoccupationpercentage - 5;
+            }
+            break;
+
+        case INC_OBJPERCENT:
+            if(gameconfig-&gt;objectiveoccupationpercentage + 5 &lt;=
+                            gameconfig-&gt;objectiveoccupationpercentage.getMax())
+            {
+                gameconfig-&gt;objectiveoccupationpercentage =
+                                gameconfig-&gt;objectiveoccupationpercentage + 5;
+            }
+            break;
+
+        case DEC_TIMELIMIT:
+            if(gameconfig-&gt;timelimit + 5 &lt;= gameconfig-&gt;timelimit.getMax())
+            {
+                gameconfig-&gt;timelimit = gameconfig-&gt;timelimit + 5;
+            }
+            break;
+
+        case INC_TIMELIMIT:
+            if(gameconfig-&gt;timelimit - 5 &gt;= gameconfig-&gt;timelimit.getMin())
+            {
+                gameconfig-&gt;timelimit = gameconfig-&gt;timelimit - 5;
+            }
+            break;
+
+        case DEC_FRAGLIMIT:
+            if(gameconfig-&gt;fraglimit - 5 &gt;= gameconfig-&gt;fraglimit.getMin())
+            {
+                gameconfig-&gt;fraglimit = gameconfig-&gt;fraglimit - 5;
+            }
+            break;
+
+        case INC_FRAGLIMIT:
+            if(gameconfig-&gt;fraglimit + 5 &lt;= gameconfig-&gt;fraglimit.getMax())
+            {
+                gameconfig-&gt;fraglimit = gameconfig-&gt;fraglimit + 5;
+            }
+            break;
+    }
+}

Modified: trunk/netpanzer/src/NetPanzer/Views/MainMenu/Multi/HostOptionsView.hpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Views/MainMenu/Multi/HostOptionsView.hpp	2009-01-29 08:30:59 UTC (rev 1088)
+++ trunk/netpanzer/src/NetPanzer/Views/MainMenu/Multi/HostOptionsView.hpp	2009-01-30 13:34:05 UTC (rev 1089)
@@ -44,7 +44,8 @@
     Choice choiceGameType;
     Choice choiceWindSpeed;
     Choice choiceCloudCoverage;
-
+protected:
+    void onComponentClicked(Component *c);
 public:
     HostOptionsView();
     virtual ~HostOptionsView()

Modified: trunk/netpanzer/src/NetPanzer/Views/MainMenu/Multi/MapSelectionView.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Views/MainMenu/Multi/MapSelectionView.cpp	2009-01-29 08:30:59 UTC (rev 1088)
+++ trunk/netpanzer/src/NetPanzer/Views/MainMenu/Multi/MapSelectionView.cpp	2009-01-30 13:34:05 UTC (rev 1089)
@@ -33,37 +33,12 @@
 std::vector&lt;MapInfo*&gt; MapSelectionView::mapList;
 int MapSelectionView::curMap = 0;
 
-static void bNextMap()
+enum
 {
-    // Make sure some maps are loaded.
-    if (MapSelectionView::curMap == -1) {
-        return;
-    }
+    PREV_MAP,
+    NEXT_MAP
+};
 
-    if (++MapSelectionView::curMap &gt;= (int) MapSelectionView::mapList.size()) {
-        MapSelectionView::curMap = 0;
-    }
-
-    gameconfig-&gt;mapcycle = MapSelectionView::mapList[MapSelectionView::curMap]-&gt;name;
-    HostOptionsView::updateGameConfigCloudCoverage();
-}
-
-static void bPreviousMap()
-{
-    // Make sure some maps are loaded.
-    if (MapSelectionView::curMap == -1) {
-        return;
-    }
-
-    if (--MapSelectionView::curMap &lt; 0) {
-        MapSelectionView::curMap = MapSelectionView::mapList.size() - 1;
-    }
-
-    gameconfig-&gt;mapcycle = MapSelectionView::mapList[MapSelectionView::curMap]-&gt;name;
-    HostOptionsView::updateGameConfigCloudCoverage();
-}
-
-
 // MapSelectionView
 //---------------------------------------------------------------------------
 MapSelectionView::MapSelectionView() : RMouseHackView()
@@ -99,16 +74,50 @@
 
     iXY pos(MAP_SIZE + BORDER_SPACE * 2, getClientRect().getSizeY() - 14 - BORDER_SPACE);
 
-    addButtonCenterText(pos, arrowButtonWidth - 1, &quot;&lt;&quot;, &quot;&quot;, bPreviousMap);
+    add ( Button::createTextButton(&quot;mapprevbutton&quot;,&quot;&lt;&quot;,pos, arrowButtonWidth, PREV_MAP) );
+
     pos.x += arrowButtonWidth;
-    addButtonCenterText(pos, arrowButtonWidth, &quot;&gt;&quot;, &quot;&quot;, bNextMap);
 
+    add ( Button::createTextButton(&quot;mapnextbutton&quot;,&quot;&gt;&quot;,pos, arrowButtonWidth, NEXT_MAP) );
+
     loadMaps();
     HostOptionsView::updateGameConfigCloudCoverage();
     HostOptionsView::updateWindSpeedString();
 
 } // end MapSelectionView::init
 
+void
+MapSelectionView::onComponentClicked(Component* c)
+{
+    if (curMap == -1)
+    {
+        return;
+    }
+    
+    switch ( c-&gt;getCustomCode() )
+    {
+        case PREV_MAP:
+            if ( --curMap &lt; 0 )
+            {
+                curMap = mapList.size() - 1;
+            }
+
+            gameconfig-&gt;mapcycle = mapList[curMap]-&gt;name;
+            HostOptionsView::updateGameConfigCloudCoverage();
+            break;
+
+        case NEXT_MAP:
+            if (++curMap &gt;= (int) mapList.size())
+            {
+                MapSelectionView::curMap = 0;
+            }
+
+            gameconfig-&gt;mapcycle = mapList[curMap]-&gt;name;
+            HostOptionsView::updateGameConfigCloudCoverage();
+            break;
+    }
+}
+
 // doDraw
 //---------------------------------------------------------------------------
 void MapSelectionView::doDraw()

Modified: trunk/netpanzer/src/NetPanzer/Views/MainMenu/Multi/MapSelectionView.hpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Views/MainMenu/Multi/MapSelectionView.hpp	2009-01-29 08:30:59 UTC (rev 1088)
+++ trunk/netpanzer/src/NetPanzer/Views/MainMenu/Multi/MapSelectionView.hpp	2009-01-30 13:34:05 UTC (rev 1089)
@@ -23,6 +23,7 @@
 
 #include &quot;Views/MainMenu/RMouseHackView.hpp&quot;
 #include &quot;2D/Surface.hpp&quot;
+#include &quot;Views/Components/Button.hpp&quot;
 
 //---------------------------------------------------------------------------
 class MapInfo
@@ -48,6 +49,9 @@
     int  loadMaps();
     void drawCurMapInfo( const iXY &amp;pos);
 
+protected:
+    void onComponentClicked(Component *c);
+
 public:
     MapSelectionView();
     ~MapSelectionView();

Modified: trunk/netpanzer/src/NetPanzer/Views/MainMenu/Multi/ServerListView.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Views/MainMenu/Multi/ServerListView.cpp	2009-01-29 08:30:59 UTC (rev 1088)
+++ trunk/netpanzer/src/NetPanzer/Views/MainMenu/Multi/ServerListView.cpp	2009-01-30 13:34:05 UTC (rev 1089)
@@ -28,8 +28,14 @@
 // XXX ultrahack
 #include &quot;Classes/ScreenSurface.hpp&quot;
 #include &quot;Views/Components/Desktop.hpp&quot;
+#include &quot;Views/Components/Button.hpp&quot;
 
 
+enum
+{
+    BTN_REFRESH
+};
+
 ServerListView* serverlistview = 0;
 
 ServerListView::ServerListView()
@@ -46,10 +52,9 @@
     setAllowMove(false);
     setVisible(false);
 
-    addButtonCenterText(iXY(getClientRect().getSizeX()-80,
-                getClientRect().getSizeY() - Surface::getFontHeight() * 2),
-            80, &quot;Refresh&quot;, &quot;&quot;, buttonRefresh);
-    
+    iXY p(getClientRect().getSizeX()-80, getClientRect().getSizeY() - Surface::getFontHeight() * 2);
+    add( Button::createTextButton(&quot;refresh&quot;,&quot;Refresh&quot;,p,80,BTN_REFRESH) );
+
     // XXX ugly
     serverlistview = this;
 }
@@ -83,7 +88,7 @@
         screen-&gt;lock();
         mylock = true;
     }
-    Desktop::draw(*screen); // XXX ultrahack
+    Desktop::draw(); // XXX ultrahack
     if ( mylock )
         screen-&gt;unlock();
     screen-&gt;copyToVideoFlip(); // XXX uberhack
@@ -199,3 +204,11 @@
     return View::lMouseUp(down_pos, up_pos);
 }
 
+void
+ServerListView::onComponentClicked(Component* c)
+{
+    if ( c-&gt;getCustomCode() == BTN_REFRESH )
+    {
+        refresh();
+    }
+}

Modified: trunk/netpanzer/src/NetPanzer/Views/MainMenu/Multi/ServerListView.hpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Views/MainMenu/Multi/ServerListView.hpp	2009-01-29 08:30:59 UTC (rev 1088)
+++ trunk/netpanzer/src/NetPanzer/Views/MainMenu/Multi/ServerListView.hpp	2009-01-30 13:34:05 UTC (rev 1089)
@@ -35,6 +35,9 @@
     virtual void doDraw();
     virtual int lMouseUp(const iXY&amp; up_pos, const iXY&amp; down_pos);
 
+protected:
+    void onComponentClicked(Component *c);
+    
 private:
     masterserver::ServerList serverlist;
     masterserver::ServerQueryThread* queryThread;

Deleted: trunk/netpanzer/src/NetPanzer/Views/MainMenu/Multi/UnitColorView.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Views/MainMenu/Multi/UnitColorView.cpp	2009-01-29 08:30:59 UTC (rev 1088)
+++ trunk/netpanzer/src/NetPanzer/Views/MainMenu/Multi/UnitColorView.cpp	2009-01-30 13:34:05 UTC (rev 1089)
@@ -1,160 +0,0 @@
-/*
-Copyright (C) 1998 Pyrosoft Inc. (www.pyrosoftgames.com), Matthew Bogue
- 
-This program is free software; you can redistribute it and/or modify
-it under the terms of the GNU General Public License as published by
-the Free Software Foundation; either version 2 of the License, or
-(at your option) any later version.
- 
-This program is distributed in the hope that it will be useful,
-but WITHOUT ANY WARRANTY; without even the implied warranty of
-MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-GNU General Public License for more details.
- 
-You should have received a copy of the GNU General Public License
-along with this program; if not, write to the Free Software
-Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
-*/
-#include &lt;config.h&gt;
-
-#include &quot;UnitColorView.hpp&quot;
-#include &quot;Views/Game/GameView.hpp&quot;
-#include &quot;Views/GameViewGlobals.hpp&quot;
-#include &quot;2D/Palette.hpp&quot;
-#include &quot;2D/ColorTable.hpp&quot;
-
-static float maxPercent       = 3.5f;
-static float minPercent       = 0.5f;
-static float incrementPercent = 0.025f;
-static float grayPercent      = 2.0f;
-static ColorTable *colorTable;
-ColorTable gray256;
-
-static void setGrayColorTable()
-{
-    colorTable = &amp;gray256;
-}
-
-static void increasePercent(float &amp;color)
-{
-    if ((color += incrementPercent) &gt; maxPercent) {
-        color = maxPercent;
-    }
-}
-
-static void decreasePercent(float &amp;color)
-{
-    if ((color -= incrementPercent) &lt; minPercent) {
-        color = minPercent;
-    }
-}
-
-static void rebuildGrayColorTable()
-{
-    // 256 shades of gray.
-    gray256.init(256);
-    for (int num = 0; num &lt; 256; num++) {
-        int c = int(Palette::color[num].r+Palette::color[num].g+Palette::color[num].b)/3; //brightness
-
-        int nearestColor = Palette::findNearestColor(
-                        int(c * grayPercent),
-                        int(c * grayPercent),
-                        int(c * grayPercent));
-        gray256.setColor(num, nearestColor);
-    }
-    gray256.setColor(255, 0);
-}
-
-static void bIncreaseBrightness()
-{
-    increasePercent(grayPercent);
-    rebuildGrayColorTable();
-}
-
-static void bDecreaseBrightness()
-{
-    decreasePercent(grayPercent);
-    rebuildGrayColorTable();
-}
-
-// UnitColorView
-//---------------------------------------------------------------------------
-UnitColorView::UnitColorView() : View()
-{
-    setSearchName(&quot;UnitColorView&quot;);
-    setTitle(&quot;Selects Your Unit Color&quot;);
-    setSubTitle(&quot;&quot;);
-
-    setAllowResize(false);
-    setAllowMove(false);
-    setVisible(false);
-
-    Surface unitSurface;
-
-    moveTo(400, 200);
-
-    packedBody.load(&quot;units/pics/pak/TitaHNSD.pak&quot;);
-    packedBody.setFPS(12);
-
-    packedTurret.load(&quot;units/pics/pak/TitaTNSD.pak&quot;);
-    packedTurret.setFPS(8);
-
-    grassSurface.loadBMP(&quot;pics/grass.bmp&quot;);
-
-    fuckingSurface.create(packedTurret.getWidth(), packedTurret.getHeight(), 1);
-    fuckingSurface.fill(0);
-
-    resize(packedTurret.getWidth(), packedTurret.getHeight());
-
-    int size = packedTurret.getWidth() / 2;
-    addButtonCenterText(iXY(0, 0), size, &quot;Up&quot;, &quot;&quot;, bIncreaseBrightness);
-    addButtonCenterText(iXY(size, 0), size, &quot;Down&quot;, &quot;&quot;, bDecreaseBrightness);
-
-    setGrayColorTable();
-    rebuildGrayColorTable();
-
-} // end UnitColorView::UnitColorView
-
-// doDraw
-//---------------------------------------------------------------------------
-void UnitColorView::doDraw()
-{
-    //unitSurface.fill(0);
-
-    packedBody.nextFrame();
-    packedTurret.nextFrame();
-
-    fuckingSurface.fill(Color::white);
-    packedBody.blt(fuckingSurface, 0, 0);
-    packedTurret.blt(fuckingSurface, 0, 0);
-    fuckingSurface.bltLookup(fuckingSurface.getRect(), colorTable-&gt;getColorArray());
-
-    drawImage(grassSurface, 0, 0);
-    drawImageTrans(fuckingSurface, 0, 0);
-
-    char strBuf[256];
-    sprintf(strBuf, &quot;%1.3f of %1.3f&quot;, grayPercent, maxPercent);
-    drawString(2, fuckingSurface.getHeight() - Surface::getFontHeight() - 1, strBuf, Color::white);
-
-    View::doDraw();
-
-} // end UnitColorView::doDraw
-
-//---------------------------------------------------------------------------
-void UnitColorView::rMouseDown(const iXY &amp;pos)
-{
-    View::lMouseDown(pos);
-}
-
-//---------------------------------------------------------------------------
-void UnitColorView::rMouseUp(const iXY &amp;downPos, const iXY &amp;upPos)
-{
-    View::lMouseUp(downPos, upPos);
-}
-
-//---------------------------------------------------------------------------
-void UnitColorView::rMouseDrag(const iXY &amp;downPos, const iXY&amp;, const iXY &amp;newPos)
-{
-    View::lMouseUp(downPos, newPos);
-    View::lMouseDown(newPos);
-}

Deleted: trunk/netpanzer/src/NetPanzer/Views/MainMenu/Multi/UnitColorView.hpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Views/MainMenu/Multi/UnitColorView.hpp	2009-01-29 08:30:59 UTC (rev 1088)
+++ trunk/netpanzer/src/NetPanzer/Views/MainMenu/Multi/UnitColorView.hpp	2009-01-30 13:34:05 UTC (rev 1089)
@@ -1,44 +0,0 @@
-/*
-Copyright (C) 1998 Pyrosoft Inc. (www.pyrosoftgames.com), Matthew Bogue
- 
-This program is free software; you can redistribute it and/or modify
-it under the terms of the GNU General Public License as published by
-the Free Software Foundation; either version 2 of the License, or
-(at your option) any later version.
- 
-This program is distributed in the hope that it will be useful,
-but WITHOUT ANY WARRANTY; without even the implied warranty of
-MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-GNU General Public License for more details.
- 
-You should have received a copy of the GNU General Public License
-along with this program; if not, write to the Free Software
-Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
-*/
-#ifndef __UnitColorView_hpp__
-#define __UnitColorView_hpp__
-
-#include &quot;Views/Components/View.hpp&quot;
-#include &quot;2D/Surface.hpp&quot;
-#include &quot;2D/PackedSurface.hpp&quot;
-
-
-//---------------------------------------------------------------------------
-class UnitColorView : public View
-{
-private:
-    Surface       fuckingSurface;
-    Surface       grassSurface;
-    PackedSurface packedBody;
-    PackedSurface packedTurret;
-
-public:
-    UnitColorView();
-
-    virtual void doDraw();
-    virtual void rMouseDown  (const iXY &amp;pos);
-    virtual void rMouseUp    (const iXY &amp;downPos, const iXY &amp;upPos);
-    virtual void rMouseDrag  (const iXY &amp;downPos, const iXY &amp;prevPos, const iXY &amp;newPos);
-}; // end UnitColorView
-
-#endif // end __UnitColorView_hpp__

Modified: trunk/netpanzer/src/NetPanzer/Views/MainMenu/Options/InterfaceView.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Views/MainMenu/Options/InterfaceView.cpp	2009-01-29 08:30:59 UTC (rev 1088)
+++ trunk/netpanzer/src/NetPanzer/Views/MainMenu/Options/InterfaceView.cpp	2009-01-30 13:34:05 UTC (rev 1089)
@@ -17,25 +17,20 @@
 */
 #include &lt;config.h&gt;
 
+#include &quot;Views/Components/Button.hpp&quot;
+
 #include &quot;Views/MainMenu/Options/InterfaceView.hpp&quot;
 #include &quot;Interfaces/GameConfig.hpp&quot;
 #include &quot;Views/GameViewGlobals.hpp&quot;
 #include &quot;Views/Components/Desktop.hpp&quot;
 #include &quot;Views/Components/Label.hpp&quot;
 
-
-static void bIncreaseScrollRate()
+enum
 {
-    if(gameconfig-&gt;scrollrate + 100 &lt;= gameconfig-&gt;scrollrate.getMax())
-        gameconfig-&gt;scrollrate = gameconfig-&gt;scrollrate + 100;
-}
+    DEC_SCROLL,
+    INC_SCROLL
+};
 
-static void bDecreaseScrollRate()
-{
-    if(gameconfig-&gt;scrollrate - 100 &gt;= gameconfig-&gt;scrollrate.getMin())
-        gameconfig-&gt;scrollrate = gameconfig-&gt;scrollrate - 100;
-}
-
 static int getScrollRate()
 {
     return (int) gameconfig-&gt;scrollrate;
@@ -73,10 +68,11 @@
 
     x = xTextStart;
     add( new Label( x, y, &quot;Scroll Rate&quot;, Color::white) );
+
     x = optionsMeterStartX;
-    addButtonCenterText(iXY(x - 1, y), arrowButtonWidth, &quot;&lt;&quot;, &quot;&quot;, bDecreaseScrollRate);
+    add( Button::createTextButton(&quot;decscroll&quot;,&quot;&lt;&quot;,iXY(x-1,y),arrowButtonWidth, DEC_SCROLL));
     x += optionsMeterWidth + arrowButtonWidth;
-    addButtonCenterText(iXY(x + 1, y), arrowButtonWidth, &quot;&gt;&quot;, &quot;&quot;, bIncreaseScrollRate);
+    add( Button::createTextButton(&quot;incscroll&quot;,&quot;&gt;&quot;,iXY(x+1,y),arrowButtonWidth, INC_SCROLL));
     y += yOffset;
 }
 
@@ -103,6 +99,27 @@
     drawImage(tempSurface, x, y);
 } // end InterfaceView::doDraw
 
+void
+InterfaceView::onComponentClicked(Component* c)
+{
+    switch ( c-&gt;getCustomCode() )
+    {
+        case DEC_SCROLL:
+            if(gameconfig-&gt;scrollrate - 100 &gt;= gameconfig-&gt;scrollrate.getMin())
+            {
+                gameconfig-&gt;scrollrate = gameconfig-&gt;scrollrate - 100;
+            }
+            break;
+
+        case INC_SCROLL:
+            if(gameconfig-&gt;scrollrate + 100 &lt;= gameconfig-&gt;scrollrate.getMax())
+            {
+                gameconfig-&gt;scrollrate = gameconfig-&gt;scrollrate + 100;
+            }
+            break;
+    }
+}
+
 // loadTitleSurface
 //---------------------------------------------------------------------------
 void InterfaceView::loadTitleSurface()

Modified: trunk/netpanzer/src/NetPanzer/Views/MainMenu/Options/InterfaceView.hpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Views/MainMenu/Options/InterfaceView.hpp	2009-01-29 08:30:59 UTC (rev 1088)
+++ trunk/netpanzer/src/NetPanzer/Views/MainMenu/Options/InterfaceView.hpp	2009-01-30 13:34:05 UTC (rev 1089)
@@ -36,7 +36,8 @@
 {
 protected:
     virtual void loadTitleSurface();
-
+    void onComponentClicked(Component *c);
+    
 public:
     InterfaceView();
 

Modified: trunk/netpanzer/src/NetPanzer/Views/MainMenu/Options/SoundView.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Views/MainMenu/Options/SoundView.cpp	2009-01-29 08:30:59 UTC (rev 1088)
+++ trunk/netpanzer/src/NetPanzer/Views/MainMenu/Options/SoundView.cpp	2009-01-30 13:34:05 UTC (rev 1089)
@@ -17,6 +17,8 @@
 */
 #include &lt;config.h&gt;
 
+#include &quot;Views/Components/Button.hpp&quot;
+
 #include &quot;SoundView.hpp&quot;
 #include &quot;Interfaces/GameConfig.hpp&quot;
 #include &quot;Views/GameViewGlobals.hpp&quot;
@@ -27,51 +29,19 @@
 #include &quot;System/DummySound.hpp&quot;
 #include &quot;Interfaces/GameControlRulesDaemon.hpp&quot;
 
-static void bDecreaseSoundVolume()
+enum
 {
-    unsigned int v = gameconfig-&gt;effectsvolume;
-    if (v) {
-        --v;
-        gameconfig-&gt;effectsvolume = v;
-        sound-&gt;setSoundVolume(v);
-    }
-}
+    DEC_SOUND,
+    INC_SOUND,
+    DEC_MUSIC,
+    INC_MUSIC
+};
 
-static void bIncreaseSoundVolume()
-{
-    unsigned int v = gameconfig-&gt;effectsvolume;
-    if (v&lt;100) {
-        ++v;
-        gameconfig-&gt;effectsvolume = v;
-        sound-&gt;setSoundVolume(v);
-    }
-}
-
 int getSoundVolume()
 {
     return gameconfig-&gt;effectsvolume;
 }
 
-static void bDecreaseMusicVolume()
-{
-    unsigned int v = gameconfig-&gt;musicvolume;
-    if (v) {
-        --v;
-        gameconfig-&gt;musicvolume = v;
-        sound-&gt;setMusicVolume(v);
-    }
-}
-
-static void bIncreaseMusicVolume()
-{
-    unsigned int v = gameconfig-&gt;musicvolume;
-    if (v&lt;100) {
-        ++v;
-        gameconfig-&gt;musicvolume = v;
-        sound-&gt;setMusicVolume(v);
-    }
-}
-
 int getMusicVolume()
 {
     return gameconfig-&gt;musicvolume;
@@ -120,10 +90,11 @@
 
     x = xTextStart;
     add( new Label( x, y, &quot;Sound Volume&quot;, Color::white) );
+
     x = optionsMeterStartX;
-    addButtonCenterText(iXY(x - 1, y), arrowButtonWidth, &quot;&lt;&quot;, &quot;&quot;, bDecreaseSoundVolume);
+    add( Button::createTextButton( &quot;decsound&quot;, &quot;&lt;&quot;, iXY( x-1, y), arrowButtonWidth, DEC_SOUND) );
     x += optionsMeterWidth + arrowButtonWidth;
-    addButtonCenterText(iXY(x + 1, y), arrowButtonWidth, &quot;&gt;&quot;, &quot;&quot;, bIncreaseSoundVolume);
+    add( Button::createTextButton( &quot;incsound&quot;, &quot;&gt;&quot;, iXY( x-1, y), arrowButtonWidth, INC_SOUND) );
     y += yOffset;
 
     y += yOffset; // add a little separation
@@ -140,10 +111,12 @@
 
     x = xTextStart;
     add( new Label( x, y, &quot;Music Volume&quot;, Color::white) );
+
     x = optionsMeterStartX;
-    addButtonCenterText(iXY(x - 1, y), arrowButtonWidth, &quot;&lt;&quot;, &quot;&quot;, bDecreaseMusicVolume);
+    add( Button::createTextButton( &quot;decmusic&quot;, &quot;&lt;&quot;, iXY( x-1, y), arrowButtonWidth, DEC_MUSIC) );
+
     x += optionsMeterWidth + arrowButtonWidth;
-    addButtonCenterText(iXY(x + 1, y), arrowButtonWidth, &quot;&gt;&quot;, &quot;&quot;, bIncreaseMusicVolume);
+    add( Button::createTextButton( &quot;incmusic&quot;, &quot;&gt;&quot;, iXY( x-1, y), arrowButtonWidth, INC_MUSIC) );
     y += yOffset;
 
     //
@@ -239,5 +212,52 @@
             checkBoxMusicEnabled-&gt;setLabel(&quot;Disabled&quot;);
         }
     }
-    
 }
+
+void
+SoundView::onComponentClicked(Component* c)
+{
+    unsigned int v;
+    switch ( c-&gt;getCustomCode() )
+    {
+        case DEC_SOUND:
+            v = gameconfig-&gt;effectsvolume;
+            if (v)
+            {
+                --v;
+                gameconfig-&gt;effectsvolume = v;
+                sound-&gt;setSoundVolume(v);
+            }
+            break;
+
+        case INC_SOUND:
+            v = gameconfig-&gt;effectsvolume;
+            if (v&lt;100)
+            {
+                ++v;
+                gameconfig-&gt;effectsvolume = v;
+                sound-&gt;setSoundVolume(v);
+            }
+            break;
+
+        case DEC_MUSIC:
+            v = gameconfig-&gt;musicvolume;
+            if (v)
+            {
+                --v;
+                gameconfig-&gt;musicvolume = v;
+                sound-&gt;setMusicVolume(v);
+            }
+            break;
+
+        case INC_MUSIC:
+            unsigned int v = gameconfig-&gt;musicvolume;
+            if (v&lt;100)
+            {
+                ++v;
+                gameconfig-&gt;musicvolume = v;
+                sound-&gt;setMusicVolume(v);
+            }
+            break;
+    }
+}

Modified: trunk/netpanzer/src/NetPanzer/Views/MainMenu/Options/SoundView.hpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Views/MainMenu/Options/SoundView.hpp	2009-01-29 08:30:59 UTC (rev 1088)
+++ trunk/netpanzer/src/NetPanzer/Views/MainMenu/Options/SoundView.hpp	2009-01-30 13:34:05 UTC (rev 1089)
@@ -41,6 +41,8 @@
     CheckBox * checkBoxSoundEnabled;
     CheckBox * checkBoxMusicEnabled;
 
+    void onComponentClicked(Component *c);
+
 public:
     SoundView();
 


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000120.html">[Netpanzer-cvs] r1088 - in trunk/netpanzer/src: Lib/2D	NetPanzer/Interfaces NetPanzer/Particles NetPanzer/Views	NetPanzer/Views/Components NetPanzer/Views/Game	NetPanzer/Views/MainMenu NetPanzer/Views/MainMenu/Multi	NetPanzer/Views/MainMenu/Options
</A></li>
	
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#121">[ date ]</a>
              <a href="thread.html#121">[ thread ]</a>
              <a href="subject.html#121">[ subject ]</a>
              <a href="author.html#121">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/netpanzer-cvs">More information about the Netpanzer-cvs
mailing list</a><br>
</body></html>
