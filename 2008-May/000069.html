<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Netpanzer-cvs] r1027 - in trunk/netpanzer: . src/Lib/2D	src/Lib/INIParser src/Lib/Util src/NetPanzer/Bot	src/NetPanzer/Classes src/NetPanzer/Classes/Units	src/NetPanzer/Classes/Weapons src/NetPanzer/Interfaces	src/NetPanzer/Particles src/NetPanzer/Structs	src/NetPanzer/Views/Components src/NetPanzer/Views/Game	src/NetPanzer/Views/MainMenu/Multi	src/NetPanzer/Views/MainMenu/Options units/profiles
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/netpanzer-cvs/2008-May/index.html" >
   <LINK REL="made" HREF="mailto:netpanzer-cvs%40lists.berlios.de?Subject=Re%3A%20%5BNetpanzer-cvs%5D%20r1027%20-%20in%20trunk/netpanzer%3A%20.%20src/Lib/2D%0A%09src/Lib/INIParser%20src/Lib/Util%20src/NetPanzer/Bot%0A%09src/NetPanzer/Classes%20src/NetPanzer/Classes/Units%0A%09src/NetPanzer/Classes/Weapons%20src/NetPanzer/Interfaces%0A%09src/NetPanzer/Particles%20src/NetPanzer/Structs%0A%09src/NetPanzer/Views/Components%20src/NetPanzer/Views/Game%0A%09src/NetPanzer/Views/MainMenu/Multi%0A%09src/NetPanzer/Views/MainMenu/Options%20units/profiles&In-Reply-To=%3C200805041407.m44E7uOs006532%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   
   <LINK REL="Next"  HREF="000070.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Netpanzer-cvs] r1027 - in trunk/netpanzer: . src/Lib/2D	src/Lib/INIParser src/Lib/Util src/NetPanzer/Bot	src/NetPanzer/Classes src/NetPanzer/Classes/Units	src/NetPanzer/Classes/Weapons src/NetPanzer/Interfaces	src/NetPanzer/Particles src/NetPanzer/Structs	src/NetPanzer/Views/Components src/NetPanzer/Views/Game	src/NetPanzer/Views/MainMenu/Multi	src/NetPanzer/Views/MainMenu/Options units/profiles</H1>
    <B>kromxp at mail.berlios.de</B> 
    <A HREF="mailto:netpanzer-cvs%40lists.berlios.de?Subject=Re%3A%20%5BNetpanzer-cvs%5D%20r1027%20-%20in%20trunk/netpanzer%3A%20.%20src/Lib/2D%0A%09src/Lib/INIParser%20src/Lib/Util%20src/NetPanzer/Bot%0A%09src/NetPanzer/Classes%20src/NetPanzer/Classes/Units%0A%09src/NetPanzer/Classes/Weapons%20src/NetPanzer/Interfaces%0A%09src/NetPanzer/Particles%20src/NetPanzer/Structs%0A%09src/NetPanzer/Views/Components%20src/NetPanzer/Views/Game%0A%09src/NetPanzer/Views/MainMenu/Multi%0A%09src/NetPanzer/Views/MainMenu/Options%20units/profiles&In-Reply-To=%3C200805041407.m44E7uOs006532%40sheep.berlios.de%3E"
       TITLE="[Netpanzer-cvs] r1027 - in trunk/netpanzer: . src/Lib/2D	src/Lib/INIParser src/Lib/Util src/NetPanzer/Bot	src/NetPanzer/Classes src/NetPanzer/Classes/Units	src/NetPanzer/Classes/Weapons src/NetPanzer/Interfaces	src/NetPanzer/Particles src/NetPanzer/Structs	src/NetPanzer/Views/Components src/NetPanzer/Views/Game	src/NetPanzer/Views/MainMenu/Multi	src/NetPanzer/Views/MainMenu/Options units/profiles">kromxp at mail.berlios.de
       </A><BR>
    <I>Sun May  4 16:07:56 CEST 2008</I>
    <P><UL>
        
        <LI>Next message: <A HREF="000070.html">[Netpanzer-cvs] r1028 - trunk/netpanzer/src/NetPanzer/System
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#69">[ date ]</a>
              <a href="thread.html#69">[ thread ]</a>
              <a href="subject.html#69">[ subject ]</a>
              <a href="author.html#69">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: kromxp
Date: 2008-05-04 16:05:21 +0200 (Sun, 04 May 2008)
New Revision: 1027

Removed:
   trunk/netpanzer/src/NetPanzer/Classes/Units/Abrams.cpp
   trunk/netpanzer/src/NetPanzer/Classes/Units/Abrams.hpp
   trunk/netpanzer/src/NetPanzer/Classes/Units/Archer.cpp
   trunk/netpanzer/src/NetPanzer/Classes/Units/Archer.hpp
   trunk/netpanzer/src/NetPanzer/Classes/Units/Hammerhead.cpp
   trunk/netpanzer/src/NetPanzer/Classes/Units/Hammerhead.hpp
   trunk/netpanzer/src/NetPanzer/Classes/Units/Humvee.cpp
   trunk/netpanzer/src/NetPanzer/Classes/Units/Humvee.hpp
   trunk/netpanzer/src/NetPanzer/Classes/Units/Leopard.cpp
   trunk/netpanzer/src/NetPanzer/Classes/Units/Leopard.hpp
   trunk/netpanzer/src/NetPanzer/Classes/Units/Lynx.cpp
   trunk/netpanzer/src/NetPanzer/Classes/Units/Lynx.hpp
   trunk/netpanzer/src/NetPanzer/Classes/Units/M109.cpp
   trunk/netpanzer/src/NetPanzer/Classes/Units/M109.hpp
   trunk/netpanzer/src/NetPanzer/Classes/Units/Scorpion.cpp
   trunk/netpanzer/src/NetPanzer/Classes/Units/Scorpion.hpp
   trunk/netpanzer/src/NetPanzer/Classes/Units/SpahPanzer.cpp
   trunk/netpanzer/src/NetPanzer/Classes/Units/SpahPanzer.hpp
   trunk/netpanzer/src/NetPanzer/Classes/Units/Valentine.cpp
   trunk/netpanzer/src/NetPanzer/Classes/Units/Valentine.hpp
   trunk/netpanzer/src/NetPanzer/Views/Components/AbstractButton.hpp
   trunk/netpanzer/src/NetPanzer/Views/MainMenu/Multi/GetSessionHostView.cpp
   trunk/netpanzer/src/NetPanzer/Views/MainMenu/Multi/GetSessionHostView.hpp
Modified:
   trunk/netpanzer/ChangeLog
   trunk/netpanzer/src/Lib/2D/Surface.hpp
   trunk/netpanzer/src/Lib/INIParser/Section.hpp
   trunk/netpanzer/src/Lib/Util/FileSystem.cpp
   trunk/netpanzer/src/NetPanzer/Bot/Bot.cpp
   trunk/netpanzer/src/NetPanzer/Bot/BotPlayer.cpp
   trunk/netpanzer/src/NetPanzer/Classes/BonusUnitPowerUp.cpp
   trunk/netpanzer/src/NetPanzer/Classes/Outpost.cpp
   trunk/netpanzer/src/NetPanzer/Classes/PlayerState.cpp
   trunk/netpanzer/src/NetPanzer/Classes/PlayerUnitConfig.cpp
   trunk/netpanzer/src/NetPanzer/Classes/PlayerUnitConfig.hpp
   trunk/netpanzer/src/NetPanzer/Classes/Units/UnitGlobals.cpp
   trunk/netpanzer/src/NetPanzer/Classes/Units/UnitGlobals.hpp
   trunk/netpanzer/src/NetPanzer/Classes/Units/Vehicle.cpp
   trunk/netpanzer/src/NetPanzer/Classes/Units/Vehicle.hpp
   trunk/netpanzer/src/NetPanzer/Classes/Weapons/MissleWeapon.cpp
   trunk/netpanzer/src/NetPanzer/Classes/Weapons/MissleWeapon.hpp
   trunk/netpanzer/src/NetPanzer/Interfaces/BaseGameManager.cpp
   trunk/netpanzer/src/NetPanzer/Interfaces/BaseGameManager.hpp
   trunk/netpanzer/src/NetPanzer/Interfaces/GameConfig.cpp
   trunk/netpanzer/src/NetPanzer/Interfaces/GameConfig.hpp
   trunk/netpanzer/src/NetPanzer/Interfaces/GameManager.cpp
   trunk/netpanzer/src/NetPanzer/Interfaces/PlayerGameManager.cpp
   trunk/netpanzer/src/NetPanzer/Interfaces/ProjectileInterface.cpp
   trunk/netpanzer/src/NetPanzer/Interfaces/UnitInterface.cpp
   trunk/netpanzer/src/NetPanzer/Interfaces/UnitProfileInterface.cpp
   trunk/netpanzer/src/NetPanzer/Interfaces/UnitProfileInterface.hpp
   trunk/netpanzer/src/NetPanzer/Particles/ChunkTrajectoryParticle2D.cpp
   trunk/netpanzer/src/NetPanzer/Particles/ParticleInterface.cpp
   trunk/netpanzer/src/NetPanzer/Particles/ParticleInterface.hpp
   trunk/netpanzer/src/NetPanzer/Structs/UnitTypes.hpp
   trunk/netpanzer/src/NetPanzer/Views/Components/Button.cpp
   trunk/netpanzer/src/NetPanzer/Views/Components/Button.hpp
   trunk/netpanzer/src/NetPanzer/Views/Components/CheckBox.cpp
   trunk/netpanzer/src/NetPanzer/Views/Components/CheckBox.hpp
   trunk/netpanzer/src/NetPanzer/Views/Components/Choice.cpp
   trunk/netpanzer/src/NetPanzer/Views/Components/Choice.hpp
   trunk/netpanzer/src/NetPanzer/Views/Components/Component.cpp
   trunk/netpanzer/src/NetPanzer/Views/Components/Component.hpp
   trunk/netpanzer/src/NetPanzer/Views/Components/Desktop.cpp
   trunk/netpanzer/src/NetPanzer/Views/Components/Desktop.hpp
   trunk/netpanzer/src/NetPanzer/Views/Components/Label.cpp
   trunk/netpanzer/src/NetPanzer/Views/Components/Label.hpp
   trunk/netpanzer/src/NetPanzer/Views/Components/MouseEvent.hpp
   trunk/netpanzer/src/NetPanzer/Views/Components/ScrollBar.cpp
   trunk/netpanzer/src/NetPanzer/Views/Components/ScrollBar.hpp
   trunk/netpanzer/src/NetPanzer/Views/Components/View.cpp
   trunk/netpanzer/src/NetPanzer/Views/Components/View.hpp
   trunk/netpanzer/src/NetPanzer/Views/Components/cButton.cpp
   trunk/netpanzer/src/NetPanzer/Views/Components/cButton.hpp
   trunk/netpanzer/src/NetPanzer/Views/Game/GameInfoView.cpp
   trunk/netpanzer/src/NetPanzer/Views/Game/HelpScrollView.cpp
   trunk/netpanzer/src/NetPanzer/Views/Game/HelpScrollView.hpp
   trunk/netpanzer/src/NetPanzer/Views/Game/LibView.cpp
   trunk/netpanzer/src/NetPanzer/Views/Game/LibView.hpp
   trunk/netpanzer/src/NetPanzer/Views/Game/VehicleSelectionView.cpp
   trunk/netpanzer/src/NetPanzer/Views/Game/VehicleSelectionView.hpp
   trunk/netpanzer/src/NetPanzer/Views/MainMenu/Multi/FlagSelectionView.cpp
   trunk/netpanzer/src/NetPanzer/Views/MainMenu/Multi/FlagSelectionView.hpp
   trunk/netpanzer/src/NetPanzer/Views/MainMenu/Multi/GetSessionView.cpp
   trunk/netpanzer/src/NetPanzer/Views/MainMenu/Multi/HostJoinTemplateView.cpp
   trunk/netpanzer/src/NetPanzer/Views/MainMenu/Multi/HostOptionsView.cpp
   trunk/netpanzer/src/NetPanzer/Views/MainMenu/Options/SoundView.cpp
   trunk/netpanzer/src/NetPanzer/Views/MainMenu/Options/SoundView.hpp
   trunk/netpanzer/src/NetPanzer/Views/MainMenu/Options/VisualsView.cpp
   trunk/netpanzer/src/NetPanzer/Views/MainMenu/Options/VisualsView.hpp
   trunk/netpanzer/units/profiles/Archer.pfl
   trunk/netpanzer/units/profiles/Bear.pfl
   trunk/netpanzer/units/profiles/Bobcat.pfl
   trunk/netpanzer/units/profiles/Drake.pfl
   trunk/netpanzer/units/profiles/Manta.pfl
   trunk/netpanzer/units/profiles/Panther1.pfl
   trunk/netpanzer/units/profiles/SPanzer.pfl
   trunk/netpanzer/units/profiles/Scout.pfl
   trunk/netpanzer/units/profiles/Stinger.pfl
   trunk/netpanzer/units/profiles/Titan.pfl
   trunk/netpanzer/units/profiles/Wolf.pfl
Log:
- Deleted AbstractButton
- Deleted GetSessionHostView.* it was not used.
- Deleted the classes for each unit type, only use Vehicle now.
- Removed LoadUnitSurfaces functions (2 in 2 different places)
- fix bug in Surface::getRect()
- fix #include in FileSystem.cpp
- GameConfig will load the spawnconfig as list
- Added some fields to UnitProfile: image, bodysprite, bodyshadow, turretsprite, turretshadow, soundselected, firesound, weapon, boundbox
- UnitProfileInterface, PlayerUnitConfig and ParticleInterface  uses a vector instead of static array
- UnitProfileInterface new functions getProfileByName and getNumUnitTypes, it will also load the unit sprites when loading the profile
- MissleWeapon has new parameter for missile size, 0 for small 1 for medium
- Player POINTS for killing tanks are NOT counted any more.
- Removed some of the cButton types in View and added to Button or in some case in a dedicated Button class
- VehicleSelectionView creates the buttons (custom button) and order the buttons in the order the unit profiles are loaded. May order them by strength in future.
- FlagSelectionView uses a custom button
- Updated unit profiles with new configuration

Notes:
* some of these changes allow to change the unit graphics order or some other parameters that before was not possible doing without modifying code, it is advised to not use this function in production servers as there is not synchronization between server and clients right now.
* bots not tested
* dedicated server not tested
* points are not counted from now and will be removed in future



Modified: trunk/netpanzer/ChangeLog
===================================================================
--- trunk/netpanzer/ChangeLog	2008-04-27 15:01:39 UTC (rev 1026)
+++ trunk/netpanzer/ChangeLog	2008-05-04 14:05:21 UTC (rev 1027)
@@ -1,3 +1,23 @@
+04-May-2008 by Aaron Perez
+- Deleted AbstractButton
+- Deleted the classes for each unit type, only use Vehicle now.
+- Removed LoadUnitSurfaces functions (2 in 2 different places)
+- fix bug in Surface::getRect()
+- fix #include in FileSystem.cpp
+- GameConfig will load the spawnconfig as list
+- Added some fields to UnitProfile: image, bodysprite, bodyshadow, turretsprite, turretshadow, soundselected, firesound, weapon, boundbox
+- UnitProfileInterface, PlayerUnitConfig and ParticleInterface  uses a vector instead of static array
+- UnitProfileInterface new functions getProfileByName and getNumUnitTypes, it will also load the unit sprites when loading the profile
+- MissleWeapon has new parameter for missile size, 0 for small 1 for medium
+- Player POINTS for killing tanks are NOT counted any more.
+- Removed some of the cButton types in View and added to Button or in some case in a dedicated Button class
+- VehicleSelectionView creates the buttons (custom button) and order the buttons in the order the unit profiles are loaded. May order them by strength in future.
+- FlagSelectionView uses a custom button
+- Updated unit profiles with new configuration
+
+01-May-2008 by Aaron Perez
+- Deleted GetSessionHostView.* it was not used.
+
 27-Apr-2008 by Aaron Perez
 - removed unused line in MenuTemplateView
 - removed classes LobbyView, ProgressView and ConsoleLoadingView functionality

Modified: trunk/netpanzer/src/Lib/2D/Surface.hpp
===================================================================
--- trunk/netpanzer/src/Lib/2D/Surface.hpp	2008-04-27 15:01:39 UTC (rev 1026)
+++ trunk/netpanzer/src/Lib/2D/Surface.hpp	2008-05-04 14:05:21 UTC (rev 1027)
@@ -92,7 +92,7 @@
     }
     iRect  getRect() const
     {
-        return iRect(0, 0, getWidth() - 1, getWidth() - 1);
+        return iRect(0, 0, getWidth() - 1, getHeight() - 1);
     }
 
     void putPixel(unsigned int x, unsigned int y, const PIX &amp;color) 

Modified: trunk/netpanzer/src/Lib/INIParser/Section.hpp
===================================================================
--- trunk/netpanzer/src/Lib/INIParser/Section.hpp	2008-04-27 15:01:39 UTC (rev 1026)
+++ trunk/netpanzer/src/Lib/INIParser/Section.hpp	2008-05-04 14:05:21 UTC (rev 1027)
@@ -28,6 +28,10 @@
  * This class represents a section in an ini file. It contains a key/value map
  * for the settings
  */
+    
+    typedef std::map&lt;std::string, std::string&gt; valuesMap;
+    typedef valuesMap::const_iterator valuesIterator;
+    
 class Section
 {
 public:
@@ -44,12 +48,22 @@
     void setIntValue(const std::string&amp; key, int value);
     void setFloatValue(const std::string&amp; key, float value);
 
+    valuesIterator getValuesBegin() const
+    {
+        return values.begin();
+    }
+    
+    valuesIterator getValuesEnd() const
+    {
+        return values.end();
+    }
+    
 private:
     friend class Store;
     Section(const std::string&amp; name);
     
     std::string name;
-    std::map&lt;std::string, std::string&gt; values;
+    valuesMap values;
 };
 
 } // end of namespace INI

Modified: trunk/netpanzer/src/Lib/Util/FileSystem.cpp
===================================================================
--- trunk/netpanzer/src/Lib/Util/FileSystem.cpp	2008-04-27 15:01:39 UTC (rev 1026)
+++ trunk/netpanzer/src/Lib/Util/FileSystem.cpp	2008-05-04 14:05:21 UTC (rev 1027)
@@ -19,10 +19,10 @@
 
 #include &lt;stdio.h&gt;
 #include &lt;string.h&gt;
-#include &lt;physfs.h&gt;
 #include &quot;Exception.hpp&quot;
 #include &quot;Log.hpp&quot;
 #include &quot;FileSystem.hpp&quot;
+#include &quot;physfs/physfs.h&quot;
 
 namespace filesystem
 {

Modified: trunk/netpanzer/src/NetPanzer/Bot/Bot.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Bot/Bot.cpp	2008-04-27 15:01:39 UTC (rev 1026)
+++ trunk/netpanzer/src/NetPanzer/Bot/Bot.cpp	2008-05-04 14:05:21 UTC (rev 1027)
@@ -100,7 +100,8 @@
 void
 Bot::produceUnit(int outpostID, int selectedProduce)
 {
-    assert(selectedProduce &lt;= _unit_type_humvee);
+    LOGGER.debug(&quot;bot: produceUnit outpost=%d selectedProduce=%d&quot;,
+                 outpostID, selectedProduce);
 
     // Send the server the selected unit and whether factory power is on.
     TerminalOutpostUnitGenRequest term_mesg;
@@ -113,7 +114,5 @@
     if (NetworkState::status == _network_state_client) {
         ObjectiveInterface::sendMessage(&amp;(term_mesg.unit_gen_request));
     }
-    LOGGER.debug(&quot;bot: produceUnit outpost=%d selectedProduce=%d&quot;,
-            outpostID, selectedProduce);
-}
+ }
 

Modified: trunk/netpanzer/src/NetPanzer/Bot/BotPlayer.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Bot/BotPlayer.cpp	2008-04-27 15:01:39 UTC (rev 1026)
+++ trunk/netpanzer/src/NetPanzer/Bot/BotPlayer.cpp	2008-05-04 14:05:21 UTC (rev 1027)
@@ -26,6 +26,7 @@
 #include &quot;BotPlayer.hpp&quot;
 
 #include &quot;Interfaces/PlayerInterface.hpp&quot;
+#include &quot;Interfaces/UnitProfileInterface.hpp&quot;
 #include &quot;Classes/PlayerID.hpp&quot;
 #include &quot;Interfaces/UnitInterface.hpp&quot;
 #include &quot;Interfaces/MapInterface.hpp&quot;
@@ -237,8 +238,7 @@
         OutpostStatus outpostStatus =
             ObjectiveInterface::getOutpostStatus(*i);
         if (outpostStatus.unit_generation_on_off == false) {
-            // XXX hack, _unit_type_humvee is expected to be last accesible
-            produceUnit(*i, rand() % (_unit_type_humvee + 1));
+            produceUnit(*i, rand() % UnitProfileInterface::getNumUnitTypes() );
         }
     }
 }

Modified: trunk/netpanzer/src/NetPanzer/Classes/BonusUnitPowerUp.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Classes/BonusUnitPowerUp.cpp	2008-04-27 15:01:39 UTC (rev 1026)
+++ trunk/netpanzer/src/NetPanzer/Classes/BonusUnitPowerUp.cpp	2008-05-04 14:05:21 UTC (rev 1027)
@@ -24,6 +24,7 @@
 #include &quot;Interfaces/PlayerInterface.hpp&quot;
 #include &quot;Interfaces/MapInterface.hpp&quot;
 #include &quot;Interfaces/ConsoleInterface.hpp&quot;
+#include &quot;Interfaces/UnitProfileInterface.hpp&quot;
 
 #include &quot;Interfaces/Server.hpp&quot;
 #include &quot;Classes/Network/NetworkServer.hpp&quot;
@@ -40,7 +41,7 @@
 BonusUnitPowerUp::BonusUnitPowerUp(iXY map_loc, int type)
         : PowerUp( map_loc, type )
 {
-    bonus_unit_type = rand() % _unit_type_humvee;
+    bonus_unit_type = rand() % UnitProfileInterface::getNumUnitTypes();
 
     bonus_unit_animation.setData( BONUS_POWERUP_ANIM );
     bonus_unit_animation.setAttrib( powerup_state.world_loc, iXY(0,0), 5 );

Modified: trunk/netpanzer/src/NetPanzer/Classes/Outpost.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Classes/Outpost.cpp	2008-04-27 15:01:39 UTC (rev 1026)
+++ trunk/netpanzer/src/NetPanzer/Classes/Outpost.cpp	2008-05-04 14:05:21 UTC (rev 1027)
@@ -137,14 +137,14 @@
 
 void
 Outpost::generateUnits()
-{
-    if ( NetworkState::status == _network_state_server ) {
-
-        if ( (unit_generation_type != _unit_type_null) &amp;&amp;
-                (objective_state.occupation_status == _occupation_status_occupied) ) {
-            if( (unit_generation_timer.count() == true) &amp;&amp;
-                    (unit_generation_on_flag == true)
-              ) {
+{   // XXX CHECK
+    if ( NetworkState::status == _network_state_server )
+    {
+        if ( (unit_generation_on_flag == true) &amp;&amp;
+            (objective_state.occupation_status == _occupation_status_occupied) )
+        {
+            if( (unit_generation_timer.count() == true) )
+            {
                 UnitBase *unit;
                 iXY gen_loc;
                 gen_loc = outpost_map_loc + unit_generation_loc;
@@ -152,7 +152,8 @@
                 unit = UnitInterface::createUnit(unit_generation_type,
                         gen_loc, objective_state.occupying_player-&gt;getID());
 
-                if ( unit != 0 ) {
+                if ( unit != 0 )
+                {
                     UnitRemoteCreate create_mesg(unit-&gt;player-&gt;getID(),
                             unit-&gt;id, gen_loc.x, gen_loc.y,
                             unit_generation_type);
@@ -174,8 +175,10 @@
             } // ** if
         } // ** if
     } // ** if ( objective_state.occupation_status == _occupation_status_unoccupied )
-    else {
-        if( (unit_generation_timer.count() == true) ) {
+    else
+    {
+        if( (unit_generation_timer.count() == true) )
+        {
             unit_generation_timer.reset();
         }
     }
@@ -258,12 +261,11 @@
     status.unit_generation_on_off = unit_generation_on_flag;
     status.unit_collection_loc = unit_collection_loc;
 
-    if ( unit_generation_type != _unit_type_null ) {
-        profile = UnitProfileInterface::getUnitProfile( unit_generation_type );
+    profile = UnitProfileInterface::getUnitProfile( unit_generation_type );
+    if ( profile )
         status.unit_generation_time = (float) profile-&gt;regen_time;
-    } else {
+    else
         status.unit_generation_time = 0;
-    }
 
     if ( unit_generation_on_flag == true ) {
         status.unit_generation_time_remaining = unit_generation_timer.getTimeLeft();

Modified: trunk/netpanzer/src/NetPanzer/Classes/PlayerState.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Classes/PlayerState.cpp	2008-04-27 15:01:39 UTC (rev 1026)
+++ trunk/netpanzer/src/NetPanzer/Classes/PlayerState.cpp	2008-05-04 14:05:21 UTC (rev 1027)
@@ -215,7 +215,7 @@
 {
     if ( stats_locked == true ) return;
     kills++;
-    kill_points += 2 * unit_config.getUnitPointValue(unit_type);
+    //kill_points += 2 * unit_config.getUnitPointValue(unit_type);
 }
 
 void PlayerState::decKills(UnitType unit_type)
@@ -229,7 +229,7 @@
 {
     if ( stats_locked == true ) return;
     losses++;
-    loss_points += unit_config.getUnitPointValue(unit_type);
+    //loss_points += unit_config.getUnitPointValue(unit_type);
 }
 
 void PlayerState::decLosses(UnitType unit_type)

Modified: trunk/netpanzer/src/NetPanzer/Classes/PlayerUnitConfig.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Classes/PlayerUnitConfig.cpp	2008-04-27 15:01:39 UTC (rev 1026)
+++ trunk/netpanzer/src/NetPanzer/Classes/PlayerUnitConfig.cpp	2008-05-04 14:05:21 UTC (rev 1027)
@@ -18,40 +18,8 @@
 #include &lt;config.h&gt;
 #include &quot;Classes/PlayerUnitConfig.hpp&quot;
 #include &quot;Interfaces/GameConfig.hpp&quot;
+#include &quot;Interfaces/UnitProfileInterface.hpp&quot;
 
-#include &lt;string.h&gt;
-
-int
-UnitGameInfo::getUnitPointValue(UnitType unit_type)
-{
-    switch(unit_type) {
-        case _unit_type_valentine:
-            return 2;
-        case _unit_type_leopard:
-            return 5;
-        case _unit_type_abrams:
-            return 6;
-        case _unit_type_hammerhead:
-            return 5;
-        case _unit_type_lynx:
-            return 1;
-        case _unit_type_spahpanzer:
-            return 4;
-        case _unit_type_archer:
-            return 5;
-        case _unit_type_scorpion:
-            return 3;
-        case _unit_type_m109:
-            return 4;
-        case _unit_type_humvee:
-            return 1;
-        default:
-            assert(false);
-    }       
-}
-
-
-
 PlayerUnitConfig::PlayerUnitConfig()
 {
 }
@@ -59,50 +27,38 @@
 void PlayerUnitConfig::initialize()
 {
     max_allowed_units = gameconfig-&gt;maxunits / gameconfig-&gt;maxplayers;
-    memset( unit_spawn_list, 0, sizeof(unit_spawn_list));
+    unit_spawn_list.resize(UnitProfileInterface::getNumUnitTypes(), 0);
+    
     int rem_units = max_allowed_units;
-    unsigned int numunits;
+    int numunits;
 
-    numunits = (rem_units &lt; gameconfig-&gt;archer)?rem_units:gameconfig-&gt;archer;
-    rem_units-=numunits;
-    unit_spawn_list[ _unit_type_archer ] = numunits;
+    vector&lt;ConfigVariable*&gt;::iterator i = gameconfig-&gt;spawnsettings.begin();
+    while ( i != gameconfig-&gt;spawnsettings.end() )
+    {
+        UnitProfile * u = UnitProfileInterface::getProfileByName((*i)-&gt;getName());
+        if ( u )
+        {
+            numunits = *(ConfigInt *)(*i);
+            if ( numunits &gt; rem_units )
+                numunits = rem_units;
+            rem_units -= numunits;
+            unit_spawn_list[u-&gt;unit_type] = numunits;
+        }
+        i++;
+    }
     
-    numunits = (rem_units &lt; gameconfig-&gt;bear)?rem_units:gameconfig-&gt;bear;
-    rem_units-=numunits;
-    unit_spawn_list[ _unit_type_spahpanzer ] = numunits;
+    if ( ! unitTotal() )
+    {
+        // there wasn't any unit, create some and add to config
+        gameconfig-&gt;clearSpawnSettings();
+        for ( int a=0; a&lt;(int)unit_spawn_list.size(); a++ )
+        {
+            unit_spawn_list[a] = 1;
+            UnitProfile * u = UnitProfileInterface::getUnitProfile(a);
+            gameconfig-&gt;spawnsettings.push_back(new ConfigInt(u-&gt;unitname,1));
+        }
+    }
     
-    numunits = (rem_units &lt; gameconfig-&gt;bobcat)?rem_units:gameconfig-&gt;bobcat;
-    rem_units-=numunits;
-    unit_spawn_list[ _unit_type_lynx ] = numunits;
-    
-    numunits = (rem_units &lt; gameconfig-&gt;drake)?rem_units:gameconfig-&gt;drake;
-    rem_units-=numunits;
-    unit_spawn_list[ _unit_type_m109 ] = numunits;
-    
-    numunits = (rem_units &lt; gameconfig-&gt;manta)?rem_units:gameconfig-&gt;manta;
-    rem_units-=numunits;
-    unit_spawn_list[ _unit_type_valentine ] = numunits;
-    
-    numunits = (rem_units &lt; gameconfig-&gt;panther1)?rem_units:gameconfig-&gt;panther1;
-    rem_units-=numunits;
-    unit_spawn_list[ _unit_type_leopard ] = numunits;
-    
-    numunits = (rem_units &lt; gameconfig-&gt;spanzer)?rem_units:gameconfig-&gt;spanzer;
-    rem_units-=numunits;
-    unit_spawn_list[ _unit_type_humvee ] = numunits;
-    
-    numunits = (rem_units &lt; gameconfig-&gt;stinger)?rem_units:gameconfig-&gt;stinger;
-    rem_units-=numunits;
-    unit_spawn_list[ _unit_type_hammerhead ] = numunits;
-    
-    numunits = (rem_units &lt; gameconfig-&gt;titan)?rem_units:gameconfig-&gt;titan;
-    rem_units-=numunits;
-    unit_spawn_list[ _unit_type_abrams ] = numunits;
-    
-    numunits = (rem_units &lt; gameconfig-&gt;wolf)?rem_units:gameconfig-&gt;wolf;
-    rem_units-=numunits;
-    unit_spawn_list[ _unit_type_scorpion ] = numunits;
-    
     unit_color = 0;
 }
 
@@ -111,7 +67,7 @@
     unsigned int total = 0;
     unsigned int i;
 
-    for( i = 0; i &lt; _MAX_UNIT_TYPES; i++ ) {
+    for( i = 0; i &lt; unit_spawn_list.size(); i++ ) {
         total += unit_spawn_list[ i ];
     }
 

Modified: trunk/netpanzer/src/NetPanzer/Classes/PlayerUnitConfig.hpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Classes/PlayerUnitConfig.hpp	2008-04-27 15:01:39 UTC (rev 1026)
+++ trunk/netpanzer/src/NetPanzer/Classes/PlayerUnitConfig.hpp	2008-05-04 14:05:21 UTC (rev 1027)
@@ -20,17 +20,15 @@
 
 #include &quot;Structs/UnitTypes.hpp&quot;
 
-class UnitGameInfo
-{
-public:
-    int getUnitPointValue(UnitType unit_type);
-};
+#include &lt;vector&gt;
 
-class PlayerUnitConfig : public UnitGameInfo
+using namespace std;
+
+class PlayerUnitConfig
 {
 protected:
     unsigned int max_allowed_units;
-    unsigned int unit_spawn_list[ _MAX_UNIT_TYPES ];
+    vector&lt;unsigned int&gt; unit_spawn_list;
     char unit_color;
 
 public:
@@ -40,23 +38,32 @@
 
     inline unsigned int getSpawnUnitCount( unsigned char unit_type ) const
     {
-        return( unit_spawn_list[ unit_type ] );
+        if ( unit_type &lt; unit_spawn_list.size() )
+            return unit_spawn_list[unit_type];
+        return 0;
     }
 
     inline void incrementSpawnUnitCount( unsigned char unit_type )
     {
-        unit_spawn_list[ unit_type ]++;
-        if ( unitTotal() &gt; max_allowed_units ) {
-            unit_spawn_list[ unit_type ]--;
+        if ( unit_type &lt; unit_spawn_list.size() )
+        {
+            unit_spawn_list[ unit_type ]++;
+            if ( unitTotal() &gt; max_allowed_units )
+            {
+                unit_spawn_list[ unit_type ]--;
+            }
         }
     }
 
-    inline void decrementSpawnUnitCount( unsigned char  unit_type )
+    inline void decrementSpawnUnitCount( unsigned char unit_type )
     {
-        if ( (unit_spawn_list[ unit_type ] &gt; 0) &amp;&amp;
-                (unitTotal() &gt; 1)
-           ) {
-            unit_spawn_list[ unit_type ]--;
+        if ( unit_type &lt; unit_spawn_list.size() )
+        {
+            if ( (unit_spawn_list[ unit_type ] &gt; 0) &amp;&amp;
+                 (unitTotal() &gt; 1) )
+            {
+                unit_spawn_list[ unit_type ]--;
+            }
         }
     }
 

Deleted: trunk/netpanzer/src/NetPanzer/Classes/Units/Abrams.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Classes/Units/Abrams.cpp	2008-04-27 15:01:39 UTC (rev 1026)
+++ trunk/netpanzer/src/NetPanzer/Classes/Units/Abrams.cpp	2008-05-04 14:05:21 UTC (rev 1027)
@@ -1,99 +0,0 @@
-/*
-Copyright (C) 1998 Pyrosoft Inc. (www.pyrosoftgames.com), Matthew Bogue
- 
-This program is free software; you can redistribute it and/or modify
-it under the terms of the GNU General Public License as published by
-the Free Software Foundation; either version 2 of the License, or
-(at your option) any later version.
- 
-This program is distributed in the hope that it will be useful,
-but WITHOUT ANY WARRANTY; without even the implied warranty of
-MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-GNU General Public License for more details.
- 
-You should have received a copy of the GNU General Public License
-along with this program; if not, write to the Free Software
-Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
-*/
-#include &lt;config.h&gt;
-
-#include &quot;Abrams.hpp&quot;
-#include &quot;Interfaces/UnitProfileInterface.hpp&quot;
-#include &quot;2D/Color.hpp&quot;
-#include &quot;Interfaces/WorldViewInterface.hpp&quot;
-#include &quot;Classes/Weapons/Weapon.hpp&quot;
-#include &quot;System/Sound.hpp&quot;
-
-#include &quot;UnitGlobals.hpp&quot;
-
-void Abrams::setUnitProperties( void )
-{
-    UnitProfile *profile;
-
-    profile = UnitProfileInterface::getUnitProfile( _unit_type_abrams );
-
-    unit_state.hit_points = profile-&gt;hit_points;
-    unit_state.max_hit_points = profile-&gt;hit_points;
-    unit_state.damage_factor = profile-&gt;attack_factor;
-    unit_state.defend_range = profile-&gt;defend_range;
-    unit_state.speed_factor = profile-&gt;speed_factor;
-    unit_state.speed_rate = profile-&gt;speed_rate;
-    unit_state.reload_time = profile-&gt;reload_time;
-    unit_state.weapon_range = profile-&gt;attack_range;
-    unit_state.unit_type = _unit_type_abrams;
-    select_info_box.setHitBarAttributes( profile-&gt;hit_points, Color::yellow );
-
-}
-
-Abrams::Abrams(PlayerState* player, UnitID id, iXY initial_loc,
-        unsigned char color, unsigned char flag )
-        : Vehicle(player, id, initial_loc)
-{
-    setUnitProperties();
-
-    if ( color == false) {
-        body_anim.setData( gAbramsBody );
-        turret_anim.setData( gAbramsTurret );
-    } else {
-        body_anim.setData( gAbramsBodyDarkBlue );
-        turret_anim.setData( gAbramsTurretDarkBlue );
-    }
-
-    body_anim_shadow.setData( gAbramsBodyShadow );
-    turret_anim_shadow.setData( gAbramsTurretShadow );
-
-
-    body_anim.setAttrib( iXY(0,0), iXY(0,0), unitLayer );
-    turret_anim.setAttrib( iXY(0,0), iXY(0,0), unitLayer );
-    body_anim_shadow.setAttrib( iXY(0,0), iXY(0,0), unitLayer);
-    turret_anim_shadow.setAttrib( iXY(0,0), iXY(0,0), unitLayer);
-
-    select_info_box.setBoxAttributes( BoundBox( -30, -30, 30, 30), Color::blue );
-    select_info_box.setBoxState( false );
-    select_info_box.setFlag( flag );
-
-    body_anim_shadow.attachSprite( &amp;body_anim, iXY(0,0) );
-    body_anim_shadow.attachSprite( &amp;turret_anim_shadow, iXY(0,0) );
-    body_anim_shadow.attachSprite( &amp;turret_anim, iXY(0,0) );
-    body_anim_shadow.attachSprite( &amp;select_info_box, iXY(0,0) );
-}
-
-//-----------------------------------------------------------------
-/**
- * Make noise.
- * @return projectile_type
- */
-unsigned short Abrams::launchProjectile()
-{
-    //SFX
-    long distance = WorldViewInterface::getCameraDistance(unit_state.location);
-    sound-&gt;playAmbientSound(&quot;ht-fire&quot;, distance );
-    sound-&gt;playBattle();
-
-    return Weapon::_shell;
-}
-//-----------------------------------------------------------------
-void Abrams::soundSelected()
-{
-    sound-&gt;playSound(&quot;ht-selected&quot;);
-}

Deleted: trunk/netpanzer/src/NetPanzer/Classes/Units/Abrams.hpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Classes/Units/Abrams.hpp	2008-04-27 15:01:39 UTC (rev 1026)
+++ trunk/netpanzer/src/NetPanzer/Classes/Units/Abrams.hpp	2008-05-04 14:05:21 UTC (rev 1027)
@@ -1,36 +0,0 @@
-/*
-Copyright (C) 1998 Pyrosoft Inc. (www.pyrosoftgames.com), Matthew Bogue
- 
-This program is free software; you can redistribute it and/or modify
-it under the terms of the GNU General Public License as published by
-the Free Software Foundation; either version 2 of the License, or
-(at your option) any later version.
- 
-This program is distributed in the hope that it will be useful,
-but WITHOUT ANY WARRANTY; without even the implied warranty of
-MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-GNU General Public License for more details.
- 
-You should have received a copy of the GNU General Public License
-along with this program; if not, write to the Free Software
-Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
-*/
-#ifndef _ABRAMS_HPP
-#define _ABRAMS_HPP
-
-#include &quot;Classes/Units/Vehicle.hpp&quot;
-
-class Abrams : public Vehicle
-{
-protected:
-    void setUnitProperties();
-    virtual unsigned short launchProjectile();
-    virtual void soundSelected();
-
-public:
-    Abrams(PlayerState* player, UnitID id, iXY initial_loc,
-            unsigned char color, unsigned char flag );
-
-};
-
-#endif // ** _ABRAMS_HPP

Deleted: trunk/netpanzer/src/NetPanzer/Classes/Units/Archer.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Classes/Units/Archer.cpp	2008-04-27 15:01:39 UTC (rev 1026)
+++ trunk/netpanzer/src/NetPanzer/Classes/Units/Archer.cpp	2008-05-04 14:05:21 UTC (rev 1027)
@@ -1,96 +0,0 @@
-/*
-Copyright (C) 1998 Pyrosoft Inc. (www.pyrosoftgames.com), Matthew Bogue
- 
-This program is free software; you can redistribute it and/or modify
-it under the terms of the GNU General Public License as published by
-the Free Software Foundation; either version 2 of the License, or
-(at your option) any later version.
- 
-This program is distributed in the hope that it will be useful,
-but WITHOUT ANY WARRANTY; without even the implied warranty of
-MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-GNU General Public License for more details.
- 
-You should have received a copy of the GNU General Public License
-along with this program; if not, write to the Free Software
-Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
-*/
-#include &lt;config.h&gt;
-#include &quot;Archer.hpp&quot;
-#include &quot;Interfaces/UnitProfileInterface.hpp&quot;
-#include &quot;2D/Color.hpp&quot;
-#include &quot;Interfaces/WorldViewInterface.hpp&quot;
-#include &quot;Classes/Weapons/Weapon.hpp&quot;
-#include &quot;System/Sound.hpp&quot;
-
-#include &quot;UnitGlobals.hpp&quot;
-
-void Archer::setUnitProperties( void )
-{
-    UnitProfile *profile;
-
-    profile = UnitProfileInterface::getUnitProfile( _unit_type_hammerhead );
-
-    unit_state.hit_points = profile-&gt;hit_points;
-    unit_state.max_hit_points = profile-&gt;hit_points;
-    unit_state.damage_factor = profile-&gt;attack_factor;
-    unit_state.defend_range = profile-&gt;defend_range;
-    unit_state.speed_factor = profile-&gt;speed_factor;
-    unit_state.speed_rate = profile-&gt;speed_rate;
-    unit_state.reload_time = profile-&gt;reload_time;
-    unit_state.weapon_range = profile-&gt;attack_range;
-    unit_state.unit_type = _unit_type_archer;
-    select_info_box.setHitBarAttributes( profile-&gt;hit_points, Color::yellow );
-}
-
-Archer::Archer(PlayerState* player, UnitID id, iXY initial_loc,
-        unsigned char color, unsigned char flag )
-        : Vehicle(player, id, initial_loc)
-{
-    setUnitProperties();
-
-    if ( color == false ) {
-        body_anim.setData( gArcherBody );
-        turret_anim.setData( gArcherTurret );
-    } else {
-        body_anim.setData( gArcherBodyDarkBlue );
-        turret_anim.setData( gArcherTurretDarkBlue );
-    }
-
-    body_anim.setAttrib( iXY(0,0), iXY(0,0), unitLayer );
-    turret_anim.setAttrib( iXY(0,0), iXY(0,0), unitLayer );
-
-    body_anim_shadow.setData( gArcherBodyShadow );
-    turret_anim_shadow.setData( gArcherTurretShadow );
-    body_anim_shadow.setAttrib( iXY(0,0), iXY(0,0), unitLayer );
-    turret_anim_shadow.setAttrib( iXY(0,0), iXY(0,0), unitLayer );
-
-    select_info_box.setBoxAttributes( BoundBox( -20, -20, 20, 20), Color::blue );
-    select_info_box.setBoxState( false );
-    select_info_box.setFlag( flag );
-
-    body_anim_shadow.attachSprite( &amp;body_anim, iXY(0,0) );
-    body_anim_shadow.attachSprite( &amp;turret_anim_shadow, iXY(0,0) );
-    body_anim_shadow.attachSprite( &amp;turret_anim, iXY(0,0) );
-    body_anim_shadow.attachSprite( &amp;select_info_box, iXY(0,0) );
-}
-
-//-----------------------------------------------------------------
-/**
- * Make noise.
- * @return projectile_type
- */
-unsigned short Archer::launchProjectile()
-{
-    //SFX
-    long distance = WorldViewInterface::getCameraDistance(unit_state.location);
-    sound-&gt;playAmbientSound(&quot;mu-fire&quot;, distance );
-    sound-&gt;playBattle();
-
-    return Weapon::_double_missile;
-}
-//-----------------------------------------------------------------
-void Archer::soundSelected()
-{
-    sound-&gt;playSound(&quot;mu-selected&quot;);
-}

Deleted: trunk/netpanzer/src/NetPanzer/Classes/Units/Archer.hpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Classes/Units/Archer.hpp	2008-04-27 15:01:39 UTC (rev 1026)
+++ trunk/netpanzer/src/NetPanzer/Classes/Units/Archer.hpp	2008-05-04 14:05:21 UTC (rev 1027)
@@ -1,36 +0,0 @@
-/*
-Copyright (C) 1998 Pyrosoft Inc. (www.pyrosoftgames.com), Matthew Bogue
- 
-This program is free software; you can redistribute it and/or modify
-it under the terms of the GNU General Public License as published by
-the Free Software Foundation; either version 2 of the License, or
-(at your option) any later version.
- 
-This program is distributed in the hope that it will be useful,
-but WITHOUT ANY WARRANTY; without even the implied warranty of
-MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-GNU General Public License for more details.
- 
-You should have received a copy of the GNU General Public License
-along with this program; if not, write to the Free Software
-Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
-*/
-#ifndef _ARCHER_HPP
-#define _ARCHER_HPP
-
-#include &quot;Classes/Units/Vehicle.hpp&quot;
-
-class Archer : public Vehicle
-{
-protected:
-    void setUnitProperties( void );
-    virtual unsigned short launchProjectile();
-    virtual void soundSelected();
-
-public:
-    Archer(PlayerState* player, UnitID id, iXY initial_loc,
-            unsigned char color, unsigned char flag );
-
-};
-
-#endif // ** _ARCHER_HPP

Deleted: trunk/netpanzer/src/NetPanzer/Classes/Units/Hammerhead.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Classes/Units/Hammerhead.cpp	2008-04-27 15:01:39 UTC (rev 1026)
+++ trunk/netpanzer/src/NetPanzer/Classes/Units/Hammerhead.cpp	2008-05-04 14:05:21 UTC (rev 1027)
@@ -1,96 +0,0 @@
-/*
-Copyright (C) 1998 Pyrosoft Inc. (www.pyrosoftgames.com), Matthew Bogue
- 
-This program is free software; you can redistribute it and/or modify
-it under the terms of the GNU General Public License as published by
-the Free Software Foundation; either version 2 of the License, or
-(at your option) any later version.
- 
-This program is distributed in the hope that it will be useful,
-but WITHOUT ANY WARRANTY; without even the implied warranty of
-MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-GNU General Public License for more details.
- 
-You should have received a copy of the GNU General Public License
-along with this program; if not, write to the Free Software
-Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
-*/
-#include &lt;config.h&gt;
-#include &quot;Hammerhead.hpp&quot;
-#include &quot;Interfaces/UnitProfileInterface.hpp&quot;
-#include &quot;2D/Color.hpp&quot;
-#include &quot;Interfaces/WorldViewInterface.hpp&quot;
-#include &quot;Classes/Weapons/Weapon.hpp&quot;
-#include &quot;System/Sound.hpp&quot;
-
-#include &quot;UnitGlobals.hpp&quot;
-
-void Hammerhead::setUnitProperties( void )
-{
-    UnitProfile *profile;
-
-    profile = UnitProfileInterface::getUnitProfile( _unit_type_hammerhead );
-
-    unit_state.hit_points = profile-&gt;hit_points;
-    unit_state.max_hit_points = profile-&gt;hit_points;
-    unit_state.damage_factor = profile-&gt;attack_factor;
-    unit_state.defend_range = profile-&gt;defend_range;
-    unit_state.speed_factor = profile-&gt;speed_factor;
-    unit_state.speed_rate = profile-&gt;speed_rate;
-    unit_state.reload_time = profile-&gt;reload_time;
-    unit_state.weapon_range = profile-&gt;attack_range;
-    unit_state.unit_type = _unit_type_hammerhead;
-    select_info_box.setHitBarAttributes( profile-&gt;hit_points, Color::yellow );
-}
-
-Hammerhead::Hammerhead(PlayerState* player, UnitID id, iXY initial_loc,
-        unsigned char color, unsigned char flag )
-        : Vehicle(player, id, initial_loc)
-{
-    setUnitProperties();
-
-    if ( color == false ) {
-        body_anim.setData( gHammerheadBody );
-        turret_anim.setData( gHammerheadTurret );
-    } else {
-        body_anim.setData( gHammerheadBodyDarkBlue );
-        turret_anim.setData( gHammerheadTurretDarkBlue );
-    }
-
-    body_anim.setAttrib( iXY(0,0), iXY(0,0), unitLayer );
-    turret_anim.setAttrib( iXY(0,0), iXY(0,0), unitLayer );
-
-    body_anim_shadow.setData( gHammerheadBodyShadow );
-    turret_anim_shadow.setData( gHammerheadTurretShadow );
-    body_anim_shadow.setAttrib( iXY(0,0), iXY(0,0), unitLayer );
-    turret_anim_shadow.setAttrib( iXY(0,0), iXY(0,0), unitLayer );
-
-    select_info_box.setBoxAttributes( BoundBox( -20, -20, 20, 20), Color::blue );
-    select_info_box.setBoxState( false );
-    select_info_box.setFlag( flag );
-
-    body_anim_shadow.attachSprite( &amp;body_anim, iXY(0,0) );
-    body_anim_shadow.attachSprite( &amp;turret_anim_shadow, iXY(0,0) );
-    body_anim_shadow.attachSprite( &amp;turret_anim, iXY(0,0) );
-    body_anim_shadow.attachSprite( &amp;select_info_box, iXY(0,0) );
-}
-
-//-----------------------------------------------------------------
-/**
- * Make noise.
- * @return projectile_type
- */
-unsigned short Hammerhead::launchProjectile()
-{
-    //SFX
-    long distance = WorldViewInterface::getCameraDistance(unit_state.location);
-    sound-&gt;playAmbientSound(&quot;mu-fire&quot;, distance );
-    sound-&gt;playBattle();
-
-    return Weapon::_quad_missile;
-}
-//-----------------------------------------------------------------
-void Hammerhead::soundSelected()
-{
-    sound-&gt;playSound(&quot;mu-selected&quot;);
-}

Deleted: trunk/netpanzer/src/NetPanzer/Classes/Units/Hammerhead.hpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Classes/Units/Hammerhead.hpp	2008-04-27 15:01:39 UTC (rev 1026)
+++ trunk/netpanzer/src/NetPanzer/Classes/Units/Hammerhead.hpp	2008-05-04 14:05:21 UTC (rev 1027)
@@ -1,36 +0,0 @@
-/*
-Copyright (C) 1998 Pyrosoft Inc. (www.pyrosoftgames.com), Matthew Bogue
- 
-This program is free software; you can redistribute it and/or modify
-it under the terms of the GNU General Public License as published by
-the Free Software Foundation; either version 2 of the License, or
-(at your option) any later version.
- 
-This program is distributed in the hope that it will be useful,
-but WITHOUT ANY WARRANTY; without even the implied warranty of
-MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-GNU General Public License for more details.
- 
-You should have received a copy of the GNU General Public License
-along with this program; if not, write to the Free Software
-Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
-*/
-#ifndef _HAMMERHEAD_HPP
-#define _HAMMERHEAD_HPP
-
-#include &quot;Classes/Units/Vehicle.hpp&quot;
-
-class Hammerhead : public Vehicle
-{
-protected:
-    void setUnitProperties();
-    virtual unsigned short launchProjectile();
-    virtual void soundSelected();
-
-public:
-    Hammerhead(PlayerState* player, UnitID id, iXY initial_loc,
-            unsigned char color, unsigned char flag );
-
-};
-
-#endif // ** _HAMMERHEAD_HPP

Deleted: trunk/netpanzer/src/NetPanzer/Classes/Units/Humvee.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Classes/Units/Humvee.cpp	2008-04-27 15:01:39 UTC (rev 1026)
+++ trunk/netpanzer/src/NetPanzer/Classes/Units/Humvee.cpp	2008-05-04 14:05:21 UTC (rev 1027)
@@ -1,93 +0,0 @@
-/*
-Copyright (C) 1998 Pyrosoft Inc. (www.pyrosoftgames.com), Matthew Bogue
- 
-This program is free software; you can redistribute it and/or modify
-it under the terms of the GNU General Public License as published by
-the Free Software Foundation; either version 2 of the License, or
-(at your option) any later version.
- 
-This program is distributed in the hope that it will be useful,
-but WITHOUT ANY WARRANTY; without even the implied warranty of
-MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-GNU General Public License for more details.
- 
-You should have received a copy of the GNU General Public License
-along with this program; if not, write to the Free Software
-Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
-*/
-#include &lt;config.h&gt;
-#include &quot;Humvee.hpp&quot;
-#include &quot;Interfaces/UnitProfileInterface.hpp&quot;
-#include &quot;2D/Color.hpp&quot;
-#include &quot;Interfaces/WorldViewInterface.hpp&quot;
-#include &quot;Classes/Weapons/Weapon.hpp&quot;
-#include &quot;System/Sound.hpp&quot;
-#include &quot;Interfaces/GameConfig.hpp&quot;
-
-#include &quot;UnitGlobals.hpp&quot;
-
-void Humvee::setUnitProperties( void )
-{
-    UnitProfile *profile;
-
-    profile = UnitProfileInterface::getUnitProfile( _unit_type_humvee );
-
-    unit_state.hit_points = profile-&gt;hit_points;
-    unit_state.max_hit_points = profile-&gt;hit_points;
-    unit_state.damage_factor = profile-&gt;attack_factor;
-    unit_state.defend_range = profile-&gt;defend_range;
-    unit_state.speed_factor = profile-&gt;speed_factor;
-    unit_state.speed_rate = profile-&gt;speed_rate;
-    unit_state.reload_time = profile-&gt;reload_time;
-    unit_state.weapon_range = profile-&gt;attack_range;
-    unit_state.unit_type = _unit_type_humvee;
-    select_info_box.setHitBarAttributes( profile-&gt;hit_points, Color::yellow );
-}
-
-Humvee::Humvee(PlayerState* player, UnitID id, iXY initial_loc,
-        unsigned char color, unsigned char flag )
-        : Vehicle(player, id, initial_loc)
-{
-    setUnitProperties();
-
-    if ( color == false) {
-        body_anim.setData( gSpahPanzerBody );
-        turret_anim.setData( gSpahPanzerTurret );
-    } else {
-        body_anim.setData( gSpahPanzerBodyDarkBlue );
-        turret_anim.setData( gSpahPanzerTurretDarkBlue );
-    }
-
-    body_anim_shadow.setData( gSpahPanzerBodyShadow );
-    turret_anim_shadow.setData( gSpahPanzerTurretShadow );
-
-
-    body_anim.setAttrib( iXY(0,0), iXY(0,0), unitLayer );
-    turret_anim.setAttrib( iXY(0,0), iXY(0,0), unitLayer );
-    body_anim_shadow.setAttrib( iXY(0,0), iXY(0,0), unitLayer);
-    turret_anim_shadow.setAttrib( iXY(0,0), iXY(0,0), unitLayer);
-
-    select_info_box.setBoxAttributes( BoundBox( -20, -20, 20, 20), Color::blue );
-    select_info_box.setBoxState( false );
-    select_info_box.setFlag( flag );
-
-    body_anim_shadow.attachSprite( &amp;body_anim, iXY(0,0) );
-    body_anim_shadow.attachSprite( &amp;turret_anim_shadow, iXY(0,0) );
-    body_anim_shadow.attachSprite( &amp;turret_anim, iXY(0,0) );
-    body_anim_shadow.attachSprite( &amp;select_info_box, iXY(0,0) );
-}
-
-//-----------------------------------------------------------------
-/**
- * Make noise.
- * @return projectile_type
- */
-unsigned short Humvee::launchProjectile()
-{
-    //SFX
-    long distance = WorldViewInterface::getCameraDistance(unit_state.location);
-    sound-&gt;playAmbientSound(&quot;lt-fire&quot;, distance );
-    sound-&gt;playBattle();
-
-    return Weapon::_shell;
-}

Deleted: trunk/netpanzer/src/NetPanzer/Classes/Units/Humvee.hpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Classes/Units/Humvee.hpp	2008-04-27 15:01:39 UTC (rev 1026)
+++ trunk/netpanzer/src/NetPanzer/Classes/Units/Humvee.hpp	2008-05-04 14:05:21 UTC (rev 1027)
@@ -1,34 +0,0 @@
-/*
-Copyright (C) 1998 Pyrosoft Inc. (www.pyrosoftgames.com), Matthew Bogue
- 
-This program is free software; you can redistribute it and/or modify
-it under the terms of the GNU General Public License as published by
-the Free Software Foundation; either version 2 of the License, or
-(at your option) any later version.
- 
-This program is distributed in the hope that it will be useful,
-but WITHOUT ANY WARRANTY; without even the implied warranty of
-MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-GNU General Public License for more details.
- 
-You should have received a copy of the GNU General Public License
-along with this program; if not, write to the Free Software
-Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
-*/
-#ifndef _HUMVEE_HPP
-#define _HUMVEE_HPP
-
-#include &quot;Classes/Units/Vehicle.hpp&quot;
-
-class Humvee : public Vehicle
-{
-protected:
-    void setUnitProperties();
-    virtual unsigned short launchProjectile();
-
-public:
-    Humvee(PlayerState* player, UnitID id, iXY initial_loc,
-            unsigned char color, unsigned char flag );
-};
-
-#endif // ** _HUMVEE_HPP

Deleted: trunk/netpanzer/src/NetPanzer/Classes/Units/Leopard.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Classes/Units/Leopard.cpp	2008-04-27 15:01:39 UTC (rev 1026)
+++ trunk/netpanzer/src/NetPanzer/Classes/Units/Leopard.cpp	2008-05-04 14:05:21 UTC (rev 1027)
@@ -1,98 +0,0 @@
-/*
-Copyright (C) 1998 Pyrosoft Inc. (www.pyrosoftgames.com), Matthew Bogue
- 
-This program is free software; you can redistribute it and/or modify
-it under the terms of the GNU General Public License as published by
-the Free Software Foundation; either version 2 of the License, or
-(at your option) any later version.
- 
-This program is distributed in the hope that it will be useful,
-but WITHOUT ANY WARRANTY; without even the implied warranty of
-MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-GNU General Public License for more details.
- 
-You should have received a copy of the GNU General Public License
-along with this program; if not, write to the Free Software
-Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
-*/
-#include &lt;config.h&gt;
-#include &quot;Leopard.hpp&quot;
-#include &quot;Interfaces/UnitProfileInterface.hpp&quot;
-#include &quot;2D/Color.hpp&quot;
-#include &quot;Interfaces/WorldViewInterface.hpp&quot;
-#include &quot;Classes/Weapons/Weapon.hpp&quot;
-#include &quot;System/Sound.hpp&quot;
-
-#include &quot;UnitGlobals.hpp&quot;
-
-void Leopard::setUnitProperties( void )
-{
-    UnitProfile *profile;
-
-    profile = UnitProfileInterface::getUnitProfile( _unit_type_leopard );
-
-    unit_state.hit_points = profile-&gt;hit_points;
-    unit_state.max_hit_points = profile-&gt;hit_points;
-    unit_state.damage_factor = profile-&gt;attack_factor;
-    unit_state.defend_range = profile-&gt;defend_range;
-    unit_state.speed_factor = profile-&gt;speed_factor;
-    unit_state.speed_rate = profile-&gt;speed_rate;
-    unit_state.reload_time = profile-&gt;reload_time;
-    unit_state.weapon_range = profile-&gt;attack_range;
-    unit_state.unit_type = _unit_type_leopard;
-    select_info_box.setHitBarAttributes( profile-&gt;hit_points, Color::yellow );
-
-}
-
-Leopard::Leopard(PlayerState* player, UnitID id, iXY initial_loc,
-        unsigned char color, unsigned char flag )
-        : Vehicle(player, id, initial_loc)
-{
-    setUnitProperties();
-
-    if ( color == false) {
-        body_anim.setData( gLeopardBody );
-        turret_anim.setData( gLeopardTurret );
-    } else {
-        body_anim.setData( gLeopardBodyDarkBlue );
-        turret_anim.setData( gLeopardTurretDarkBlue );
-    }
-
-
-    body_anim.setAttrib( iXY(0,0), iXY(0,0), unitLayer );
-    turret_anim.setAttrib( iXY(0,0), iXY(0,0), unitLayer );
-
-    body_anim_shadow.setData( gLeopardBodyShadow );
-    turret_anim_shadow.setData( gLeopardTurretShadow );
-    body_anim_shadow.setAttrib( iXY(0,0), iXY(0,0), unitLayer );
-    turret_anim_shadow.setAttrib( iXY(0,0), iXY(0,0), unitLayer );
-
-    select_info_box.setBoxAttributes( BoundBox( -25, -25, 25, 25), Color::blue );
-    select_info_box.setBoxState( false );
-    select_info_box.setFlag( flag );
-
-    body_anim_shadow.attachSprite( &amp;body_anim, iXY(0,0) );
-    body_anim_shadow.attachSprite( &amp;turret_anim_shadow, iXY(0,0) );
-    body_anim_shadow.attachSprite( &amp;turret_anim, iXY(0,0) );
-    body_anim_shadow.attachSprite( &amp;select_info_box, iXY(0,0) );
-}
-
-//-----------------------------------------------------------------
-/**
- * Make noise.
- * @return projectile_type
- */
-unsigned short Leopard::launchProjectile()
-{
-    //SFX
-    long distance = WorldViewInterface::getCameraDistance(unit_state.location);
-    sound-&gt;playAmbientSound(&quot;mt-fire&quot;, distance );
-    sound-&gt;playBattle();
-
-    return Weapon::_shell;
-}
-//-----------------------------------------------------------------
-void Leopard::soundSelected()
-{
-    sound-&gt;playSound(&quot;mt-selected&quot;);
-}

Deleted: trunk/netpanzer/src/NetPanzer/Classes/Units/Leopard.hpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Classes/Units/Leopard.hpp	2008-04-27 15:01:39 UTC (rev 1026)
+++ trunk/netpanzer/src/NetPanzer/Classes/Units/Leopard.hpp	2008-05-04 14:05:21 UTC (rev 1027)
@@ -1,35 +0,0 @@
-/*
-Copyright (C) 1998 Pyrosoft Inc. (www.pyrosoftgames.com), Matthew Bogue
- 
-This program is free software; you can redistribute it and/or modify
-it under the terms of the GNU General Public License as published by
-the Free Software Foundation; either version 2 of the License, or
-(at your option) any later version.
- 
-This program is distributed in the hope that it will be useful,
-but WITHOUT ANY WARRANTY; without even the implied warranty of
-MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-GNU General Public License for more details.
- 
-You should have received a copy of the GNU General Public License
-along with this program; if not, write to the Free Software
-Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
-*/
-#ifndef _LEOPARD_HPP
-#define _LEOPARD_HPP
-
-#include &quot;Classes/Units/Vehicle.hpp&quot;
-
-class Leopard : public Vehicle
-{
-protected:
-    void setUnitProperties();
-    virtual unsigned short launchProjectile();
-    virtual void soundSelected();
-
-public:
-    Leopard(PlayerState* palyer, UnitID id, iXY initial_loc,
-            unsigned char color, unsigned char flag );
-};
-
-#endif // ** _LEOPARD_HPP

Deleted: trunk/netpanzer/src/NetPanzer/Classes/Units/Lynx.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Classes/Units/Lynx.cpp	2008-04-27 15:01:39 UTC (rev 1026)
+++ trunk/netpanzer/src/NetPanzer/Classes/Units/Lynx.cpp	2008-05-04 14:05:21 UTC (rev 1027)
@@ -1,98 +0,0 @@
-/*
-Copyright (C) 1998 Pyrosoft Inc. (www.pyrosoftgames.com), Matthew Bogue
- 
-This program is free software; you can redistribute it and/or modify
-it under the terms of the GNU General Public License as published by
-the Free Software Foundation; either version 2 of the License, or
-(at your option) any later version.
- 
-This program is distributed in the hope that it will be useful,
-but WITHOUT ANY WARRANTY; without even the implied warranty of
-MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-GNU General Public License for more details.
- 
-You should have received a copy of the GNU General Public License
-along with this program; if not, write to the Free Software
-Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
-*/
-#include &lt;config.h&gt;
-#include &quot;Lynx.hpp&quot;
-#include &quot;Interfaces/UnitProfileInterface.hpp&quot;
-#include &quot;2D/Color.hpp&quot;
-#include &quot;Interfaces/WorldViewInterface.hpp&quot;
-#include &quot;Classes/Weapons/Weapon.hpp&quot;
-#include &quot;System/Sound.hpp&quot;
-
-#include &quot;UnitGlobals.hpp&quot;
-
-void Lynx::setUnitProperties()
-{
-    UnitProfile *profile;
-
-    profile = UnitProfileInterface::getUnitProfile( _unit_type_lynx );
-
-    unit_state.hit_points = profile-&gt;hit_points;
-    unit_state.max_hit_points = profile-&gt;hit_points;
-    unit_state.damage_factor = profile-&gt;attack_factor;
-    unit_state.defend_range = profile-&gt;defend_range;
-    unit_state.speed_factor = profile-&gt;speed_factor;
-    unit_state.speed_rate = profile-&gt;speed_rate;
-    unit_state.reload_time = profile-&gt;reload_time;
-    unit_state.weapon_range = profile-&gt;attack_range;
-    unit_state.unit_type = _unit_type_lynx;
-    select_info_box.setHitBarAttributes( profile-&gt;hit_points, Color::yellow );
-
-}
-
-Lynx::Lynx(PlayerState* player, UnitID id, iXY initial_loc,
-        unsigned char color, unsigned char flag )
-        : Vehicle(player, id, initial_loc)
-{
-    setUnitProperties();
-
-    if ( color == false) {
-        body_anim.setData( gLynxBody );
-        turret_anim.setData( gLynxTurret );
-    } else {
-        body_anim.setData( gLynxBodyDarkBlue );
-        turret_anim.setData( gLynxTurretDarkBlue );
-    }
-
-
-    body_anim.setAttrib( iXY(0,0), iXY(0,0), unitLayer );
-    turret_anim.setAttrib( iXY(0,0), iXY(0,0), unitLayer );
-
-    body_anim_shadow.setData( gLynxBodyShadow );
-    turret_anim_shadow.setData( gLynxTurretShadow );
-    body_anim_shadow.setAttrib( iXY(0,0), iXY(0,0), unitLayer );
-    turret_anim_shadow.setAttrib( iXY(0,0), iXY(0,0), unitLayer );
-
-    select_info_box.setBoxAttributes( BoundBox( -30, -30, 30, 30), Color::blue );
-    select_info_box.setBoxState( false );
-    select_info_box.setFlag( flag );
-
-    body_anim_shadow.attachSprite( &amp;body_anim, iXY(0,0) );
-    body_anim_shadow.attachSprite( &amp;turret_anim_shadow, iXY(0,0) );
-    body_anim_shadow.attachSprite( &amp;turret_anim, iXY(0,0) );
-    body_anim_shadow.attachSprite( &amp;select_info_box, iXY(0,0) );
-}
-
-//-----------------------------------------------------------------
-/**
- * Make noise.
- * @return projectile_type
- */
-unsigned short Lynx::launchProjectile()
-{
-    //SFX
-    long distance = WorldViewInterface::getCameraDistance(unit_state.location);
-    sound-&gt;playAmbientSound(&quot;lt-fire&quot;, distance );
-    sound-&gt;playBattle();
-
-    return Weapon::_shell;
-}
-//-----------------------------------------------------------------
-void Lynx::soundSelected()
-{
-    sound-&gt;playSound(&quot;lt-selected&quot;);
-}

Deleted: trunk/netpanzer/src/NetPanzer/Classes/Units/Lynx.hpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Classes/Units/Lynx.hpp	2008-04-27 15:01:39 UTC (rev 1026)
+++ trunk/netpanzer/src/NetPanzer/Classes/Units/Lynx.hpp	2008-05-04 14:05:21 UTC (rev 1027)
@@ -1,35 +0,0 @@
-/*
-Copyright (C) 1998 Pyrosoft Inc. (www.pyrosoftgames.com), Matthew Bogue
- 
-This program is free software; you can redistribute it and/or modify
-it under the terms of the GNU General Public License as published by
-the Free Software Foundation; either version 2 of the License, or
-(at your option) any later version.
- 
-This program is distributed in the hope that it will be useful,
-but WITHOUT ANY WARRANTY; without even the implied warranty of
-MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-GNU General Public License for more details.
- 
-You should have received a copy of the GNU General Public License
-along with this program; if not, write to the Free Software
-Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
-*/
-#ifndef _LYNX_HPP
-#define _LYNX_HPP
-
-#include &quot;Classes/Units/Vehicle.hpp&quot;
-
-class Lynx : public Vehicle
-{
-protected:
-    void setUnitProperties( void );
-    virtual unsigned short launchProjectile();
-    virtual void soundSelected();
-
-public:
-    Lynx(PlayerState* player, UnitID id, iXY initial_loc,
-         unsigned char color, unsigned char flag);
-};
-
-#endif

Deleted: trunk/netpanzer/src/NetPanzer/Classes/Units/M109.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Classes/Units/M109.cpp	2008-04-27 15:01:39 UTC (rev 1026)
+++ trunk/netpanzer/src/NetPanzer/Classes/Units/M109.cpp	2008-05-04 14:05:21 UTC (rev 1027)
@@ -1,97 +0,0 @@
-/*
-Copyright (C) 1998 Pyrosoft Inc. (www.pyrosoftgames.com), Matthew Bogue
- 
-This program is free software; you can redistribute it and/or modify
-it under the terms of the GNU General Public License as published by
-the Free Software Foundation; either version 2 of the License, or
-(at your option) any later version.
- 
-This program is distributed in the hope that it will be useful,
-but WITHOUT ANY WARRANTY; without even the implied warranty of
-MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-GNU General Public License for more details.
- 
-You should have received a copy of the GNU General Public License
-along with this program; if not, write to the Free Software
-Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
-*/
-#include &lt;config.h&gt;
-#include &quot;M109.hpp&quot;
-#include &quot;Interfaces/UnitProfileInterface.hpp&quot;
-#include &quot;2D/Color.hpp&quot;
-#include &quot;Interfaces/WorldViewInterface.hpp&quot;
-#include &quot;Classes/Weapons/Weapon.hpp&quot;
-#include &quot;System/Sound.hpp&quot;
-
-#include &quot;UnitGlobals.hpp&quot;
-
-void M109::setUnitProperties( void )
-{
-    UnitProfile *profile;
-
-    profile = UnitProfileInterface::getUnitProfile( _unit_type_m109 );
-
-    unit_state.hit_points = profile-&gt;hit_points;
-    unit_state.max_hit_points = profile-&gt;hit_points;
-    unit_state.damage_factor = profile-&gt;attack_factor;
-    unit_state.defend_range = profile-&gt;defend_range;
-    unit_state.speed_factor = profile-&gt;speed_factor;
-    unit_state.speed_rate = profile-&gt;speed_rate;
-    unit_state.reload_time = profile-&gt;reload_time;
-    unit_state.weapon_range = profile-&gt;attack_range;
-    unit_state.unit_type = _unit_type_m109;
-    select_info_box.setHitBarAttributes( profile-&gt;hit_points, Color::yellow );
-
-}
-
-M109::M109(PlayerState* player, UnitID id, iXY initial_loc,
-        unsigned char color, unsigned char flag )
-        : Vehicle(player, id, initial_loc)
-{
-    setUnitProperties();
-
-    if ( color == false) {
-        body_anim.setData( gM109Body );
-        turret_anim.setData( gM109Turret );
-    } else {
-        body_anim.setData( gM109BodyDarkBlue );
-        turret_anim.setData( gM109TurretDarkBlue );
-    }
-
-    body_anim_shadow.setData( gM109BodyShadow );
-    turret_anim_shadow.setData( gM109TurretShadow );
-
-    body_anim.setAttrib( iXY(0,0), iXY(0,0), unitLayer );
-    turret_anim.setAttrib( iXY(0,0), iXY(0,0), unitLayer );
-    body_anim_shadow.setAttrib( iXY(0,0), iXY(0,0), unitLayer);
-    turret_anim_shadow.setAttrib( iXY(0,0), iXY(0,0), unitLayer);
-
-    select_info_box.setBoxAttributes( BoundBox( -30, -30, 30, 30), Color::blue );
-    select_info_box.setBoxState( false );
-    select_info_box.setFlag( flag );
-
-    body_anim_shadow.attachSprite( &amp;body_anim, iXY(0,0) );
-    body_anim_shadow.attachSprite( &amp;turret_anim_shadow, iXY(0,0) );
-    body_anim_shadow.attachSprite( &amp;turret_anim, iXY(0,0) );
-    body_anim_shadow.attachSprite( &amp;select_info_box, iXY(0,0) );
-}
-
-//-----------------------------------------------------------------
-/**
- * Make noise.
- * @return projectile_type
- */
-unsigned short M109::launchProjectile()
-{
-    //SFX
-    long distance = WorldViewInterface::getCameraDistance(unit_state.location);
-    sound-&gt;playAmbientSound(&quot;ht-fire&quot;, distance );
-    sound-&gt;playBattle();
-
-    return Weapon::_shell;
-}
-//-----------------------------------------------------------------
-void M109::soundSelected()
-{
-    sound-&gt;playSound(&quot;ht-selected&quot;);
-}

Deleted: trunk/netpanzer/src/NetPanzer/Classes/Units/M109.hpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Classes/Units/M109.hpp	2008-04-27 15:01:39 UTC (rev 1026)
+++ trunk/netpanzer/src/NetPanzer/Classes/Units/M109.hpp	2008-05-04 14:05:21 UTC (rev 1027)
@@ -1,36 +0,0 @@
-/*
-Copyright (C) 1998 Pyrosoft Inc. (www.pyrosoftgames.com), Matthew Bogue
- 
-This program is free software; you can redistribute it and/or modify
-it under the terms of the GNU General Public License as published by
-the Free Software Foundation; either version 2 of the License, or
-(at your option) any later version.
- 
-This program is distributed in the hope that it will be useful,
-but WITHOUT ANY WARRANTY; without even the implied warranty of
-MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-GNU General Public License for more details.
- 
-You should have received a copy of the GNU General Public License
-along with this program; if not, write to the Free Software
-Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
-*/
-#ifndef _M109_HPP
-#define _M109_HPP
-
-#include &quot;Classes/Units/Vehicle.hpp&quot;
-
-class M109 : public Vehicle
-{
-protected:
-    void setUnitProperties();
-    virtual unsigned short launchProjectile();
-    virtual void soundSelected();
-
-public:
-    M109(PlayerState* player, UnitID id, iXY initial_loc,
-            unsigned char color, unsigned char flag );
-
-};
-
-#endif // ** _M109_HPP

Deleted: trunk/netpanzer/src/NetPanzer/Classes/Units/Scorpion.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Classes/Units/Scorpion.cpp	2008-04-27 15:01:39 UTC (rev 1026)
+++ trunk/netpanzer/src/NetPanzer/Classes/Units/Scorpion.cpp	2008-05-04 14:05:21 UTC (rev 1027)
@@ -1,97 +0,0 @@
-/*
-Copyright (C) 1998 Pyrosoft Inc. (www.pyrosoftgames.com), Matthew Bogue
- 
-This program is free software; you can redistribute it and/or modify
-it under the terms of the GNU General Public License as published by
-the Free Software Foundation; either version 2 of the License, or
-(at your option) any later version.
- 
-This program is distributed in the hope that it will be useful,
-but WITHOUT ANY WARRANTY; without even the implied warranty of
-MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-GNU General Public License for more details.
- 
-You should have received a copy of the GNU General Public License
-along with this program; if not, write to the Free Software
-Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
-*/
-#include &lt;config.h&gt;
-#include &quot;Scorpion.hpp&quot;
-#include &quot;Interfaces/UnitProfileInterface.hpp&quot;
-#include &quot;2D/Color.hpp&quot;
-#include &quot;Interfaces/WorldViewInterface.hpp&quot;
-#include &quot;Classes/Weapons/Weapon.hpp&quot;
-#include &quot;System/Sound.hpp&quot;
-
-#include &quot;UnitGlobals.hpp&quot;
-
-void Scorpion::setUnitProperties( void )
-{
-    UnitProfile *profile;
-
-    profile = UnitProfileInterface::getUnitProfile( _unit_type_scorpion );
-
-    unit_state.hit_points = profile-&gt;hit_points;
-    unit_state.max_hit_points = profile-&gt;hit_points;
-    unit_state.damage_factor = profile-&gt;attack_factor;
-    unit_state.defend_range = profile-&gt;defend_range;
-    unit_state.speed_factor = profile-&gt;speed_factor;
-    unit_state.speed_rate = profile-&gt;speed_rate;
-    unit_state.reload_time = profile-&gt;reload_time;
-    unit_state.weapon_range = profile-&gt;attack_range;
-    unit_state.unit_type = _unit_type_scorpion;
-    select_info_box.setHitBarAttributes( profile-&gt;hit_points, Color::yellow );
-
-}
-
-Scorpion::Scorpion(PlayerState* player, UnitID id, iXY initial_loc,
-        unsigned char color, unsigned char flag )
-        : Vehicle(player, id, initial_loc)
-{
-    setUnitProperties();
-
-    if ( color == false) {
-        body_anim.setData( gScorpionBody );
-        turret_anim.setData( gScorpionTurret );
-    } else {
-        body_anim.setData( gScorpionBodyDarkBlue );
-        turret_anim.setData( gScorpionTurretDarkBlue );
-    }
-
-    body_anim.setAttrib( iXY(0,0), iXY(0,0), unitLayer );
-    turret_anim.setAttrib( iXY(0,0), iXY(0,0), unitLayer );
-
-    body_anim_shadow.setData( gScorpionBodyShadow );
-    turret_anim_shadow.setData( gScorpionTurretShadow );
-    body_anim_shadow.setAttrib( iXY(0,0), iXY(0,0), unitLayer );
-    turret_anim_shadow.setAttrib( iXY(0,0), iXY(0,0), unitLayer );
-
-    select_info_box.setBoxAttributes( BoundBox( -30, -30, 30, 30), Color::blue );
-    select_info_box.setBoxState( false );
-    select_info_box.setFlag( flag );
-
-    body_anim_shadow.attachSprite( &amp;body_anim, iXY(0,0) );
-    body_anim_shadow.attachSprite( &amp;turret_anim_shadow, iXY(0,0) );
-    body_anim_shadow.attachSprite( &amp;turret_anim, iXY(0,0) );
-    body_anim_shadow.attachSprite( &amp;select_info_box, iXY(0,0) );
-}
-
-//-----------------------------------------------------------------
-/**
- * Make noise.
- * @return projectile_type
- */
-unsigned short Scorpion::launchProjectile()
-{
-    //SFX
-    long distance = WorldViewInterface::getCameraDistance(unit_state.location);
-    sound-&gt;playAmbientSound(&quot;lt-fire&quot;, distance );
-    sound-&gt;playBattle();
-
-    return Weapon::_shell;
-}
-//-----------------------------------------------------------------
-void Scorpion::soundSelected()
-{
-    sound-&gt;playSound(&quot;lt-selected&quot;);
-}

Deleted: trunk/netpanzer/src/NetPanzer/Classes/Units/Scorpion.hpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Classes/Units/Scorpion.hpp	2008-04-27 15:01:39 UTC (rev 1026)
+++ trunk/netpanzer/src/NetPanzer/Classes/Units/Scorpion.hpp	2008-05-04 14:05:21 UTC (rev 1027)
@@ -1,36 +0,0 @@
-/*
-Copyright (C) 1998 Pyrosoft Inc. (www.pyrosoftgames.com), Matthew Bogue
- 
-This program is free software; you can redistribute it and/or modify
-it under the terms of the GNU General Public License as published by
-the Free Software Foundation; either version 2 of the License, or
-(at your option) any later version.
- 
-This program is distributed in the hope that it will be useful,
-but WITHOUT ANY WARRANTY; without even the implied warranty of
-MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-GNU General Public License for more details.
- 
-You should have received a copy of the GNU General Public License
-along with this program; if not, write to the Free Software
-Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
-*/
-#ifndef _SCORPION_HPP
-#define _SCORPION_HPP
-
-#include &quot;Classes/Units/Vehicle.hpp&quot;
-
-class Scorpion : public Vehicle
-{
-protected:
-    void setUnitProperties();
-    virtual unsigned short launchProjectile();
-    virtual void soundSelected();
-
-public:
-    Scorpion(PlayerState* player, UnitID id, iXY initial_loc,
-            unsigned char color, unsigned char flag );
-
-};
-
-#endif // ** _SCORPION_HPP

Deleted: trunk/netpanzer/src/NetPanzer/Classes/Units/SpahPanzer.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Classes/Units/SpahPanzer.cpp	2008-04-27 15:01:39 UTC (rev 1026)
+++ trunk/netpanzer/src/NetPanzer/Classes/Units/SpahPanzer.cpp	2008-05-04 14:05:21 UTC (rev 1027)
@@ -1,99 +0,0 @@
-/*
-Copyright (C) 1998 Pyrosoft Inc. (www.pyrosoftgames.com), Matthew Bogue
- 
-This program is free software; you can redistribute it and/or modify
-it under the terms of the GNU General Public License as published by
-the Free Software Foundation; either version 2 of the License, or
-(at your option) any later version.
- 
-This program is distributed in the hope that it will be useful,
-but WITHOUT ANY WARRANTY; without even the implied warranty of
-MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-GNU General Public License for more details.
- 
-You should have received a copy of the GNU General Public License
-along with this program; if not, write to the Free Software
-Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
-*/
-#include &lt;config.h&gt;
-
-#include &quot;SpahPanzer.hpp&quot;
-#include &quot;Interfaces/UnitProfileInterface.hpp&quot;
-#include &quot;2D/Color.hpp&quot;
-#include &quot;Interfaces/WorldViewInterface.hpp&quot;
-#include &quot;Classes/Weapons/Weapon.hpp&quot;
-#include &quot;System/Sound.hpp&quot;
-
-#include &quot;UnitGlobals.hpp&quot;
-
-void SpahPanzer::setUnitProperties( void )
-{
-    UnitProfile *profile;
-
-    profile = UnitProfileInterface::getUnitProfile( _unit_type_spahpanzer );
-
-    unit_state.hit_points = profile-&gt;hit_points;
-    unit_state.max_hit_points = profile-&gt;hit_points;
-    unit_state.damage_factor = profile-&gt;attack_factor;
-    unit_state.defend_range = profile-&gt;defend_range;
-    unit_state.speed_factor = profile-&gt;speed_factor;
-    unit_state.speed_rate = profile-&gt;speed_rate;
-    unit_state.reload_time = profile-&gt;reload_time;
-    unit_state.weapon_range = profile-&gt;attack_range;
-    unit_state.unit_type = _unit_type_spahpanzer;
-    select_info_box.setHitBarAttributes( profile-&gt;hit_points, Color::yellow );
-
-}
-
-SpahPanzer::SpahPanzer(PlayerState* player, UnitID id, iXY initial_loc,
-        unsigned char color, unsigned char flag )
-        : Vehicle(player, id, initial_loc)
-{
-    setUnitProperties();
-
-    if ( color == false) {
-        body_anim.setData( gBearBody );
-        turret_anim.setData( gBearTurret );
-    } else {
-        body_anim.setData( gBearBodyDarkBlue );
-        turret_anim.setData( gBearTurretDarkBlue );
-    }
-
-
-    body_anim.setAttrib( iXY(0,0), iXY(0,0), unitLayer );
-    turret_anim.setAttrib( iXY(0,0), iXY(0,0), unitLayer );
-
-    body_anim_shadow.setData( gBearBodyShadow );
-    turret_anim_shadow.setData( gBearTurretShadow );
-    body_anim_shadow.setAttrib( iXY(0,0), iXY(0,0), unitLayer );
-    turret_anim_shadow.setAttrib( iXY(0,0), iXY(0,0), unitLayer );
-
-    select_info_box.setBoxAttributes( BoundBox( -30, -30, 30, 30), Color::blue );
-    select_info_box.setBoxState( false );
-    select_info_box.setFlag( flag );
-
-    body_anim_shadow.attachSprite( &amp;body_anim, iXY(0,0) );
-    body_anim_shadow.attachSprite( &amp;turret_anim_shadow, iXY(0,0) );
-    body_anim_shadow.attachSprite( &amp;turret_anim, iXY(0,0) );
-    body_anim_shadow.attachSprite( &amp;select_info_box, iXY(0,0) );
-}
-
-//-----------------------------------------------------------------
-/**
- * Make noise.
- * @return projectile_type
- */
-unsigned short SpahPanzer::launchProjectile()
-{
-    //SFX
-    long distance = WorldViewInterface::getCameraDistance(unit_state.location);
-    sound-&gt;playAmbientSound(&quot;mt-fire&quot;, distance );
-    sound-&gt;playBattle();
-
-    return Weapon::_shell;
-}
-//-----------------------------------------------------------------
-void SpahPanzer::soundSelected()
-{
-    sound-&gt;playSound(&quot;mt-selected&quot;);
-}

Deleted: trunk/netpanzer/src/NetPanzer/Classes/Units/SpahPanzer.hpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Classes/Units/SpahPanzer.hpp	2008-04-27 15:01:39 UTC (rev 1026)
+++ trunk/netpanzer/src/NetPanzer/Classes/Units/SpahPanzer.hpp	2008-05-04 14:05:21 UTC (rev 1027)
@@ -1,36 +0,0 @@
-/*
-Copyright (C) 1998 Pyrosoft Inc. (www.pyrosoftgames.com), Matthew Bogue
- 
-This program is free software; you can redistribute it and/or modify
-it under the terms of the GNU General Public License as published by
-the Free Software Foundation; either version 2 of the License, or
-(at your option) any later version.
- 
-This program is distributed in the hope that it will be useful,
-but WITHOUT ANY WARRANTY; without even the implied warranty of
-MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-GNU General Public License for more details.
- 
-You should have received a copy of the GNU General Public License
-along with this program; if not, write to the Free Software
-Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
-*/
-#ifndef _SPAHPANZER_HPP
-#define _SPAHPANZER_HPP
-
-#include &quot;Classes/Units/Vehicle.hpp&quot;
-
-class SpahPanzer : public Vehicle
-{
-protected:
-    void setUnitProperties();
-    virtual unsigned short launchProjectile();
-    virtual void soundSelected();
-
-public:
-    SpahPanzer(PlayerState* player, UnitID id, iXY initial_loc,
-            unsigned char color, unsigned char flag );
-
-};
-
-#endif // ** _SPAHPANZER_HPP

Modified: trunk/netpanzer/src/NetPanzer/Classes/Units/UnitGlobals.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Classes/Units/UnitGlobals.cpp	2008-04-27 15:01:39 UTC (rev 1026)
+++ trunk/netpanzer/src/NetPanzer/Classes/Units/UnitGlobals.cpp	2008-05-04 14:05:21 UTC (rev 1027)
@@ -20,109 +20,6 @@
 #include &quot;2D/Palette.hpp&quot;
 #include &quot;2D/Surface.hpp&quot;
 
-// Comment this out if you want green units
-#define _GRAY_MAPPED_UNITS
-
-PackedSurface gAbramsTurret;
-PackedSurface gAbramsBody;
-
-PackedSurface gLeopardTurret;
-PackedSurface gLeopardBody;
-
-PackedSurface gValentineTurret;
-PackedSurface gValentineBody;
-
-PackedSurface gHammerheadTurret;
-PackedSurface gHammerheadBody;
-
-PackedSurface gHumveeBody;
-
-PackedSurface gLynxTurret;
-PackedSurface gLynxBody;
-
-PackedSurface gM109Turret;
-PackedSurface gM109Body;
-
-PackedSurface gBearTurret;
-PackedSurface gBearBody;
-
-PackedSurface gSpahPanzerTurret;
-PackedSurface gSpahPanzerBody;
-
-PackedSurface gScorpionTurret;
-PackedSurface gScorpionBody;
-
-PackedSurface gArcherTurret;
-PackedSurface gArcherBody;
-
-//********** DARK BLUE UNITS ************
-
-PackedSurface gAbramsTurretDarkBlue;
-PackedSurface gAbramsBodyDarkBlue;
-
-PackedSurface gLeopardTurretDarkBlue;
-PackedSurface gLeopardBodyDarkBlue;
-
-PackedSurface gValentineTurretDarkBlue;
-PackedSurface gValentineBodyDarkBlue;
-
-PackedSurface gHammerheadTurretDarkBlue;
-PackedSurface gHammerheadBodyDarkBlue;
-
-PackedSurface gHumveeBodyDarkBlue;
-
-PackedSurface gLynxTurretDarkBlue;
-PackedSurface gLynxBodyDarkBlue;
-
-PackedSurface gM109TurretDarkBlue;
-PackedSurface gM109BodyDarkBlue;
-
-PackedSurface gBearTurretDarkBlue;
-PackedSurface gBearBodyDarkBlue;
-
-PackedSurface gSpahPanzerTurretDarkBlue;
-PackedSurface gSpahPanzerBodyDarkBlue;
-
-PackedSurface gScorpionTurretDarkBlue;
-PackedSurface gScorpionBodyDarkBlue;
-
-PackedSurface gArcherTurretDarkBlue;
-PackedSurface gArcherBodyDarkBlue;
-
-//********** SHADOWS ************
-
-PackedSurface gAbramsTurretShadow;
-PackedSurface gAbramsBodyShadow;
-
-PackedSurface gLeopardTurretShadow;
-PackedSurface gLeopardBodyShadow;
-
-PackedSurface gValentineTurretShadow;
-PackedSurface gValentineBodyShadow;
-
-PackedSurface gHammerheadTurretShadow;
-PackedSurface gHammerheadBodyShadow;
-
-PackedSurface gHumveeBodyShadow;
-
-PackedSurface gLynxTurretShadow;
-PackedSurface gLynxBodyShadow;
-
-PackedSurface gM109TurretShadow;
-PackedSurface gM109BodyShadow;
-
-PackedSurface gBearTurretShadow;
-PackedSurface gBearBodyShadow;
-
-PackedSurface gSpahPanzerTurretShadow;
-PackedSurface gSpahPanzerBodyShadow;
-
-PackedSurface gScorpionTurretShadow;
-PackedSurface gScorpionBodyShadow;
-
-PackedSurface gArcherTurretShadow;
-PackedSurface gArcherBodyShadow;
-
 int unitLayer = 3;
 
 void colorMapGray(PackedSurface &amp;source, PackedSurface &amp;dest, ColorTable &amp;colorTable)
@@ -144,160 +41,3 @@
 
     dest.pack(tempSurface);
 }
-
-void LoadUnitSurfaces( void )
-{
-    gAbramsTurret.load( &quot;units/pics/pak/TitaTNSD.pak&quot; );
-    gAbramsBody.load( &quot;units/pics/pak/TitaHNSD.pak&quot; );
-
-    gLeopardTurret.load( &quot;units/pics/pak/PantTNSD.pak&quot; );
-    gLeopardBody.load( &quot;units/pics/pak/PantHNSD.pak&quot; );
-
-    gValentineTurret.load( &quot;units/pics/pak/MantTNSD.pak&quot; );
-    gValentineBody.load( &quot;units/pics/pak/MantHNSD.pak&quot; );
-
-    gHammerheadTurret.load( &quot;units/pics/pak/StinTNSD.pak&quot; );
-    gHammerheadBody.load( &quot;units/pics/pak/StinHNSD.pak&quot; );
-
-    //gHumveeBody.load( &quot;units/pics/pak/ScouHNSD.pak&quot; );
-
-    gScorpionTurret.load( &quot;units/pics/pak/WolfTNSD.pak&quot; );
-    gScorpionBody.load( &quot;units/pics/pak/WolfHNSD.pak&quot; );
-
-    gLynxTurret.load( &quot;units/pics/pak/BobcTNSD.pak&quot; );
-    gLynxBody.load( &quot;units/pics/pak/BobcHNSD.pak&quot; );
-
-    gM109Turret.load( &quot;units/pics/pak/DrakTNSD.pak&quot; );
-    gM109Body.load( &quot;units/pics/pak/DrakHNSD.pak&quot; );
-
-    gBearTurret.load( &quot;units/pics/pak/BearTNSD.pak&quot; );
-    gBearBody.load( &quot;units/pics/pak/BearHNSD.pak&quot; );
-
-    gSpahPanzerTurret.load( &quot;units/pics/pak/SpahTNSD.pak&quot; );
-    gSpahPanzerBody.load( &quot;units/pics/pak/SpahHNSD.pak&quot; );
-
-    gArcherTurret.load( &quot;units/pics/pak/ArchTNSD.pak&quot; );
-    gArcherBody.load( &quot;units/pics/pak/ArchHNSD.pak&quot; );
-
-#ifdef _GRAY_MAPPED_UNITS
-    Palette::init(&quot;netp&quot;);
-    ColorTable gray256;
-
-    float grayPercent = 1.25f;
-
-    // 256 shades of gray.
-    gray256.init(256);
-    for (int num = 0; num &lt; 256; num++) {
-        int c = int(Palette::color[num].r+Palette::color[num].g+Palette::color[num].b)/3; //brightness
-        int nearestColor = Palette::findNearestColor(
-                    int(c * grayPercent),
-                    int(c * grayPercent),
-                    int(c * grayPercent));
-        gray256.setColor(num, nearestColor);
-    }
-
-    gray256.setColor(255, 0);
-
-    //********** DARK BLUE UNITS ************
-    colorMapGray(gAbramsTurret, gAbramsTurretDarkBlue, gray256);
-    colorMapGray(gAbramsBody, gAbramsBodyDarkBlue, gray256);
-
-    colorMapGray(gLeopardTurret, gLeopardTurretDarkBlue, gray256);
-    colorMapGray(gLeopardBody, gLeopardBodyDarkBlue, gray256);
-
-    colorMapGray(gValentineTurret, gValentineTurretDarkBlue, gray256);
-    colorMapGray(gValentineBody, gValentineBodyDarkBlue, gray256);
-
-    colorMapGray(gHammerheadTurret, gHammerheadTurretDarkBlue, gray256);
-    colorMapGray(gHammerheadBody, gHammerheadBodyDarkBlue, gray256);
-
-    //colorMapGray(gHumveeBody, gHumveeBodyDarkBlue, gray256);
-
-    colorMapGray(gScorpionTurret, gScorpionTurretDarkBlue, gray256);
-    colorMapGray(gScorpionBody, gScorpionBodyDarkBlue, gray256);
-
-    colorMapGray(gLynxTurret, gLynxTurretDarkBlue, gray256);
-    colorMapGray(gLynxBody, gLynxBodyDarkBlue, gray256);
-
-    colorMapGray(gM109Turret, gM109TurretDarkBlue, gray256);
-    colorMapGray(gM109Body, gM109BodyDarkBlue, gray256);
-
-    colorMapGray(gBearTurret, gBearTurretDarkBlue, gray256);
-    colorMapGray(gBearBody, gBearBodyDarkBlue, gray256);
-
-    colorMapGray(gSpahPanzerTurret, gSpahPanzerTurretDarkBlue, gray256);
-    colorMapGray(gSpahPanzerBody, gSpahPanzerBodyDarkBlue, gray256);
-
-    colorMapGray(gArcherTurret, gArcherTurretDarkBlue, gray256);
-    colorMapGray(gArcherBody, gArcherBodyDarkBlue, gray256);
-
-#else
-    //********** DARK BLUE UNITS ************
-
-    gAbramsTurretDarkBlue.load( &quot;units/pics/pak/TitaTNSD.pak&quot; );
-    gAbramsBodyDarkBlue.load( &quot;units/pics/pak/TitaHNSD.pak&quot; );
-
-    gLeopardTurretDarkBlue.load( &quot;units/pics/pak/PantTNSD.pak&quot; );
-    gLeopardBodyDarkBlue.load( &quot;units/pics/pak/PantHNSD.pak&quot; );
-
-    gValentineTurretDarkBlue.load( &quot;units/pics/pak/MantTNSD.pak&quot; );
-    gValentineBodyDarkBlue.load( &quot;units/pics/pak/MantHNSD.pak&quot; );
-
-    gHammerheadTurretDarkBlue.load( &quot;units/pics/pak/StinTNSD.pak&quot; );
-    gHammerheadBodyDarkBlue.load( &quot;units/pics/pak/StinHNSD.pak&quot; );
-
-    //gHumveeBodyDarkBlue.load( &quot;units/pics/pak/ScouHNSD.pak&quot; );
-
-    gScorpionTurretDarkBlue.load( &quot;units/pics/pak/WolfTNSD.pak&quot; );
-    gScorpionBodyDarkBlue.load( &quot;units/pics/pak/WolfHNSD.pak&quot; );
-
-    gLynxTurretDarkBlue.load( &quot;units/pics/pak/BobcTNSD.pak&quot; );
-    gLynxBodyDarkBlue.load( &quot;units/pics/pak/BobcHNSD.pak&quot; );
-
-    gM109TurretDarkBlue.load( &quot;units/pics/pak/DrakTNSD.pak&quot; );
-    gM109BodyDarkBlue.load( &quot;units/pics/pak/DrakHNSD.pak&quot; );
-
-    gBearTurretDarkBlue.load( &quot;units/pics/pak/BearTNSD.pak&quot; );
-    gBearBodyDarkBlue.load( &quot;units/pics/pak/BearHNSD.pak&quot; );
-
-    gSpahPanzerTurretDarkBlue.load( &quot;units/pics/pak/SpahTNSD.pak&quot; );
-    gSpahPanzerBodyDarkBlue.load( &quot;units/pics/pak/SpahHNSD.pak&quot; );
-
-    gArcherTurretDarkBlue.load( &quot;units/pics/pak/ArchTNSD.pak&quot; );
-    gArcherBodyDarkBlue.load( &quot;units/pics/pak/ArchHNSD.pak&quot; );
-
-#endif
-    //********** SHADOWS ************
-
-    gAbramsTurretShadow.load( &quot;units/pics/pak/TitaTSSD.pak&quot; );
-    gAbramsBodyShadow.load( &quot;units/pics/pak/TitaHSSD.pak&quot; );
-
-    gLeopardTurretShadow.load( &quot;units/pics/pak/PantTSSD.pak&quot; );
-    gLeopardBodyShadow.load( &quot;units/pics/pak/PantHSSD.pak&quot; );
-
-    gValentineTurretShadow.load( &quot;units/pics/pak/MantTSSD.pak&quot; );
-    gValentineBodyShadow.load( &quot;units/pics/pak/MantHSSD.pak&quot; );
-
-    gHammerheadTurretShadow.load( &quot;units/pics/pak/StinTSSD.pak&quot; );
-    gHammerheadBodyShadow.load( &quot;units/pics/pak/StinHSSD.pak&quot; );
-
-    //gHumveeBodyShadow.load( &quot;units/pics/pak/ScouHSSD.pak&quot; );
-
-    gLynxTurretShadow.load( &quot;units/pics/pak/BobcTSSD.pak&quot; );
-    gLynxBodyShadow.load( &quot;units/pics/pak/BobcHSSD.pak&quot; );
-
-    gM109TurretShadow.load( &quot;units/pics/pak/DrakTSSD.pak&quot; );
-    gM109BodyShadow.load( &quot;units/pics/pak/DrakHSSD.pak&quot; );
-
-    gSpahPanzerTurretShadow.load( &quot;units/pics/pak/SpahTSSD.pak&quot; );
-    gSpahPanzerBodyShadow.load( &quot;units/pics/pak/SpahHSSD.pak&quot; );
-
-    gBearTurretShadow.load( &quot;units/pics/pak/BearTSSD.pak&quot; );
-    gBearBodyShadow.load( &quot;units/pics/pak/BearHSSD.pak&quot; );
-
-    gScorpionTurretShadow.load( &quot;units/pics/pak/WolfTSSD.pak&quot; );
-    gScorpionBodyShadow.load( &quot;units/pics/pak/WolfHSSD.pak&quot; );
-
-    gArcherTurretShadow.load( &quot;units/pics/pak/ArchTSSD.pak&quot; );
-    gArcherBodyShadow.load( &quot;units/pics/pak/ArchHSSD.pak&quot; );
-}

Modified: trunk/netpanzer/src/NetPanzer/Classes/Units/UnitGlobals.hpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Classes/Units/UnitGlobals.hpp	2008-04-27 15:01:39 UTC (rev 1026)
+++ trunk/netpanzer/src/NetPanzer/Classes/Units/UnitGlobals.hpp	2008-05-04 14:05:21 UTC (rev 1027)
@@ -20,106 +20,6 @@
 
 #include &quot;2D/PackedSurface.hpp&quot;
 
-extern PackedSurface gAbramsTurret;
-extern PackedSurface gAbramsBody;
-
-extern PackedSurface gLeopardTurret;
-extern PackedSurface gLeopardBody;
-
-extern PackedSurface gValentineTurret;
-extern PackedSurface gValentineBody;
-
-extern PackedSurface gHammerheadTurret;
-extern PackedSurface gHammerheadBody;
-
-extern PackedSurface gHumveeBody;
-
-extern PackedSurface gLynxTurret;
-extern PackedSurface gLynxBody;
-
-extern PackedSurface gM109Turret;
-extern PackedSurface gM109Body;
-
-extern PackedSurface gBearTurret;
-extern PackedSurface gBearBody;
-
-extern PackedSurface gSpahPanzerTurret;
-extern PackedSurface gSpahPanzerBody;
-
-extern PackedSurface gScorpionTurret;
-extern PackedSurface gScorpionBody;
-
-extern PackedSurface gArcherTurret;
-extern PackedSurface gArcherBody;
-
-//********** DARK BLUE UNITS ************
-extern PackedSurface gAbramsTurretDarkBlue;
-extern PackedSurface gAbramsBodyDarkBlue;
-
-extern PackedSurface gLeopardTurretDarkBlue;
-extern PackedSurface gLeopardBodyDarkBlue;
-
-extern PackedSurface gValentineTurretDarkBlue;
-extern PackedSurface gValentineBodyDarkBlue;
-
-extern PackedSurface gHammerheadTurretDarkBlue;
-extern PackedSurface gHammerheadBodyDarkBlue;
-
-extern PackedSurface gHumveeBodyDarkBlue;
-
-extern PackedSurface gLynxTurretDarkBlue;
-extern PackedSurface gLynxBodyDarkBlue;
-
-extern PackedSurface gM109TurretDarkBlue;
-extern PackedSurface gM109BodyDarkBlue;
-
-extern PackedSurface gBearTurretDarkBlue;
-extern PackedSurface gBearBodyDarkBlue;
-
-extern PackedSurface gSpahPanzerTurretDarkBlue;
-extern PackedSurface gSpahPanzerBodyDarkBlue;
-
-extern PackedSurface gScorpionTurretDarkBlue;
-extern PackedSurface gScorpionBodyDarkBlue;
-
-extern PackedSurface gArcherTurretDarkBlue;
-extern PackedSurface gArcherBodyDarkBlue;
-
-//********** SHADOWS ************
-extern PackedSurface gAbramsTurretShadow;
-extern PackedSurface gAbramsBodyShadow;
-
-extern PackedSurface gLeopardTurretShadow;
-extern PackedSurface gLeopardBodyShadow;
-
-extern PackedSurface gValentineTurretShadow;
-extern PackedSurface gValentineBodyShadow;
-
-extern PackedSurface gHammerheadTurretShadow;
-extern PackedSurface gHammerheadBodyShadow;
-
-extern PackedSurface gHumveeBodyShadow;
-
-extern PackedSurface gLynxTurretShadow;
-extern PackedSurface gLynxBodyShadow;
-
-extern PackedSurface gM109TurretShadow;
-extern PackedSurface gM109BodyShadow;
-
-extern PackedSurface gBearTurretShadow;
-extern PackedSurface gBearBodyShadow;
-
-extern PackedSurface gSpahPanzerTurretShadow;
-extern PackedSurface gSpahPanzerBodyShadow;
-
-extern PackedSurface gScorpionTurretShadow;
-extern PackedSurface gScorpionBodyShadow;
-
-extern PackedSurface gArcherTurretShadow;
-extern PackedSurface gArcherBodyShadow;
-
-void LoadUnitSurfaces( void );
-
 void RemapGrayUnitsHack( ColorTable &amp;gray256 );
 
 extern int unitLayer;

Deleted: trunk/netpanzer/src/NetPanzer/Classes/Units/Valentine.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Classes/Units/Valentine.cpp	2008-04-27 15:01:39 UTC (rev 1026)
+++ trunk/netpanzer/src/NetPanzer/Classes/Units/Valentine.cpp	2008-05-04 14:05:21 UTC (rev 1027)
@@ -1,99 +0,0 @@
-/*
-Copyright (C) 1998 Pyrosoft Inc. (www.pyrosoftgames.com), Matthew Bogue
- 
-This program is free software; you can redistribute it and/or modify
-it under the terms of the GNU General Public License as published by
-the Free Software Foundation; either version 2 of the License, or
-(at your option) any later version.
- 
-This program is distributed in the hope that it will be useful,
-but WITHOUT ANY WARRANTY; without even the implied warranty of
-MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-GNU General Public License for more details.
- 
-You should have received a copy of the GNU General Public License
-along with this program; if not, write to the Free Software
-Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
-*/
-#include &lt;config.h&gt;
-#include &quot;Valentine.hpp&quot;
-#include &quot;Interfaces/UnitProfileInterface.hpp&quot;
-#include &quot;2D/Color.hpp&quot;
-#include &quot;Interfaces/WorldViewInterface.hpp&quot;
-#include &quot;Classes/Weapons/Weapon.hpp&quot;
-#include &quot;System/Sound.hpp&quot;
-
-#include &quot;UnitGlobals.hpp&quot;
-
-void Valentine::setUnitProperties( void )
-{
-    UnitProfile *profile;
-
-    profile = UnitProfileInterface::getUnitProfile( _unit_type_valentine );
-
-    unit_state.hit_points = profile-&gt;hit_points;
-    unit_state.max_hit_points = profile-&gt;hit_points;
-    unit_state.damage_factor = profile-&gt;attack_factor;
-    unit_state.defend_range = profile-&gt;defend_range;
-    unit_state.speed_factor = profile-&gt;speed_factor;
-    unit_state.speed_rate = profile-&gt;speed_rate;
-    unit_state.reload_time = profile-&gt;reload_time;
-    unit_state.weapon_range = profile-&gt;attack_range;
-    unit_state.unit_type = _unit_type_valentine;
-    select_info_box.setHitBarAttributes( profile-&gt;hit_points, Color::yellow );
-
-}
-
-Valentine::Valentine(PlayerState* player, UnitID id, iXY initial_loc,
-        unsigned char color, unsigned char flag )
-        : Vehicle(player, id, initial_loc)
-{
-    setUnitProperties();
-
-    if ( color == false) {
-        body_anim.setData( gValentineBody );
-        turret_anim.setData( gValentineTurret );
-    } else {
-        body_anim.setData( gValentineBodyDarkBlue );
-        turret_anim.setData( gValentineTurretDarkBlue );
-    }
-
-
-
-    body_anim.setAttrib( iXY(0,0), iXY(0,0), unitLayer );
-    turret_anim.setAttrib( iXY(0,0), iXY(0,0), unitLayer );
-
-    body_anim_shadow.setData( gValentineBodyShadow );
-    turret_anim_shadow.setData( gValentineTurretShadow );
-    body_anim_shadow.setAttrib( iXY(0,0), iXY(0,0), unitLayer );
-    turret_anim_shadow.setAttrib( iXY(0,0), iXY(0,0), unitLayer );
-
-    select_info_box.setBoxAttributes( BoundBox( -20, -20, 20, 20), Color::blue );
-    select_info_box.setBoxState( false );
-    select_info_box.setFlag( flag );
-
-    body_anim_shadow.attachSprite( &amp;body_anim, iXY(0,0) );
-    body_anim_shadow.attachSprite( &amp;turret_anim_shadow, iXY(0,0) );
-    body_anim_shadow.attachSprite( &amp;turret_anim, iXY(0,0) );
-    body_anim_shadow.attachSprite( &amp;select_info_box, iXY(0,0) );
-}
-
-//-----------------------------------------------------------------
-/**
- * Make noise.
- * @return projectile_type
- */
-unsigned short Valentine::launchProjectile()
-{
-    //SFX
-    long distance = WorldViewInterface::getCameraDistance(unit_state.location);
-    sound-&gt;playAmbientSound(&quot;lt-fire&quot;, distance );
-    sound-&gt;playBattle();
-
-    return Weapon::_shell;
-}
-//-----------------------------------------------------------------
-void Valentine::soundSelected()
-{
-    sound-&gt;playSound(&quot;lt-selected&quot;);
-}

Deleted: trunk/netpanzer/src/NetPanzer/Classes/Units/Valentine.hpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Classes/Units/Valentine.hpp	2008-04-27 15:01:39 UTC (rev 1026)
+++ trunk/netpanzer/src/NetPanzer/Classes/Units/Valentine.hpp	2008-05-04 14:05:21 UTC (rev 1027)
@@ -1,36 +0,0 @@
-/*
-Copyright (C) 1998 Pyrosoft Inc. (www.pyrosoftgames.com), Matthew Bogue
- 
-This program is free software; you can redistribute it and/or modify
-it under the terms of the GNU General Public License as published by
-the Free Software Foundation; either version 2 of the License, or
-(at your option) any later version.
- 
-This program is distributed in the hope that it will be useful,
-but WITHOUT ANY WARRANTY; without even the implied warranty of
-MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-GNU General Public License for more details.
- 
-You should have received a copy of the GNU General Public License
-along with this program; if not, write to the Free Software
-Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
-*/
-#ifndef _VALENTINE_HPP
-#define _VALENTINE_HPP
-
-#include &quot;Classes/Units/Vehicle.hpp&quot;
-
-class Valentine : public Vehicle
-{
-protected:
-    void setUnitProperties();
-    virtual unsigned short launchProjectile();
-    virtual void soundSelected();
-
-public:
-    Valentine(PlayerState* player, UnitID id, iXY initial_loc,
-            unsigned char color, unsigned char flag );
-
-};
-
-#endif // ** _VALENTINE_HPP

Modified: trunk/netpanzer/src/NetPanzer/Classes/Units/Vehicle.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Classes/Units/Vehicle.cpp	2008-04-27 15:01:39 UTC (rev 1026)
+++ trunk/netpanzer/src/NetPanzer/Classes/Units/Vehicle.cpp	2008-05-04 14:05:21 UTC (rev 1027)
@@ -23,22 +23,26 @@
 #include &quot;Util/Log.hpp&quot;
 #include &quot;Classes/UnitBlackBoard.hpp&quot;
 #include &quot;Classes/Units/Vehicle.hpp&quot;
+#include &quot;Classes/Units/UnitGlobals.hpp&quot;
 #include &quot;Classes/Network/NetworkState.hpp&quot;
 #include &quot;Interfaces/PathScheduler.hpp&quot;
 #include &quot;Interfaces/MapInterface.hpp&quot;
 #include &quot;Interfaces/ProjectileInterface.hpp&quot;
 #include &quot;Interfaces/UnitInterface.hpp&quot;
+#include &quot;Interfaces/UnitProfileInterface.hpp&quot;
 #include &quot;System/Sound.hpp&quot;
 
+
 // NOTE: Temp unit new sprites put in
 #include &quot;Interfaces/GameConfig.hpp&quot;
 
 #include &quot;Interfaces/ConsoleInterface.hpp&quot;
 #include &quot;Particles/ParticleInterface.hpp&quot;
+#include &quot;Interfaces/WorldViewInterface.hpp&quot;
 
 enum{ _rotate_and_move, _rotate_stop_move };
 
-Vehicle::Vehicle(PlayerState* player, UnitID id, iXY initial_loc)
+Vehicle::Vehicle(PlayerState* player, unsigned char utype, UnitID id, iXY initial_loc)
     : UnitBase(player, id)
 {
     smolderWait    = 0.0f;
@@ -86,9 +90,73 @@
     move_opcode_sent = false;
     fsmMoveMapSquare_movement_type = 0;
 
-    aiFsmDefendHold_state = 0;  
+    aiFsmDefendHold_state = 0;
+
+    // from unit profiles
+    setUnitProperties(utype);
+    iXY zero;
+    zero.zero();
+    body_anim.setAttrib( zero, zero, unitLayer );
+    turret_anim.setAttrib( zero, zero, unitLayer );
+    body_anim_shadow.setAttrib( zero, zero, unitLayer);
+    turret_anim_shadow.setAttrib( zero, zero, unitLayer);
+    
+    select_info_box.setBoxState( false );
+    select_info_box.setFlag( player-&gt;getFlag() );
+    
+    body_anim_shadow.attachSprite( &amp;body_anim, zero );
+    body_anim_shadow.attachSprite( &amp;turret_anim_shadow, zero );
+    body_anim_shadow.attachSprite( &amp;turret_anim, zero );
+    body_anim_shadow.attachSprite( &amp;select_info_box, zero );
 }
 
+void Vehicle::setUnitProperties( unsigned char utype )
+{
+    UnitProfile *profile;
+    
+    profile = UnitProfileInterface::getUnitProfile( utype );
+    
+    unit_state.hit_points = profile-&gt;hit_points;
+    unit_state.max_hit_points = profile-&gt;hit_points;
+    unit_state.damage_factor = profile-&gt;attack_factor;
+    unit_state.defend_range = profile-&gt;defend_range;
+    unit_state.speed_factor = profile-&gt;speed_factor;
+    unit_state.speed_rate = profile-&gt;speed_rate;
+    unit_state.reload_time = profile-&gt;reload_time;
+    unit_state.weapon_range = profile-&gt;attack_range;
+    unit_state.unit_type = utype;
+    select_info_box.setHitBarAttributes( profile-&gt;hit_points, Color::yellow );
+    body_anim.setData( profile-&gt;bodySprite );
+    body_anim_shadow.setData( profile-&gt;bodyShadow );
+    turret_anim.setData( profile-&gt;turretSprite );
+    turret_anim_shadow.setData( profile-&gt;turretShadow );
+    soundSelect = profile-&gt;soundSelected;
+    fireSound = profile-&gt;fireSound;
+    if ( profile-&gt;weaponType == &quot;QUADMISSILE&quot; )
+    {
+        weaponType = Weapon::_quad_missile;
+    }
+    else if ( profile-&gt;weaponType == &quot;BULLET&quot; )
+    {
+        weaponType = Weapon::_bullet;
+    }
+    else if ( profile-&gt;weaponType == &quot;SHELL&quot; )
+    {
+        weaponType = Weapon::_shell;
+    }
+    else if ( profile-&gt;weaponType == &quot;DOUBLEMISSILE&quot; )
+    {
+        weaponType = Weapon::_double_missile;
+    }
+    else
+    {
+        weaponType = Weapon::_bullet;
+    }
+    int bsize = profile-&gt;boundBox / 2;
+    select_info_box.setBoxAttributes( BoundBox( -bsize, -bsize, bsize, bsize), Color::blue);
+}
+
+
 void Vehicle::updateUnitStateProperties()
 {
     if ( reload_counter &lt; unit_state.reload_time )
@@ -1386,7 +1454,7 @@
 //-----------------------------------------------------------------
 void Vehicle::soundSelected()
 {
-    sound-&gt;playSound(&quot;yessir&quot;);
+        sound-&gt;playSound( soundSelect.size()?soundSelect.c_str():&quot;yessir&quot;);
 }
 
 void Vehicle::accessThreatLevels()
@@ -1399,6 +1467,17 @@
 
 }
 
+//-----------------------------------------------------------------
+unsigned short Vehicle::launchProjectile()
+{
+    long distance = WorldViewInterface::getCameraDistance(unit_state.location);
+    sound-&gt;playAmbientSound(fireSound.c_str(), distance );
+    sound-&gt;playBattle();
+    
+    return weaponType;
+}
+
+//-----------------------------------------------------------------
 void Vehicle::updateFsmState()
 {
     if ( fsm_timer.count() ) {

Modified: trunk/netpanzer/src/NetPanzer/Classes/Units/Vehicle.hpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Classes/Units/Vehicle.hpp	2008-04-27 15:01:39 UTC (rev 1026)
+++ trunk/netpanzer/src/NetPanzer/Classes/Units/Vehicle.hpp	2008-05-04 14:05:21 UTC (rev 1027)
@@ -17,6 +17,7 @@
 */
 #ifndef _VEHICLE_HPP
 #define _VEHICLE_HPP
+#include &lt;string&gt;
 
 #include &quot;Classes/UnitBase.hpp&quot;
 #include &quot;Util/Timer.hpp&quot;
@@ -79,6 +80,10 @@
     SpritePacked turret_anim_shadow;
 
     UnitSelectionBox select_info_box;
+    
+    std::string soundSelect;
+    std::string fireSound;
+    unsigned short weaponType;
 
     Timer unit_state_timer;
     Timer fsm_timer;
@@ -195,7 +200,7 @@
     void aiFsmManualMove();
 
     void fireWeapon( iXY &amp;target_loc );
-    virtual unsigned short launchProjectile() = 0;
+    virtual unsigned short launchProjectile();
     virtual void soundSelected();
 
     TimerFrameBase threat_level_under_attack_timer;
@@ -232,9 +237,11 @@
     void messageWeaponHit(const UnitMessage* message);
     void messageSelectBoxUpdate(const UnitMessage* message);
     void messageSelfDestruct(const UnitMessage* message);
+    
+    void setUnitProperties( unsigned char utype );
 
 public:
-    Vehicle(PlayerState* player, UnitID id, iXY initial_loc);
+    Vehicle(PlayerState* player, unsigned char utype, UnitID id, iXY initial_loc);
 
     virtual void updateState();
 

Modified: trunk/netpanzer/src/NetPanzer/Classes/Weapons/MissleWeapon.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Classes/Weapons/MissleWeapon.cpp	2008-04-27 15:01:39 UTC (rev 1026)
+++ trunk/netpanzer/src/NetPanzer/Classes/Weapons/MissleWeapon.cpp	2008-05-04 14:05:21 UTC (rev 1027)
@@ -31,8 +31,8 @@
 
 
 float MissleWeapon::thrustForce = gMissleThrustForce;
-
-MissleWeapon::MissleWeapon(UnitID &amp;owner, unsigned short owner_type_id, unsigned short damage, iXY &amp;start, iXY &amp;end)
+// size 0 = small 1 = medium
+MissleWeapon::MissleWeapon(UnitID &amp;owner, unsigned short owner_type_id, unsigned short size, unsigned short damage, iXY &amp;start, iXY &amp;end)
         : Weapon(owner, owner_type_id, damage, start, end)
 {
     velocity     = thrustForce * 2;
@@ -42,7 +42,7 @@
     totalWait    = 0.0f;
 
     // Set the correct missle type.
-    if (owner_type_id == _unit_type_archer) {
+    if ( size ) {
         shell.setData(gMissleMediumPackedSurface);
         shellShadow.setData(gMissleMediumPackedSurface);
 

Modified: trunk/netpanzer/src/NetPanzer/Classes/Weapons/MissleWeapon.hpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Classes/Weapons/MissleWeapon.hpp	2008-04-27 15:01:39 UTC (rev 1026)
+++ trunk/netpanzer/src/NetPanzer/Classes/Weapons/MissleWeapon.hpp	2008-05-04 14:05:21 UTC (rev 1027)
@@ -39,7 +39,7 @@
     virtual void fsmFlight();
 
 public:
-    MissleWeapon(UnitID &amp;owner, unsigned short owner_type_id, unsigned short damage, iXY &amp;start, iXY &amp;end);
+    MissleWeapon(UnitID &amp;owner, unsigned short owner_type_id, unsigned short damage, unsigned short size, iXY &amp;start, iXY &amp;end);
     virtual void updateStatus();
     virtual void offloadGraphics( SpriteSorter &amp;sorter );
 

Modified: trunk/netpanzer/src/NetPanzer/Interfaces/BaseGameManager.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Interfaces/BaseGameManager.cpp	2008-04-27 15:01:39 UTC (rev 1026)
+++ trunk/netpanzer/src/NetPanzer/Interfaces/BaseGameManager.cpp	2008-05-04 14:05:21 UTC (rev 1027)
@@ -135,7 +135,6 @@
 void BaseGameManager::loadGameData()
 {
     UnitProfileInterface::loadUnitProfiles();
-    LoadUnitSurfaces();
     UNIT_FLAGS_SURFACE.loadAllBMPInDirectory(&quot;pics/flags/&quot;);
     if(UNIT_FLAGS_SURFACE.getNumFrames() == 0) {
         throw Exception(&quot;Couldn't find any flag in pics/flags/.&quot;);
@@ -276,163 +275,7 @@
 void BaseGameManager::graphicsLoop()
 {
 }
-//-----------------------------------------------------------------
-void BaseGameManager::LoadUnitSurfaces()
-{
-    gAbramsTurret.load( &quot;units/pics/pak/TitaTNSD.pak&quot; );
-    gAbramsBody.load( &quot;units/pics/pak/TitaHNSD.pak&quot; );
 
-    gLeopardTurret.load( &quot;units/pics/pak/PantTNSD.pak&quot; );
-    gLeopardBody.load( &quot;units/pics/pak/PantHNSD.pak&quot; );
-
-    gValentineTurret.load( &quot;units/pics/pak/MantTNSD.pak&quot; );
-    gValentineBody.load( &quot;units/pics/pak/MantHNSD.pak&quot; );
-
-    gHammerheadTurret.load( &quot;units/pics/pak/StinTNSD.pak&quot; );
-    gHammerheadBody.load( &quot;units/pics/pak/StinHNSD.pak&quot; );
-
-    //gHumveeBody.load( &quot;units/pics/pak/ScouHNSD.pak&quot; );
-
-    gScorpionTurret.load( &quot;units/pics/pak/WolfTNSD.pak&quot; );
-    gScorpionBody.load( &quot;units/pics/pak/WolfHNSD.pak&quot; );
-
-    gLynxTurret.load( &quot;units/pics/pak/BobcTNSD.pak&quot; );
-    gLynxBody.load( &quot;units/pics/pak/BobcHNSD.pak&quot; );
-
-    gM109Turret.load( &quot;units/pics/pak/DrakTNSD.pak&quot; );
-    gM109Body.load( &quot;units/pics/pak/DrakHNSD.pak&quot; );
-
-    gBearTurret.load( &quot;units/pics/pak/BearTNSD.pak&quot; );
-    gBearBody.load( &quot;units/pics/pak/BearHNSD.pak&quot; );
-
-    gSpahPanzerTurret.load( &quot;units/pics/pak/SpahTNSD.pak&quot; );
-    gSpahPanzerBody.load( &quot;units/pics/pak/SpahHNSD.pak&quot; );
-
-    gArcherTurret.load( &quot;units/pics/pak/ArchTNSD.pak&quot; );
-    gArcherBody.load( &quot;units/pics/pak/ArchHNSD.pak&quot; );
-
-#ifdef _GRAY_MAPPED_UNITS
-    Palette::init(&quot;netp&quot;);
-    ColorTable gray256;
-
-    float grayPercent = 1.25f;
-
-    // 256 shades of gray.
-    gray256.init(256);
-    for (int num = 0; num &lt; 256; num++) {
-        int c = int(Palette::color[num].r+Palette::color[num].g+Palette::color[num].b)/3; //brightness
-        int nearestColor = Palette::findNearestColor(
-		SDL_Color(int(c * grayPercent), int(c * grayPercent),
-			 int(c * grayPercent)));
-        gray256.setColor(num, nearestColor);
-    }
-
-    gray256.setColor(255, 0);
-
-    //********** DARK BLUE UNITS ************
-    colorMapGray(gAbramsTurret, gAbramsTurretDarkBlue, gray256);
-    colorMapGray(gAbramsBody, gAbramsBodyDarkBlue, gray256);
-
-    colorMapGray(gLeopardTurret, gLeopardTurretDarkBlue, gray256);
-    colorMapGray(gLeopardBody, gLeopardBodyDarkBlue, gray256);
-
-    colorMapGray(gValentineTurret, gValentineTurretDarkBlue, gray256);
-    colorMapGray(gValentineBody, gValentineBodyDarkBlue, gray256);
-
-    colorMapGray(gHammerheadTurret, gHammerheadTurretDarkBlue, gray256);
-    colorMapGray(gHammerheadBody, gHammerheadBodyDarkBlue, gray256);
-
-    //colorMapGray(gHumveeBody, gHumveeBodyDarkBlue, gray256);
-
-    colorMapGray(gScorpionTurret, gScorpionTurretDarkBlue, gray256);
-    colorMapGray(gScorpionBody, gScorpionBodyDarkBlue, gray256);
-
-    colorMapGray(gLynxTurret, gLynxTurretDarkBlue, gray256);
-    colorMapGray(gLynxBody, gLynxBodyDarkBlue, gray256);
-
-    colorMapGray(gM109Turret, gM109TurretDarkBlue, gray256);
-    colorMapGray(gM109Body, gM109BodyDarkBlue, gray256);
-
-    colorMapGray(gBearTurret, gBearTurretDarkBlue, gray256);
-    colorMapGray(gBearBody, gBearBodyDarkBlue, gray256);
-
-    colorMapGray(gSpahPanzerTurret, gSpahPanzerTurretDarkBlue, gray256);
-    colorMapGray(gSpahPanzerBody, gSpahPanzerBodyDarkBlue, gray256);
-
-    colorMapGray(gArcherTurret, gArcherTurretDarkBlue, gray256);
-    colorMapGray(gArcherBody, gArcherBodyDarkBlue, gray256);
-
-#else
-    //********** DARK BLUE UNITS ************
-
-    gAbramsTurretDarkBlue.load( &quot;units/pics/pak/TitaTNSD.pak&quot; );
-    gAbramsBodyDarkBlue.load( &quot;units/pics/pak/TitaHNSD.pak&quot; );
-
-    gLeopardTurretDarkBlue.load( &quot;units/pics/pak/PantTNSD.pak&quot; );
-    gLeopardBodyDarkBlue.load( &quot;units/pics/pak/PantHNSD.pak&quot; );
-
-    gValentineTurretDarkBlue.load( &quot;units/pics/pak/MantTNSD.pak&quot; );
-    gValentineBodyDarkBlue.load( &quot;units/pics/pak/MantHNSD.pak&quot; );
-
-    gHammerheadTurretDarkBlue.load( &quot;units/pics/pak/StinTNSD.pak&quot; );
-    gHammerheadBodyDarkBlue.load( &quot;units/pics/pak/StinHNSD.pak&quot; );
-
-    //gHumveeBodyDarkBlue.load( &quot;units/pics/pak/ScouHNSD.pak&quot; );
-
-    gScorpionTurretDarkBlue.load( &quot;units/pics/pak/WolfTNSD.pak&quot; );
-    gScorpionBodyDarkBlue.load( &quot;units/pics/pak/WolfHNSD.pak&quot; );
-
-    gLynxTurretDarkBlue.load( &quot;units/pics/pak/BobcTNSD.pak&quot; );
-    gLynxBodyDarkBlue.load( &quot;units/pics/pak/BobcHNSD.pak&quot; );
-
-    gM109TurretDarkBlue.load( &quot;units/pics/pak/DrakTNSD.pak&quot; );
-    gM109BodyDarkBlue.load( &quot;units/pics/pak/DrakHNSD.pak&quot; );
-
-    gBearTurretDarkBlue.load( &quot;units/pics/pak/BearTNSD.pak&quot; );
-    gBearBodyDarkBlue.load( &quot;units/pics/pak/BearHNSD.pak&quot; );
-
-    gSpahPanzerTurretDarkBlue.load( &quot;units/pics/pak/SpahTNSD.pak&quot; );
-    gSpahPanzerBodyDarkBlue.load( &quot;units/pics/pak/SpahHNSD.pak&quot; );
-
-    gArcherTurretDarkBlue.load( &quot;units/pics/pak/ArchTNSD.pak&quot; );
-    gArcherBodyDarkBlue.load( &quot;units/pics/pak/ArchHNSD.pak&quot; );
-
-#endif
-    //********** SHADOWS ************
-
-    gAbramsTurretShadow.load( &quot;units/pics/pak/TitaTSSD.pak&quot; );
-    gAbramsBodyShadow.load( &quot;units/pics/pak/TitaHSSD.pak&quot; );
-
-    gLeopardTurretShadow.load( &quot;units/pics/pak/PantTSSD.pak&quot; );
-    gLeopardBodyShadow.load( &quot;units/pics/pak/PantHSSD.pak&quot; );
-
-    gValentineTurretShadow.load( &quot;units/pics/pak/MantTSSD.pak&quot; );
-    gValentineBodyShadow.load( &quot;units/pics/pak/MantHSSD.pak&quot; );
-
-    gHammerheadTurretShadow.load( &quot;units/pics/pak/StinTSSD.pak&quot; );
-    gHammerheadBodyShadow.load( &quot;units/pics/pak/StinHSSD.pak&quot; );
-
-    //gHumveeBodyShadow.load( &quot;units/pics/pak/ScouHSSD.pak&quot; );
-
-    gLynxTurretShadow.load( &quot;units/pics/pak/BobcTSSD.pak&quot; );
-    gLynxBodyShadow.load( &quot;units/pics/pak/BobcHSSD.pak&quot; );
-
-    gM109TurretShadow.load( &quot;units/pics/pak/DrakTSSD.pak&quot; );
-    gM109BodyShadow.load( &quot;units/pics/pak/DrakHSSD.pak&quot; );
-
-    gSpahPanzerTurretShadow.load( &quot;units/pics/pak/SpahTSSD.pak&quot; );
-    gSpahPanzerBodyShadow.load( &quot;units/pics/pak/SpahHSSD.pak&quot; );
-
-    gBearTurretShadow.load( &quot;units/pics/pak/BearTSSD.pak&quot; );
-    gBearBodyShadow.load( &quot;units/pics/pak/BearHSSD.pak&quot; );
-
-    gScorpionTurretShadow.load( &quot;units/pics/pak/WolfTSSD.pak&quot; );
-    gScorpionBodyShadow.load( &quot;units/pics/pak/WolfHSSD.pak&quot; );
-
-    gArcherTurretShadow.load( &quot;units/pics/pak/ArchTSSD.pak&quot; );
-    gArcherBodyShadow.load( &quot;units/pics/pak/ArchHSSD.pak&quot; );
-}
-
 //---------------------------------------------------------------------
 void
 BaseGameManager::stopMainLoop()

Modified: trunk/netpanzer/src/NetPanzer/Interfaces/BaseGameManager.hpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Interfaces/BaseGameManager.hpp	2008-04-27 15:01:39 UTC (rev 1026)
+++ trunk/netpanzer/src/NetPanzer/Interfaces/BaseGameManager.hpp	2008-05-04 14:05:21 UTC (rev 1027)
@@ -64,7 +64,6 @@
 
 private:
     void loadGameData();
-    void LoadUnitSurfaces();
     void sleeping();                       
     
     static const int TIMEINTERVAL = 20;

Modified: trunk/netpanzer/src/NetPanzer/Interfaces/GameConfig.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Interfaces/GameConfig.cpp	2008-04-27 15:01:39 UTC (rev 1026)
+++ trunk/netpanzer/src/NetPanzer/Interfaces/GameConfig.cpp	2008-05-04 14:05:21 UTC (rev 1027)
@@ -199,17 +199,6 @@
     radarsettings.push_back(&amp;radar_objectivedrawmode);
     radarsettings.push_back(&amp;radar_resizerate);
     
-    spawnsettings.push_back(&amp;titan);
-    spawnsettings.push_back(&amp;manta);
-    spawnsettings.push_back(&amp;panther1);
-    spawnsettings.push_back(&amp;stinger);
-    spawnsettings.push_back(&amp;spanzer);
-    spawnsettings.push_back(&amp;bobcat);
-    spawnsettings.push_back(&amp;wolf);
-    spawnsettings.push_back(&amp;bear);
-    spawnsettings.push_back(&amp;drake);
-    spawnsettings.push_back(&amp;archer);
-    
     try {
         loadConfig();
     } catch(std::exception&amp; e) {
@@ -250,7 +239,7 @@
     loadSettings(inifile.getSection(&quot;interface&quot;), interfacesettings);
     loadSettings(inifile.getSection(&quot;radar&quot;), radarsettings);
     loadSettings(inifile.getSection(&quot;server&quot;), serversettings);
-    loadSettings(inifile.getSection(&quot;spawnconfig&quot;),spawnsettings);
+    loadSpawnSettings(inifile.getSection(&quot;spawnconfig&quot;),spawnsettings);
 }
 
 void GameConfig::loadSettings(const INI::Section&amp; section,
@@ -314,6 +303,19 @@
     }
 }
 
+void GameConfig::loadSpawnSettings(const INI::Section&amp; section,
+                                   std::vector&lt;ConfigVariable*&gt;&amp; settings)
+{
+    INI::valuesIterator i = section.getValuesBegin();
+    while ( i != section.getValuesEnd() )
+    {
+        ConfigInt * intvar = new ConfigInt( i-&gt;first, section.getIntValue(i-&gt;first) );
+        settings.push_back(intvar);
+        i++;
+    }
+}
+
+
 void GameConfig::saveConfig()
 {
     INI::Store inifile;

Modified: trunk/netpanzer/src/NetPanzer/Interfaces/GameConfig.hpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Interfaces/GameConfig.hpp	2008-04-27 15:01:39 UTC (rev 1026)
+++ trunk/netpanzer/src/NetPanzer/Interfaces/GameConfig.hpp	2008-05-04 14:05:21 UTC (rev 1027)
@@ -203,11 +203,19 @@
     ConfigInt   drake;
     ConfigInt   archer;
     
+    std::vector&lt;ConfigVariable*&gt; spawnsettings;
     
-
-    PlayerUnitConfig unit_spawn_config;
-    
 public:
+    void clearSpawnSettings()
+    {
+        std::vector&lt;ConfigVariable*&gt;::iterator i = spawnsettings.begin();
+        while ( i != spawnsettings.end() )
+        {
+            delete *i;
+            i++;
+        }
+        spawnsettings.clear();
+    }
     const char* getGameTypeString() const
     {
         switch(gametype) {
@@ -329,6 +337,8 @@
 
     void loadSettings(const INI::Section&amp;,
             std::vector&lt;ConfigVariable*&gt;&amp; settings);
+    void loadSpawnSettings(const INI::Section&amp; section,
+                           std::vector&lt;ConfigVariable*&gt;&amp; settings);
     void saveSettings(INI::Section&amp;, std::vector&lt;ConfigVariable*&gt;&amp; settings);
 
     std::vector&lt;ConfigVariable*&gt; gamesettings;
@@ -337,8 +347,7 @@
     std::vector&lt;ConfigVariable*&gt; visualssettings;
     std::vector&lt;ConfigVariable*&gt; soundsettings;
     std::vector&lt;ConfigVariable*&gt; interfacesettings;
-    std::vector&lt;ConfigVariable*&gt; radarsettings;   
-    std::vector&lt;ConfigVariable*&gt; spawnsettings;
+    std::vector&lt;ConfigVariable*&gt; radarsettings;
 };
 
 extern GameConfig* gameconfig;

Modified: trunk/netpanzer/src/NetPanzer/Interfaces/GameManager.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Interfaces/GameManager.cpp	2008-04-27 15:01:39 UTC (rev 1026)
+++ trunk/netpanzer/src/NetPanzer/Interfaces/GameManager.cpp	2008-05-04 14:05:21 UTC (rev 1027)
@@ -78,7 +78,6 @@
 #include &quot;Views/MainMenu/Multi/JoinView.hpp&quot;
 #include &quot;Views/MainMenu/Multi/HostView.hpp&quot;
 #include &quot;Views/MainMenu/Multi/GetSessionView.hpp&quot;
-#include &quot;Views/MainMenu/Multi/GetSessionHostView.hpp&quot;
 #include &quot;Views/MainMenu/Multi/UnitSelectionView.hpp&quot;
 #include &quot;Views/MainMenu/Multi/FlagSelectionView.hpp&quot;
 #include &quot;Views/MainMenu/Multi/UnitColorView.hpp&quot;

Modified: trunk/netpanzer/src/NetPanzer/Interfaces/PlayerGameManager.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Interfaces/PlayerGameManager.cpp	2008-04-27 15:01:39 UTC (rev 1026)
+++ trunk/netpanzer/src/NetPanzer/Interfaces/PlayerGameManager.cpp	2008-05-04 14:05:21 UTC (rev 1027)
@@ -73,7 +73,6 @@
 #include &quot;Views/MainMenu/Multi/JoinView.hpp&quot;
 #include &quot;Views/MainMenu/Multi/HostView.hpp&quot;
 #include &quot;Views/MainMenu/Multi/GetSessionView.hpp&quot;
-#include &quot;Views/MainMenu/Multi/GetSessionHostView.hpp&quot;
 #include &quot;Views/MainMenu/Multi/UnitSelectionView.hpp&quot;
 #include &quot;Views/MainMenu/Multi/FlagSelectionView.hpp&quot;
 #include &quot;Views/MainMenu/Multi/UnitColorView.hpp&quot;
@@ -199,7 +198,6 @@
     Desktop::add(new JoinView());
     Desktop::add(new HostView());
     Desktop::add(new GetSessionView());
-    Desktop::add(new GetSessionHostView());
     Desktop::add(new OptionsTemplateView());
     Desktop::add(new OrderingView());
     Desktop::add(new HelpView());
@@ -502,12 +500,15 @@
         }
 
         if (KeyboardInterface::getKeyPressed(SDLK_ESCAPE)) {
-            if (Desktop::getView(&quot;GameView&quot;)-&gt;getVisible()) {
+            if (Desktop::getView(&quot;GameView&quot;)-&gt;getVisible())
+            {
                 if (!Desktop::getView(&quot;OptionsView&quot;)-&gt;getVisible() &amp;&amp;
                         !Desktop::getView(&quot;SoundView&quot;)-&gt;getVisible() &amp;&amp;
                         !Desktop::getView(&quot;ControlsView&quot;)-&gt;getVisible() &amp;&amp;
                         !Desktop::getView(&quot;InterfaceView&quot;)-&gt;getVisible() &amp;&amp;
-                        !Desktop::getView(&quot;VisualsView&quot;)-&gt;getVisible()) {
+                        !Desktop::getView(&quot;VisualsView&quot;)-&gt;getVisible())
+                {
+                    
                     View *v = Desktop::getView(&quot;OptionsView&quot;);
                     assert(v != 0);
                     ((OptionsTemplateView *)v)-&gt;initButtons();
@@ -535,7 +536,9 @@
 
                     Desktop::setVisibility(&quot;OptionsView&quot;, true);
                     Desktop::setActiveView(&quot;OptionsView&quot;);
-                } else {
+                }
+                else
+                {
                     View *v = Desktop::getView(&quot;OptionsView&quot;);
                     assert(v != 0);
                     ((OptionsTemplateView *)v)-&gt;setAlwaysOnBottom(true);

Modified: trunk/netpanzer/src/NetPanzer/Interfaces/ProjectileInterface.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Interfaces/ProjectileInterface.cpp	2008-04-27 15:01:39 UTC (rev 1026)
+++ trunk/netpanzer/src/NetPanzer/Interfaces/ProjectileInterface.cpp	2008-05-04 14:05:21 UTC (rev 1027)
@@ -66,7 +66,7 @@
         endPos    = iXY(end.x + (rand() % endRadius &lt;&lt; 1) - endRadius, end.y + (rand() % endRadius &lt;&lt; 1) - endRadius);
         offsetPos = Math::unitDirectionWest(direction) * startRadius * 2;
         startPos = start + iXY(int(offsetPos.x), int(offsetPos.y));
-        temp = new MissleWeapon( owner, owner_type_id, damage, startPos, endPos);
+        temp = new MissleWeapon( owner, owner_type_id, 0, damage, startPos, endPos);
         projectiles.push_back(temp);
 
         ParticleInterface::addMissleLaunchPuff(startPos, direction, owner_type_id);
@@ -75,7 +75,7 @@
         endPos    = iXY(end.x + (rand() % endRadius &lt;&lt; 1) - endRadius, end.y + (rand() % endRadius &lt;&lt; 1) - endRadius);
         offsetPos = Math::unitDirectionWest(direction) * startRadius;
         startPos = start + iXY(int(offsetPos.x), int(offsetPos.y));
-        temp = new MissleWeapon( owner, owner_type_id, damage, startPos, endPos);
+        temp = new MissleWeapon( owner, owner_type_id, 0, damage, startPos, endPos);
         projectiles.push_back(temp);
         ParticleInterface::addMissleLaunchPuff(startPos, direction, owner_type_id);
 
@@ -83,7 +83,7 @@
         endPos    = iXY(end.x + (rand() % endRadius &lt;&lt; 1) - endRadius, end.y + (rand() % endRadius &lt;&lt; 1) - endRadius);
         offsetPos = Math::unitDirectionEast(direction) * startRadius;
         startPos = start + iXY(int(offsetPos.x), int(offsetPos.y));
-        temp = new MissleWeapon( owner, owner_type_id, damage, startPos, endPos);
+        temp = new MissleWeapon( owner, owner_type_id, 0, damage, startPos, endPos);
         projectiles.push_back(temp);
         ParticleInterface::addMissleLaunchPuff(startPos, direction, owner_type_id);
 
@@ -91,7 +91,7 @@
         endPos    = iXY(end.x + (rand() % endRadius &lt;&lt; 1) - endRadius, end.y + (rand() % endRadius &lt;&lt; 1) - endRadius);
         offsetPos = Math::unitDirectionEast(direction) * startRadius * 2;
         startPos = start + iXY(int(offsetPos.x), int(offsetPos.y));
-        temp = new MissleWeapon( owner, owner_type_id, damage, startPos, endPos);
+        temp = new MissleWeapon( owner, owner_type_id, 0, damage, startPos, endPos);
         projectiles.push_back(temp);
         ParticleInterface::addMissleLaunchPuff(startPos, direction, owner_type_id);
     } else if (projectile_type == Weapon::_bullet) {
@@ -116,7 +116,7 @@
         endPos    = iXY(end.x + (rand() % endRadius &lt;&lt; 1) - endRadius, end.y + (rand() % endRadius &lt;&lt; 1) - endRadius);
         offsetPos = Math::unitDirectionWest(direction) * startRadius;
         startPos = start + iXY(int(offsetPos.x), int(offsetPos.y));
-        temp = new MissleWeapon( owner, owner_type_id, damage, startPos, endPos);
+        temp = new MissleWeapon( owner, owner_type_id, 1, damage, startPos, endPos);
         projectiles.push_back(temp);
         ParticleInterface::addMissleLaunchPuff(startPos, direction, owner_type_id);
 
@@ -124,7 +124,7 @@
         endPos    = iXY(end.x + (rand() % endRadius &lt;&lt; 1) - endRadius, end.y + (rand() % endRadius &lt;&lt; 1) - endRadius);
         offsetPos = Math::unitDirectionEast(direction) * startRadius;
         startPos = start + iXY(int(offsetPos.x), int(offsetPos.y));
-        temp = new MissleWeapon( owner, owner_type_id, damage, startPos, endPos);
+        temp = new MissleWeapon( owner, owner_type_id, 1, damage, startPos, endPos);
         projectiles.push_back(temp);
         ParticleInterface::addMissleLaunchPuff(startPos, direction, owner_type_id);
     }

Modified: trunk/netpanzer/src/NetPanzer/Interfaces/UnitInterface.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Interfaces/UnitInterface.cpp	2008-04-27 15:01:39 UTC (rev 1026)
+++ trunk/netpanzer/src/NetPanzer/Interfaces/UnitInterface.cpp	2008-05-04 14:05:21 UTC (rev 1027)
@@ -26,16 +26,6 @@
 #include &quot;Interfaces/WorldViewInterface.hpp&quot;
 
 #include &quot;Classes/Units/Vehicle.hpp&quot;
-#include &quot;Classes/Units/Abrams.hpp&quot;
-#include &quot;Classes/Units/Valentine.hpp&quot;
-#include &quot;Classes/Units/Leopard.hpp&quot;
-#include &quot;Classes/Units/Hammerhead.hpp&quot;
-#include &quot;Classes/Units/Humvee.hpp&quot;
-#include &quot;Classes/Units/Lynx.hpp&quot;
-#include &quot;Classes/Units/Scorpion.hpp&quot;
-#include &quot;Classes/Units/SpahPanzer.hpp&quot;
-#include &quot;Classes/Units/M109.hpp&quot;
-#include &quot;Classes/Units/Archer.hpp&quot;
 
 #include &quot;Types/iXY.hpp&quot;
 #include &quot;Util/Timer.hpp&quot;
@@ -309,50 +299,14 @@
     PlayerState* player = PlayerInterface::getPlayerState( player_index );
     unit_flag = player-&gt;getFlag();
 
-    switch(unit_type) {
-        case _unit_type_valentine:
-            unit = new Valentine(player, id, location, color_flag, unit_flag);
-            break;
-
-        case _unit_type_leopard:
-            unit = new Leopard(player, id, location, color_flag, unit_flag);
-            break;
-
-        case _unit_type_abrams:
-            unit = new Abrams(player, id, location, color_flag, unit_flag);
-            break;
-
-        case _unit_type_hammerhead:
-            unit = new Hammerhead(player, id, location, color_flag, unit_flag);
-            break;
-
-        case _unit_type_humvee:
-            unit = new Humvee(player, id, location, color_flag, unit_flag);
-            break;
-
-        case _unit_type_lynx:
-            unit = new Lynx(player, id, location, color_flag, unit_flag);
-            break;
-
-        case _unit_type_m109:
-            unit = new M109(player, id, location, color_flag, unit_flag);
-            break;
-
-        case _unit_type_spahpanzer:
-            unit = new SpahPanzer(player, id, location, color_flag, unit_flag);
-            break;
-
-        case _unit_type_scorpion:
-            unit = new Scorpion(player, id, location, color_flag, unit_flag);
-            break;
-
-        case _unit_type_archer:
-            unit = new Archer(player, id, location, color_flag, unit_flag);
-            break;
-
-        default:
-            assert(&quot;unknown unit_type&quot; == 0);
+    if ( unit_type &lt; UnitProfileInterface::getNumUnitTypes() )
+    {
+        unit = new Vehicle(player, unit_type, id, location);        
     }
+    else
+    {   // XXX change for a error window
+        assert(&quot;unknown unit_type&quot; == 0);        
+    }
 
     return unit;
 }
@@ -443,7 +397,7 @@
 
     unit_placement_matrix.reset( location );
 
-    for ( unit_type_index = 0; unit_type_index &lt; _MAX_UNIT_TYPES; unit_type_index++ ) {
+    for ( unit_type_index = 0; unit_type_index &lt; UnitProfileInterface::getNumUnitTypes(); unit_type_index++ ) {
 
         unit_spawn_count = unit_config.getSpawnUnitCount( unit_type_index );
         for ( unit_spawn_index = 0; unit_spawn_index &lt; unit_spawn_count; unit_spawn_index++ ) {

Modified: trunk/netpanzer/src/NetPanzer/Interfaces/UnitProfileInterface.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Interfaces/UnitProfileInterface.cpp	2008-04-27 15:01:39 UTC (rev 1026)
+++ trunk/netpanzer/src/NetPanzer/Interfaces/UnitProfileInterface.cpp	2008-05-04 14:05:21 UTC (rev 1027)
@@ -20,29 +20,43 @@
 #include &quot;Interfaces/UnitProfileInterface.hpp&quot;
 #include &quot;Util/Exception.hpp&quot;
 #include &quot;Util/FileSystem.hpp&quot;
+#include &quot;Util/Log.hpp&quot;
+#include &lt;ctype.h&gt;
 #include &lt;memory&gt;
 #include &lt;string.h&gt;
 
 typedef
 struct
 {
-    char params[16][64];
+    char params[32][128];
     short param_count;
 }
 parameter_list;
 
 #define _MAX_KEY_LENGTH 64
 
-char field_headers[19][64] = { &quot;[TURRET_PLACEMENT]&quot;, &quot;[MOVE_OFFSET]&quot;, &quot;HITPOINTS&quot;,
-                               &quot;ATTACK_FACTOR&quot;, &quot;RELOAD_TIME&quot;, &quot;REACTION_TIME&quot;, &quot;RANGE_MAX&quot;, &quot;REGEN_TIME&quot;,
-                               &quot;DEFEND_RANGE&quot;, &quot;SPEED_RATE&quot;, &quot;SPEED_FACTOR&quot;, &quot;REPATH_TIME&quot;, &quot;FUEL_CAPACITY&quot;,
-                               &quot;TRACKING_RATE&quot;, &quot;JAMM_ABLE&quot;, &quot;JAMMING_TIME&quot;, &quot;JAMMING_RANGE&quot;, &quot;FUELING_RANGE&quot;, &quot;END&quot; };
+char field_headers[28][64] =
+{ 
+    &quot;[TURRET_PLACEMENT]&quot;, &quot;[MOVE_OFFSET]&quot;, &quot;HITPOINTS&quot;,
+    &quot;ATTACK_FACTOR&quot;, &quot;RELOAD_TIME&quot;, &quot;REACTION_TIME&quot;, &quot;RANGE_MAX&quot;, &quot;REGEN_TIME&quot;,
+    &quot;DEFEND_RANGE&quot;, &quot;SPEED_RATE&quot;, &quot;SPEED_FACTOR&quot;, &quot;REPATH_TIME&quot;, &quot;FUEL_CAPACITY&quot;,
+    &quot;TRACKING_RATE&quot;, &quot;JAMM_ABLE&quot;, &quot;JAMMING_TIME&quot;, &quot;JAMMING_RANGE&quot;, &quot;FUELING_RANGE&quot;,
+    &quot;IMAGE&quot;,&quot;BODYSPRITE&quot;, &quot;BODYSHADOW&quot;, &quot;TURRETSPRITE&quot;, &quot;TURRETSHADOW&quot;, &quot;SOUNDSELECTED&quot;,
+    &quot;FIRESOUND&quot;, &quot;WEAPON&quot;, &quot;BOUNDBOX&quot;, 
+    &quot;END&quot;
+};
 
-enum { _turret_place, _move_offset, _hit_points, _attack_x, _reload_time,
-       _react_time, _range_max, _regen_time, _defend_range, _speed_rate, _speed_factor, _repath_time, _fuel_capacity,
-       _tracking_rate, _jamm_able, _jamming_time, _jamming_range, _fueling_range, _end };
+enum
+{ 
+    _turret_place, _move_offset, _hit_points, _attack_x, _reload_time,
+    _react_time, _range_max, _regen_time, _defend_range, _speed_rate, _speed_factor, _repath_time, _fuel_capacity,
+    _tracking_rate, _jamm_able, _jamming_time, _jamming_range, _fueling_range,
+    _image, _bodysprite, _bodyshadow, _turretsprite, _turretshadow, _soundselected,
+    _firesound, _weapontype, _boundbox,
+    _end
+};
 
-short max_field_key = 19;
+short max_field_key = 28;
 
 
 //****************************************************************************************
@@ -84,35 +98,7 @@
 
 }
 //****************************************************************************************
-void get_line(char* string, long count, FILE *infile )
-{
-    int  inchar;
-    char tempchar;
-    short string_count = 0;
 
-    inchar = fgetc( infile );
-    tempchar = (char ) inchar;
-
-    while( !feof(infile) &amp;&amp; (tempchar != ';' ) ) {
-        if ( (tempchar != '\n') &amp;&amp; (tempchar != '\r') ) {
-            string[ string_count ] = tempchar;
-            string_count++;
-            if(string_count &gt;= count) {
-                string[string_count-1] = 0;
-                return;
-            }
-        }
-
-        inchar = fgetc( infile );
-        tempchar = (char ) inchar;
-    }
-
-    string[ string_count ] = 0;
-}
-
-
-//****************************************************************************************
-
 short extract_token( char *token, char **string )
 {
     char token_char = ' ';
@@ -163,14 +149,13 @@
             params-&gt;param_count++;
     }
 
-
 }
 
 
 void read_vehicle_profile(const std::string&amp; unitName, UnitProfile *profile)
 {
     int field;
-    char temp_str[80];
+    char temp_str[256];
     parameter_list param_list;
     int temp_int;
     short not_done = true;
@@ -180,19 +165,22 @@
     file_path += &quot;.pfl&quot;;
 
     profile-&gt;unitname = unitName;
-
+    
     try {
 	std::auto_ptr&lt;filesystem::ReadFile&gt; file(
                 filesystem::openRead(file_path));
 
 	while( not_done ) {
-	    for(int i=0; i&lt;80; i++) {
-		file-&gt;read(&amp;(temp_str[i]), 1, 1);
-		if(temp_str[i] == '\n') {
-		    temp_str[i] = 0;
-		    break;
-		}
+	    for(int i=0; i&lt;256; i++)
+        {
+            file-&gt;read(&amp;(temp_str[i]), 1, 1);
+            if(temp_str[i] == '\n')
+            {
+                temp_str[i] = 0;
+                break;
+            }
 	    }
+        
 	    string_to_params( temp_str, &amp;param_list );
 	    find_keyword( param_list.params[0], &amp;field, (char * ) field_headers, max_field_key );
 
@@ -308,7 +296,44 @@
 			profile-&gt;fueling_range = (long) temp_int;
 		    }
 		    break;
+        
+        case _image:
+            profile-&gt;imagefile = param_list.params[1];
+            break;
+        
+        case _bodysprite:
+            profile-&gt;bodySprite.load(param_list.params[1]);
+            break;
 
+        case _bodyshadow:
+            profile-&gt;bodyShadow.load(param_list.params[1]);
+            break;
+            
+        case _turretsprite:
+            profile-&gt;turretSprite.load(param_list.params[1]);
+            break;
+
+        case _turretshadow:
+            profile-&gt;turretShadow.load(param_list.params[1]);
+            break;
+                
+        case _soundselected:
+            profile-&gt;soundSelected = param_list.params[1];
+            break;
+
+        case _firesound:
+            profile-&gt;fireSound = param_list.params[1];
+            break;
+            
+        case _weapontype:
+            profile-&gt;weaponType = param_list.params[1];
+            break;
+                
+        case _boundbox:
+            sscanf( param_list.params[1], &quot;%d&quot;, &amp;temp_int );
+            profile-&gt;boundBox = (short) temp_int;
+            break;
+                
 		case _end :
 		    {
 			not_done = false;
@@ -322,24 +347,106 @@
     }
 } // function
 
-UnitProfile UnitProfileInterface::profile_table[ _MAX_UNIT_TYPES ];
+vector&lt;UnitProfile *&gt; UnitProfileInterface::profiles;
 
+void
+UnitProfileInterface::clearProfiles()
+{
+    vector&lt;UnitProfile *&gt;::iterator i = profiles.begin();
+    while ( i != profiles.end() )
+    {
+        delete *i;
+        i++;
+    }
+    profiles.clear();
+}
+
 void UnitProfileInterface::loadUnitProfiles( void )
 {
-    read_vehicle_profile(&quot;Titan&quot;, &amp;profile_table[ _unit_type_abrams ]);
-    read_vehicle_profile(&quot;Manta&quot;, &amp;profile_table[ _unit_type_valentine ]);
-    read_vehicle_profile(&quot;Panther1&quot;, &amp;profile_table[ _unit_type_leopard ]);
-    read_vehicle_profile(&quot;Stinger&quot;, &amp;profile_table[ _unit_type_hammerhead ]);
-    read_vehicle_profile(&quot;SPanzer&quot;, &amp;profile_table[ _unit_type_humvee ]);
-    read_vehicle_profile(&quot;Bobcat&quot;, &amp;profile_table[ _unit_type_lynx ]);
-    read_vehicle_profile(&quot;Wolf&quot;, &amp;profile_table[ _unit_type_scorpion]);
-    read_vehicle_profile(&quot;Bear&quot;, &amp;profile_table[ _unit_type_spahpanzer]);
-    read_vehicle_profile(&quot;Drake&quot;, &amp;profile_table[ _unit_type_m109]);
-    read_vehicle_profile(&quot;Archer&quot;, &amp;profile_table[ _unit_type_archer]);
+    clearProfiles();
+    UnitProfile * p;
+    
+    p = new UnitProfile();
+    read_vehicle_profile(&quot;Manta&quot;, p);
+    p-&gt;unit_type = profiles.size();
+    profiles.push_back(p);
+    
+    p = new UnitProfile();
+    read_vehicle_profile(&quot;Panther1&quot;, p);
+    p-&gt;unit_type = profiles.size();
+    profiles.push_back(p);
+
+    p = new UnitProfile();
+    read_vehicle_profile(&quot;Titan&quot;, p);
+    p-&gt;unit_type = profiles.size();
+    profiles.push_back(p);
+
+    p = new UnitProfile();
+    read_vehicle_profile(&quot;Stinger&quot;, p);
+    p-&gt;unit_type = profiles.size();
+    profiles.push_back(p);
+    
+    p = new UnitProfile();
+    read_vehicle_profile(&quot;Bobcat&quot;, p);
+    p-&gt;unit_type = profiles.size();
+    profiles.push_back(p);
+    
+    p = new UnitProfile();
+    read_vehicle_profile(&quot;Bear&quot;, p);
+    p-&gt;unit_type = profiles.size();
+    profiles.push_back(p);
+
+    p = new UnitProfile();
+    read_vehicle_profile(&quot;Archer&quot;, p);
+    p-&gt;unit_type = profiles.size();
+    profiles.push_back(p);
+
+    p = new UnitProfile();
+    read_vehicle_profile(&quot;Wolf&quot;, p);
+    p-&gt;unit_type = profiles.size();
+    profiles.push_back(p);
+    
+    p = new UnitProfile();
+    read_vehicle_profile(&quot;Drake&quot;, p);
+    p-&gt;unit_type = profiles.size();
+    profiles.push_back(p);
+
+    p = new UnitProfile();
+    read_vehicle_profile(&quot;SPanzer&quot;, p); // should be scout or humvee?
+    p-&gt;unit_type = profiles.size();
+    profiles.push_back(p);
 }
 
 UnitProfile * UnitProfileInterface::getUnitProfile( unsigned short unit_type )
 {
-    assert( unit_type &lt; _MAX_UNIT_TYPES );
-    return( &amp;profile_table[ unit_type ] );
+    if ( unit_type &lt; profiles.size() )
+        return profiles[unit_type];
+    return 0;
 }
+
+UnitProfile *
+UnitProfileInterface::getProfileByName( const std::string &amp;name )
+{
+    vector&lt;UnitProfile *&gt;::iterator i = profiles.begin();
+    while ( i != profiles.end() )
+    {
+        if ( name.length() != (*i)-&gt;unitname.length() )
+        {
+            i++;
+            continue; // continue if size !=
+        }
+
+        std::string::size_type s = 0;
+        while ( s &lt; name.length()
+               &amp;&amp; toupper(name[s]) == toupper((*i)-&gt;unitname[s]) )
+        {
+            s++;
+        }
+        
+        if ( s == name.length() )
+            return *i;
+        
+        i++;
+    }
+    return 0; // null pointer warning
+}

Modified: trunk/netpanzer/src/NetPanzer/Interfaces/UnitProfileInterface.hpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Interfaces/UnitProfileInterface.hpp	2008-04-27 15:01:39 UTC (rev 1026)
+++ trunk/netpanzer/src/NetPanzer/Interfaces/UnitProfileInterface.hpp	2008-05-04 14:05:21 UTC (rev 1027)
@@ -19,14 +19,19 @@
 #define _UNITPROFILEINTERFACE_HPP
 
 #include &lt;string&gt;
+#include &lt;vector&gt;
 
+using namespace std;
+
 #include &quot;Structs/UnitTypes.hpp&quot;
 #include &quot;Classes/UnitState.hpp&quot;
+#include &quot;2D/PackedSurface.hpp&quot;
 
 class UnitProfile
 {
 public:
     std::string unitname;
+    unsigned short unit_type;
 
     short hit_points;
     short attack_factor;
@@ -46,16 +51,31 @@
     long  fueling_range;
     // ** for ecm truck only **
     long  jamming_range;
+    std::string imagefile;
+    PackedSurface bodySprite;
+    PackedSurface bodyShadow;
+    PackedSurface turretSprite;
+    PackedSurface turretShadow;
+    std::string soundSelected;
+    std::string fireSound;
+    std::string weaponType;
+    short boundBox;
 };
 
 class UnitProfileInterface
 {
 protected:
-    static UnitProfile profile_table[ _MAX_UNIT_TYPES ];
-
+    static vector&lt;UnitProfile *&gt; profiles;
+    static void clearProfiles();
+    
 public:
     static void loadUnitProfiles( void );
     static UnitProfile * getUnitProfile( unsigned short unit_type );
+    static UnitProfile * getProfileByName( const std::string &amp;name );
+    static unsigned short getNumUnitTypes()
+    {
+        return profiles.size();
+    }
 };
 
 

Modified: trunk/netpanzer/src/NetPanzer/Particles/ChunkTrajectoryParticle2D.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Particles/ChunkTrajectoryParticle2D.cpp	2008-04-27 15:01:39 UTC (rev 1026)
+++ trunk/netpanzer/src/NetPanzer/Particles/ChunkTrajectoryParticle2D.cpp	2008-05-04 14:05:21 UTC (rev 1027)
@@ -25,6 +25,7 @@
 #include &quot;Interfaces/TileInterface.hpp&quot;
 #include &quot;Classes/Units/UnitGlobals.hpp&quot;
 #include &quot;Particles/ParticleInterface.hpp&quot;
+#include &quot;Interfaces/UnitProfileInterface.hpp&quot;
 
 
 PackedSurface ChunkTrajectoryParticle2D::staticPackedGroundChunks;
@@ -203,9 +204,11 @@
 {
     // Blt the green titan body onto a surface to pull colors from.
     Surface tempUnitBodyGray;
-    tempUnitBodyGray.create(gAbramsBodyDarkBlue.getWidth(), gAbramsBodyDarkBlue.getHeight(), 1);
+    UnitProfile * uprofile = UnitProfileInterface::getUnitProfile(0);
+
+    tempUnitBodyGray.create(uprofile-&gt;bodySprite.getWidth(), uprofile-&gt;bodySprite.getHeight(), 1);
     tempUnitBodyGray.fill(0);
-    gAbramsBodyDarkBlue.blt(tempUnitBodyGray, 0, 0);
+    uprofile-&gt;bodySprite.blt(tempUnitBodyGray, 0, 0);
 
     // Build a table of the green unit colors.
     Surface tempSurface(2, 2, 64);
@@ -247,9 +250,11 @@
 
     // Blt the green titan body onto a surface to pull colors from.
     Surface tempUnitBodyGray;
-    tempUnitBodyGray.create(gAbramsBody.getWidth(), gAbramsBody.getHeight(), 1);
+    UnitProfile * uprofile = UnitProfileInterface::getUnitProfile(0);
+    
+    tempUnitBodyGray.create(uprofile-&gt;bodySprite.getWidth(), uprofile-&gt;bodySprite.getHeight(), 1);
     tempUnitBodyGray.fill(0);
-    gAbramsBody.blt(tempUnitBodyGray, 0, 0);
+    uprofile-&gt;bodySprite.blt(tempUnitBodyGray, 0, 0);
 
     // Build a table of the green unit colors.
     Surface tempSurface(2, 2, 64);

Modified: trunk/netpanzer/src/NetPanzer/Particles/ParticleInterface.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Particles/ParticleInterface.cpp	2008-04-27 15:01:39 UTC (rev 1026)
+++ trunk/netpanzer/src/NetPanzer/Particles/ParticleInterface.cpp	2008-05-04 14:05:21 UTC (rev 1027)
@@ -59,8 +59,8 @@
 int ParticleInterface::gMuzzleSystemCullMissCount        = 1;
 int ParticleInterface::gMuzzleSystemCullHitCount         = 1;
 
-int ParticleInterface::unitHitPointTable[_MAX_UNIT_TYPES];
-int ParticleInterface::unitAttackFactorTable[_MAX_UNIT_TYPES];
+vector&lt;int&gt; ParticleInterface::unitHitPointTable;
+vector&lt;int&gt; ParticleInterface::unitAttackFactorTable;
 
 
 //--------------------------------------------------------------------------
@@ -488,7 +488,7 @@
         unitState.location.y = gameViewRect.min.y + 100 + (rand() % (gameViewRect.getSizeY() - 200));
 
         // Hack until all the units are actually used.
-        unitState.unit_type = rand() % _MAX_UNIT_TYPES;
+        unitState.unit_type = rand() % UnitProfileInterface::getNumUnitTypes();
         //unitState.unit_type = rand() % 7;
 
         addHit(unitState);
@@ -508,7 +508,7 @@
         location.x = gameViewRect.min.x + 100 + (rand() % (gameViewRect.getSizeX() - 200));
         location.y = gameViewRect.min.y + 100 + (rand() % (gameViewRect.getSizeY() - 200));
 
-        addMiss(location, rand() % _MAX_UNIT_TYPES);
+        addMiss(location, rand() % UnitProfileInterface::getNumUnitTypes());
     }
 }
 
@@ -755,7 +755,10 @@
 
 void ParticleInterface::buildUnitTables()
 {
-    for (int i = 0; i &lt; _MAX_UNIT_TYPES; i++) {
+    unitHitPointTable.resize(UnitProfileInterface::getNumUnitTypes());
+    unitAttackFactorTable.resize(UnitProfileInterface::getNumUnitTypes());
+    
+    for (int i = 0; i &lt; UnitProfileInterface::getNumUnitTypes(); i++) {
         UnitProfile *p = UnitProfileInterface::getUnitProfile(i);
 
         unitHitPointTable[i]     = int(sqrt(p-&gt;hit_points));
@@ -855,11 +858,12 @@
     m.puffRandScale  = 0.1f;
     m.puffType       = DARK;
 
-    if (unitType == _unit_type_m109) {
-        m.muzzleType = MuzzleSystem::TRIPLE;
-    } else {
+// XXX CHECK
+//    if (unitType == _unit_type_m109) {
+//        m.muzzleType = MuzzleSystem::TRIPLE;
+//    } else {
         m.muzzleType = MuzzleSystem::SINGLE;
-    }
+//    }
 
     assert(frame &lt; 36 &amp;&amp; frame &gt;= 0);
     fXYZ muzzlePos;
@@ -977,81 +981,18 @@
     }
 }
 
-//enum  { _unit_type_valentine,
-//        _unit_type_leopard,
-//        _unit_type_abrams,
-//        _unit_type_hammerhead,
-//        _unit_type_lynx,
-//        _unit_type_m109,
-//        _unit_type_spahpanzer,
-//        _unit_type_scorpion,
-//        _unit_type_humvee,
-//        _unit_type_hover_craft,
-//        _unit_type_comm_killer,
-//        _unit_type_refueler,
-//        _unit_type_null
-//      };
-
 //--------------------------------------------------------------------------
 void ParticleInterface::getUnitParticleInfo()
 {
-    assert(gValentineTurret.getFrameCount() &gt; 0);
-
     // Create the correct number of unit information slots.
-    unitParticleInfo.resize(_MAX_UNIT_TYPES);
-
-    // _unit_type_valentine
-    getMuzzleTips(gValentineTurret, unitParticleInfo[_unit_type_valentine].muzzleTip);
-    getMinBounds(gValentineBody, unitParticleInfo[_unit_type_valentine].minBounds);
-
-    // _unit_type_leopard
-    getMuzzleTips(gLeopardTurret, unitParticleInfo[_unit_type_leopard].muzzleTip);
-    getMinBounds(gLeopardBody, unitParticleInfo[_unit_type_leopard].minBounds);
-
-    // _unit_type_abrams
-    getMuzzleTips(gAbramsTurret, unitParticleInfo[_unit_type_abrams].muzzleTip);
-    getMinBounds(gAbramsBody, unitParticleInfo[_unit_type_abrams].minBounds);
-
-    // _unit_type_hammerhead
-    getMuzzleTips(gHammerheadTurret, unitParticleInfo[_unit_type_hammerhead].muzzleTip);
-    getMinBounds(gHammerheadBody, unitParticleInfo[_unit_type_hammerhead].minBounds);
-
-    // _unit_type_humvee
-    getMuzzleTips(gSpahPanzerBody, unitParticleInfo[_unit_type_humvee].muzzleTip);
-    getMinBounds(gSpahPanzerBody, unitParticleInfo[_unit_type_humvee].minBounds);
-
-    // _unit_type_lynx
-    getMuzzleTips(gLynxTurret, unitParticleInfo[_unit_type_lynx].muzzleTip);
-    getMinBounds(gLynxBody, unitParticleInfo[_unit_type_lynx].minBounds);
-
-    // _unit_type_m109
-    getMuzzleTips(gM109Turret, unitParticleInfo[_unit_type_m109].muzzleTip);
-    getMinBounds(gM109Body, unitParticleInfo[_unit_type_m109].minBounds);
-
-    // _unit_type_spahpanzer
-    getMuzzleTips(gBearTurret, unitParticleInfo[_unit_type_spahpanzer].muzzleTip);
-    getMinBounds(gBearBody, unitParticleInfo[_unit_type_spahpanzer].minBounds);
-
-    // _unit_type_scorpion
-    getMuzzleTips(gScorpionTurret, unitParticleInfo[_unit_type_scorpion].muzzleTip);
-    getMinBounds(gScorpionBody, unitParticleInfo[_unit_type_scorpion].minBounds);
-
-    // _unit_type_hover_craft
-    //getMuzzleTips(gHoverCraftBody, unitParticleInfo[_unit_type_hover_craft].muzzleTip);
-    //getMinBounds(gHoverCraftBody, unitParticleInfo[_unit_type_hover_craft].minBounds);
-
-    // _unit_type_comm_killer
-    //getMuzzleTips(gCommKillerBody, unitParticleInfo[_unit_type_comm_killer].muzzleTip);
-    //getMinBounds(gCommKillerBody, unitParticleInfo[_unit_type_comm_killer].minBounds);
-
-    // _unit_type_refueler
-    //getMuzzleTips(gRefuelerBody, unitParticleInfo[_unit_type_refueler].muzzleTip);
-    //getMinBounds(gRefuelerBody, unitParticleInfo[_unit_type_refueler].minBounds);
-
-    // _unit_type_archer
-    getMuzzleTips(gArcherTurret, unitParticleInfo[_unit_type_archer].muzzleTip);
-    getMinBounds(gArcherBody, unitParticleInfo[_unit_type_archer].minBounds);
-
+    unitParticleInfo.resize(UnitProfileInterface::getNumUnitTypes());
+    
+    for ( int i=0; i&lt; UnitProfileInterface::getNumUnitTypes(); i++ )
+    {
+        UnitProfile * uprofile = UnitProfileInterface::getUnitProfile(i);
+        getMuzzleTips(uprofile-&gt;turretSprite, unitParticleInfo[i].muzzleTip);
+        getMinBounds(uprofile-&gt;bodySprite, unitParticleInfo[i].minBounds);        
+    }
 }
 
 //--------------------------------------------------------------------------

Modified: trunk/netpanzer/src/NetPanzer/Particles/ParticleInterface.hpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Particles/ParticleInterface.hpp	2008-04-27 15:01:39 UTC (rev 1026)
+++ trunk/netpanzer/src/NetPanzer/Particles/ParticleInterface.hpp	2008-05-04 14:05:21 UTC (rev 1027)
@@ -27,6 +27,10 @@
 #include &quot;Structs/UnitTypes.hpp&quot;
 #include &quot;Classes/UnitState.hpp&quot;
 
+#include &lt;vector&gt;
+
+using namespace std;
+
 class Surface;
 class PackedSurface;
 
@@ -51,8 +55,8 @@
     static void getMuzzleTips(PackedSurface &amp;packedSource, iXY muzzleTips [36]);
     static void getMinBounds(PackedSurface &amp;packedSource, iRect &amp;minBounds);
 
-    static int   unitHitPointTable[_MAX_UNIT_TYPES];
-    static int   unitAttackFactorTable[_MAX_UNIT_TYPES];
+    static vector&lt;int&gt;   unitHitPointTable;
+    static vector&lt;int&gt;   unitAttackFactorTable;
 
     static void  buildUnitTables();
     static float getFrameRateAdjustment();

Modified: trunk/netpanzer/src/NetPanzer/Structs/UnitTypes.hpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Structs/UnitTypes.hpp	2008-04-27 15:01:39 UTC (rev 1026)
+++ trunk/netpanzer/src/NetPanzer/Structs/UnitTypes.hpp	2008-05-04 14:05:21 UTC (rev 1027)
@@ -18,7 +18,7 @@
 #ifndef _UNITTYPES_HPP
 #define _UNITTYPES_HPP
 
-#define _MAX_UNIT_TYPES 13
+#define _MAX_UNIT_TYPES 10
 
 enum UnitType {
     _unit_type_valentine = 0,   // now called manta

Deleted: trunk/netpanzer/src/NetPanzer/Views/Components/AbstractButton.hpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Views/Components/AbstractButton.hpp	2008-04-27 15:01:39 UTC (rev 1026)
+++ trunk/netpanzer/src/NetPanzer/Views/Components/AbstractButton.hpp	2008-05-04 14:05:21 UTC (rev 1027)
@@ -1,39 +0,0 @@
-/*
-Copyright (C) 1998 Pyrosoft Inc. (www.pyrosoftgames.com), Matthew Bogue
- 
-This program is free software; you can redistribute it and/or modify
-it under the terms of the GNU General Public License as published by
-the Free Software Foundation; either version 2 of the License, or
-(at your option) any later version.
- 
-This program is distributed in the hope that it will be useful,
-but WITHOUT ANY WARRANTY; without even the implied warranty of
-MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-GNU General Public License for more details.
- 
-You should have received a copy of the GNU General Public License
-along with this program; if not, write to the Free Software
-Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
-*/
-#ifndef __AbstractButton_hpp__
-#define __AbstractButton_hpp__
-
-#include &quot;Views/Components/Button.hpp&quot;
-#include &quot;MouseEvent.hpp&quot;
-
-//--------------------------------------------------------------------------
-class AbstractButton : public Button
-{
-public:
-    AbstractButton() {}
-    AbstractButton(const std::string&amp; s) : Button(s) {}
-    virtual ~AbstractButton() {}
-
-    virtual void actionPerformed(const mMouseEvent &amp;me)
-    {
-        Button::actionPerformed(me);
-    }
-    virtual void draw(Surface&amp; ) {}
-}; // end AbstractButton
-
-#endif // end __AbstractButton_hpp__

Modified: trunk/netpanzer/src/NetPanzer/Views/Components/Button.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Views/Components/Button.cpp	2008-04-27 15:01:39 UTC (rev 1026)
+++ trunk/netpanzer/src/NetPanzer/Views/Components/Button.cpp	2008-05-04 14:05:21 UTC (rev 1027)
@@ -18,35 +18,42 @@
 #include &lt;config.h&gt;
 
 #include &quot;Views/Components/Button.hpp&quot;
-#include &quot;ViewGlobals.hpp&quot;
+#include &quot;Util/Log.hpp&quot;
+
 #include &quot;MouseEvent.hpp&quot;
 
-// draw
-//---------------------------------------------------------------------------
-void Button::draw(Surface &amp;dest)
-{
-    iRect bounds;
-    getBounds(bounds);
 
-    if ( dirty )
-        render();
-
-    surface.blt(dest, bounds.min.x, bounds.min.y);
-    
-} // end Button::draw
-
 // render
 void
 Button::render()
 {
-    surface.fill(componentBodyColor);
-    surface.drawButtonBorder(borderTop, borderBottom);
+    if ( bimage.getNumFrames() == 1 ) {
+        bimage.blt(surface, extraBorder, extraBorder);
+    }
+    else if ( bimage.getNumFrames() == 3 )
+    {
+        bimage.setFrame(bstate);
+        bimage.blt(surface, extraBorder, extraBorder);
+    }
+    else
+    {
+        surface.fill(componentBodyColor);        
+    }
+
+    if ( borders[bstate][0]|extraBorder ) // only 1 | (binary or)
+    {
+        surface.drawButtonBorder(borders[bstate][0], borders[bstate][1]);
+    }
     
-    Surface text;
-    text.renderText( label.c_str(), textColor, 0);
-    // blit centered and transparent
-    text.bltTrans(surface, (surface.getWidth()/2) - (text.getWidth()/2),
-                           (surface.getHeight()/2) - (text.getHeight()/2));
+    if ( label.length() )
+    {
+        Surface text;
+        text.renderText( label.c_str(), textColor, 0);
+        // blit centered and transparent
+        text.bltTrans(surface, (surface.getWidth()/2) - (text.getWidth()/2),
+                      (surface.getHeight()/2) - (text.getHeight()/2));        
+    }
+    
     dirty = false;
 }
 
@@ -56,18 +63,15 @@
 {
     if (me.getID() == mMouseEvent::MOUSE_EVENT_ENTERED
                 || me.getID() == mMouseEvent::MOUSE_EVENT_RELEASED) {
+        bstate = BOVER;
         textColor = Color::red;
-        borderTop = topLeftBorderColor;
-        borderBottom = bottomRightBorderColor;
         dirty = true; // draw text in red
     } else if (me.getID() == mMouseEvent::MOUSE_EVENT_EXITED) {
+        bstate = BNORMAL;
         textColor = Color::white;
-        borderTop = topLeftBorderColor;
-        borderBottom = bottomRightBorderColor;
         dirty = true; // draw defaults;
     } else if (me.getID() == mMouseEvent::MOUSE_EVENT_PRESSED) {
-        borderTop = bottomRightBorderColor;
-        borderBottom = topLeftBorderColor;
+        bstate = BPRESSED;
         textColor = Color::yellow;
         dirty = true;
     }

Modified: trunk/netpanzer/src/NetPanzer/Views/Components/Button.hpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Views/Components/Button.hpp	2008-04-27 15:01:39 UTC (rev 1026)
+++ trunk/netpanzer/src/NetPanzer/Views/Components/Button.hpp	2008-05-04 14:05:21 UTC (rev 1027)
@@ -20,62 +20,124 @@
 #define __Button_hpp__
 
 #include &quot;Component.hpp&quot;
+#include &quot;2D/Color.hpp&quot;
+#include &quot;ViewGlobals.hpp&quot;
 
+typedef enum
+{
+    BNORMAL =   0,
+    BOVER   =   1,
+    BPRESSED=   2
+} ButtonState;
+
 //--------------------------------------------------------------------------
 class Button : public Component
 {
+private:
+    int extraBorder;
 protected:
     std::string label;
-    std::string actionCommand;
-    
-    PIX borderTop;
-    PIX borderBottom;
+        
+    PIX borders[3][2];
     PIX textColor;
     
+    Surface bimage;
+    
     void render();
+    ButtonState bstate;
+    
+    void resetState()
+    {
+        bstate = BNORMAL;
+        textColor = Color::white;
+        dirty = true;
+    }
 
 public:
-    Button() : Component()
+    Button(const std::string &amp;cname) : Component(cname)
     {
-        reset();
+        position.zero();
+        label.clear();
+        bstate = BNORMAL;
+        textColor = Color::white;
+        memset(borders, 0, sizeof(borders));
+        extraBorder = 0;
     }
 
-    Button(const std::string&amp; s) : Component()
-    {
-        reset();
-        
-        label         = s;
-        actionCommand = label;
-    }
     virtual ~Button()
     {}
 
-    void reset()
+    void setLabel(const std::string&amp; l)
     {
-        label         = &quot;&quot;;
-        actionCommand = &quot;&quot;;
+        label = l;
+        dirty = true;
     }
-
-    void setActionCommand(const std::string&amp; l)
+    
+    void setImage(const Surface &amp;s)
     {
-        label = l;
+        if ( s.getNumFrames() ) {
+            bimage.copy(s);
+            setSize(bimage.getWidth(), bimage.getHeight());
+        } else {
+            bimage.free();
+        }
+        dirty = true;
     }
-    void setLabel(const std::string&amp; l)
+    void clearImage()
     {
-        label = l;
+        bimage.free();
+    }
+    
+    void setUnitSelectionBorder()
+    {
+        borders[0][0] = Color::darkGray;
+        borders[0][1] = Color::darkGray;
+        borders[1][0] = Color::red;
+        borders[1][1] = Color::red;
+        borders[2][0] = Color::darkGray;
+        borders[2][1] = Color::darkGray;
         dirty = true;
     }
+    
+    void setNormalBorder()
+    {
+        borders[0][0] = topLeftBorderColor;
+        borders[0][1] = bottomRightBorderColor;
+        borders[1][0] = topLeftBorderColor;
+        borders[1][1] = bottomRightBorderColor;
+        borders[2][0] = bottomRightBorderColor;
+        borders[2][1] = topLeftBorderColor;
+        dirty=true;
+    }
 
-    const std::string&amp; getLabel() const
+    void clearBorder()
     {
-        return label;
+        memset(borders, 0, sizeof(borders));
+        dirty = true;
     }
-    const std::string&amp; getActionCommand() const
+    
+    void setSize(int x, int y)
     {
-        return actionCommand;
+        Component::setSize(x+(extraBorder*2), y+(extraBorder*2));
     }
+    
+    void setExtraBorder()
+    {
+        extraBorder = 1;
+        setSize( size.x, size.y);
+    }
+    
+    void clearExtraBorder()
+    {
+        extraBorder = 0;
+        setSize( size.x, size.y);
+    }
 
-    virtual void draw(Surface &amp;dest);
+    const std::string&amp; getLabel() const
+    {
+        return label;
+    }
+
     virtual void actionPerformed(const mMouseEvent &amp;me);
 }; // end Button
 

Modified: trunk/netpanzer/src/NetPanzer/Views/Components/CheckBox.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Views/Components/CheckBox.cpp	2008-04-27 15:01:39 UTC (rev 1026)
+++ trunk/netpanzer/src/NetPanzer/Views/Components/CheckBox.cpp	2008-05-04 14:05:21 UTC (rev 1027)
@@ -21,20 +21,6 @@
 #include &quot;MouseEvent.hpp&quot;
 #include &quot;Views/Components/StateChangedCallback.hpp&quot;
 
-// draw
-//---------------------------------------------------------------------------
-void CheckBox::draw(Surface &amp;dest)
-{
-    iRect bounds;
-
-    getBounds(bounds);
-    if ( dirty )
-        render();
-
-    surface.blt(dest, bounds.min.x, bounds.min.y);
-
-} // end CheckBox::draw
-
 void
 CheckBox::render()
 {

Modified: trunk/netpanzer/src/NetPanzer/Views/Components/CheckBox.hpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Views/Components/CheckBox.hpp	2008-04-27 15:01:39 UTC (rev 1026)
+++ trunk/netpanzer/src/NetPanzer/Views/Components/CheckBox.hpp	2008-05-04 14:05:21 UTC (rev 1027)
@@ -21,6 +21,7 @@
 
 #include &quot;Component.hpp&quot;
 #include &quot;MouseEvent.hpp&quot;
+#include &quot;Util/Log.hpp&quot;
 
 class StateChangedCallback;
 
@@ -40,21 +41,21 @@
     CheckBox(StateChangedCallback* newcallback = 0)
             : Component(), state(false), callback(newcallback)
     {
-        setSize(14, 14);
+        setSize( 14, 14);
         textColor = Color::white;
     }
 
     CheckBox(const std::string&amp; newlabel, bool newstate = false)
             : Component(), label(newlabel), state(newstate), callback(0)
     {
-        setSize(14+label.length()*8,14);
+        setSize( 14+label.length()*8, 14);
         textColor = Color::white;
         dirty = true;
-        //size = iXY(14, 14);
     }
 
     virtual ~CheckBox()
-    { }
+    {
+    }
 
     const std::string&amp; getLabel() const
     {
@@ -68,7 +69,7 @@
     void setLabel(const std::string&amp; label)
     {
         CheckBox::label = label;
-        setSize(14+label.length()*8,14);
+        setSize( 14+label.length()*8, 14);
         dirty = true;
     }
     void setState(bool state)
@@ -80,7 +81,6 @@
         callback = newcallback;
     }
 
-    virtual void draw(Surface &amp;dest);
     virtual void actionPerformed(const mMouseEvent &amp;me);
 }; // end CheckBox
 

Modified: trunk/netpanzer/src/NetPanzer/Views/Components/Choice.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Views/Components/Choice.cpp	2008-04-27 15:01:39 UTC (rev 1026)
+++ trunk/netpanzer/src/NetPanzer/Views/Components/Choice.cpp	2008-05-04 14:05:21 UTC (rev 1027)
@@ -89,29 +89,29 @@
         size.y = choiceList.size() * ChoiceItemHeight;
 
         // Make sure the choice fits on the screen.
-        if (min.y + size.y &gt;= parentDimensions.y) {
+        if (position.y + size.y &gt;= parentDimensions.y) {
             // Check to see if it will fit above the base position.
-            if ((min.y + ChoiceItemHeight) - size.y &gt; 0) {
+            if ((position.y + ChoiceItemHeight) - size.y &gt; 0) {
                 // Since it fits above, put it there.
                 adjustedY =  size.y - ChoiceItemHeight;
-                min.y     -= adjustedY;
+                position.y     -= adjustedY;
 
             } else {
                 // Since it does not fit above, just put it below and keep it on the screen.
-                adjustedY =  min.y + size.y - parentDimensions.y;
-                min.y     -= adjustedY + 1;
+                adjustedY =  position.y + size.y - parentDimensions.y;
+                position.y     -= adjustedY + 1;
             }
 
 
             // Make sure the choice is still on the screen.
-            assert (min.y &gt;= 0);
+            assert (position.y &gt;= 0);
         }
     } else if (me.getID() == mMouseEvent::MOUSE_EVENT_DRAGGED &amp;&amp;
                 (me.getModifiers() &amp; InputEvent::BUTTON1_MASK)) {
         isOpen = true;
         size.y = choiceList.size() * ChoiceItemHeight;
 
-        iRect r(min.x, min.y, min.x + size.x, min.y + ChoiceItemHeight);
+        iRect r(position.x, position.y, position.x + size.x, position.y + ChoiceItemHeight);
 
         for (size_t i = 0; i &lt; choiceList.size(); i++) {
             // Find the selected item.
@@ -131,7 +131,7 @@
         size.y = ChoiceItemHeight;
 
         // Move the choice back to its original location.
-        min.y += adjustedY;
+        position.y += adjustedY;
         adjustedY = 0;
 
         // set new element
@@ -151,7 +151,7 @@
         size.y = ChoiceItemHeight;
 
         // Move the choice back to its original location.
-        min.y += adjustedY;
+        position.y += adjustedY;
         adjustedY = 0;
 
         // set new element
@@ -172,12 +172,12 @@
     iXY pos;
 
     //pos.x = min.x - strlen((const char *) label) * CHAR_XPIX - CHAR_XPIX;
-    pos.x = min.x;
-    pos.y = min.y - Surface::getFontHeight() - 4;
+    pos.x = position.x;
+    pos.y = position.y - Surface::getFontHeight() - 4;
 
     // Draw the name of the choice.
-    dest.bltStringShadowed( min.x, pos.y + adjustedY,
-                            name.c_str(), Color::white, Color::black);
+    dest.bltStringShadowed( position.x, pos.y + adjustedY,
+                            componentName.c_str(), Color::white, Color::black);
 
     getBounds(r);
 
@@ -191,7 +191,7 @@
     if (!isOpen)	{
         s.bltStringShadowedCenter(choiceList[index].c_str(), Color::white, Color::black);
     } else {
-        r = iRect(min.x, min.y, min.x + size.x, min.y + ChoiceItemHeight);
+        r = iRect(position.x, position.y, position.x + size.x, position.y + ChoiceItemHeight);
 
         size_t count = choiceList.size();
 

Modified: trunk/netpanzer/src/NetPanzer/Views/Components/Choice.hpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Views/Components/Choice.hpp	2008-04-27 15:01:39 UTC (rev 1026)
+++ trunk/netpanzer/src/NetPanzer/Views/Components/Choice.hpp	2008-05-04 14:05:21 UTC (rev 1027)
@@ -70,6 +70,9 @@
     }
 
     virtual void draw(Surface &amp;dest);
+    virtual void render()
+    {
+    }
     virtual void actionPerformed(const mMouseEvent &amp;me);
 
 private:

Modified: trunk/netpanzer/src/NetPanzer/Views/Components/Component.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Views/Components/Component.cpp	2008-04-27 15:01:39 UTC (rev 1026)
+++ trunk/netpanzer/src/NetPanzer/Views/Components/Component.cpp	2008-05-04 14:05:21 UTC (rev 1027)
@@ -30,7 +30,7 @@
     foreground = gForeground;
     background = gBackground;
     size.zero();
-    min.zero();
+    position.zero();
     enabled    = true;
     visible    = true;
     parent     = 0;
@@ -42,10 +42,10 @@
 //---------------------------------------------------------------------------
 bool Component::contains(int x, int y) const
 {
-    return (x &gt;= min.x &amp;&amp;
-            x &lt; min.x + size.x &amp;&amp;
-            y &gt;= min.y &amp;&amp;
-            y &lt; min.y + size.y);
+    return (x &gt;= position.x &amp;&amp;
+            x &lt; position.x + size.x &amp;&amp;
+            y &gt;= position.y &amp;&amp;
+            y &lt; position.y + size.y);
 
 } // end Component::contains
 
@@ -61,8 +61,8 @@
 //---------------------------------------------------------------------------
 void Component::setLocation(int x, int y)
 {
-    min.x = x;
-    min.y = y;
+    position.x = x;
+    position.y = y;
 
 } // end Component::setLocation
 

Modified: trunk/netpanzer/src/NetPanzer/Views/Components/Component.hpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Views/Components/Component.hpp	2008-04-27 15:01:39 UTC (rev 1026)
+++ trunk/netpanzer/src/NetPanzer/Views/Components/Component.hpp	2008-05-04 14:05:21 UTC (rev 1027)
@@ -25,6 +25,7 @@
 #include &quot;Types/iXY.hpp&quot;
 #include &quot;Types/iRect.hpp&quot;
 #include &quot;Util/NoCopy.hpp&quot;
+#include &quot;Util/Log.hpp&quot;
 
 class mMouseEvent;
 
@@ -35,9 +36,9 @@
     PIX    background;
     PIX    foreground;
     iXY     size;
-    iXY     min;
+    iXY    position;
     Surface surface;
-    std::string name;
+    std::string componentName;
     bool    enabled;
     bool    visible;
     bool    dirty;
@@ -67,14 +68,21 @@
     {
         reset();
     }
+    
+    Component(const std::string &amp;cname) : componentName(cname)
+    {
+        reset();
+    }
+    
     virtual ~Component()
-    {}
+    {
+    }
 
     // Accessor functions.
     void getBounds(iRect &amp;r)
     {
-        r.min = min;
-        r.max = min + size;
+        r.min = position;
+        r.max = position + size;
     }
     bool contains(int x, int y) const;
     bool contains(iXY p) const { return contains(p.x, p.y); }
@@ -89,27 +97,38 @@
 
     void setBounds(const iRect &amp;r)
     {
-        min  = r.min;
+        position  = r.min;
         size = r.getSize();
-        surface.create(r.getSizeX(), r.getSizeY(), 1);
+        //surface.create(r.getSizeX(), r.getSizeY(), 1);
         dirty = true;
     }
-    void setSize(int x, int y)
+    
+    virtual void setSize(int x, int y)
     {
         size.x=x;
         size.y=y;
         surface.create(x,y,1);
         dirty=true;
     }
-    void setSize(const iXY &amp;d) { setSize(d.x, d.y); }
 
 //    void setEnabled(bool _enabled) { enabled = _enabled; }
 //    void setForeground(PIX _foreground) { foreground = _foreground; }
     void setLocation(int x, int y);
     void setLocation(const iXY &amp;p) { setLocation(p.x, p.y); }
-    void setName(const std::string&amp; name) { Component::name = name; }
+    void setName(const std::string&amp; name) { Component::componentName = name; }
 
-    virtual void draw(Surface &amp;dest) = 0;
+    virtual void draw(Surface &amp;dest)
+    {
+        iRect bounds;
+        getBounds(bounds);
+        
+        if ( dirty )
+            render();
+        
+        surface.blt(dest, bounds.min.x, bounds.min.y);
+    }
+    
+    virtual void render() = 0;
     virtual void actionPerformed(const mMouseEvent &amp;me) = 0;
 }; // end Component
 

Modified: trunk/netpanzer/src/NetPanzer/Views/Components/Desktop.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Views/Components/Desktop.cpp	2008-04-27 15:01:39 UTC (rev 1026)
+++ trunk/netpanzer/src/NetPanzer/Views/Components/Desktop.cpp	2008-05-04 14:05:21 UTC (rev 1027)
@@ -309,6 +309,7 @@
 void Desktop::add(View *view, bool autoActivate)
 {
     assert(view != 0);
+    LOGGER.warning(&quot;Desktop:add(%x) name=%s&quot;, (unsigned int)view, view-&gt;searchName);
     views.push_back(view);
     if (autoActivate)
         activate(view);
@@ -340,7 +341,7 @@
             focus-&gt;deactivate();
         }
 
-        if (!(view-&gt;getAlwaysOnBottom())) {
+         if (!(view-&gt;getAlwaysOnBottom())) {
             for(size_t i = 0; i&lt;views.size(); i++) {
                 if(views[i] == view) {
                     for(size_t i2 = i; i2 &gt;= 1; i2--)
@@ -349,7 +350,7 @@
                     break;
                 }
             }
-        }
+        } 
         focus = view;
         view-&gt;activate();
     }

Modified: trunk/netpanzer/src/NetPanzer/Views/Components/Desktop.hpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Views/Components/Desktop.hpp	2008-04-27 15:01:39 UTC (rev 1026)
+++ trunk/netpanzer/src/NetPanzer/Views/Components/Desktop.hpp	2008-05-04 14:05:21 UTC (rev 1027)
@@ -23,6 +23,7 @@
 #include &lt;vector&gt;
 #include &quot;Views/Components/View.hpp&quot;
 #include &quot;Util/TimeStamp.hpp&quot;
+#include &quot;Util/Log.hpp&quot;
 
 class Surface;
 

Modified: trunk/netpanzer/src/NetPanzer/Views/Components/Label.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Views/Components/Label.cpp	2008-04-27 15:01:39 UTC (rev 1026)
+++ trunk/netpanzer/src/NetPanzer/Views/Components/Label.cpp	2008-05-04 14:05:21 UTC (rev 1027)
@@ -23,11 +23,11 @@
 {    
     if ( shadowed )
     {
-        dest.bltStringShadowed(min.x, min.y, text.c_str(), foreground, background);
+        dest.bltStringShadowed(position.x, position.y, text.c_str(), foreground, background);
     }
     else
     {
-        dest.bltString(min.x, min.y, text.c_str(), foreground);
+        dest.bltString(position.x, position.y, text.c_str(), foreground);
     }
 }
 

Modified: trunk/netpanzer/src/NetPanzer/Views/Components/Label.hpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Views/Components/Label.hpp	2008-04-27 15:01:39 UTC (rev 1026)
+++ trunk/netpanzer/src/NetPanzer/Views/Components/Label.hpp	2008-05-04 14:05:21 UTC (rev 1027)
@@ -33,12 +33,17 @@
         background = bgcolor;
         foreground = color;
         shadowed = shadow;
-        min.x = x;
-        min.y = y;
+        position.x = x;
+        position.y = y;
     }
     
     void draw(Surface &amp;dest);
     
+    virtual void render()
+    {
+        
+    }
+    
     void actionPerformed(const mMouseEvent &amp;me) {}
     
 private:

Modified: trunk/netpanzer/src/NetPanzer/Views/Components/MouseEvent.hpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Views/Components/MouseEvent.hpp	2008-04-27 15:01:39 UTC (rev 1026)
+++ trunk/netpanzer/src/NetPanzer/Views/Components/MouseEvent.hpp	2008-05-04 14:05:21 UTC (rev 1027)
@@ -98,13 +98,9 @@
         return popupTrigger;
     }
 
-    bool getSource(const Component &amp;source) const
+    Component * getSource() const
     {
-        if (mMouseEvent::source == &amp;source) {
-            return true;
-        }
-
-        return false;
+        return source;
     }
 
 }

Modified: trunk/netpanzer/src/NetPanzer/Views/Components/ScrollBar.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Views/Components/ScrollBar.cpp	2008-04-27 15:01:39 UTC (rev 1026)
+++ trunk/netpanzer/src/NetPanzer/Views/Components/ScrollBar.cpp	2008-05-04 14:05:21 UTC (rev 1027)
@@ -24,7 +24,13 @@
 ScrollBar::ScrollBar() : Component()
 {
     reset();
+    decrease = new Button( &quot;decreaseButton&quot;);
+    decrease-&gt;setLabel(&quot;-&quot;);
+    
+    increase = new Button( &quot;increaseButton&quot;);
+    increase-&gt;setLabel(&quot;+&quot;);
 
+
 } // end ScrollBar::ScrollBar
 
 // ScrollBar
@@ -34,6 +40,11 @@
     reset();
 
     ScrollBar::orientation = orientation;
+    decrease = new Button( &quot;decreaseButton&quot;);
+    decrease-&gt;setLabel(&quot;-&quot;);
+    
+    increase = new Button( &quot;increaseButton&quot;);
+    increase-&gt;setLabel(&quot;+&quot;);
 
 } // end ScrollBar::ScrollBar
 
@@ -48,10 +59,16 @@
     ScrollBar::value       = visible;
     ScrollBar::minimum     = minimum;
     ScrollBar::maximum     = maximum;
+ 
+    decrease = new Button( &quot;decreaseButton&quot;);
+    decrease-&gt;setLabel(&quot;-&quot;);
+    
+    increase = new Button( &quot;increaseButton&quot;);
+    increase-&gt;setLabel(&quot;+&quot;);
+    
+    decrease-&gt;setSize(MINOR_AXIS_SIZE, MINOR_AXIS_SIZE);
+    increase-&gt;setSize(MINOR_AXIS_SIZE, MINOR_AXIS_SIZE);
 
-    decrease.setSize(MINOR_AXIS_SIZE, MINOR_AXIS_SIZE);
-    increase.setSize(MINOR_AXIS_SIZE, MINOR_AXIS_SIZE);
-
 } // end ScrollBar::ScrollBar
 
 // reset
@@ -76,12 +93,12 @@
     if (parent != 0) {
         if (orientation == HORIZONTAL) {
             // MINOR_AXIS_SIZE * 2 is room for the click buttons.
-            min.x = ((View *) parent)-&gt;getClientRect().min.x + MINOR_AXIS_SIZE;
-            min.y = ((View *) parent)-&gt;getClientRect().max.y - MINOR_AXIS_SIZE;
+            position.x = ((View *) parent)-&gt;getClientRect().min.x + MINOR_AXIS_SIZE;
+            position.y = ((View *) parent)-&gt;getClientRect().max.y - MINOR_AXIS_SIZE;
         } else if (orientation == VERTICAL) {
             // MINOR_AXIS_SIZE * 2 is room for the click buttons.
-            min.x = ((View *) parent)-&gt;getClientRect().max.x - MINOR_AXIS_SIZE;
-            min.y = ((View *) parent)-&gt;getClientRect().min.y + MINOR_AXIS_SIZE;
+            position.x = ((View *) parent)-&gt;getClientRect().max.x - MINOR_AXIS_SIZE;
+            position.y = ((View *) parent)-&gt;getClientRect().min.y + MINOR_AXIS_SIZE;
         } else {
             assert(false);
         }
@@ -119,11 +136,11 @@
 
     // Set the button locations.
     if (orientation == VERTICAL) {
-        decrease.setLocation(min.x, min.y - MINOR_AXIS_SIZE);
-        increase.setLocation(min.x, min.y + MINOR_AXIS_SIZE);
+        decrease-&gt;setLocation(position.x, position.y - MINOR_AXIS_SIZE);
+        increase-&gt;setLocation(position.x, position.y + MINOR_AXIS_SIZE);
     } else if (orientation == HORIZONTAL) {
-        decrease.setLocation(min.x - MINOR_AXIS_SIZE, min.y);
-        increase.setLocation(min.x + MINOR_AXIS_SIZE, min.y);
+        decrease-&gt;setLocation(position.x - MINOR_AXIS_SIZE, position.y);
+        increase-&gt;setLocation(position.x + MINOR_AXIS_SIZE, position.y);
     } else {
         assert(false);
     }

Modified: trunk/netpanzer/src/NetPanzer/Views/Components/ScrollBar.hpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Views/Components/ScrollBar.hpp	2008-04-27 15:01:39 UTC (rev 1026)
+++ trunk/netpanzer/src/NetPanzer/Views/Components/ScrollBar.hpp	2008-05-04 14:05:21 UTC (rev 1027)
@@ -47,8 +47,8 @@
     int   viewableAmount; // The total number of viewable items.
     float percent;
 
-    Button decrease;
-    Button increase;
+    Button * decrease;
+    Button * increase;
 
 protected:
     void clicked(const iXY &amp;pos);
@@ -115,6 +115,10 @@
     }
 
     virtual void draw(Surface &amp;dest);
+    virtual void render()
+    {
+        
+    }
     virtual void actionPerformed(const mMouseEvent&amp; me);
 }; // end ScrollBar
 

Modified: trunk/netpanzer/src/NetPanzer/Views/Components/View.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Views/Components/View.cpp	2008-04-27 15:01:39 UTC (rev 1026)
+++ trunk/netpanzer/src/NetPanzer/Views/Components/View.cpp	2008-05-04 14:05:21 UTC (rev 1027)
@@ -1036,45 +1036,6 @@
     buttons.push_back(button);
 } // end addButtonCenterText
 
-// addButtonTIL
-//---------------------------------------------------------------------------
-// Purpose: Adds a button of a TIL image.
-//---------------------------------------------------------------------------
-void View::addButtonBMP(const iXY &amp;pos, const char *imageName, const char *toolTip, ITEM_FUNC func, const bool &amp;isBordered)
-{
-    cButton* button = new cButton;
-    if (isBordered) {
-        button-&gt;createBMPBordered(pos, imageName, toolTip, func);
-
-    } else {
-        button-&gt;createBMP(pos, imageName, toolTip, func);
-    }
-
-    buttons.push_back(button);
-} // end addButtonBMP
-
-// addButtonSurface
-//---------------------------------------------------------------------------
-// Purpose: Adds a button of a Surface image.
-//---------------------------------------------------------------------------
-void View::addButtonSurface(const iXY &amp;pos, Surface &amp;source, const char *toolTip, ITEM_FUNC func)
-{
-    cButton* button = new cButton;
-    button-&gt;createSurface(pos, source, toolTip, func);
-    buttons.push_back(button);
-} // end addButtonSurface
-
-// addButtonSurfaceSingle
-//---------------------------------------------------------------------------
-// Purpose: Adds a button of a Surface image.
-//---------------------------------------------------------------------------
-void View::addButtonSurfaceSingle(const iXY &amp;pos, Surface &amp;source, const char *toolTip, ITEM_FUNC func)
-{
-    cButton* button = new cButton;
-    button-&gt;createSurfaceSingle(pos, source, toolTip, func);
-    buttons.push_back(button);
-} // end addButtonSurfaceSingle
-
 // setSearchName
 //---------------------------------------------------------------------------
 // Purpose: Sets the title of the window.

Modified: trunk/netpanzer/src/NetPanzer/Views/Components/View.hpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Views/Components/View.hpp	2008-04-27 15:01:39 UTC (rev 1026)
+++ trunk/netpanzer/src/NetPanzer/Views/Components/View.hpp	2008-05-04 14:05:21 UTC (rev 1027)
@@ -149,17 +149,6 @@
     // cButton Functions.
     void addButtonPackedSurface(const iXY &amp;pos, PackedSurface &amp;source, const char *toolTip, ITEM_FUNC leftClickFunc);
     void addButtonCenterText(const iXY &amp;pos, const int &amp;xSize, const char *nName, const char *nToolTip, ITEM_FUNC nLeftClickFunc);
-    void addButtonBMP(const iXY &amp;pos, const char *imageName, const char *toolTip, ITEM_FUNC func, const bool &amp;isBordered);
-    inline void addButtonBMP(const iXY &amp;pos, const char *imageName, const char *toolTip, ITEM_FUNC func)
-    {
-        addButtonBMP(pos, imageName, toolTip, func, false);
-    }
-    inline void addButtonBMPBordered(const iXY &amp;pos, const char *imageName, const char *toolTip, ITEM_FUNC func)
-    {
-        addButtonBMP(pos, imageName, toolTip, func, true);
-    }
-    void addButtonSurface(const iXY &amp;pos, Surface &amp;source, const char *toolTip, ITEM_FUNC func);
-    void addButtonSurfaceSingle(const iXY &amp;pos, Surface &amp;source, const char *toolTip, ITEM_FUNC func);
     /*!FIXME!*/ void drawDefinedButtons   (Surface &amp;clientArea);
     void drawHighlightedButton(Surface &amp;clientArea);
     void drawPressedButton(Surface &amp;clientArea);
@@ -252,17 +241,18 @@
     }
     void removeAllButtons()
     {
-        buttons.clear();
+        buttons.clear(); // XXX LEAK
     }
     void removeComponents()
     {
         ComponentsIterator i = components.begin();
         while ( i != components.end() )
         {
-            delete *i;
+            Component *c = *i;
             i++;
+            delete c;
         }
-        components.clear(); // XXX delete them?
+        components.clear();
         focusComponent      = 0;
     }
 

Modified: trunk/netpanzer/src/NetPanzer/Views/Components/cButton.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Views/Components/cButton.cpp	2008-04-27 15:01:39 UTC (rev 1026)
+++ trunk/netpanzer/src/NetPanzer/Views/Components/cButton.cpp	2008-05-04 14:05:21 UTC (rev 1027)
@@ -101,141 +101,6 @@
 
 } // end createCenterText
 
-// createBMP
-//---------------------------------------------------------------------------
-void cButton::createBMP(iXY pos,
-                        const char *imageName,
-                        const char *nToolTip,
-                        ITEM_FUNC nLeftClickFunc,
-                        bool isBordered)
-{
-    Surface tempTopSurface;
-
-    Surface tempSurface;
-    tempSurface.loadBMP(imageName);
-
-    tempTopSurface.create(tempSurface.getWidth(), tempSurface.getHeight(), 3);
-
-    tempTopSurface.setFrame(0);
-    tempSurface.blt(tempTopSurface, 0, 0);
-    if (isBordered) {
-        tempTopSurface.drawButtonBorder(Color::darkGray, Color::darkGray);
-    }
-
-    tempTopSurface.setFrame(1);
-    tempSurface.blt(tempTopSurface, 0, 0);
-    if (isBordered) {
-        tempTopSurface.drawButtonBorder(Color::red, Color::red);
-    }
-
-    tempTopSurface.setFrame(2);
-    tempSurface.blt(tempTopSurface, 0, 0);
-    if (isBordered) {
-        tempTopSurface.drawButtonBorder(Color::darkGray, Color::darkGray);
-    }
-
-    tempTopSurface.setFrame(0);
-
-    setName(&quot;TIL file&quot;);
-    toolTip       = strdup(nToolTip); assert(toolTip != 0);
-    bounds        = iRect(pos.x, pos.y, pos.x + tempTopSurface.getWidth(), pos.y + tempTopSurface.getHeight());
-    leftClickFunc = nLeftClickFunc;
-
-    topSurface.pack(tempTopSurface);
-} // end createBMP
-
-// createSurface
-//---------------------------------------------------------------------------
-void cButton::createSurface(
-    iXY         pos,
-    Surface    &amp;source,
-    const char *nToolTip,
-    ITEM_FUNC   nLeftClickFunc,
-    bool        isBordered)
-{
-    Surface tempTopSurface;
-
-    tempTopSurface.create(source.getWidth(), source.getHeight(), 3);
-
-    tempTopSurface.setFrame(0);
-    source.setFrame(0);
-    source.blt(tempTopSurface, 0, 0);
-
-    tempTopSurface.setFrame(1);
-    if (source.getNumFrames() &gt; 1) {
-        source.setFrame(1);
-        source.blt(tempTopSurface, 0, 0);
-
-        if (isBordered) {
-            tempTopSurface.drawButtonBorder(Color::lightGreen, Color::darkGreen);
-        }
-
-    } else {
-        source.blt(tempTopSurface, 0, 0);
-
-        if (isBordered) {
-            tempTopSurface.drawButtonBorder(Color::lightRed, Color::darkRed);
-        }
-    }
-
-    tempTopSurface.setFrame(2);
-    if (source.getNumFrames() &gt; 2) {
-        source.setFrame(2);
-        source.blt(tempTopSurface, 0, 0);
-    } else {
-        source.blt(tempTopSurface, 0, 0);
-
-        if (isBordered) {
-            tempTopSurface.drawButtonBorder(Color::darkGreen, Color::lightGreen);
-        }
-    }
-
-    tempTopSurface.setFrame(0);
-
-    setName(&quot;Surface Single&quot;);
-    toolTip       = strdup(nToolTip); assert(toolTip != 0);
-    bounds        = iRect(pos.x, pos.y, pos.x + tempTopSurface.getWidth(), pos.y + tempTopSurface.getHeight());
-    leftClickFunc = nLeftClickFunc;
-
-    topSurface.pack(tempTopSurface);
-
-} // end createSurface
-
-// createSurfaceSingle
-//---------------------------------------------------------------------------
-void cButton::createSurfaceSingle(
-    iXY pos,
-    Surface &amp;source,
-    const char *nToolTip,
-    ITEM_FUNC nLeftClickFunc)
-{
-    Surface tempTopSurface;
-
-    tempTopSurface.create(source.getWidth(), source.getHeight(), 3);
-
-    tempTopSurface.setFrame(0);
-    source.blt(tempTopSurface, 0, 0);
-    //tempTopSurface.drawButtonBorder(Color::white, Color::gray128);
-
-    tempTopSurface.setFrame(1);
-    source.blt(tempTopSurface, 0, 0);
-    tempTopSurface.drawButtonBorder(Color::red, Color::darkRed);
-
-    tempTopSurface.setFrame(2);
-    source.blt(tempTopSurface, 0, 0);
-    tempTopSurface.drawButtonBorder(Color::green, Color::darkGreen);
-
-    tempTopSurface.setFrame(0);
-
-    setName(&quot;Surface Single&quot;);
-    toolTip       = strdup(nToolTip); assert(toolTip != 0);
-    bounds        = iRect(pos.x, pos.y, pos.x + tempTopSurface.getWidth(), pos.y + tempTopSurface.getHeight());
-    leftClickFunc = nLeftClickFunc;
-
-    topSurface.pack(tempTopSurface);
-
-} // end createSurfaceSingle
-
 // RESET
 //---------------------------------------------------------------------------
 void cButton::reset()

Modified: trunk/netpanzer/src/NetPanzer/Views/Components/cButton.hpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Views/Components/cButton.hpp	2008-04-27 15:01:39 UTC (rev 1026)
+++ trunk/netpanzer/src/NetPanzer/Views/Components/cButton.hpp	2008-05-04 14:05:21 UTC (rev 1027)
@@ -67,28 +67,6 @@
 
     void createCenterText(iXY pos, int xSize, const char *nName, const char *nToolTip, ITEM_FUNC nLeftClickFunc);
 
-    void createBMP(iXY pos, const char *imageName, const char *nToolTip, ITEM_FUNC nLeftClickFunc, bool isBordered);
-    inline void createBMP(iXY pos, const char *imageName, const char *nToolTip, ITEM_FUNC nLeftClickFunc)
-    {
-        createBMP(pos, imageName, nToolTip, nLeftClickFunc, false);
-    }
-    inline void createBMPBordered(iXY pos, const char *imageName, const char *nToolTip, ITEM_FUNC nLeftClickFunc)
-    {
-        createBMP(pos, imageName, nToolTip, nLeftClickFunc, true);
-    }
-
-    void createSurface(iXY pos, Surface &amp;source, const char *nToolTip, ITEM_FUNC nLeftClickFunc, bool isBordered);
-    inline void createSurface(iXY pos, Surface &amp;source, const char *nToolTip, ITEM_FUNC nLeftClickFunc)
-    {
-        createSurface(pos, source, nToolTip, nLeftClickFunc, false);
-    }
-    inline void createSurfaceBordered(iXY pos, Surface &amp;source, const char *nToolTip, ITEM_FUNC nLeftClickFunc)
-    {
-        createSurface(pos, source, nToolTip, nLeftClickFunc, true);
-    }
-
-    void createSurfaceSingle(iXY pos, Surface &amp;source, const char *nToolTip, ITEM_FUNC nLeftClickFunc);
-
     inline bool contains(iXY pos)
     {
         assert(this != 0);

Modified: trunk/netpanzer/src/NetPanzer/Views/Game/GameInfoView.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Views/Game/GameInfoView.cpp	2008-04-27 15:01:39 UTC (rev 1026)
+++ trunk/netpanzer/src/NetPanzer/Views/Game/GameInfoView.cpp	2008-05-04 14:05:21 UTC (rev 1027)
@@ -75,17 +75,17 @@
     setSearchName(&quot;GameInfoView&quot;);
     setTitle(&quot;Information&quot;);
     setSubTitle(&quot;&quot;);
-
+    
     setAllowResize(false);
     setAllowMove(false);
     setDisplayStatusBar(false);
     setVisible(false);
     setBordered(true);
-
+    
     moveTo(iXY(0,0));
     //resizeClientArea(iXY(100, 2 * 2 + 12 * 3 + 8));
     resizeClientArea(iXY(140, 2 * 2 + 5 * 12 + 8));
-
+    
     if(gameconfig-&gt;gameinfoposition.isDefaultValue()) {
         // Start it in the top-right corner.
         iXY pos(screen-&gt;getWidth() - getSize().x,0);

Modified: trunk/netpanzer/src/NetPanzer/Views/Game/HelpScrollView.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Views/Game/HelpScrollView.cpp	2008-04-27 15:01:39 UTC (rev 1026)
+++ trunk/netpanzer/src/NetPanzer/Views/Game/HelpScrollView.cpp	2008-05-04 14:05:21 UTC (rev 1027)
@@ -113,14 +113,20 @@
     iXY size(20, 20);
     iXY pos(getClientRect().getSizeX() - size.x, 0);
 
-    upButton.setLabel(&quot;+&quot;);
-    upButton.setBounds(iRect(pos, pos + size));
-    add(&amp;upButton);
+    upButton = new Button(&quot;upButton&quot;);
+    upButton-&gt;setLabel(&quot;+&quot;);
+    upButton-&gt;setLocation(pos.x, pos.y);
+    upButton-&gt;setSize(size.x, size.y);
+    upButton-&gt;setNormalBorder();
+    add(upButton);
 
     pos = iXY(getClientRect().getSizeX() - size.x, getClientRect().getSizeY() - size.y);
-    downButton.setLabel(&quot;-&quot;);
-    downButton.setBounds(iRect(pos, pos + size));
-    add(&amp;downButton);
+    downButton = new Button(&quot;downButton&quot;);
+    downButton-&gt;setLabel(&quot;-&quot;);
+    downButton-&gt;setLocation(pos.x, pos.y);
+    downButton-&gt;setSize(size.x, size.y);
+    downButton-&gt;setNormalBorder();
+    add(downButton);
 
 } // end HelpScrollView::HelpScrollView
 
@@ -184,11 +190,11 @@
 void HelpScrollView::actionPerformed(mMouseEvent me)
 {
     if (me.getID() == mMouseEvent::MOUSE_EVENT_CLICKED) {
-        if (me.getSource(upButton)) {
+        if (me.getSource()==upButton) {
             if (--topViewableItem &lt; 0) {
                 topViewableItem = 0;
             }
-        } else if (me.getSource(downButton)) {
+        } else if (me.getSource()==downButton) {
             if (++topViewableItem &gt;= (long) text.size() - maxViewableItems) {
                 topViewableItem = (long) text.size() - maxViewableItems;
             }

Modified: trunk/netpanzer/src/NetPanzer/Views/Game/HelpScrollView.hpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Views/Game/HelpScrollView.hpp	2008-04-27 15:01:39 UTC (rev 1026)
+++ trunk/netpanzer/src/NetPanzer/Views/Game/HelpScrollView.hpp	2008-05-04 14:05:21 UTC (rev 1027)
@@ -43,8 +43,8 @@
     enum { TEXT_GAP_SPACE = 2 };
     void insert(const char *string);
 
-    Button upButton;
-    Button downButton;
+    Button * upButton;
+    Button * downButton;
 
     int maxViewableItems;
     int topViewableItem;

Modified: trunk/netpanzer/src/NetPanzer/Views/Game/LibView.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Views/Game/LibView.cpp	2008-04-27 15:01:39 UTC (rev 1026)
+++ trunk/netpanzer/src/NetPanzer/Views/Game/LibView.cpp	2008-05-04 14:05:21 UTC (rev 1027)
@@ -76,45 +76,53 @@
     addButtonCenterText(iXY((getClientRect().getSize().x / 3) * 1, 0), getClientRect().getSize().x / 3, &quot;Particles&quot;, &quot;&quot;, bParticleInfo);
     addButtonCenterText(iXY((getClientRect().getSize().x / 3) * 2, 0), getClientRect().getSize().x / 3, &quot;Environment&quot;, &quot;&quot;, bEnvironmentInfo);
 
-    checkBoxAllowParticleGeneration.setLabel(&quot;Allow Particle Generation&quot;);
-    checkBoxAllowParticleGeneration.setLocation(0, 15);
-    checkBoxAllowParticleGeneration.setState(Particle2D::getCreateParticles());
-    add(&amp;checkBoxAllowParticleGeneration);
+    checkBoxAllowParticleGeneration = new CheckBox();
+    checkBoxAllowParticleGeneration-&gt;setLabel(&quot;Allow Particle Generation&quot;);
+    checkBoxAllowParticleGeneration-&gt;setLocation(0, 15);
+    checkBoxAllowParticleGeneration-&gt;setState(Particle2D::getCreateParticles());
+    add(checkBoxAllowParticleGeneration);
 
-    checkBoxAllowTimeSlice.setLabel(&quot;Allow Time Slice&quot;);
-    checkBoxAllowTimeSlice.setLocation(0, 30);
-    checkBoxAllowTimeSlice.setState(gTimeSliceFlag);
-    add(&amp;checkBoxAllowTimeSlice);
+    checkBoxAllowTimeSlice = new CheckBox();
+    checkBoxAllowTimeSlice-&gt;setLabel(&quot;Allow Time Slice&quot;);
+    checkBoxAllowTimeSlice-&gt;setLocation(0, 30);
+    checkBoxAllowTimeSlice-&gt;setState(gTimeSliceFlag);
+    add(checkBoxAllowTimeSlice);
 
-    checkBoxAllowSpanBlitting.setLabel(&quot;Allow Blended Span Blitting&quot;);
-    checkBoxAllowSpanBlitting.setLocation(0, 45);
-    checkBoxAllowSpanBlitting.setState(allowSpanBlitting);
-    add(&amp;checkBoxAllowSpanBlitting);
+    checkBoxAllowSpanBlitting = new CheckBox();
+    checkBoxAllowSpanBlitting-&gt;setLabel(&quot;Allow Blended Span Blitting&quot;);
+    checkBoxAllowSpanBlitting-&gt;setLocation(0, 45);
+    checkBoxAllowSpanBlitting-&gt;setState(allowSpanBlitting);
+    add(checkBoxAllowSpanBlitting);
 
-    checkBoxParticlesCanHaveSmoke.setLabel(&quot;Allow Explosion Particle Smoke&quot;);
-    checkBoxParticlesCanHaveSmoke.setLocation(0, 60);
-    checkBoxParticlesCanHaveSmoke.setState(ParticleInterface::gParticlesCanHaveSmoke);
-    add(&amp;checkBoxParticlesCanHaveSmoke);
+    checkBoxParticlesCanHaveSmoke = new CheckBox();
+    checkBoxParticlesCanHaveSmoke-&gt;setLabel(&quot;Allow Explosion Particle Smoke&quot;);
+    checkBoxParticlesCanHaveSmoke-&gt;setLocation(0, 60);
+    checkBoxParticlesCanHaveSmoke-&gt;setState(ParticleInterface::gParticlesCanHaveSmoke);
+    add(checkBoxParticlesCanHaveSmoke);
 
-    checkBoxSolidColorExplosionParticles.setLabel(&quot;Solid Color Explosion Particles&quot;);
-    checkBoxSolidColorExplosionParticles.setLocation(0, 75);
-    checkBoxSolidColorExplosionParticles.setState(ParticleInterface::gSolidColorExplosionParticles);
-    add(&amp;checkBoxSolidColorExplosionParticles);
+    checkBoxSolidColorExplosionParticles = new CheckBox();
+    checkBoxSolidColorExplosionParticles-&gt;setLabel(&quot;Solid Color Explosion Particles&quot;);
+    checkBoxSolidColorExplosionParticles-&gt;setLocation(0, 75);
+    checkBoxSolidColorExplosionParticles-&gt;setState(ParticleInterface::gSolidColorExplosionParticles);
+    add(checkBoxSolidColorExplosionParticles);
 
-    checkBoxParticleInterfaceSim.setLabel(&quot;Particle Interface Sim&quot;);
-    checkBoxParticleInterfaceSim.setLocation(0, 90);
-    checkBoxParticleInterfaceSim.setState(ParticleInterface::gTestSim);
-    add(&amp;checkBoxParticleInterfaceSim);
+    checkBoxParticleInterfaceSim = new CheckBox();
+    checkBoxParticleInterfaceSim-&gt;setLabel(&quot;Particle Interface Sim&quot;);
+    checkBoxParticleInterfaceSim-&gt;setLocation(0, 90);
+    checkBoxParticleInterfaceSim-&gt;setState(ParticleInterface::gTestSim);
+    add(checkBoxParticleInterfaceSim);
 
-    checkBoxSolidBackground.setLabel(&quot;Solid Background&quot;);
-    checkBoxSolidBackground.setLocation(0, 105);
-    checkBoxSolidBackground.setState(GameView::gDrawSolidBackground);
-    add(&amp;checkBoxSolidBackground);
+    checkBoxSolidBackground = new CheckBox();
+    checkBoxSolidBackground-&gt;setLabel(&quot;Solid Background&quot;);
+    checkBoxSolidBackground-&gt;setLocation(0, 105);
+    checkBoxSolidBackground-&gt;setState(GameView::gDrawSolidBackground);
+    add(checkBoxSolidBackground);
 
-    checkBoxDrawExplosionParticleCount.setLabel(&quot;Draw Explosion Particle Count&quot;);
-    checkBoxDrawExplosionParticleCount.setLocation(0, 120);
-    checkBoxDrawExplosionParticleCount.setState(ParticleInterface::gDrawExplosionParticleCount);
-    add(&amp;checkBoxDrawExplosionParticleCount);
+    checkBoxDrawExplosionParticleCount = new CheckBox();
+    checkBoxDrawExplosionParticleCount-&gt;setLabel(&quot;Draw Explosion Particle Count&quot;);
+    checkBoxDrawExplosionParticleCount-&gt;setLocation(0, 120);
+    checkBoxDrawExplosionParticleCount-&gt;setState(ParticleInterface::gDrawExplosionParticleCount);
+    add(checkBoxDrawExplosionParticleCount);
 
 } // end LibView::LibView
 
@@ -313,22 +321,22 @@
 //---------------------------------------------------------------------------
 void LibView::actionPerformed(mMouseEvent me)
 {
-    if (me.getSource(checkBoxAllowParticleGeneration)) {
-        Particle2D::setCreateParticles(checkBoxAllowParticleGeneration.getState());
-    } else if (me.getSource(checkBoxAllowTimeSlice)) {
-        gTimeSliceFlag = checkBoxAllowTimeSlice.getState();
-    } else if (me.getSource(checkBoxAllowSpanBlitting)) {
-        allowSpanBlitting = checkBoxAllowSpanBlitting.getState();
-    } else if (me.getSource(checkBoxParticlesCanHaveSmoke)) {
-        ParticleInterface::gParticlesCanHaveSmoke = checkBoxParticlesCanHaveSmoke.getState();
-    } else if (me.getSource(checkBoxSolidColorExplosionParticles)) {
-        ParticleInterface::gSolidColorExplosionParticles = checkBoxSolidColorExplosionParticles.getState();
-    } else if (me.getSource(checkBoxParticleInterfaceSim)) {
-        ParticleInterface::gTestSim = checkBoxParticleInterfaceSim.getState();
-    } else if (me.getSource(checkBoxSolidBackground)) {
-        GameView::gDrawSolidBackground = checkBoxSolidBackground.getState();
-    } else if (me.getSource(checkBoxDrawExplosionParticleCount)) {
-        ParticleInterface::gDrawExplosionParticleCount = checkBoxDrawExplosionParticleCount.getState();
+    if (me.getSource()==checkBoxAllowParticleGeneration) {
+        Particle2D::setCreateParticles(checkBoxAllowParticleGeneration-&gt;getState());
+    } else if (me.getSource()==checkBoxAllowTimeSlice) {
+        gTimeSliceFlag = checkBoxAllowTimeSlice-&gt;getState();
+    } else if (me.getSource()==checkBoxAllowSpanBlitting) {
+        allowSpanBlitting = checkBoxAllowSpanBlitting-&gt;getState();
+    } else if (me.getSource()==checkBoxParticlesCanHaveSmoke) {
+        ParticleInterface::gParticlesCanHaveSmoke = checkBoxParticlesCanHaveSmoke-&gt;getState();
+    } else if (me.getSource()==checkBoxSolidColorExplosionParticles) {
+        ParticleInterface::gSolidColorExplosionParticles = checkBoxSolidColorExplosionParticles-&gt;getState();
+    } else if (me.getSource()==checkBoxParticleInterfaceSim) {
+        ParticleInterface::gTestSim = checkBoxParticleInterfaceSim-&gt;getState();
+    } else if (me.getSource()==checkBoxSolidBackground) {
+        GameView::gDrawSolidBackground = checkBoxSolidBackground-&gt;getState();
+    } else if (me.getSource()==checkBoxDrawExplosionParticleCount) {
+        ParticleInterface::gDrawExplosionParticleCount = checkBoxDrawExplosionParticleCount-&gt;getState();
     }
 
 } // end LibView::actionPerformed

Modified: trunk/netpanzer/src/NetPanzer/Views/Game/LibView.hpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Views/Game/LibView.hpp	2008-04-27 15:01:39 UTC (rev 1026)
+++ trunk/netpanzer/src/NetPanzer/Views/Game/LibView.hpp	2008-05-04 14:05:21 UTC (rev 1027)
@@ -40,14 +40,14 @@
     void drawParticleInfo(Surface &amp;clientArea, iXY pos);
     void drawEnvironmentInfo(Surface &amp;dest, iXY pos);
 
-    CheckBox checkBoxAllowParticleGeneration;
-    CheckBox checkBoxAllowTimeSlice;
-    CheckBox checkBoxAllowSpanBlitting;
-    CheckBox checkBoxParticlesCanHaveSmoke;
-    CheckBox checkBoxSolidColorExplosionParticles;
-    CheckBox checkBoxParticleInterfaceSim;
-    CheckBox checkBoxSolidBackground;
-    CheckBox checkBoxDrawExplosionParticleCount;
+    CheckBox * checkBoxAllowParticleGeneration;
+    CheckBox * checkBoxAllowTimeSlice;
+    CheckBox * checkBoxAllowSpanBlitting;
+    CheckBox * checkBoxParticlesCanHaveSmoke;
+    CheckBox * checkBoxSolidColorExplosionParticles;
+    CheckBox * checkBoxParticleInterfaceSim;
+    CheckBox * checkBoxSolidBackground;
+    CheckBox * checkBoxDrawExplosionParticleCount;
 
 public:
     LibView();

Modified: trunk/netpanzer/src/NetPanzer/Views/Game/VehicleSelectionView.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Views/Game/VehicleSelectionView.cpp	2008-04-27 15:01:39 UTC (rev 1026)
+++ trunk/netpanzer/src/NetPanzer/Views/Game/VehicleSelectionView.cpp	2008-05-04 14:05:21 UTC (rev 1027)
@@ -21,85 +21,45 @@
 #include &quot;VehicleSelectionView.hpp&quot;
 #include &quot;Structs/UnitTypes.hpp&quot;
 #include &quot;Views/GameViewGlobals.hpp&quot;
-#include &quot;Views/Components/Desktop.hpp&quot;
 #include &quot;Classes/Network/TerminalNetMesg.hpp&quot;
-#include &quot;Interfaces/Client.hpp&quot;
 #include &quot;Classes/Network/NetworkClient.hpp&quot;
 #include &quot;Classes/Network/NetworkState.hpp&quot;
 #include &quot;Classes/WorldInputCmdProcessor.hpp&quot;
+#include &quot;Classes/ScreenSurface.hpp&quot;
+#include &quot;Util/Math.hpp&quot;
+#include &quot;Structs/UnitTypes.hpp&quot;
 #include &quot;Interfaces/WorldViewInterface.hpp&quot;
 #include &quot;Interfaces/ObjectiveInterface.hpp&quot;
+#include &quot;Interfaces/Client.hpp&quot;
 #include &quot;Interfaces/UnitProfileInterface.hpp&quot;
-#include &quot;Classes/ScreenSurface.hpp&quot;
-#include &quot;Util/Math.hpp&quot;
 #include &quot;Interfaces/ObjectiveInterface.hpp&quot;
-#include &quot;Structs/UnitTypes.hpp&quot;
 #include &quot;Interfaces/UnitInterface.hpp&quot;
 #include &quot;Interfaces/PlayerInterface.hpp&quot;
 #include &quot;Interfaces/GameConfig.hpp&quot;
+#include &quot;Views/Components/Desktop.hpp&quot;
 #include &quot;Views/Components/ViewGlobals.hpp&quot;
 #include &quot;Views/Components/Label.hpp&quot;
 
-
-Button VehicleSelectionView::buttonStaticDisplay;
-Button VehicleSelectionView::buttonPower;
-Button VehicleSelectionView::buttonOk;
-
-bool changeMade = false;
-
-iRect   VehicleSelectionView::miniProductionRect(0, 0, 0, 0);
-Surface VehicleSelectionView::unitImages;
-bool    VehicleSelectionView::displayMiniProductionStatus = true;
-bool    VehicleSelectionView::displayOutpostNames = true;
-
+int vsvSelectedUnit   = 0;
+int vsvUnitGenOn      = true;
+bool changeMade       = false;
 unsigned short CURRENT_SELECTED_OUTPOST_ID;
 
-
-int vsvSelectedUnit   = _unit_type_valentine;
-int vsvUnitGenOn      = true;
-
-void activateVehicleSelectionView(unsigned short outpost_id)
-{
-    OutpostStatus outpost_status;
-
-    CURRENT_SELECTED_OUTPOST_ID = outpost_id;
-
-    outpost_status  = ObjectiveInterface::getOutpostStatus(CURRENT_SELECTED_OUTPOST_ID);
-    vsvSelectedUnit = outpost_status.unit_generation_type;
-    vsvUnitGenOn    = outpost_status.unit_generation_on_off;
-
-    if (vsvUnitGenOn) {
-        VehicleSelectionView::setPowerOn();
-    } else {
-        VehicleSelectionView::setPowerOff();
-    }
-
-    Desktop::setVisibility( &quot;VehicleSelectionView&quot;, true);
-}
-
-void toggleDisplayOutpostNames( void )
-{
-    VehicleSelectionView::displayOutpostNames = !VehicleSelectionView::displayOutpostNames;
-}
-
-
-
 static void sendOutpostStatus()
 {
     if (!changeMade) {
         return;
     }
-    assert(vsvSelectedUnit != _unit_type_null);
-
+    
     // Send the server the selected unit and whether factory power is on.
     TerminalOutpostUnitGenRequest term_mesg;
-
+    
     term_mesg.unit_gen_request.set( CURRENT_SELECTED_OUTPOST_ID,
-                                    (char) vsvSelectedUnit,
-                                    vsvUnitGenOn );
-
+                                   (char) vsvSelectedUnit,
+                                   vsvUnitGenOn );
+    
     CLIENT-&gt;sendMessage(&amp;term_mesg, sizeof(term_mesg));
-
+    
     if(NetworkState::status == _network_state_client) {
         ObjectiveInterface::sendMessage( &amp;(term_mesg.unit_gen_request) );
     }
@@ -116,141 +76,89 @@
 {
     vsvUnitGenOn = true;
     changeMade   = true;
-
+    
     VehicleSelectionView::setPowerOn();
 }
 
-
-static void bSelectScout()
+class UnitSelectionButton : public Button
 {
-    if (vsvSelectedUnit == _unit_type_humvee &amp;&amp; vsvUnitGenOn) {
-        Desktop::setVisibilityNoDoAnything(&quot;VehicleSelectionView&quot;, false);
-        return;
+protected:
+    unsigned short unitType;
+    VehicleSelectionView * p;
+public:
+    UnitSelectionButton(VehicleSelectionView * vsv, const char *cname, int unit_type, int x, int y, const Surface &amp;s)
+        : Button(cname), unitType(unit_type), p(vsv)
+    {
+        bimage.copy(s);
+        setSize( bimage.getWidth(), bimage.getHeight());
+        setLocation(x, y);
+        setUnitSelectionBorder();
     }
-
-    vsvSelectedUnit = _unit_type_humvee;
-    changeMade      = true;
-    bSetPowerOn();
-    bOK();
-}
-
-static void bSelectManta()
-{
-    if (vsvSelectedUnit == _unit_type_valentine &amp;&amp; vsvUnitGenOn) {
-        Desktop::setVisibilityNoDoAnything(&quot;VehicleSelectionView&quot;, false);
-        return;
+    
+    void actionPerformed( const mMouseEvent &amp;e )
+    {        
+        if ( e.getID() == mMouseEvent::MOUSE_EVENT_PRESSED )
+        {
+            resetState();
+            if (vsvSelectedUnit == unitType &amp;&amp; vsvUnitGenOn) {
+                Desktop::setVisibilityNoDoAnything(&quot;VehicleSelectionView&quot;, false);
+                return;
+            }
+            
+            vsvSelectedUnit = unitType;
+            changeMade      = true;
+            bSetPowerOn();
+            bOK();
+        }
+        else if ( e.getID() == mMouseEvent::MOUSE_EVENT_ENTERED )
+        {
+            Button::actionPerformed(e);
+            p-&gt;highlightedUnitType = unitType;
+        }
+        else if ( e.getID() == mMouseEvent::MOUSE_EVENT_EXITED )
+        {
+            Button::actionPerformed(e);
+            if ( p-&gt;highlightedUnitType == unitType )
+                p-&gt;highlightedUnitType = -1;
+        }
     }
+};
 
-    vsvSelectedUnit = _unit_type_valentine;
-    changeMade      = true;
-    bSetPowerOn();
-    bOK();
-}
+Button * VehicleSelectionView::buttonStaticDisplay = 0;
+Button * VehicleSelectionView::buttonPower = 0;
+Button * VehicleSelectionView::buttonOk = 0;
 
-static void bSelectPanther1()
-{
-    if (vsvSelectedUnit == _unit_type_leopard &amp;&amp; vsvUnitGenOn) {
-        Desktop::setVisibilityNoDoAnything(&quot;VehicleSelectionView&quot;, false);
-        return;
-    }
+iRect   VehicleSelectionView::miniProductionRect(0, 0, 0, 0);
+Surface VehicleSelectionView::unitImages;
+bool    VehicleSelectionView::displayMiniProductionStatus = true;
+bool    VehicleSelectionView::displayOutpostNames = true;
 
-    vsvSelectedUnit = _unit_type_leopard;
-    changeMade      = true;
-    bSetPowerOn();
-    bOK();
-}
 
-static void bSelectTitan()
-{
-    if (vsvSelectedUnit == _unit_type_abrams &amp;&amp; vsvUnitGenOn) {
-        Desktop::setVisibilityNoDoAnything(&quot;VehicleSelectionView&quot;, false);
-        return;
-    }
 
-    vsvSelectedUnit = _unit_type_abrams;
-    changeMade      = true;
-    bSetPowerOn();
-    bOK();
-}
-
-static void bSelectStinger()
+void activateVehicleSelectionView(unsigned short outpost_id)
 {
-    if (vsvSelectedUnit == _unit_type_hammerhead &amp;&amp; vsvUnitGenOn) {
-        Desktop::setVisibilityNoDoAnything(&quot;VehicleSelectionView&quot;, false);
-        return;
-    }
+    OutpostStatus outpost_status;
 
-    vsvSelectedUnit = _unit_type_hammerhead;
-    changeMade      = true;
-    bSetPowerOn();
-    bOK();
-}
+    CURRENT_SELECTED_OUTPOST_ID = outpost_id;
 
-static void bSelectBobcat()
-{
-    if (vsvSelectedUnit == _unit_type_lynx &amp;&amp; vsvUnitGenOn) {
-        Desktop::setVisibilityNoDoAnything(&quot;VehicleSelectionView&quot;, false);
-        return;
-    }
+    outpost_status  = ObjectiveInterface::getOutpostStatus(CURRENT_SELECTED_OUTPOST_ID);
+    vsvSelectedUnit = outpost_status.unit_generation_type;
+    vsvUnitGenOn    = outpost_status.unit_generation_on_off;
 
-    vsvSelectedUnit = _unit_type_lynx;
-    changeMade      = true;
-    bSetPowerOn();
-    bOK();
-}
-
-static void bSelectWolf()
-{
-    if (vsvSelectedUnit == _unit_type_scorpion &amp;&amp; vsvUnitGenOn) {
-        Desktop::setVisibilityNoDoAnything(&quot;VehicleSelectionView&quot;, false);
-        return;
+    if (vsvUnitGenOn) {
+        VehicleSelectionView::setPowerOn();
+    } else {
+        VehicleSelectionView::setPowerOff();
     }
 
-    vsvSelectedUnit = _unit_type_scorpion;
-    changeMade      = true;
-    bSetPowerOn();
-    bOK();
+    Desktop::setVisibility( &quot;VehicleSelectionView&quot;, true);
 }
 
-static void bSelectBear()
+void toggleDisplayOutpostNames( void )
 {
-    if (vsvSelectedUnit == _unit_type_spahpanzer &amp;&amp; vsvUnitGenOn) {
-        Desktop::setVisibilityNoDoAnything(&quot;VehicleSelectionView&quot;, false);
-        return;
-    }
-
-    vsvSelectedUnit = _unit_type_spahpanzer;
-    changeMade      = true;
-    bSetPowerOn();
-    bOK();
+    VehicleSelectionView::displayOutpostNames = !VehicleSelectionView::displayOutpostNames;
 }
 
-static void bSelectDrake()
-{
-    if (vsvSelectedUnit == _unit_type_m109 &amp;&amp; vsvUnitGenOn) {
-        Desktop::setVisibilityNoDoAnything(&quot;VehicleSelectionView&quot;, false);
-        return;
-    }
-
-    vsvSelectedUnit = _unit_type_m109;
-    changeMade      = true;
-    bSetPowerOn();
-    bOK();
-}
-
-static void bSelectArcher()
-{
-    if (vsvSelectedUnit == _unit_type_archer &amp;&amp; vsvUnitGenOn) {
-        Desktop::setVisibilityNoDoAnything(&quot;VehicleSelectionView&quot;, false);
-        return;
-    }
-
-    vsvSelectedUnit = _unit_type_archer;
-    changeMade      = true;
-    bSetPowerOn();
-    bOK();
-}
-
 // VehicleSelectionView
 //---------------------------------------------------------------------------
 VehicleSelectionView::VehicleSelectionView() : GameTemplateView()
@@ -266,8 +174,6 @@
 
     moveTo(iXY(0, 0));
 
-    char      strBuf[256];
-    int       unit_regen_time;
     const int yOffset  = 15;
     const int gapSpace =  1;
 
@@ -280,18 +186,27 @@
     add( new Label( pos.x+2, pos.y+2, &quot;Static Display:&quot;, Color::white) );
 
     pos.x = getClientRect().getSizeX() - 100;
-    buttonStaticDisplay.setLabel(&quot;On&quot;);
-    buttonStaticDisplay.setBounds(iRect(pos, pos + iXY(100, 15)));
-    add(&amp;buttonStaticDisplay);
+    if ( !buttonStaticDisplay )
+        buttonStaticDisplay = new Button( &quot;ButtonStaticDisplay&quot;);
+    buttonStaticDisplay-&gt;setLabel(&quot;On&quot;);
+    buttonStaticDisplay-&gt;setLocation(pos.x, pos.y);
+    buttonStaticDisplay-&gt;setSize( 100, 15);
+    buttonStaticDisplay-&gt;setNormalBorder();
+    add(buttonStaticDisplay);
     pos.y += yOffset;
 
     pos.x = 0;
     add( new Label( pos.x+2, pos.y+2, &quot;Power:&quot;, Color::white) );
 
     pos.x = getClientRect().getSizeX() - 100;
-    buttonPower.setLabel(&quot;Off&quot;);
-    buttonPower.setBounds(iRect(pos, pos + iXY(100, 15)));
-    add(&amp;buttonPower);
+    if ( !buttonPower )
+        buttonPower = new Button( &quot;ButtonPower&quot;);
+    
+    buttonPower-&gt;setLabel(&quot;Off&quot;);
+    buttonPower-&gt;setLocation(pos.x,pos.y);
+    buttonPower-&gt;setSize( 100, 15);
+    buttonPower-&gt;setNormalBorder();
+    add(buttonPower);
     pos.y += yOffset;
 
     // XXX hardcoded for now
@@ -317,80 +232,43 @@
 
     pos.x = 0;
 
-    // Unit images.
-    unit_regen_time = getUnitRegenTime(_unit_type_humvee);
-    sprintf(strBuf, &quot;SpahPanzer - Build Time: %01d:%02d&quot;, unit_regen_time / 60, unit_regen_time % 60);
-    addButtonBMPBordered(pos, &quot;pics/menus/vehicleSelectionView/scout.bmp&quot;, strBuf, bSelectScout);
-    abstractButtonHumvee.setBounds(iRect(pos, pos + iXY(48,48)));
-    add(&amp;abstractButtonHumvee);
-
-    pos.x += 48 + gapSpace;
-    unit_regen_time = getUnitRegenTime(_unit_type_valentine);
-    sprintf(strBuf, &quot;Manta - Build Time: %01d:%02d&quot;, unit_regen_time / 60, unit_regen_time % 60);
-    addButtonBMPBordered(pos, &quot;pics/menus/vehicleSelectionView/manta.bmp&quot;, strBuf, bSelectManta);
-    abstractButtonValentine.setBounds(iRect(pos, pos + iXY(48,48)));
-    add(&amp;abstractButtonValentine);
-
-    pos.x += 48 + gapSpace;
-    unit_regen_time = getUnitRegenTime(_unit_type_leopard);
-    sprintf(strBuf, &quot;Panther1 - Build Time: %01d:%02d&quot;, unit_regen_time / 60, unit_regen_time % 60);
-    addButtonBMPBordered(pos, &quot;pics/menus/vehicleSelectionView/panther1.bmp&quot;, strBuf, bSelectPanther1);
-    abstractButtonLeopard.setBounds(iRect(pos, pos + iXY(48,48)));
-    add(&amp;abstractButtonLeopard);
-
-    pos.x += 48 + gapSpace;
-    unit_regen_time = getUnitRegenTime(_unit_type_abrams);
-    sprintf(strBuf, &quot;Titan - Build Time: %01d:%02d&quot;, unit_regen_time / 60, unit_regen_time % 60);
-    addButtonBMPBordered(pos, &quot;pics/menus/vehicleSelectionView/titan.bmp&quot;, strBuf, bSelectTitan);
-    abstractButtonAbrams.setBounds(iRect(pos, pos + iXY(48,48)));
-    add(&amp;abstractButtonAbrams);
-
-    pos.x += 48 + gapSpace;
-    unit_regen_time = getUnitRegenTime(_unit_type_hammerhead);
-    sprintf(strBuf, &quot;Stinger - Build Time: %01d:%02d&quot;, unit_regen_time / 60, unit_regen_time % 60);
-    addButtonBMPBordered(pos, &quot;pics/menus/vehicleSelectionView/stinger.bmp&quot;, strBuf, bSelectStinger);
-    abstractButtonHammerhead.setBounds(iRect(pos, pos + iXY(48,48)));
-    add(&amp;abstractButtonHammerhead);
-
-    pos.x = 0;
-    pos.y += 48 + gapSpace;
-    unit_regen_time = getUnitRegenTime(_unit_type_lynx);
-    sprintf(strBuf, &quot;Bobcat - Build Time: %01d:%02d&quot;, unit_regen_time / 60, unit_regen_time % 60);
-    addButtonBMPBordered(pos, &quot;pics/menus/vehicleSelectionView/bobcat.bmp&quot;, strBuf, bSelectBobcat);
-    abstractButtonLynx.setBounds(iRect(pos, pos + iXY(48,48)));
-    add(&amp;abstractButtonLynx);
-
-    pos.x += 48 + gapSpace;
-    unit_regen_time = getUnitRegenTime(_unit_type_scorpion);
-    sprintf(strBuf, &quot;Wolf - Build Time: %01d:%02d&quot;, unit_regen_time / 60, unit_regen_time % 60);
-    addButtonBMPBordered(pos, &quot;pics/menus/vehicleSelectionView/wolf.bmp&quot;, strBuf, bSelectWolf);
-    abstractButtonScorpion.setBounds(iRect(pos, pos + iXY(48, 48)));
-    add(&amp;abstractButtonScorpion);
-
-    pos.x += 48 + gapSpace;
-    unit_regen_time = getUnitRegenTime(_unit_type_spahpanzer);
-    sprintf(strBuf, &quot;Bear - Build Time: %01d:%02d&quot;, unit_regen_time / 60, unit_regen_time % 60);
-    addButtonBMPBordered(pos, &quot;pics/menus/vehicleSelectionView/bear.bmp&quot;, strBuf, bSelectBear);
-    abstractButtonSpahpanzer.setBounds(iRect(pos, pos + iXY(48, 48)));
-    add(&amp;abstractButtonSpahpanzer);
-
-    pos.x += 48 + gapSpace;
-    unit_regen_time = getUnitRegenTime(_unit_type_m109);
-    sprintf(strBuf, &quot;Drake - Build Time: %01d:%02d&quot;, unit_regen_time / 60, unit_regen_time % 60);
-    addButtonBMPBordered(pos, &quot;pics/menus/vehicleSelectionView/drake.bmp&quot;, strBuf, bSelectDrake);
-    abstractButtonM109.setBounds(iRect(pos, pos + iXY(48, 48)));
-    add(&amp;abstractButtonM109);
-
-    pos.x += 48 + gapSpace;
-    unit_regen_time = getUnitRegenTime(_unit_type_archer);
-    sprintf(strBuf, &quot;Archer - Build Time: %01d:%02d&quot;, unit_regen_time / 60, unit_regen_time % 60);
-    addButtonBMPBordered(pos, &quot;pics/menus/vehicleSelectionView/archer.bmp&quot;, strBuf, bSelectArcher);
-    abstractButtonArcher.setBounds(iRect(pos, pos + iXY(48, 48)));
-    add(&amp;abstractButtonArcher);
-
-    pos.y += 48 + gapSpace * 4;
-    pos.x = 0;
-
+    Surface tempSurface;
+    
+    UnitSelectionButton *usb;
+    UnitProfile *uprofile;
+    unitImages.create(48, 48, UnitProfileInterface::getNumUnitTypes());
+    // XXX order by something?
+    for ( int ut=0; ut &lt; UnitProfileInterface::getNumUnitTypes(); ut++)
+    {
+        uprofile = UnitProfileInterface::getUnitProfile(ut);
+        
+        tempSurface.loadBMP(uprofile-&gt;imagefile.c_str());
+        unitImages.setFrame(ut);
+        tempSurface.blt(unitImages, 0, 0);
+        
+        usb = new UnitSelectionButton(this, uprofile-&gt;unitname.c_str(),
+                                      ut, pos.x, pos.y, tempSurface);
+        
+        add(usb);
+        
+        pos.x += 48 + gapSpace;
+        if ( pos.x+48 &gt; max.x-min.x )
+        {
+            pos.x = 0;
+            pos.y += 48 + gapSpace;
+        }
+    }
+    
+    if ( pos.x == 0 )
+    {
+        pos.y += gapSpace * 3; // and the one just added before = 4
+    }
+    else
+    {
+        pos.y += 48 + gapSpace * 4;
+        pos.x = 0;
+    }
+    
     unitProfileDataY = pos.y;
     pos.y += 74;
 
@@ -400,52 +278,15 @@
     //pos.y += yOffset;
 
     pos.x = (getClientRect().getSizeX() - 100) / 2;
-    buttonOk.setLabel(&quot;Ok&quot;);
-    buttonOk.setBounds(iRect(pos, pos + iXY(100, 15)));
-    add(&amp;buttonOk);
+    if ( !buttonOk )
+        buttonOk = new Button( &quot;buttonClose&quot;);
+    
+    buttonOk-&gt;setLabel(&quot;Close&quot;);
+    buttonOk-&gt;setLocation(pos.x,pos.y);
+    buttonOk-&gt;setSize(100, 15);
+    buttonOk-&gt;setNormalBorder();
+    add(buttonOk);
 
-    unitImages.create(48, 48, _MAX_UNIT_TYPES);
-
-    Surface tempSurface;
-    int i = 0;
-
-    tempSurface.loadBMP(&quot;pics/menus/vehicleSelectionView/manta.bmp&quot;);
-    unitImages.setFrame(i++);
-    tempSurface.blt(unitImages, 0, 0);
-    tempSurface.loadBMP(&quot;pics/menus/vehicleSelectionView/panther1.bmp&quot;);
-    unitImages.setFrame(i++);
-    tempSurface.blt(unitImages, 0, 0);
-    tempSurface.loadBMP(&quot;pics/menus/vehicleSelectionView/titan.bmp&quot;);
-    unitImages.setFrame(i++);
-    tempSurface.blt(unitImages, 0, 0);
-    tempSurface.loadBMP(&quot;pics/menus/vehicleSelectionView/stinger.bmp&quot;);
-    unitImages.setFrame(i++);
-    tempSurface.blt(unitImages, 0, 0);
-    tempSurface.loadBMP(&quot;pics/menus/vehicleSelectionView/bobcat.bmp&quot;);
-    unitImages.setFrame(i++);
-    tempSurface.blt(unitImages, 0, 0);
-    tempSurface.loadBMP(&quot;pics/menus/vehicleSelectionView/bear.bmp&quot;);
-    unitImages.setFrame(i++);
-    tempSurface.blt(unitImages, 0, 0);
-    tempSurface.loadBMP(&quot;pics/menus/vehicleSelectionView/archer.bmp&quot;);
-    unitImages.setFrame(i++);
-    tempSurface.blt(unitImages, 0, 0);
-    tempSurface.loadBMP(&quot;pics/menus/vehicleSelectionView/wolf.bmp&quot;);
-    unitImages.setFrame(i++);
-    tempSurface.blt(unitImages, 0, 0);
-    tempSurface.loadBMP(&quot;pics/menus/vehicleSelectionView/drake.bmp&quot;);
-    unitImages.setFrame(i++);
-    tempSurface.blt(unitImages, 0, 0);
-    tempSurface.loadBMP(&quot;pics/menus/vehicleSelectionView/scout.bmp&quot;);
-    unitImages.setFrame(i++);
-    tempSurface.blt(unitImages, 0, 0);
-    unitImages.setFrame(i++);
-    unitImages.fill(Color::red);
-    unitImages.setFrame(i++);
-    unitImages.fill(Color::green);
-    unitImages.setFrame(i++);
-    unitImages.fill(Color::blue);
-
     maxHitPoints = 1;
     maxAttackFactor = 1;
     maxAttackRange = 1;
@@ -455,7 +296,7 @@
     maxRegenTime = 1;
     getProfileData();
 
-    highlightedUnitType = 0;
+    highlightedUnitType = -1;
 
 } // end VehicleSelectionView::VehicleSelectionView
 
@@ -588,7 +429,14 @@
 //---------------------------------------------------------------------------
 const char *VehicleSelectionView::getUnitName(int unitType)
 {
-    if (unitType == _unit_type_valentine) {
+    UnitProfile *p = UnitProfileInterface::getUnitProfile(unitType);
+    if ( p )
+    {
+        return p-&gt;unitname.c_str();
+    }
+    return &quot;Invalid unit type.&quot;;
+    
+ /*   if (unitType == _unit_type_valentine) {
         return &quot;Manta&quot;;
     } else if (unitType == _unit_type_leopard) {
         return &quot;Panther 1&quot;;
@@ -615,6 +463,7 @@
     } else {
         return &quot;Invalid unit type.&quot;;
     }
+  */
 
 } // end VehicleSelectionView::getUnitName
 
@@ -622,16 +471,11 @@
 //---------------------------------------------------------------------------
 int VehicleSelectionView::getUnitRegenTime(unsigned short unitType)
 {
-    UnitProfile *profile;
-
-    if (unitType != _unit_type_null) {
-        profile = UnitProfileInterface::getUnitProfile(unitType);
+    UnitProfile *profile = UnitProfileInterface::getUnitProfile(unitType);
+    if ( profile )
         return (int) profile-&gt;regen_time;
-    }
 
-    assert(false);
     return 0;
-
 } // end VehicleSelectionView::getUnitRegenTime
 
 // mouseMove
@@ -640,9 +484,16 @@
 {
     GameTemplateView::mouseMove(prevPos, newPos);
 
-    if (highlightedButton &gt;= 0) {
-        showStatus(buttons[highlightedButton]-&gt;getToolTip());
-    } else {
+    if ( highlightedUnitType &gt;= 0 )
+    {
+        char strBuf[256];
+        int rtime = getUnitRegenTime(highlightedUnitType);
+        snprintf(strBuf, sizeof(strBuf)-1, &quot;%s - Build Time: %01d:%02d&quot;,
+                 getUnitName(highlightedUnitType), rtime / 60, rtime % 60);
+        showStatus(strBuf);
+    }
+    else
+    {
         showStatus(&quot;Select a unit for production&quot;);
     }
 
@@ -846,7 +697,7 @@
 //---------------------------------------------------------------------------
 void VehicleSelectionView::getProfileData()
 {
-    for (int i = 0; i &lt; _unit_type_null; i++) {
+    for (int i = 0; i &lt; UnitProfileInterface::getNumUnitTypes(); i++) {
         const UnitProfile *p = UnitProfileInterface::getUnitProfile(i);
 
         checkMaxValues(*p);
@@ -932,21 +783,21 @@
 void VehicleSelectionView::actionPerformed(mMouseEvent me)
 {
     if (me.getID() == mMouseEvent::MOUSE_EVENT_CLICKED) {
-        if (me.getSource(buttonStaticDisplay)) {
-            if (buttonStaticDisplay.getLabel() == &quot;On&quot;) {
-                buttonStaticDisplay.setLabel(&quot;Off&quot;);
+        if (me.getSource()==buttonStaticDisplay) {
+            if (buttonStaticDisplay-&gt;getLabel() == &quot;On&quot;) {
+                buttonStaticDisplay-&gt;setLabel(&quot;Off&quot;);
             } else {
-                buttonStaticDisplay.setLabel(&quot;On&quot;);
+                buttonStaticDisplay-&gt;setLabel(&quot;On&quot;);
             }
 
             VehicleSelectionView::displayMiniProductionStatus = !VehicleSelectionView::displayMiniProductionStatus;
         }
 
-        if (me.getSource(buttonPower)) {
-            if (buttonPower.getLabel() == &quot;On&quot;) {
-                buttonPower.setLabel(&quot;Off&quot;);
+        if (me.getSource()==buttonPower) {
+            if (buttonPower-&gt;getLabel() == &quot;On&quot;) {
+                buttonPower-&gt;setLabel(&quot;Off&quot;);
             } else {
-                buttonPower.setLabel(&quot;On&quot;);
+                buttonPower-&gt;setLabel(&quot;On&quot;);
             }
 
             vsvUnitGenOn = !vsvUnitGenOn;
@@ -954,51 +805,19 @@
             sendOutpostStatus();
         }
 
-        if (me.getSource(buttonOk)) {
+        if (me.getSource()==buttonOk) {
             Desktop::setVisibilityNoDoAnything(&quot;VehicleSelectionView&quot;, false);
             sendOutpostStatus();
             changeMade = false;
         }
-    } else if (me.getID() == mMouseEvent::MOUSE_EVENT_ENTERED) {
-        if (me.getSource(abstractButtonValentine)) {
-            highlightedUnitType = _unit_type_valentine;
-        }
-        if (me.getSource(abstractButtonLeopard)) {
-            highlightedUnitType = _unit_type_leopard;
-        }
-        if (me.getSource(abstractButtonAbrams)) {
-            highlightedUnitType = _unit_type_abrams;
-        }
-        if (me.getSource(abstractButtonHammerhead)) {
-            highlightedUnitType = _unit_type_hammerhead;
-        }
-        if (me.getSource(abstractButtonLynx)) {
-            highlightedUnitType = _unit_type_lynx;
-        }
-        if (me.getSource(abstractButtonM109)) {
-            highlightedUnitType = _unit_type_m109;
-        }
-        if (me.getSource(abstractButtonSpahpanzer)) {
-            highlightedUnitType = _unit_type_spahpanzer;
-        }
-        if (me.getSource(abstractButtonScorpion)) {
-            highlightedUnitType = _unit_type_scorpion;
-        }
-        if (me.getSource(abstractButtonHumvee)) {
-            highlightedUnitType = _unit_type_humvee;
-        }
-        if (me.getSource(abstractButtonArcher)) {
-            highlightedUnitType = _unit_type_archer;
-        }
     }
-
 } // end VehicleSelectionView::actionPerformed
 
 // setPowerOn
 //---------------------------------------------------------------------------
 void VehicleSelectionView::setPowerOn()
 {
-    buttonPower.setLabel(&quot;On&quot;);
+    buttonPower-&gt;setLabel(&quot;On&quot;);
 
 } // end VehicleSelectionView::setPowerOn
 
@@ -1006,7 +825,7 @@
 //---------------------------------------------------------------------------
 void VehicleSelectionView::setPowerOff()
 {
-    buttonPower.setLabel(&quot;Off&quot;);
+    buttonPower-&gt;setLabel(&quot;Off&quot;);
 
 } // end VehicleSelectionView::setPowerOff
 

Modified: trunk/netpanzer/src/NetPanzer/Views/Game/VehicleSelectionView.hpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Views/Game/VehicleSelectionView.hpp	2008-04-27 15:01:39 UTC (rev 1026)
+++ trunk/netpanzer/src/NetPanzer/Views/Game/VehicleSelectionView.hpp	2008-05-04 14:05:21 UTC (rev 1027)
@@ -22,7 +22,7 @@
 #include &quot;Views/Components/View.hpp&quot;
 #include &quot;GameTemplateView.hpp&quot;
 #include &quot;Interfaces/UnitProfileInterface.hpp&quot;
-#include &quot;Views/Components/AbstractButton.hpp&quot;
+#include &quot;Views/Components/Component.hpp&quot;
 #include &quot;Views/Components/Button.hpp&quot;
 
 
@@ -62,23 +62,13 @@
 class VehicleSelectionView : public GameTemplateView
 {
 private:
+    friend class UnitSelectionButton;
     int highlightedUnitType;
 
-    AbstractButton abstractButtonValentine;
-    AbstractButton abstractButtonLeopard;
-    AbstractButton abstractButtonAbrams;
-    AbstractButton abstractButtonHammerhead;
-    AbstractButton abstractButtonLynx;
-    AbstractButton abstractButtonM109;
-    AbstractButton abstractButtonSpahpanzer;
-    AbstractButton abstractButtonScorpion;
-    AbstractButton abstractButtonHumvee;
-    AbstractButton abstractButtonArcher;
+    static Button * buttonStaticDisplay;
+    static Button * buttonPower;
+    static Button * buttonOk;
 
-    static Button buttonStaticDisplay;
-    static Button buttonPower;
-    static Button buttonOk;
-
     int maxHitPoints;
     int maxAttackFactor;
     int maxAttackRange;

Modified: trunk/netpanzer/src/NetPanzer/Views/MainMenu/Multi/FlagSelectionView.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Views/MainMenu/Multi/FlagSelectionView.cpp	2008-04-27 15:01:39 UTC (rev 1026)
+++ trunk/netpanzer/src/NetPanzer/Views/MainMenu/Multi/FlagSelectionView.cpp	2008-05-04 14:05:21 UTC (rev 1027)
@@ -22,10 +22,45 @@
 #include &quot;Views/GameViewGlobals.hpp&quot;
 #include &quot;Util/Exception.hpp&quot;
 #include &quot;Interfaces/GameConfig.hpp&quot;
+#include &quot;Views/Components/Button.hpp&quot;
+#include &quot;Views/Components/MouseEvent.hpp&quot;
+#include &quot;2D/Color.hpp&quot;
 
-Surface playerFlag;
-int     playerFlagSelected = 0;
+unsigned char FlagSelectionView::playerFlagSelected = 0;
 
+class FlagButton : public Button
+{
+protected:
+    unsigned char fcode;
+public:
+    FlagButton(int x, int y, Surface &amp;s, unsigned char flagCode)
+        : Button(&quot;flag&quot;)
+    {
+        setLocation(x, y);
+        setSize(s.getWidth(), s.getHeight());
+        bimage.create(s.getWidth(), s.getHeight(), 1);
+        s.blt(bimage, 0, 0);
+        fcode = flagCode;
+        
+        setExtraBorder();
+        borders[1][0] = Color::red;
+        borders[1][1] = Color::darkRed;
+        borders[2][0] = Color::green;
+        borders[2][1] = Color::darkGreen;
+    }
+    
+    void actionPerformed( const mMouseEvent &amp;e)
+    {
+        if ( e.getID() == mMouseEvent::MOUSE_EVENT_CLICKED )
+        {
+            FlagSelectionView::setSelectedFlag(fcode);
+        }
+        else
+        {
+            Button::actionPerformed(e);
+        }
+    }
+};
 
 // FlagSelectionView
 //---------------------------------------------------------------------------
@@ -43,22 +78,8 @@
     moveTo(bodyTextRect.min.x + bodyTextRect.getSizeX() / 2 + 10 + 30,
            bodyTextRect.min.y + 50);
 
-    // Load the flag images.
-    //flags.loadAllBMPInDirectory(&quot;pics/flags/&quot;);
-
     resizeClientArea(bodyTextRect.getSizeX() / 2 - 10 - 30, 108);
 
-    // Define the scrollBar fot this view.
-    //scrollBar = new ScrollBar(HORIZONTAL, 0, 1, 0, flags.getFrameCount());
-    //if (scrollBar == 0)
-    //{
-    //	throw Exception(&quot;ERROR: Unable to allocate scrollBar.&quot;);
-    //}
-    //
-    //scrollBar-&gt;setViewableAmount(getClientRect().getSizeX() / flags.getWidth());
-    //
-    //add(scrollBar);
-
     init();
 
 } // end FlagSelectionView::FlagSelectionView
@@ -67,39 +88,39 @@
 //---------------------------------------------------------------------------
 void FlagSelectionView::init()
 {
-    if (playerFlag.loadAllBMPInDirectory(&quot;pics/flags/&quot;) &lt;= 0)
+    if (flags.loadAllBMPInDirectory(&quot;pics/flags/&quot;) &lt;= 0)
         throw Exception(&quot;Couldn't find flags for menu in '%s'.&quot;,
                         &quot;pics/flags/&quot;);
-    playerFlag.mapFromPalette(&quot;netp&quot;);
+    flags.mapFromPalette(&quot;netp&quot;);
 
-    iXY flagStartOffset(BORDER_SPACE, BORDER_SPACE * 2 + playerFlag.getHeight());
+    iXY flagStartOffset(BORDER_SPACE, BORDER_SPACE * 2 + flags.getHeight());
 
-    int xOffset = playerFlag.getWidth() + 2;
-    int yOffset = playerFlag.getHeight() + 2;
+    int xOffset = flags.getWidth() + 2;
+    int yOffset = flags.getHeight() + 2;
 
     int x = flagStartOffset.x;
     int y = flagStartOffset.y;
 
-    for (unsigned int i = 0; i &lt; playerFlag.getNumFrames(); i++) {
-        playerFlag.setFrame(i);
-        //playerFlag.drawButtonBorder(Color::white, Color::gray64);
+    for (unsigned int i = 0; i &lt; flags.getNumFrames(); i++) {
+        flags.setFrame(i);
 
-        addButtonSurfaceSingle(iXY(x, y), playerFlag, &quot;&quot;, 0);
+        add( new FlagButton( x, y, flags, i) );
 
         x += xOffset;
 
-        if (x &gt; flagStartOffset.x + getClientRect().getSizeX() - BORDER_SPACE - (int)playerFlag.getWidth()) {
+        if (x &gt; flagStartOffset.x + getClientRect().getSizeX() - BORDER_SPACE - (int)flags.getWidth()) {
             x = flagStartOffset.x;
             y += yOffset;
         }
     }
 
-    playerFlag.setFrame(0);
     if(gameconfig-&gt;playerflag.isDefaultValue()) {
         // new player, no flag...
-        gameconfig-&gt;playerflag=rand()%playerFlag.getNumFrames();
+        gameconfig-&gt;playerflag=rand()%flags.getNumFrames();
     }
+    
     playerFlagSelected = gameconfig-&gt;playerflag;
+    flags.setFrame(playerFlagSelected);
 } // end FlagSelectionView::init
 
 // doDraw
@@ -114,53 +135,11 @@
     int CHAR_XPIX = 8; // XXX hardcoded
     clientArea.bltStringShadowed(
             BORDER_SPACE,
-            BORDER_SPACE + (playerFlag.getHeight() - Surface::getFontHeight()) / 2,
+            BORDER_SPACE + (flags.getHeight() - Surface::getFontHeight()) / 2,
             strBuf, windowTextColor, windowTextColorShadow);
-    playerFlag.setFrame(playerFlagSelected);
-    playerFlag.blt(clientArea, BORDER_SPACE + strlen(strBuf) * CHAR_XPIX + BORDER_SPACE, BORDER_SPACE);
+    flags.setFrame(playerFlagSelected);
+    flags.blt(clientArea, BORDER_SPACE + strlen(strBuf) * CHAR_XPIX + BORDER_SPACE, BORDER_SPACE);
 
-    //char strBuf[256];
-    //sprintf(strBuf, &quot;%d&quot;, scrollBar-&gt;getValue());
-    //clientArea.bltStringCenter(strBuf, Color::white);
-    //
-    //// The -12 is a cheeze hack to take into account the scrollBar minor axis size.
-    //int x;
-    //int y = (clientArea.getHeight() - flags.getHeight() - 12) / 2;
-    //
-    //int minFlag = scrollBar-&gt;getValue();
-    //int maxFlag = scrollBar-&gt;getValue() + scrollBar-&gt;getViewableAmount();
-    //
-    //if (maxFlag &gt; flags.getFrameCount() - 1)
-    //{
-    //	assert(false);
-    //	maxFlag = flags.getFrameCount() - 1;
-    //}
-    //
-    ////for (int i = 0; i &lt; flags.getFrameCount(); i++)
-    //
-    //for (int i = minFlag; i &lt; maxFlag; i++)
-    //{
-    //	x = flags.getWidth() * (i - minFlag);
-    //
-    //	flags.setFrame(i);
-    //	flags.blt(clientArea, x, y);
-    //}
-
     View::doDraw(viewArea, clientArea);
 
 } // end FlagSelectionView::doDraw
-
-// lMouseUp
-//--------------------------------------------------------------------------
-int FlagSelectionView::lMouseUp(const iXY &amp;downPos, const iXY &amp;upPos)
-{
-    View::lMouseUp(downPos, upPos);
-
-    const int buttonsBeforeFlags = 0;
-
-    if (getPrevPressedButton() &gt;= buttonsBeforeFlags &amp;&amp; getPrevPressedButton() &lt; (int)playerFlag.getNumFrames() + buttonsBeforeFlags) {
-        playerFlagSelected = getPrevPressedButton() - buttonsBeforeFlags;
-    }
-
-    return true;
-} // end FlagSelectionViewlMouseUp

Modified: trunk/netpanzer/src/NetPanzer/Views/MainMenu/Multi/FlagSelectionView.hpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Views/MainMenu/Multi/FlagSelectionView.hpp	2008-04-27 15:01:39 UTC (rev 1026)
+++ trunk/netpanzer/src/NetPanzer/Views/MainMenu/Multi/FlagSelectionView.hpp	2008-05-04 14:05:21 UTC (rev 1027)
@@ -20,31 +20,35 @@
 
 #include &quot;Views/MainMenu/RMouseHackView.hpp&quot;
 #include &quot;2D/Surface.hpp&quot;
-#include &quot;Views/Components/ScrollBar.hpp&quot;
 
-extern Surface playerFlag;
-extern int     playerFlagSelected;
-
 //---------------------------------------------------------------------------
 class FlagSelectionView : public RMouseHackView
 {
 private:
-    ScrollBar *scrollBar;
     Surface    flags;
-
+    static unsigned char playerFlagSelected;
+    
     enum { BORDER_SPACE = 4 };
 
 public:
     FlagSelectionView();
     virtual ~FlagSelectionView()
+    {}
+    
+    static void setSelectedFlag(unsigned char code)
     {
-        delete scrollBar;
+        playerFlagSelected = code;
     }
+    
+    static unsigned char getSelectedFlag()
+    {
+        return playerFlagSelected;
+    }
 
     virtual void doDraw(Surface &amp;windowArea, Surface &amp;clientArea);
-    virtual int  lMouseUp(const iXY &amp;downPos, const iXY &amp;upPos);
-    virtual void drawBorder(Surface&amp; )
-    {}
+    //virtual int  lMouseUp(const iXY &amp;downPos, const iXY &amp;upPos);
+    //virtual void drawBorder(Surface&amp; )
+    //{}
 
     void init();
 }

Deleted: trunk/netpanzer/src/NetPanzer/Views/MainMenu/Multi/GetSessionHostView.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Views/MainMenu/Multi/GetSessionHostView.cpp	2008-04-27 15:01:39 UTC (rev 1026)
+++ trunk/netpanzer/src/NetPanzer/Views/MainMenu/Multi/GetSessionHostView.cpp	2008-05-04 14:05:21 UTC (rev 1027)
@@ -1,335 +0,0 @@
-/*
-Copyright (C) 1998 Pyrosoft Inc. (www.pyrosoftgames.com), Matthew Bogue
- 
-This program is free software; you can redistribute it and/or modify
-it under the terms of the GNU General Public License as published by
-the Free Software Foundation; either version 2 of the License, or
-(at your option) any later version.
- 
-This program is distributed in the hope that it will be useful,
-but WITHOUT ANY WARRANTY; without even the implied warranty of
-MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-GNU General Public License for more details.
- 
-You should have received a copy of the GNU General Public License
-along with this program; if not, write to the Free Software
-Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
-*/
-#include &lt;config.h&gt;
-
-#include &quot;GetSessionHostView.hpp&quot;
-#include &quot;Views/Components/Desktop.hpp&quot;
-#include &quot;Util/TimerInterface.hpp&quot;
-#include &quot;Views/GameViewGlobals.hpp&quot;
-
-#include &quot;Interfaces/Client.hpp&quot;
-
-// cHostCompareName
-//---------------------------------------------------------------------------
-int cHostCompareName(const void *elem1, const void *elem2)
-{
-    cHost *e1;
-    cHost *e2;
-
-    e1 = (cHost *) elem1;
-    e2 = (cHost *) elem2;
-
-    return strcmp(e1-&gt;getName(), e2-&gt;getName());
-
-} // end cHostCompareName
-
-// GetSessionHostView
-//---------------------------------------------------------------------------
-GetSessionHostView::GetSessionHostView() : View()
-{
-    setSearchName(&quot;GetSessionHostView&quot;);
-    setTitle(&quot;Select Session Host&quot;);
-    setSubTitle(&quot;&quot;);
-
-    setAllowResize(false);
-    setAllowMove(false);
-    //setDisplayStatusBar(true);
-    setVisible(false);
-
-    moveTo(bodyTextRect.min.x, bodyTextRect.min.y + 190);
-    resizeClientArea(bodyTextRect.getSizeX(), 158);
-    //moveTo(68, 204);
-    //resize(610 - 68, 161);
-
-    //setScrollBar(true);
-
-    viewableItemCount =  0;
-    highlightedItem   = -1;
-    selectedItem      = -1;
-
-    maxYOffset = 0;
-
-    // Define the scrollBar fot this view.
-    //scrollBar = new ScrollBar(VERTICAL, 0, 1, 0, 100);
-
-    //add(scrollBar);
-
-    maxViewableItems = getClientRect().getSizeY() / (TEXT_GAP_SPACE + Surface::getFontHeight()) - 1;
-    topViewableItem  = 0;
-
-    //iXY size(20, 20);
-    //iXY pos(getClientRect().getSizeX() - size.x, 0);
-
-    //upButton.setLabel(&quot;+&quot;);
-    //upButton.setBounds(iRect(pos, pos + size));
-    //add(&amp;upButton);
-    //
-    //pos = iXY(getClientRect().getSizeX() - size.x, getClientRect().getSizeY() - size.y);
-    //downButton.setLabel(&quot;-&quot;);
-    //downButton.setBounds(iRect(pos, pos + size));
-    //add(&amp;downButton);
-
-} // end GetSessionHostView constructor
-
-// doDraw
-//---------------------------------------------------------------------------
-void GetSessionHostView::doDraw(Surface &amp;viewArea, Surface &amp;clientArea)
-{
-    static float curGroupTime = 0.0f;
-
-    //iRect r(getViewRect());
-    //viewArea.bltLookup(r, Palette::darkGray256.getColorArray());
-
-    if ((curGroupTime += TimerInterface::getTimeSlice()) &gt; 5.0f) {
-        updateHostList();
-        curGroupTime = 0.0f;
-    }
-
-
-    drawHostList(clientArea);
-
-    //if (hosts.size() &gt; 0)
-    //{
-    //	clientArea.bltStringCenter(hosts[0].getName(), Color::white);
-    //}
-
-    //char strBuf[256];
-    //sprintf(strBuf, &quot;%d&quot;, selectedItem);
-    //clientArea.bltStringCenter(strBuf, Color::white);
-
-    View::doDraw(viewArea, clientArea);
-
-} // end GetSessionHostView::doDraw
-
-// drawHostList
-//---------------------------------------------------------------------------
-void GetSessionHostView::drawHostList(Surface &amp;dest)
-{
-    char host_info_str[256];
-    int curIndex = 0;
-    int color;
-
-    Surface tempSurface( getClientRect().getSizeX() - 2,
-                         TEXT_GAP_SPACE + Surface::getFontHeight(),
-                         1 );
-
-    tempSurface.fill(Color::darkGreen);
-    sprintf( host_info_str, &quot;%-24s %-24s %-12s %10s&quot;, &quot;Host&quot;,
-             &quot;Map&quot;,
-             &quot;Game Type&quot;,
-             &quot;Players&quot;   );
-
-    tempSurface.bltString( 4, 1, host_info_str, Color::white );
-    tempSurface.blt(dest, 0, 1 );
-
-    curIndex++;
-
-    for (size_t i = 0; i &lt; hosts.size(); i++) {
-        sprintf( host_info_str, &quot;%-24s %-24s %-15s %4d/%-4d&quot;, hosts[i].name,
-                 hosts[i].map,
-                 hosts[i].game_type,
-                 hosts[i].current_players,
-                 hosts[i].max_players  );
-
-
-        color = Color::white;
-
-        if (i == (size_t) highlightedItem) {
-            color = Color::red;
-        } else if (i == (size_t) selectedItem) {
-            color = Color::green;
-        }
-
-        dest.bltString(4, 6 + curIndex * (TEXT_GAP_SPACE + Surface::getFontHeight()), host_info_str, color);
-
-        curIndex++;
-    }
-    //for (int i = topViewableItem; i &lt; topViewableItem + maxViewableItems; i++)
-
-    /*
-    	int i;
-     
-    	int shit = 0;
-    	int color;
-    	for (i = scrollBar.getValue(); i &lt; scrollBar.getValue() + viewableItemCount; i++)
-    	{
-    		iXY offset;
-    		offset.x = 2;
-    		offset.y = 2 + shit * (CHAR_YPIX + ITEM_GAP_SPACE);
-    		
-    		// Get a color for the item.
-    		if (i == selectedItem)
-    		{
-    			color = Color::green;
-    		} else
-    		if (i == highlightedItem)
-    		{
-    			color = Color::red;
-    		} else
-    		{
-    			color = Color::white;
-    		}
-    		
-    		// Display the name of this shape.
-    		dest.bltString(offset.x, offset.y, hosts[i].getName(), color);
-     
-    		shit++;
-    	}
-    */
-} // end GetSessionHostView::drawHostList
-
-// updateHostList
-//---------------------------------------------------------------------------
-void GetSessionHostView::updateHostList()
-{
-#if 0
-    int num_games;
-    //char game_name[80];
-    // XXX
-    // HRESULT hr;
-
-    //SessionList session_list;
-    /*
-    //bug#15+
-    hr =	EnumerateGames( gapp.hwndApp );
-
-    if(hr == DPERR_USERCANCEL)
-     {
-    //WE NEED TO BACK OUT TO SELECTSESSIONTYPEVIEW if this
-        //happens
-    Desktop::setVisibilityAllWindows(false);
-    Desktop::setVisibility(&quot;GetSessionView&quot;, true);
-     }
-
-    if((hr == DPERR_EXCEPTION) || (hr == DPERR_GENERIC))
-     {
-     //WE NEED TO TELL THEM THAT A WEIRD DPLAY ERROR OCCURRED
-     //AND BUMP THEM OUT TO HOST OR JOIN MENU
-    Desktop::toggleVisibility(&quot;DirectPlayErrorExceptionView&quot;);
-     }
-    	
-    num_games = GetNumGames();
-    */
-
-    Desktop::setVisibilityAllWindows(false);
-    Desktop::setVisibility(&quot;GetSessionView&quot;, true);
-
-    num_games = session_list.getSize();
-
-
-    // Hack to allow only 10 sessions.
-    if (num_games &gt; 10) {
-        num_games = 10;
-    }
-
-    char curHostName[256];
-    if (hosts.size() &gt; 0 &amp;&amp; selectedItem != -1 &amp;&amp; selectedItem &lt; (int) hosts.size()) {
-        sprintf(curHostName, &quot;%s&quot;, hosts[selectedItem].getName());
-    } else {
-        strcpy(curHostName, &quot;&quot;);
-    }
-
-    hosts.clear();
-
-    for (int num = 0; num &lt; num_games; num++) {
-        hosts.resize(hosts.size() + 1);
-        sprintf(hosts[hosts.size() - 1].name, &quot;%s&quot;, session_list[ num ].name );
-        sprintf(hosts[hosts.size() - 1].map, &quot;%s&quot;, session_list[ num ].map );
-        sprintf(hosts[hosts.size() - 1].game_type, &quot;%s&quot;, session_list[ num ].game_type );
-        hosts[hosts.size() - 1].current_players = session_list[ num ].current_players;
-        hosts[hosts.size() - 1].max_players = session_list[ num ].max_players;
-
-    }
-
-    // See if the host name still exists, if so, remap the index to selectedItem.
-    selectedItem = -1;
-
-    for (int num = 0; num &lt; num_games; num++) {
-        if (strcasecmp(hosts[num].getName(), curHostName) == 0) {
-            selectedItem = num;
-        }
-    }
-
-    //int maxViewableItems = getClientRect().getSize().y / (CHAR_YPIX + ITEM_GAP_SPACE);
-    //
-    //viewableItemCount = (hosts.size() &lt; maxViewableItems) ? hosts.size() : maxViewableItems;
-    /*
-    	scrollBar.setViewableAmount(viewableItemCount);
-    	scrollBar.setItemCount(hosts.size());
-    	scrollBar.setItemsSize(CHAR_YPIX + ITEM_GAP_SPACE);
-    */
-#endif
-} // end GetSessionHostView::updateHostList
-
-// findItemContaining
-//---------------------------------------------------------------------------
-int GetSessionHostView::findItemContaining(const iXY &amp;pos)
-{
-    int curIndex = 0;
-
-    int length = getClientRect().getSizeX() - 12;
-
-    for (size_t i = 0; i &lt; hosts.size(); i++) {
-        iXY tempPos;
-
-        tempPos.x = 4;
-        tempPos.y = 6 + curIndex * (TEXT_GAP_SPACE + Surface::getFontHeight()) + (TEXT_GAP_SPACE + Surface::getFontHeight());
-
-        iRect r(tempPos.x, tempPos.y, tempPos.x + length, tempPos.y + TEXT_GAP_SPACE + Surface::getFontHeight());
-
-        if (r.contains(pos)) {
-            highlightedItem = i;
-
-            return i;
-        }
-
-        curIndex++;
-    }
-
-    return -1;
-
-} // end GetSessionHostView::findItemContaining
-
-// lMouseDown
-//---------------------------------------------------------------------------
-void GetSessionHostView::lMouseDown(const iXY &amp;pos)
-{
-    selectedItem = findItemContaining(pos);
-
-    if ((selectedItem != -1) &amp;&amp; (selectedItem &lt; (int) hosts.size())) {
-        // TODO
-    }
-
-} // end GetSessionHostView::lMouseDown
-
-// actionPerformed
-//---------------------------------------------------------------------------
-void GetSessionHostView::actionPerformed(mMouseEvent me)
-{
-    if (me.getID() == mMouseEvent::MOUSE_EVENT_EXITED) {
-        highlightedItem = -1;
-    }
-
-} // end GetSessionHostView::actionPerformed
-
-// mouseMove
-//---------------------------------------------------------------------------
-void GetSessionHostView::mouseMove(const iXY&amp;, const iXY &amp;newPos)
-{
-    highlightedItem = findItemContaining(newPos);
-} // end GetSessionHostView::mouseMove

Deleted: trunk/netpanzer/src/NetPanzer/Views/MainMenu/Multi/GetSessionHostView.hpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Views/MainMenu/Multi/GetSessionHostView.hpp	2008-04-27 15:01:39 UTC (rev 1026)
+++ trunk/netpanzer/src/NetPanzer/Views/MainMenu/Multi/GetSessionHostView.hpp	2008-05-04 14:05:21 UTC (rev 1027)
@@ -1,96 +0,0 @@
-/*
-Copyright (C) 1998 Pyrosoft Inc. (www.pyrosoftgames.com), Matthew Bogue
- 
-This program is free software; you can redistribute it and/or modify
-it under the terms of the GNU General Public License as published by
-the Free Software Foundation; either version 2 of the License, or
-(at your option) any later version.
- 
-This program is distributed in the hope that it will be useful,
-but WITHOUT ANY WARRANTY; without even the implied warranty of
-MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-GNU General Public License for more details.
- 
-You should have received a copy of the GNU General Public License
-along with this program; if not, write to the Free Software
-Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
-*/
-#ifndef __GetSessionHostView_hpp__
-#define __GetSessionHostView_hpp__
-
-#include &lt;vector&gt;
-
-#include &quot;Views/Components/View.hpp&quot;
-#include &quot;2D/Surface.hpp&quot;
-#include &quot;Views/Components/ScrollBar.hpp&quot;
-
-// Used for sorting a shape.
-int cHostCompareName(const void *elem1, const void *elem2);
-
-//---------------------------------------------------------------------------
-class cHost
-{
-public:
-    cHost()
-    {}
-    ~cHost()
-    {}
-
-    inline const char *getName()
-    {
-        return name;
-    }
-
-public:
-    char name[64];
-    char map[64];
-    char game_type[64];
-    int  current_players;
-    int  max_players;
-}
-; // end cHost
-
-
-//---------------------------------------------------------------------------
-class GetSessionHostView : public View
-{
-private:
-    std::vector&lt;cHost&gt; hosts;
-
-    int viewableItemCount;
-    int highlightedItem;
-    int selectedItem;
-    enum { ITEM_GAP_SPACE = 4 };
-
-    int findItemContaining(const iXY &amp;pos);
-
-    int  maxYOffset;
-
-    ScrollBar *scrollBar;
-
-    enum { TEXT_GAP_SPACE = 2 };
-
-    Button upButton;
-    Button downButton;
-
-    int maxViewableItems;
-    int topViewableItem;
-
-public:
-    GetSessionHostView();
-    virtual ~GetSessionHostView()
-    {
-        delete scrollBar;
-    }
-
-
-    void drawHostList(Surface &amp;dest);
-    void updateHostList();
-
-    virtual void doDraw(Surface &amp;windowArea, Surface &amp;clientArea);
-    virtual void lMouseDown(const iXY &amp;pos);
-    virtual void actionPerformed(mMouseEvent me);
-    virtual void mouseMove(const iXY &amp; prevPos, const iXY &amp;newPos);
-}; // end GetSessionHostView
-
-#endif // end __GetSessionHostView_hpp__

Modified: trunk/netpanzer/src/NetPanzer/Views/MainMenu/Multi/GetSessionView.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Views/MainMenu/Multi/GetSessionView.cpp	2008-04-27 15:01:39 UTC (rev 1026)
+++ trunk/netpanzer/src/NetPanzer/Views/MainMenu/Multi/GetSessionView.cpp	2008-05-04 14:05:21 UTC (rev 1027)
@@ -18,7 +18,6 @@
 #include &lt;config.h&gt;
 
 #include &quot;GetSessionView.hpp&quot;
-#include &quot;GetSessionHostView.hpp&quot;
 #include &quot;Views/Components/Desktop.hpp&quot;
 #include &quot;Interfaces/GameConfig.hpp&quot;
 #include &quot;Interfaces/GameManager.hpp&quot;

Modified: trunk/netpanzer/src/NetPanzer/Views/MainMenu/Multi/HostJoinTemplateView.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Views/MainMenu/Multi/HostJoinTemplateView.cpp	2008-04-27 15:01:39 UTC (rev 1026)
+++ trunk/netpanzer/src/NetPanzer/Views/MainMenu/Multi/HostJoinTemplateView.cpp	2008-05-04 14:05:21 UTC (rev 1027)
@@ -83,7 +83,7 @@
         return;
 
     // Set the player flag.
-    gameconfig-&gt;playerflag = playerFlagSelected;
+    gameconfig-&gt;playerflag = FlagSelectionView::getSelectedFlag();
 
     // Close all menu views.
     Desktop::setVisibilityAllWindows(false);

Modified: trunk/netpanzer/src/NetPanzer/Views/MainMenu/Multi/HostOptionsView.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Views/MainMenu/Multi/HostOptionsView.cpp	2008-04-27 15:01:39 UTC (rev 1026)
+++ trunk/netpanzer/src/NetPanzer/Views/MainMenu/Multi/HostOptionsView.cpp	2008-05-04 14:05:21 UTC (rev 1027)
@@ -522,23 +522,23 @@
 //---------------------------------------------------------------------------
 void HostOptionsView::actionPerformed(mMouseEvent me)
 {
-    if (me.getSource(checkPublic)) {
+    if (me.getSource()==&amp;checkPublic) {
         if ( getVisible() ) {
             gameconfig-&gt;publicServer = checkPublic.getState();
         }
-    } else if (me.getSource(checkPowerUp)) {
+    } else if (me.getSource()==&amp;checkPowerUp) {
         if ( getVisible() ) {
             gameconfig-&gt;powerups = checkPowerUp.getState();
         }
-    } else if (me.getSource(choiceWindSpeed)) {
+    } else if (me.getSource()==&amp;choiceWindSpeed) {
         windSpeed = choiceWindSpeed.getSelectedIndex();
 
         updateWindSpeedString();
-    } else if (me.getSource(choiceCloudCoverage)) {
+    } else if (me.getSource()==&amp;choiceCloudCoverage) {
         cloudCoverageCount = choiceCloudCoverage.getSelectedIndex();
 
         updateGameConfigCloudCoverage();
-    } else if (me.getSource(choiceGameType)) {
+    } else if (me.getSource()==&amp;choiceGameType) {
         if ( getVisible() ) {
             gameType = choiceGameType.getSelectedIndex();
 

Modified: trunk/netpanzer/src/NetPanzer/Views/MainMenu/Options/SoundView.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Views/MainMenu/Options/SoundView.cpp	2008-04-27 15:01:39 UTC (rev 1026)
+++ trunk/netpanzer/src/NetPanzer/Views/MainMenu/Options/SoundView.cpp	2008-05-04 14:05:21 UTC (rev 1027)
@@ -109,12 +109,13 @@
     
     x = xTextStart;
     add( new Label( x, y, &quot;Sound Status&quot;, Color::white) );
-    checkBoxSoundEnabled.setLabel(gameconfig-&gt;enablesound?&quot;Enabled&quot;:&quot;Disabled&quot;);
-    checkBoxSoundEnabled.setState(gameconfig-&gt;enablesound);
+    checkBoxSoundEnabled = new CheckBox();
+    checkBoxSoundEnabled-&gt;setLabel(gameconfig-&gt;enablesound?&quot;Enabled&quot;:&quot;Disabled&quot;);
+    checkBoxSoundEnabled-&gt;setState(gameconfig-&gt;enablesound);
     x += Surface::getTextLength(&quot;Sound Status: &quot;);
-    checkBoxSoundEnabled.setLocation(x, y-2);
-    checkBoxSoundEnabled.setStateChangedCallback(this);
-    add(&amp;checkBoxSoundEnabled);
+    checkBoxSoundEnabled-&gt;setLocation(x, y-2);
+    checkBoxSoundEnabled-&gt;setStateChangedCallback(this);
+    add(checkBoxSoundEnabled);
     y += yOffset;
 
     x = xTextStart;
@@ -128,12 +129,13 @@
     y += yOffset; // add a little separation
     x = xTextStart;
     add( new Label( x, y, &quot;Music Status&quot;, Color::white) );
-    checkBoxMusicEnabled.setLabel(gameconfig-&gt;enablemusic?&quot;Enabled&quot;:&quot;Disabled&quot;);
-    checkBoxMusicEnabled.setState(gameconfig-&gt;enablemusic);
+    checkBoxMusicEnabled = new CheckBox();
+    checkBoxMusicEnabled-&gt;setLabel(gameconfig-&gt;enablemusic?&quot;Enabled&quot;:&quot;Disabled&quot;);
+    checkBoxMusicEnabled-&gt;setState(gameconfig-&gt;enablemusic);
     x += Surface::getTextLength(&quot;Music Status: &quot;);
-    checkBoxMusicEnabled.setLocation(x, y-2);
-    checkBoxMusicEnabled.setStateChangedCallback(this);
-    add(&amp;checkBoxMusicEnabled);
+    checkBoxMusicEnabled-&gt;setLocation(x, y-2);
+    checkBoxMusicEnabled-&gt;setStateChangedCallback(this);
+    add(checkBoxMusicEnabled);
     y += yOffset;
 
     x = xTextStart;
@@ -209,32 +211,32 @@
 
 void SoundView::stateChanged(Component* source)
 {
-    if (source == &amp;checkBoxSoundEnabled) {
-        gameconfig-&gt;enablesound = checkBoxSoundEnabled.getState();
+    if (source == checkBoxSoundEnabled) {
+        gameconfig-&gt;enablesound = checkBoxSoundEnabled-&gt;getState();
         
         delete sound;
 
-        if ( checkBoxSoundEnabled.getState() ) {
+        if ( checkBoxSoundEnabled-&gt;getState() ) {
             sound = new SDLSound();
-            checkBoxSoundEnabled.setLabel(&quot;Enabled&quot;);
+            checkBoxSoundEnabled-&gt;setLabel(&quot;Enabled&quot;);
             if ( GameControlRulesDaemon::getGameState() ) {
                 sound-&gt;playTankIdle();
             }
-            if ( checkBoxMusicEnabled.getState() )
+            if ( checkBoxMusicEnabled-&gt;getState() )
                 sound-&gt;playMusic(&quot;sound/music/&quot;);
         } else {
             sound = new DummySound();
-            checkBoxSoundEnabled.setLabel(&quot;Disabled&quot;);
+            checkBoxSoundEnabled-&gt;setLabel(&quot;Disabled&quot;);
         }
-    } else if (source == &amp;checkBoxMusicEnabled) {
-        gameconfig-&gt;enablemusic = checkBoxMusicEnabled.getState();
+    } else if (source == checkBoxMusicEnabled) {
+        gameconfig-&gt;enablemusic = checkBoxMusicEnabled-&gt;getState();
         
-        if ( checkBoxMusicEnabled.getState() ) {
+        if ( checkBoxMusicEnabled-&gt;getState() ) {
             sound-&gt;playMusic(&quot;sound/music/&quot;);
-            checkBoxMusicEnabled.setLabel(&quot;Enabled&quot;);
+            checkBoxMusicEnabled-&gt;setLabel(&quot;Enabled&quot;);
         } else {
             sound-&gt;stopMusic();
-            checkBoxMusicEnabled.setLabel(&quot;Disabled&quot;);
+            checkBoxMusicEnabled-&gt;setLabel(&quot;Disabled&quot;);
         }
     }
     

Modified: trunk/netpanzer/src/NetPanzer/Views/MainMenu/Options/SoundView.hpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Views/MainMenu/Options/SoundView.hpp	2008-04-27 15:01:39 UTC (rev 1026)
+++ trunk/netpanzer/src/NetPanzer/Views/MainMenu/Options/SoundView.hpp	2008-05-04 14:05:21 UTC (rev 1027)
@@ -38,8 +38,8 @@
 {
 protected:
     virtual void loadTitleSurface();
-    CheckBox checkBoxSoundEnabled;
-    CheckBox checkBoxMusicEnabled;
+    CheckBox * checkBoxSoundEnabled;
+    CheckBox * checkBoxMusicEnabled;
 
 public:
     SoundView();

Modified: trunk/netpanzer/src/NetPanzer/Views/MainMenu/Options/VisualsView.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Views/MainMenu/Options/VisualsView.cpp	2008-04-27 15:01:39 UTC (rev 1026)
+++ trunk/netpanzer/src/NetPanzer/Views/MainMenu/Options/VisualsView.cpp	2008-05-04 14:05:21 UTC (rev 1027)
@@ -36,74 +36,90 @@
 
     initButtons();
 
+} // end VisualsView::VisualsView
+
+// initButtons
+//---------------------------------------------------------------------------
+void VisualsView::initButtons()
+{
+    OptionsTemplateView::initButtons(); // XXX this clears buttons and delete components
+    
     int xTextStart       = bodyTextRect.min.x;
     int x                = xTextStart + 10;
     int y                = bodyTextRect.min.y;
     int yOffset          =  20;
-
+    
     // Settings
     //----------------------------------------------------------------------
     int minWidth = 19 * 8;
-
+    
     x = xTextStart + 10;
     y = 100;
-    choiceResolution.setName(&quot;Resolution&quot;);
-    choiceResolution.addItem(&quot;640x480&quot;);
-    choiceResolution.addItem(&quot;800x600&quot;);
-    choiceResolution.addItem(&quot;1024x768&quot;);
-    choiceResolution.setLocation(x, y);
-    choiceResolution.select(gameconfig-&gt;screenresolution);
-    choiceResolution.setMinWidth(minWidth);
-    choiceResolution.setStateChangedCallback(this);
-
-    checkBoxFullscreen.setLabel(&quot;Fullscreen&quot;);
-    checkBoxFullscreen.setState(gameconfig-&gt;fullscreen);    
-    checkBoxFullscreen.setLocation(x+ 200, y);
-    checkBoxFullscreen.setStateChangedCallback(this);
+    
+    choiceResolution = new Choice();
+    choiceResolution-&gt;setName(&quot;Resolution&quot;);
+    choiceResolution-&gt;addItem(&quot;640x480&quot;);
+    choiceResolution-&gt;addItem(&quot;800x600&quot;);
+    choiceResolution-&gt;addItem(&quot;1024x768&quot;);
+    choiceResolution-&gt;setLocation(x, y);
+    choiceResolution-&gt;select(gameconfig-&gt;screenresolution);
+    choiceResolution-&gt;setMinWidth(minWidth);
+    choiceResolution-&gt;setStateChangedCallback(this);
+    add(choiceResolution);
+    
+    checkBoxFullscreen = new CheckBox();
+    checkBoxFullscreen-&gt;setLabel(&quot;Fullscreen&quot;);
+    checkBoxFullscreen-&gt;setState(gameconfig-&gt;fullscreen);    
+    checkBoxFullscreen-&gt;setLocation(x+ 200, y);
+    checkBoxFullscreen-&gt;setStateChangedCallback(this);
+    add(checkBoxFullscreen);
     y += yOffset;
     y += yOffset;
-
-    choiceMiniMapUnitSize.setName(&quot;Mini Map Unit Size&quot;);
-    choiceMiniMapUnitSize.addItem(&quot;Small&quot;);
-    choiceMiniMapUnitSize.addItem(&quot;Large&quot;);
-    choiceMiniMapUnitSize.setLocation(x, y);
-    choiceMiniMapUnitSize.select(gameconfig-&gt;radar_unitsize);
-    choiceMiniMapUnitSize.setMinWidth(minWidth);
-    choiceMiniMapUnitSize.setStateChangedCallback(this);
+    
+    choiceMiniMapUnitSize = new Choice();
+    choiceMiniMapUnitSize-&gt;setName(&quot;Mini Map Unit Size&quot;);
+    choiceMiniMapUnitSize-&gt;addItem(&quot;Small&quot;);
+    choiceMiniMapUnitSize-&gt;addItem(&quot;Large&quot;);
+    choiceMiniMapUnitSize-&gt;setLocation(x, y);
+    choiceMiniMapUnitSize-&gt;select(gameconfig-&gt;radar_unitsize);
+    choiceMiniMapUnitSize-&gt;setMinWidth(minWidth);
+    choiceMiniMapUnitSize-&gt;setStateChangedCallback(this);
+    add(choiceMiniMapUnitSize);
     y += yOffset;
     y += yOffset;
-
-
+    
+    
     // Other visual options to add.
     // Gamma
     // Blend Mouse.
-
-    checkBoxDrawAllShadows.setLabel(&quot;Draw All Shadows&quot;);
-    checkBoxDrawAllShadows.setState(gameconfig-&gt;displayshadows);
-    checkBoxDrawAllShadows.setLocation(x, y);
-    checkBoxDrawAllShadows.setStateChangedCallback(this);
+    
+    checkBoxDrawAllShadows = new CheckBox();
+    checkBoxDrawAllShadows-&gt;setLabel(&quot;Draw All Shadows&quot;);
+    checkBoxDrawAllShadows-&gt;setState(gameconfig-&gt;displayshadows);
+    checkBoxDrawAllShadows-&gt;setLocation(x, y);
+    checkBoxDrawAllShadows-&gt;setStateChangedCallback(this);
+    add(checkBoxDrawAllShadows);
     y += yOffset;
-
-    checkBoxBlendSmoke.setLabel(&quot;Blend Smoke&quot;);
-    checkBoxBlendSmoke.setState(gameconfig-&gt;blendsmoke);
-    checkBoxBlendSmoke.setLocation(x, y);
-    checkBoxBlendSmoke.setStateChangedCallback(this);
+    
+    checkBoxBlendSmoke = new CheckBox();
+    checkBoxBlendSmoke-&gt;setLabel(&quot;Blend Smoke&quot;);
+    checkBoxBlendSmoke-&gt;setState(gameconfig-&gt;blendsmoke);
+    checkBoxBlendSmoke-&gt;setLocation(x, y);
+    checkBoxBlendSmoke-&gt;setStateChangedCallback(this);
+    add(checkBoxBlendSmoke);
     y += yOffset;
-} // end VisualsView::VisualsView
+    
+    
+    //removeAllButtons();
+    //removeComponents();
+    
 
-// initButtons
-//---------------------------------------------------------------------------
-void VisualsView::initButtons()
-{
-    OptionsTemplateView::initButtons();
 
-    add(&amp;checkBoxDrawAllShadows);
-    add(&amp;checkBoxBlendSmoke);
-    add(&amp;checkBoxFullscreen);
-    add(&amp;choiceResolution);
+    
+    
     //add(&amp;choiceGameViewBackgroundColor);
     //add(&amp;choiceMiniMapObjectiveDrawMode);
-    add(&amp;choiceMiniMapUnitSize);
+    
     //add(&amp;choiceUnitSelectionDrawMode);
     //add(&amp;choiceUnitInfoDrawLayer);
     //add(&amp;choiceYourRadarUnit);
@@ -144,26 +160,26 @@
 void VisualsView::stateChanged(Component* source)
 {
     // Check Box Draw All Shadows
-    if (source == &amp;checkBoxDrawAllShadows) {
-        gameconfig-&gt;displayshadows = checkBoxDrawAllShadows.getState();
+    if (source == checkBoxDrawAllShadows) {
+        gameconfig-&gt;displayshadows = checkBoxDrawAllShadows-&gt;getState();
     }
     // Check Box Blend Smoke
-    else if (source == &amp;checkBoxBlendSmoke) {
-        gameconfig-&gt;blendsmoke = checkBoxBlendSmoke.getState();
-    } else if (source == &amp;checkBoxFullscreen) {
-        gameconfig-&gt;fullscreen = checkBoxFullscreen.getState();
+    else if (source == checkBoxBlendSmoke) {
+        gameconfig-&gt;blendsmoke = checkBoxBlendSmoke-&gt;getState();
+    } else if (source == checkBoxFullscreen) {
+        gameconfig-&gt;fullscreen = checkBoxFullscreen-&gt;getState();
         GameManager::setVideoMode();
     }
     // Choice Resolution
-    else if (source == &amp;choiceResolution) {
-        gameconfig-&gt;screenresolution = choiceResolution.getSelectedIndex();
+    else if (source == choiceResolution) {
+        gameconfig-&gt;screenresolution = choiceResolution-&gt;getSelectedIndex();
         GameManager::setVideoMode();
     }
     // Choice Mini Map Unit Size
-    else if (source == &amp;choiceMiniMapUnitSize) {
-        if (choiceMiniMapUnitSize.getSelectedIndex() == 0) {
+    else if (source == choiceMiniMapUnitSize) {
+        if (choiceMiniMapUnitSize-&gt;getSelectedIndex() == 0) {
             gameconfig-&gt;radar_unitsize = _mini_map_unit_size_small;
-        } else if (choiceMiniMapUnitSize.getSelectedIndex() == 1) {
+        } else if (choiceMiniMapUnitSize-&gt;getSelectedIndex() == 1) {
             gameconfig-&gt;radar_unitsize = _mini_map_unit_size_large;
         }
     }

Modified: trunk/netpanzer/src/NetPanzer/Views/MainMenu/Options/VisualsView.hpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Views/MainMenu/Options/VisualsView.hpp	2008-04-27 15:01:39 UTC (rev 1026)
+++ trunk/netpanzer/src/NetPanzer/Views/MainMenu/Options/VisualsView.hpp	2008-05-04 14:05:21 UTC (rev 1027)
@@ -42,17 +42,17 @@
     int      selectedColorStartY;
 
     // Option check boxes.
-    CheckBox checkBoxDrawAllShadows;
-    CheckBox checkBoxBlendSmoke;
-    CheckBox checkBoxFullscreen;
+    CheckBox * checkBoxDrawAllShadows;
+    CheckBox * checkBoxBlendSmoke;
+    CheckBox * checkBoxFullscreen;
     //CheckBox drawUnitReload;
 
     // Option choices.
-    Choice   choiceResolution;
-    Choice   choiceGameViewBackgroundColor;
-    Choice   choiceMiniMapObjectiveDrawMode;
-    Choice   choiceMiniMapUnitSize;
-    Choice   choiceUnitSelectionDrawMode;
+    Choice   * choiceResolution;
+    Choice   * choiceGameViewBackgroundColor;
+    Choice   * choiceMiniMapObjectiveDrawMode;
+    Choice   * choiceMiniMapUnitSize;
+    Choice   * choiceUnitSelectionDrawMode;
 
     //Choice   choiceUnitInfoDrawLayer;
 

Modified: trunk/netpanzer/units/profiles/Archer.pfl
===================================================================
--- trunk/netpanzer/units/profiles/Archer.pfl	2008-04-27 15:01:39 UTC (rev 1026)
+++ trunk/netpanzer/units/profiles/Archer.pfl	2008-05-04 14:05:21 UTC (rev 1027)
@@ -1,25 +1,22 @@
-HITPOINTS      120;
-
-DAMAGE_FACTOR    0;
-
-ATTACK_FACTOR  350;
-
-RELOAD_TIME     110;
-
-REACTION_TIME    8;
-
-RANGE_MAX     2400000;
-
-REGEN_TIME    90;
-
-DEFEND_RANGE   14400000;
-
-SPEED_RATE       16;
-
-SPEED_FACTOR      2;
-
-REPATH_TIME      10;
-
-FUEL_CAPACITY  2000;
-
-END;
+HITPOINTS      120;
+DAMAGE_FACTOR    0;
+ATTACK_FACTOR  350;
+RELOAD_TIME     110;
+REACTION_TIME    8;
+RANGE_MAX     2400000;
+REGEN_TIME    90;
+DEFEND_RANGE   14400000;
+SPEED_RATE       16;
+SPEED_FACTOR      2;
+REPATH_TIME      10;
+FUEL_CAPACITY  2000;
+IMAGE &quot;pics/menus/vehicleSelectionView/archer.bmp&quot;
+BODYSPRITE &quot;units/pics/pak/ArchHNSD.pak&quot;
+BODYSHADOW &quot;units/pics/pak/ArchHSSD.pak&quot;
+TURRETSPRITE &quot;units/pics/pak/ArchTNSD.pak&quot;
+TURRETSHADOW &quot;units/pics/pak/ArchTSSD.pak&quot;
+SOUNDSELECTED &quot;mu-selected&quot;
+FIRESOUND &quot;mu-fire&quot;
+WEAPON &quot;DOUBLEMISSILE&quot;
+BOUNDBOX 40
+END;

Modified: trunk/netpanzer/units/profiles/Bear.pfl
===================================================================
--- trunk/netpanzer/units/profiles/Bear.pfl	2008-04-27 15:01:39 UTC (rev 1026)
+++ trunk/netpanzer/units/profiles/Bear.pfl	2008-05-04 14:05:21 UTC (rev 1027)
@@ -1,25 +1,22 @@
-HITPOINTS      450;
-
-DAMAGE_FACTOR    0;
-
-ATTACK_FACTOR   80;
-
-RELOAD_TIME     40;
-
-REACTION_TIME    8;
-
-RANGE_MAX     400000;
-
-REGEN_TIME     35;
-
-DEFEND_RANGE  240000;
-
-SPEED_RATE       14;
-
-SPEED_FACTOR      2;
-
-REPATH_TIME      2;
-
-FUEL_CAPACITY  2000;
-
-END;
+HITPOINTS      450;
+DAMAGE_FACTOR    0;
+ATTACK_FACTOR   80;
+RELOAD_TIME     40;
+REACTION_TIME    8;
+RANGE_MAX     400000;
+REGEN_TIME     35;
+DEFEND_RANGE  240000;
+SPEED_RATE       14;
+SPEED_FACTOR      2;
+REPATH_TIME      2;
+FUEL_CAPACITY  2000;
+IMAGE &quot;pics/menus/vehicleSelectionView/bear.bmp&quot;
+BODYSPRITE &quot;units/pics/pak/BearHNSD.pak&quot;
+BODYSHADOW &quot;units/pics/pak/BearHSSD.pak&quot;
+TURRETSPRITE &quot;units/pics/pak/BearTNSD.pak&quot;
+TURRETSHADOW &quot;units/pics/pak/BearTSSD.pak&quot;
+SOUNDSELECTED &quot;mt-selected&quot;
+FIRESOUND &quot;mt-fire&quot;
+WEAPON &quot;SHELL&quot;
+BOUNDBOX 60
+END;

Modified: trunk/netpanzer/units/profiles/Bobcat.pfl
===================================================================
--- trunk/netpanzer/units/profiles/Bobcat.pfl	2008-04-27 15:01:39 UTC (rev 1026)
+++ trunk/netpanzer/units/profiles/Bobcat.pfl	2008-05-04 14:05:21 UTC (rev 1027)
@@ -1,25 +1,22 @@
-HITPOINTS      200;
-
-DAMAGE_FACTOR    0;
-
-ATTACK_FACTOR   30;
-
-RELOAD_TIME     20;
-
-REACTION_TIME    8;
-
-RANGE_MAX     122500;
-
-REGEN_TIME     20;
-
-DEFEND_RANGE  73500;
-
-SPEED_RATE       20;
-
-SPEED_FACTOR      4;
-
-REPATH_TIME      20;
-
-FUEL_CAPACITY  2000;
-
-END;
+HITPOINTS      200;
+DAMAGE_FACTOR    0;
+ATTACK_FACTOR   30;
+RELOAD_TIME     20;
+REACTION_TIME    8;
+RANGE_MAX     122500;
+REGEN_TIME     20;
+DEFEND_RANGE  73500;
+SPEED_RATE       20;
+SPEED_FACTOR      4;
+REPATH_TIME      20;
+FUEL_CAPACITY  2000;
+IMAGE &quot;pics/menus/vehicleSelectionView/bobcat.bmp&quot;
+BODYSPRITE &quot;units/pics/pak/BobcHNSD.pak&quot;
+BODYSHADOW &quot;units/pics/pak/BobcHSSD.pak&quot;
+TURRETSPRITE &quot;units/pics/pak/BobcTNSD.pak&quot;
+TURRETSHADOW &quot;units/pics/pak/BobcTSSD.pak&quot;
+SOUNDSELECTED &quot;lt-selected&quot;
+FIRESOUND &quot;lt-fire&quot;
+WEAPON &quot;SHELL&quot;
+BOUNDBOX 60
+END;

Modified: trunk/netpanzer/units/profiles/Drake.pfl
===================================================================
--- trunk/netpanzer/units/profiles/Drake.pfl	2008-04-27 15:01:39 UTC (rev 1026)
+++ trunk/netpanzer/units/profiles/Drake.pfl	2008-05-04 14:05:21 UTC (rev 1027)
@@ -1,25 +1,22 @@
-HITPOINTS     300;
-
-DAMAGE_FACTOR   0;
-
-ATTACK_FACTOR  180;
-
-RELOAD_TIME    50;
-
-REACTION_TIME   8;
-
-RANGE_MAX     1000000;
-
-REGEN_TIME    55;
-
-DEFEND_RANGE  600000;
-
-SPEED_RATE       16;
-
-SPEED_FACTOR      2;
-
-REPATH_TIME      20;
-
-FUEL_CAPACITY  2000;
-
-END;
+HITPOINTS     300;
+DAMAGE_FACTOR   0;
+ATTACK_FACTOR  180;
+RELOAD_TIME    50;
+REACTION_TIME   8;
+RANGE_MAX     1000000;
+REGEN_TIME    55;
+DEFEND_RANGE  600000;
+SPEED_RATE       16;
+SPEED_FACTOR      2;
+REPATH_TIME      20;
+FUEL_CAPACITY  2000;
+IMAGE &quot;pics/menus/vehicleSelectionView/drake.bmp&quot;
+BODYSPRITE &quot;units/pics/pak/DrakHNSD.pak&quot;
+BODYSHADOW &quot;units/pics/pak/DrakHSSD.pak&quot;
+TURRETSPRITE &quot;units/pics/pak/DrakTNSD.pak&quot;
+TURRETSHADOW &quot;units/pics/pak/DrakTSSD.pak&quot;
+SOUNDSELECTED &quot;ht-selected&quot;
+FIRESOUND &quot;ht-fire&quot;
+WEAPON &quot;SHELL&quot;
+BOUNDBOX 60
+END;

Modified: trunk/netpanzer/units/profiles/Manta.pfl
===================================================================
--- trunk/netpanzer/units/profiles/Manta.pfl	2008-04-27 15:01:39 UTC (rev 1026)
+++ trunk/netpanzer/units/profiles/Manta.pfl	2008-05-04 14:05:21 UTC (rev 1027)
@@ -1,25 +1,22 @@
-HITPOINTS      350;
-
-DAMAGE_FACTOR    0;
-
-ATTACK_FACTOR   50;
-
-RELOAD_TIME     35;
-
-REACTION_TIME    8;
-
-RANGE_MAX     230400;
-
-REGEN_TIME     30;
-
-DEFEND_RANGE  138000;
-
-SPEED_RATE       20;
-
-SPEED_FACTOR      4;
-
-REPATH_TIME      2;
-
-FUEL_CAPACITY  2000;
-
-END;
+HITPOINTS      350;
+DAMAGE_FACTOR    0;
+ATTACK_FACTOR   50;
+RELOAD_TIME     35;
+REACTION_TIME    8;
+RANGE_MAX     230400;
+REGEN_TIME     30;
+DEFEND_RANGE  138000;
+SPEED_RATE       20;
+SPEED_FACTOR      4;
+REPATH_TIME      2;
+FUEL_CAPACITY  2000;
+IMAGE &quot;pics/menus/vehicleSelectionView/manta.bmp&quot;
+BODYSPRITE &quot;units/pics/pak/MantHNSD.pak&quot;
+BODYSHADOW &quot;units/pics/pak/MantHSSD.pak&quot;
+TURRETSPRITE &quot;units/pics/pak/MantTNSD.pak&quot;
+TURRETSHADOW &quot;units/pics/pak/MantTSSD.pak&quot;
+SOUNDSELECTED &quot;lt-selected&quot;
+FIRESOUND &quot;lt-fire&quot;
+WEAPON &quot;SHELL&quot;
+BOUNDBOX 40
+END;

Modified: trunk/netpanzer/units/profiles/Panther1.pfl
===================================================================
--- trunk/netpanzer/units/profiles/Panther1.pfl	2008-04-27 15:01:39 UTC (rev 1026)
+++ trunk/netpanzer/units/profiles/Panther1.pfl	2008-05-04 14:05:21 UTC (rev 1027)
@@ -1,25 +1,22 @@
-HITPOINTS     525;
-
-DAMAGE_FACTOR   0;
-
-ATTACK_FACTOR  80;
-
-RELOAD_TIME    50;
-
-REACTION_TIME   8;
-
-RANGE_MAX     409600;
-
-REGEN_TIME    45;
-
-DEFEND_RANGE  245760;
-
-SPEED_RATE       18;
-
-SPEED_FACTOR      2;
-
-REPATH_TIME      20;
-
-FUEL_CAPACITY  2000;
-
-END;
+HITPOINTS     525;
+DAMAGE_FACTOR   0;
+ATTACK_FACTOR  80;
+RELOAD_TIME    50;
+REACTION_TIME   8;
+RANGE_MAX     409600;
+REGEN_TIME    45;
+DEFEND_RANGE  245760;
+SPEED_RATE       18;
+SPEED_FACTOR      2;
+REPATH_TIME      20;
+FUEL_CAPACITY  2000;
+IMAGE &quot;pics/menus/vehicleSelectionView/panther1.bmp&quot;
+BODYSPRITE &quot;units/pics/pak/PantHNSD.pak&quot;
+BODYSHADOW &quot;units/pics/pak/PantHSSD.pak&quot;
+TURRETSPRITE &quot;units/pics/pak/PantTNSD.pak&quot;
+TURRETSHADOW &quot;units/pics/pak/PantTSSD.pak&quot;
+SOUNDSELECTED &quot;mt-selected&quot;
+FIRESOUND &quot;mt-fire&quot;
+WEAPON &quot;SHELL&quot;
+BOUNDBOX 50
+END;

Modified: trunk/netpanzer/units/profiles/SPanzer.pfl
===================================================================
--- trunk/netpanzer/units/profiles/SPanzer.pfl	2008-04-27 15:01:39 UTC (rev 1026)
+++ trunk/netpanzer/units/profiles/SPanzer.pfl	2008-05-04 14:05:21 UTC (rev 1027)
@@ -1,27 +1,24 @@
-HITPOINTS         60;
-
-DAMAGE_FACTOR      0;
-
-ATTACK_FACTOR      15;
-
-RELOAD_TIME       20;
-
-REACTION_TIME      8;
-
-RANGE_MAX     100000;
-
-REGEN_TIME      20;
-
-DEFEND_RANGE   60000;
-
-SPEED_RATE        22;
-
-SPEED_FACTOR       4;
-                
-REPATH_TIME       20;
-
-FUEL_CAPACITY  10000;
-
-END; 
-
-
+HITPOINTS         60;
+DAMAGE_FACTOR      0;
+ATTACK_FACTOR      15;
+RELOAD_TIME       20;
+REACTION_TIME      8;
+RANGE_MAX     100000;
+REGEN_TIME      20;
+DEFEND_RANGE   60000;
+SPEED_RATE        22;
+SPEED_FACTOR       4;
+REPATH_TIME       20;
+FUEL_CAPACITY  10000;
+IMAGE &quot;pics/menus/vehicleSelectionView/scout.bmp&quot;;
+BODYSPRITE &quot;units/pics/pak/SpahHNSD.pak&quot;
+BODYSHADOW &quot;units/pics/pak/SpahHSSD.pak&quot;
+TURRETSPRITE &quot;units/pics/pak/SpahTNSD.pak&quot;
+TURRETSHADOW &quot;units/pics/pak/SpahTSSD.pak&quot;
+SOUNDSELECTED &quot;yessir&quot;
+FIRESOUND &quot;lt-fire&quot;
+WEAPON &quot;SHELL&quot;
+BOUNDBOX 40
+END; 
+
+

Modified: trunk/netpanzer/units/profiles/Scout.pfl
===================================================================
--- trunk/netpanzer/units/profiles/Scout.pfl	2008-04-27 15:01:39 UTC (rev 1026)
+++ trunk/netpanzer/units/profiles/Scout.pfl	2008-05-04 14:05:21 UTC (rev 1027)
@@ -1,27 +1,15 @@
-HITPOINTS         25;
-
-DAMAGE_FACTOR      0;
-
-ATTACK_FACTOR      5;
-
-RELOAD_TIME       20;
-
-REACTION_TIME      8;
-
-RANGE_MAX      90000;
-
-REGEN_TIME      25;
-
-DEFEND_RANGE   54000;
-
-SPEED_RATE        18;
-
-SPEED_FACTOR       4;
-                
-REPATH_TIME       20;
-
-FUEL_CAPACITY  10000;
-
-END; 
-
-
+HITPOINTS         25;
+DAMAGE_FACTOR      0;
+ATTACK_FACTOR      5;
+RELOAD_TIME       20;
+REACTION_TIME      8;
+RANGE_MAX      90000;
+REGEN_TIME      25;
+DEFEND_RANGE   54000;
+SPEED_RATE        18;
+SPEED_FACTOR       4;
+REPATH_TIME       20;
+FUEL_CAPACITY  10000;
+END; 
+
+

Modified: trunk/netpanzer/units/profiles/Stinger.pfl
===================================================================
--- trunk/netpanzer/units/profiles/Stinger.pfl	2008-04-27 15:01:39 UTC (rev 1026)
+++ trunk/netpanzer/units/profiles/Stinger.pfl	2008-05-04 14:05:21 UTC (rev 1027)
@@ -1,25 +1,22 @@
-HITPOINTS      100;
-
-DAMAGE_FACTOR    0;
-
-ATTACK_FACTOR  200;
-
-RELOAD_TIME     100;
-
-REACTION_TIME    8;
-
-RANGE_MAX     1600000;
-
-REGEN_TIME    80;
-
-DEFEND_RANGE   9600000;
-
-SPEED_RATE       18;
-
-SPEED_FACTOR      2;
-
-REPATH_TIME      10;
-
-FUEL_CAPACITY  2000;
-
-END;
+HITPOINTS      100;
+DAMAGE_FACTOR    0;
+ATTACK_FACTOR  200;
+RELOAD_TIME     100;
+REACTION_TIME    8;
+RANGE_MAX     1600000;
+REGEN_TIME    80;
+DEFEND_RANGE   9600000;
+SPEED_RATE       18;
+SPEED_FACTOR      2;
+REPATH_TIME      10;
+FUEL_CAPACITY  2000;
+IMAGE &quot;pics/menus/vehicleSelectionView/stinger.bmp&quot;
+BODYSPRITE &quot;units/pics/pak/StinHNSD.pak&quot;
+BODYSHADOW &quot;units/pics/pak/StinHSSD.pak&quot;
+TURRETSPRITE &quot;units/pics/pak/StinTNSD.pak&quot;
+TURRETSHADOW &quot;units/pics/pak/StinTSSD.pak&quot;
+SOUNDSELECTED &quot;mu-selected&quot;
+FIRESOUND &quot;mu-fire&quot;
+WEAPON &quot;QUADMISSILE&quot;
+BOUNDBOX 40
+END;

Modified: trunk/netpanzer/units/profiles/Titan.pfl
===================================================================
--- trunk/netpanzer/units/profiles/Titan.pfl	2008-04-27 15:01:39 UTC (rev 1026)
+++ trunk/netpanzer/units/profiles/Titan.pfl	2008-05-04 14:05:21 UTC (rev 1027)
@@ -1,25 +1,22 @@
-HITPOINTS     1300;
-
-DAMAGE_FACTOR   0;
-
-ATTACK_FACTOR  140;
-
-RELOAD_TIME    60;
-
-REACTION_TIME   8;
-
-RANGE_MAX     1000000;
-
-REGEN_TIME    60;
-
-DEFEND_RANGE  800000;
-
-SPEED_RATE       16;
-
-SPEED_FACTOR      2;
-
-REPATH_TIME      20;
-
-FUEL_CAPACITY  2000; 
-
-END;
+HITPOINTS     1300;
+DAMAGE_FACTOR   0;
+ATTACK_FACTOR  140;
+RELOAD_TIME    60;
+REACTION_TIME   8;
+RANGE_MAX     1000000;
+REGEN_TIME    60;
+DEFEND_RANGE  800000;
+SPEED_RATE       16;
+SPEED_FACTOR      2;
+REPATH_TIME      20;
+FUEL_CAPACITY  2000; 
+IMAGE &quot;pics/menus/vehicleSelectionView/titan.bmp&quot;
+BODYSPRITE &quot;units/pics/pak/TitaHNSD.pak&quot;
+BODYSHADOW &quot;units/pics/pak/TitaHSSD.pak&quot;
+TURRETSPRITE &quot;units/pics/pak/TitaTNSD.pak&quot;
+TURRETSHADOW &quot;units/pics/pak/TitaTSSD.pak&quot;
+SOUNDSELECTED &quot;ht-selected&quot;
+FIRESOUND &quot;ht-fire&quot;
+WEAPON &quot;SHELL&quot;
+BOUNDBOX 60
+END;

Modified: trunk/netpanzer/units/profiles/Wolf.pfl
===================================================================
--- trunk/netpanzer/units/profiles/Wolf.pfl	2008-04-27 15:01:39 UTC (rev 1026)
+++ trunk/netpanzer/units/profiles/Wolf.pfl	2008-05-04 14:05:21 UTC (rev 1027)
@@ -1,25 +1,22 @@
-HITPOINTS      175;
-
-DAMAGE_FACTOR    0;
-
-ATTACK_FACTOR   60;
-
-RELOAD_TIME     40;
-
-REACTION_TIME    8;
-
-RANGE_MAX    1000000;
-
-REGEN_TIME     50;
-
-DEFEND_RANGE  600000;
-
-SPEED_RATE       20;
-
-SPEED_FACTOR      4;
-
-REPATH_TIME      2;
-
-FUEL_CAPACITY  2000;
-
-END;
+HITPOINTS      175;
+DAMAGE_FACTOR    0;
+ATTACK_FACTOR   60;
+RELOAD_TIME     40;
+REACTION_TIME    8;
+RANGE_MAX    1000000;
+REGEN_TIME     50;
+DEFEND_RANGE  600000;
+SPEED_RATE       20;
+SPEED_FACTOR      4;
+REPATH_TIME      2;
+FUEL_CAPACITY  2000;
+IMAGE &quot;pics/menus/vehicleSelectionView/wolf.bmp&quot;
+BODYSPRITE &quot;units/pics/pak/WolfHNSD.pak&quot;
+BODYSHADOW &quot;units/pics/pak/WolfHSSD.pak&quot;
+TURRETSPRITE &quot;units/pics/pak/WolfTNSD.pak&quot;
+TURRETSHADOW &quot;units/pics/pak/WolfTSSD.pak&quot;
+SOUNDSELECTED &quot;lt-selected&quot;
+FIRESOUND &quot;lt-fire&quot;
+WEAPON &quot;SHELL&quot;
+BOUNDBOX 60
+END;


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	
	<LI>Next message: <A HREF="000070.html">[Netpanzer-cvs] r1028 - trunk/netpanzer/src/NetPanzer/System
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#69">[ date ]</a>
              <a href="thread.html#69">[ thread ]</a>
              <a href="subject.html#69">[ subject ]</a>
              <a href="author.html#69">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/netpanzer-cvs">More information about the Netpanzer-cvs
mailing list</a><br>
</body></html>
