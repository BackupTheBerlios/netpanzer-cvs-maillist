<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Netpanzer-cvs] r1356 - in trunk/netpanzer: pics/default	src/NetPanzer/Classes src/NetPanzer/Interfaces	src/NetPanzer/Units src/NetPanzer/Views/Components	src/NetPanzer/Views/Game
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/netpanzer-cvs/2012-April/index.html" >
   <LINK REL="made" HREF="mailto:netpanzer-cvs%40lists.berlios.de?Subject=Re%3A%20%5BNetpanzer-cvs%5D%20r1356%20-%20in%20trunk/netpanzer%3A%20pics/default%0A%09src/NetPanzer/Classes%20src/NetPanzer/Interfaces%0A%09src/NetPanzer/Units%20src/NetPanzer/Views/Components%0A%09src/NetPanzer/Views/Game&In-Reply-To=%3C20120427095516.D4FEA55B0C%40scm.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000379.html">
   <LINK REL="Next"  HREF="000381.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Netpanzer-cvs] r1356 - in trunk/netpanzer: pics/default	src/NetPanzer/Classes src/NetPanzer/Interfaces	src/NetPanzer/Units src/NetPanzer/Views/Components	src/NetPanzer/Views/Game</H1>
    <B>wile64 at scm.berlios.de</B> 
    <A HREF="mailto:netpanzer-cvs%40lists.berlios.de?Subject=Re%3A%20%5BNetpanzer-cvs%5D%20r1356%20-%20in%20trunk/netpanzer%3A%20pics/default%0A%09src/NetPanzer/Classes%20src/NetPanzer/Interfaces%0A%09src/NetPanzer/Units%20src/NetPanzer/Views/Components%0A%09src/NetPanzer/Views/Game&In-Reply-To=%3C20120427095516.D4FEA55B0C%40scm.berlios.de%3E"
       TITLE="[Netpanzer-cvs] r1356 - in trunk/netpanzer: pics/default	src/NetPanzer/Classes src/NetPanzer/Interfaces	src/NetPanzer/Units src/NetPanzer/Views/Components	src/NetPanzer/Views/Game">wile64 at scm.berlios.de
       </A><BR>
    <I>Fri Apr 27 11:55:16 CEST 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="000379.html">[Netpanzer-cvs] r1355 - in trunk/netpanzer/src/NetPanzer:	Classes/Network Interfaces Views/Game
</A></li>
        <LI>Next message: <A HREF="000381.html">[Netpanzer-cvs] r1357 - in trunk/netpanzer/src/NetPanzer:	Interfaces Views/Game
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#380">[ date ]</a>
              <a href="thread.html#380">[ thread ]</a>
              <a href="subject.html#380">[ subject ]</a>
              <a href="author.html#380">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: wile64
Date: 2012-04-27 11:55:16 +0200 (Fri, 27 Apr 2012)
New Revision: 1356

Added:
   trunk/netpanzer/pics/default/team-1.bmp
   trunk/netpanzer/pics/default/team-2.bmp
   trunk/netpanzer/pics/default/team-3.bmp
   trunk/netpanzer/pics/default/team-4.bmp
Removed:
   trunk/netpanzer/pics/default/team-one.bmp
   trunk/netpanzer/pics/default/team-two.bmp
Modified:
   trunk/netpanzer/src/NetPanzer/Classes/SelectionBoxSprite.cpp
   trunk/netpanzer/src/NetPanzer/Classes/SelectionBoxSprite.hpp
   trunk/netpanzer/src/NetPanzer/Interfaces/Team.cpp
   trunk/netpanzer/src/NetPanzer/Interfaces/Team.hpp
   trunk/netpanzer/src/NetPanzer/Interfaces/TeamManager.cpp
   trunk/netpanzer/src/NetPanzer/Interfaces/TeamManager.hpp
   trunk/netpanzer/src/NetPanzer/Units/Vehicle.cpp
   trunk/netpanzer/src/NetPanzer/Views/Components/InfoBar.cpp
   trunk/netpanzer/src/NetPanzer/Views/Game/EndRoundView.cpp
   trunk/netpanzer/src/NetPanzer/Views/Game/EndRoundView.hpp
   trunk/netpanzer/src/NetPanzer/Views/Game/GTeamView.cpp
   trunk/netpanzer/src/NetPanzer/Views/Game/GTeamView.hpp
Log:
TeamMode : 
 - Add team flag on unit
 - show team frag on statusbar
 - remove useless procedure
 - load flag on team directly
 - add 4 flag team (only 2 team now, but max 4 after)

Added: trunk/netpanzer/pics/default/team-1.bmp
===================================================================
(Binary files differ)


Property changes on: trunk/netpanzer/pics/default/team-1.bmp
___________________________________________________________________
Added: svn:mime-type
   + application/octet-stream

Added: trunk/netpanzer/pics/default/team-2.bmp
===================================================================
(Binary files differ)


Property changes on: trunk/netpanzer/pics/default/team-2.bmp
___________________________________________________________________
Added: svn:mime-type
   + application/octet-stream

Added: trunk/netpanzer/pics/default/team-3.bmp
===================================================================
(Binary files differ)


Property changes on: trunk/netpanzer/pics/default/team-3.bmp
___________________________________________________________________
Added: svn:mime-type
   + application/octet-stream

Added: trunk/netpanzer/pics/default/team-4.bmp
===================================================================
(Binary files differ)


Property changes on: trunk/netpanzer/pics/default/team-4.bmp
___________________________________________________________________
Added: svn:mime-type
   + application/octet-stream

Deleted: trunk/netpanzer/pics/default/team-one.bmp
===================================================================
(Binary files differ)

Deleted: trunk/netpanzer/pics/default/team-two.bmp
===================================================================
(Binary files differ)

Modified: trunk/netpanzer/src/NetPanzer/Classes/SelectionBoxSprite.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Classes/SelectionBoxSprite.cpp	2012-04-25 20:30:37 UTC (rev 1355)
+++ trunk/netpanzer/src/NetPanzer/Classes/SelectionBoxSprite.cpp	2012-04-27 09:55:16 UTC (rev 1356)
@@ -20,6 +20,7 @@
 #include &quot;Classes/SelectionBoxSprite.hpp&quot;
 #include &quot;2D/Palette.hpp&quot;
 #include &quot;Interfaces/GameConfig.hpp&quot;
+#include &quot;Interfaces/TeamManager.hpp&quot;
 #include &quot;Resources/ResourceManager.hpp&quot;
 
 bool SelectionBoxSprite::isVisible(const iRect &amp;world_win) const
@@ -150,6 +151,15 @@
     {
         if ( playerName.length() &gt; 0 )
         {   // XXX dirty trick, I don't center the text, just &quot;by hand&quot;
+            if (GameConfig::game_teammode == true)
+            {
+                
+            TeamManager::drawFlag(team_ID, *surface, min_abs.x + FLAG_WIDTH  + 2, min_abs.y - FLAG_HEIGHT-2 );
+            surface-&gt;bltString( min_abs.x + FLAG_WIDTH  + 17,
+                                min_abs.y - FLAG_HEIGHT + 2,
+                                playerName.c_str(),  Color::gray224);
+            }
+            else
             surface-&gt;bltString( min_abs.x + FLAG_WIDTH  + 2,
                                 min_abs.y - FLAG_HEIGHT + 2,
                                 playerName.c_str(), Color::gray224);

Modified: trunk/netpanzer/src/NetPanzer/Classes/SelectionBoxSprite.hpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Classes/SelectionBoxSprite.hpp	2012-04-25 20:30:37 UTC (rev 1355)
+++ trunk/netpanzer/src/NetPanzer/Classes/SelectionBoxSprite.hpp	2012-04-27 09:55:16 UTC (rev 1356)
@@ -62,6 +62,7 @@
     
     Surface * unit_flag;
     std::string playerName;
+    Uint8 team_ID;
 
 public:
     UnitSelectionBox( );
@@ -106,6 +107,10 @@
     {
         playerName = name;
     }
+    inline void setTeam( Uint8 Team_index )
+    {
+        team_ID = Team_index;
+    }
 
     virtual void blit( Surface *surface, const iRect &amp;world_win );
 };

Modified: trunk/netpanzer/src/NetPanzer/Interfaces/Team.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Interfaces/Team.cpp	2012-04-25 20:30:37 UTC (rev 1355)
+++ trunk/netpanzer/src/NetPanzer/Interfaces/Team.cpp	2012-04-27 09:55:16 UTC (rev 1356)
@@ -19,6 +19,7 @@
 #include &quot;Interfaces/PlayerInterface.hpp&quot;
 #include &quot;Interfaces/Team.hpp&quot;
 #include &quot;Util/Log.hpp&quot;
+#include &quot;2D/Surface.hpp&quot;
 
 void Team::initialize(const Uint8 id)
 {
@@ -61,7 +62,6 @@
 
 void Team::removePlayer(PlayerID old_player)
 {
-   // LOGGER.warning(&quot;Team::removePlayer %d&quot;, player_id);
     for ( PlayerID player_id = 0; player_id &lt; PlayerInterface::getMaxPlayers(); ++player_id )
     {
         if (PlayerInterface::getPlayer(player_id)-&gt;isActive())
@@ -96,24 +96,14 @@
     return count;
 }
 
-void Team::spawnTeam( const iXY &amp;location )
+void Team::loadFlag(const char *fileName)
 {
-    PlayerID player_id;
-    for ( player_id = 0; player_id &lt; PlayerInterface::getMaxPlayers(); ++player_id )
-    {
-        if (PlayerInterface::getPlayer(player_id)-&gt;isActive())
-        {
-            if (PlayerInterface::getPlayer(player_id)-&gt;getTeamID() == teamID) 
-            {
-                PlayerInterface::spawnPlayer(player_id, location);
-            }
-        }
-    }
+    Flag.loadBMP(fileName);
 }
 
-void Team::spawnPlayer( PlayerID player_id, const iXY &amp;location )
+void Team::drawFlag(Surface &amp;dest, int x, int y) const
 {
-    PlayerInterface::spawnPlayer(player_id, location);
+    Flag.bltTrans(dest, x, y);
 }
 
 long Team::getTeamScore()

Modified: trunk/netpanzer/src/NetPanzer/Interfaces/Team.hpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Interfaces/Team.hpp	2012-04-25 20:30:37 UTC (rev 1355)
+++ trunk/netpanzer/src/NetPanzer/Interfaces/Team.hpp	2012-04-27 09:55:16 UTC (rev 1356)
@@ -19,27 +19,28 @@
 #define _TEAM_HPP
 
 #include &quot;Core/CoreTypes.hpp&quot;
+#include &quot;2D/Surface.hpp&quot;
 
 class Team
 {
 protected:
     Uint8 teamID;
     std::string name;
+    Surface Flag;
 
 public:
     void initialize(const Uint8 id);
 
     void setName(const std::string&amp; newname);
     const std::string&amp; getName() const;
-    
+
     void addPlayer(PlayerID player_id);
     void removePlayer(PlayerID player_id);
     void cleanUp();
     Uint8 getID() const { return teamID; }
     PlayerID countPlayers();
-    void spawnTeam(const iXY &amp;location );
-    void spawnPlayer(PlayerID player_id, const iXY &amp;location );
-    
+    void loadFlag(const char *fileName);
+    void drawFlag(Surface &amp;dest, int x, int y) const;
     long getTeamScore();
 
 };

Modified: trunk/netpanzer/src/NetPanzer/Interfaces/TeamManager.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Interfaces/TeamManager.cpp	2012-04-25 20:30:37 UTC (rev 1355)
+++ trunk/netpanzer/src/NetPanzer/Interfaces/TeamManager.cpp	2012-04-27 09:55:16 UTC (rev 1356)
@@ -34,10 +34,10 @@
 
 void TeamManager::initialize(const Uint8 _max_teams)
 {
-
+    char txtBuf[256];
     max_Teams = _max_teams;
     int team_id;
-
+    
     delete[] Teams_lists;
     Teams_lists = new Team[max_Teams];
 
@@ -49,6 +49,8 @@
     {
         Teams_lists[ team_id ].initialize(team_id);
         if (team_id &lt; (Uint8) plist.size()) Teams_lists[ team_id ].setName(plist[team_id]);
+        snprintf(txtBuf, sizeof(txtBuf), &quot;pics/default/team-%d.bmp&quot;, team_id+1);
+        Teams_lists[ team_id ].loadFlag(txtBuf);
     }
 }
 
@@ -91,32 +93,6 @@
     max_Teams = 0;
 }
 
-void TeamManager::spawnTeams()
-{
-    iXY spawn_point = MapInterface::getMinSpawnPoint();
-    Teams_lists[ 0 ].spawnTeam(spawn_point);
-    spawn_point = MapInterface::getMaxSpawnPoint();
-    Teams_lists[ 1 ].spawnTeam(spawn_point);
-}
-
-void TeamManager::spawnPlayer(PlayerID player_id)
-{
-    Uint8 Team_id = PlayerInterface::getPlayer(player_id)-&gt;getTeamID();
-    iXY spawn_point;
-    switch (Team_id)
-    {
-    case 0:
-        spawn_point = MapInterface::getMinSpawnPoint();
-        break;
-    case 1:
-        spawn_point = MapInterface::getMaxSpawnPoint();
-        break;
-    default:
-        spawn_point = MapInterface::getFreeSpawnPoint();
-    }
-    Teams_lists[ Team_id ].spawnPlayer(player_id, spawn_point);
-}
-
 iXY TeamManager::getPlayerSpawnPoint(PlayerID player_id)
 {
     Uint8 Team_id = PlayerInterface::getPlayer(player_id)-&gt;getTeamID();
@@ -136,7 +112,7 @@
     return spawn_point;
 }
 
-long TeamManager::GetTeamScore(  Uint8 team_id )
+long TeamManager::getTeamScore(  Uint8 team_id )
 {
     return Teams_lists[team_id].getTeamScore();
 }
@@ -146,6 +122,11 @@
     return Teams_lists[team_id].getName();
 }
 
+void TeamManager::drawFlag(Uint8 team_id, Surface &amp;dest, int x, int y)
+{
+    Teams_lists[team_id].drawFlag(dest, x, y);
+}
+
 bool TeamManager::testRuleScoreLimit( long score_limit )
 {
     for (Uint8 team_id = 0; team_id &lt; max_Teams; ++team_id )

Modified: trunk/netpanzer/src/NetPanzer/Interfaces/TeamManager.hpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Interfaces/TeamManager.hpp	2012-04-25 20:30:37 UTC (rev 1355)
+++ trunk/netpanzer/src/NetPanzer/Interfaces/TeamManager.hpp	2012-04-27 09:55:16 UTC (rev 1356)
@@ -28,22 +28,20 @@
 
 public:
     static void initialize(const Uint8 _max_teams);
+
     static void addPlayer(PlayerID player_id);
     static void addPlayerinTeam(PlayerID player_id, Uint8 team_id);
+    static void removePlayer(PlayerID player_id, Uint8 team_id);
     
     static void cleanUp();
-    static PlayerID getMaxteams()
-    {
-        return max_Teams;
-    }
-    static void spawnTeams();
-    static void spawnPlayer(PlayerID player_id);
+
+    static PlayerID getMaxteams(){return max_Teams;}
     static iXY getPlayerSpawnPoint(PlayerID player_id);
-    static void removePlayer(PlayerID player_id, Uint8 team_id);
 
-    static long GetTeamScore( Uint8 team_id );
+    static long getTeamScore( Uint8 team_id );
     static const std::string&amp; getTeamName( Uint8 team_id );
     static bool testRuleScoreLimit( long score_limit );
+    static void drawFlag(Uint8 team_id, Surface &amp;dest, int x, int y);
     
     static void PlayerrequestchangeTeam(PlayerID player_id, Uint8 newteam);
     static void serverrequestchangeTeam(PlayerID player_id, Uint8 team_idx);

Modified: trunk/netpanzer/src/NetPanzer/Units/Vehicle.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Units/Vehicle.cpp	2012-04-25 20:30:37 UTC (rev 1355)
+++ trunk/netpanzer/src/NetPanzer/Units/Vehicle.cpp	2012-04-27 09:55:16 UTC (rev 1356)
@@ -135,6 +135,7 @@
     select_info_box.setBoxState( false );
     select_info_box.setFlag( player-&gt;getFlag() );
     select_info_box.setName( player-&gt;getName() );
+    select_info_box.setTeam( player-&gt;getTeamID() );
 
     body_anim_shadow.attachSprite( &amp;body_anim, zero );
     body_anim_shadow.attachSprite( &amp;turret_anim_shadow, zero );

Modified: trunk/netpanzer/src/NetPanzer/Views/Components/InfoBar.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Views/Components/InfoBar.cpp	2012-04-25 20:30:37 UTC (rev 1355)
+++ trunk/netpanzer/src/NetPanzer/Views/Components/InfoBar.cpp	2012-04-27 09:55:16 UTC (rev 1356)
@@ -25,6 +25,7 @@
 #include &quot;Interfaces/PlayerInterface.hpp&quot;
 #include &quot;Objectives/ObjectiveInterface.hpp&quot;
 #include &quot;Interfaces/GameManager.hpp&quot;
+#include &quot;Interfaces/TeamManager.hpp&quot;
 
 
 static const PIX titles_color = 206; // #6d78c1 more or less &quot;slate blue&quot;
@@ -57,7 +58,8 @@
              int(UnitInterface::getUnitCount(PlayerInterface::getLocalPlayerIndex())),
              GameConfig::game_maxunits / GameConfig::game_maxplayers,
              
-             PlayerInterface::getLocalPlayer()-&gt;getKills(),
+             (GameConfig::game_gametype == true)?PlayerInterface::getLocalPlayer()-&gt;getKills()
+             :TeamManager::getTeamScore(PlayerInterface::getLocalPlayer()-&gt;getTeamID()),
              (GameConfig::game_gametype == _gametype_fraglimit)?(int)GameConfig::game_fraglimit:0,
              
              PlayerInterface::getLocalPlayer()-&gt;getObjectivesHeld(),

Modified: trunk/netpanzer/src/NetPanzer/Views/Game/EndRoundView.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Views/Game/EndRoundView.cpp	2012-04-25 20:30:37 UTC (rev 1355)
+++ trunk/netpanzer/src/NetPanzer/Views/Game/EndRoundView.cpp	2012-04-27 09:55:16 UTC (rev 1356)
@@ -26,8 +26,8 @@
 #include &quot;Views/GameViewGlobals.hpp&quot;
 #include &quot;Classes/ScreenSurface.hpp&quot;
 #include &quot;Interfaces/PlayerInterface.hpp&quot;
-#include &quot;Classes/Network/PlayerNetMessage.hpp&quot;
-#include &quot;Classes/Network/NetworkClient.hpp&quot;
+#include &quot;Interfaces/TeamManager.hpp&quot;
+#include &quot;Classes/WorldInputCmdProcessor.hpp&quot;
 #include &quot;Interfaces/GameConfig.hpp&quot;
 #include &quot;Objectives/ObjectiveInterface.hpp&quot;
 
@@ -123,7 +123,17 @@
     }
 };
 
+class StatesSortByTeam
+    : public std::binary_function&lt;const PlayerState*, const PlayerState*, bool&gt;
+{
+public:
+    bool operator() (const PlayerState* state1, const PlayerState* state2)
+    {
+            return state1-&gt;getTeamID() &lt; state2-&gt;getTeamID();
+    }
+};
 
+
 // drawPlayerStats
 //---------------------------------------------------------------------------
 // Purpose:
@@ -142,7 +152,11 @@
             states.push_back(state);
         }
     }
-
+    if (GameConfig::game_teammode)
+    {
+        std::sort(states.begin(), states.end(), StatesSortByTeam());
+    }
+    else
     switch(GameConfig::game_gametype)
     {
         case _gametype_objective:
@@ -169,6 +183,7 @@
     cur_line_pos += ENTRY_HEIGHT;
     flag_pos += ENTRY_HEIGHT;
     ++cur_state;
+
     for(std::vector&lt;const PlayerState*&gt;::iterator i = states.begin();
             i != states.end(); ++i) {
         const PlayerState* state = *i;
@@ -215,45 +230,6 @@
 
 }
 
-void EndRoundView::lMouseDown(const iXY&amp; pos)
-{
-    // XXX ALLY
-    if ( pos.x &gt;= 4 &amp;&amp; pos.x &lt;= 24 &amp;&amp; pos.y &gt;= TABLE_START )
-    {
-        unsigned int ypos = pos.y - TABLE_START;
-        unsigned int linepos = ypos / ENTRY_HEIGHT;
-        if ( linepos &lt; states.size() )
-        {
-            unsigned int destplayer = states[linepos]-&gt;getID();
-            unsigned int localplayer = PlayerInterface::getLocalPlayerIndex();
-            if ( destplayer != localplayer )
-            {
-                PlayerAllianceRequest allie_request;
-
-                if ( PlayerInterface::isSingleAllied(localplayer, destplayer) )
-                {
-                    allie_request.set( localplayer, destplayer, _player_break_alliance);
-                }
-                else
-                {
-                    allie_request.set( localplayer, destplayer, _player_make_alliance);
-                }
-
-                CLIENT-&gt;sendMessage( &amp;allie_request, sizeof(PlayerAllianceRequest));
-            }
-        }
-    }
-}
-
-void EndRoundView::mouseMove(const iXY &amp; prevPos, const iXY &amp;newPos)
-{
-    selected_line = -1;
-    if ( newPos.y &gt;= TABLE_START )
-    {
-        selected_line = (newPos.y-TABLE_START) / ENTRY_HEIGHT;
-    }
-}
-
 void EndRoundView::doActivate()
 {
     selected_line = -1;
@@ -270,3 +246,8 @@
     int y = (screen-&gt;getHeight() / 2) - 250;
     moveTo(iXY(x, y));
 }
+
+void EndRoundView::processEvents()
+{
+    COMMAND_PROCESSOR.process(false);
+}

Modified: trunk/netpanzer/src/NetPanzer/Views/Game/EndRoundView.hpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Views/Game/EndRoundView.hpp	2012-04-25 20:30:37 UTC (rev 1355)
+++ trunk/netpanzer/src/NetPanzer/Views/Game/EndRoundView.hpp	2012-04-27 09:55:16 UTC (rev 1356)
@@ -53,10 +53,9 @@
     void checkResolution(iXY oldResolution, iXY newResolution);
 
 protected:
-    virtual void lMouseDown(const iXY &amp;pos);
-    virtual void mouseMove(const iXY &amp; prevPos, const iXY &amp;newPos);
     virtual void doActivate();
     virtual void doDeactivate();
+    virtual void processEvents();
     void drawTitle(Surface &amp;windowArea)
     {
     }

Modified: trunk/netpanzer/src/NetPanzer/Views/Game/GTeamView.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Views/Game/GTeamView.cpp	2012-04-25 20:30:37 UTC (rev 1355)
+++ trunk/netpanzer/src/NetPanzer/Views/Game/GTeamView.cpp	2012-04-27 09:55:16 UTC (rev 1356)
@@ -45,10 +45,7 @@
     setVisible(false);
     setBordered(false);
  
-    loaded = false;
-    TeamOneImage.loadBMP(&quot;pics/default/team-one.bmp&quot;);
-    TeamTwoImage.loadBMP(&quot;pics/default/team-two.bmp&quot;);
- 
+    loaded = false; 
 }
  
 void GTeamView::init()
@@ -90,7 +87,7 @@
 public:
     bool operator() (const PlayerState* state1, const PlayerState* state2)
     {
-        return state1-&gt;getTeamID() &lt; state2-&gt;getTeamID();
+            return state1-&gt;getTeamID() &lt; state2-&gt;getTeamID();
     }
 };
  
@@ -111,12 +108,12 @@
     std::sort(states.begin(), states.end(), StatesSortByTeam());
  
     int cur_line_pos = firstrect.min.y +20;
-    snprintf(statBuf, sizeof(statBuf), &quot;%-20s%6ld&quot;, TeamManager::getTeamName(0).c_str(), TeamManager::GetTeamScore(0));
+    snprintf(statBuf, sizeof(statBuf), &quot;%-20s%6ld&quot;, TeamManager::getTeamName(0).c_str(), TeamManager::getTeamScore(0));
     dest.bltStringShadowed(firstrect.min.x+10, cur_line_pos, statBuf,Color::lightGreen, Color::gray64);
-    TeamOneImage.bltTrans(dest, firstrect.min.x+(firstrect.getSizeX()/2), cur_line_pos-15 );
-    snprintf(statBuf, sizeof(statBuf), &quot;%-20s%6ld&quot;, TeamManager::getTeamName(1).c_str(), TeamManager::GetTeamScore(1));
+    TeamManager::drawFlag(0, dest, firstrect.min.x+(firstrect.getSizeX()/2), cur_line_pos-17 );
+    snprintf(statBuf, sizeof(statBuf), &quot;%-20s%6ld&quot;, TeamManager::getTeamName(1).c_str(), TeamManager::getTeamScore(1));
     dest.bltStringShadowed(secondrect.min.x+10, cur_line_pos, statBuf,Color::lightGreen, Color::gray64);
-    TeamTwoImage.bltTrans(dest, secondrect.min.x+(secondrect.getSizeX()/2), cur_line_pos-15 );
+    TeamManager::drawFlag(1, dest, secondrect.min.x+(secondrect.getSizeX()/2), cur_line_pos-17);
     cur_line_pos += 25;
     dest.drawLine(firstrect.min.x+10, cur_line_pos-10, firstrect.max.x-10, cur_line_pos-10, Color::lightGreen);
     dest.drawLine(secondrect.min.x+10, cur_line_pos-10, secondrect.max.x-10, cur_line_pos-10, Color::lightGreen);

Modified: trunk/netpanzer/src/NetPanzer/Views/Game/GTeamView.hpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Views/Game/GTeamView.hpp	2012-04-25 20:30:37 UTC (rev 1355)
+++ trunk/netpanzer/src/NetPanzer/Views/Game/GTeamView.hpp	2012-04-27 09:55:16 UTC (rev 1356)
@@ -30,8 +30,6 @@
 private:
     bool loaded;
 
-    Surface TeamOneImage;
-    Surface TeamTwoImage;
     iRect firstrect;
     iRect secondrect;
     std::vector&lt;const PlayerState*&gt; states;

</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000379.html">[Netpanzer-cvs] r1355 - in trunk/netpanzer/src/NetPanzer:	Classes/Network Interfaces Views/Game
</A></li>
	<LI>Next message: <A HREF="000381.html">[Netpanzer-cvs] r1357 - in trunk/netpanzer/src/NetPanzer:	Interfaces Views/Game
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#380">[ date ]</a>
              <a href="thread.html#380">[ thread ]</a>
              <a href="subject.html#380">[ subject ]</a>
              <a href="author.html#380">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/netpanzer-cvs">More information about the Netpanzer-cvs
mailing list</a><br>
</body></html>
