<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Netpanzer-cvs] r1050 - in trunk/netpanzer: nbproject src/NetPanzer	src/NetPanzer/Bot src/NetPanzer/Classes	src/NetPanzer/Classes/AI src/NetPanzer/Classes/Network	src/NetPanzer/Classes/Weapons src/NetPanzer/Interfaces	src/NetPanzer/Objectives src/NetPanzer/Particles	src/NetPanzer/PowerUps src/NetPanzer/Structs	src/NetPanzer/Units src/NetPanzer/Views/Game
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/netpanzer-cvs/2008-September/index.html" >
   <LINK REL="made" HREF="mailto:netpanzer-cvs%40lists.berlios.de?Subject=Re%3A%20%5BNetpanzer-cvs%5D%20r1050%20-%20in%20trunk/netpanzer%3A%20nbproject%20src/NetPanzer%0A%09src/NetPanzer/Bot%20src/NetPanzer/Classes%0A%09src/NetPanzer/Classes/AI%20src/NetPanzer/Classes/Network%0A%09src/NetPanzer/Classes/Weapons%20src/NetPanzer/Interfaces%0A%09src/NetPanzer/Objectives%20src/NetPanzer/Particles%0A%09src/NetPanzer/PowerUps%20src/NetPanzer/Structs%0A%09src/NetPanzer/Units%20src/NetPanzer/Views/Game&In-Reply-To=%3C200809091632.m89GWkX1001635%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000088.html">
   <LINK REL="Next"  HREF="000090.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Netpanzer-cvs] r1050 - in trunk/netpanzer: nbproject src/NetPanzer	src/NetPanzer/Bot src/NetPanzer/Classes	src/NetPanzer/Classes/AI src/NetPanzer/Classes/Network	src/NetPanzer/Classes/Weapons src/NetPanzer/Interfaces	src/NetPanzer/Objectives src/NetPanzer/Particles	src/NetPanzer/PowerUps src/NetPanzer/Structs	src/NetPanzer/Units src/NetPanzer/Views/Game</H1>
    <B>kromxp at mail.berlios.de</B> 
    <A HREF="mailto:netpanzer-cvs%40lists.berlios.de?Subject=Re%3A%20%5BNetpanzer-cvs%5D%20r1050%20-%20in%20trunk/netpanzer%3A%20nbproject%20src/NetPanzer%0A%09src/NetPanzer/Bot%20src/NetPanzer/Classes%0A%09src/NetPanzer/Classes/AI%20src/NetPanzer/Classes/Network%0A%09src/NetPanzer/Classes/Weapons%20src/NetPanzer/Interfaces%0A%09src/NetPanzer/Objectives%20src/NetPanzer/Particles%0A%09src/NetPanzer/PowerUps%20src/NetPanzer/Structs%0A%09src/NetPanzer/Units%20src/NetPanzer/Views/Game&In-Reply-To=%3C200809091632.m89GWkX1001635%40sheep.berlios.de%3E"
       TITLE="[Netpanzer-cvs] r1050 - in trunk/netpanzer: nbproject src/NetPanzer	src/NetPanzer/Bot src/NetPanzer/Classes	src/NetPanzer/Classes/AI src/NetPanzer/Classes/Network	src/NetPanzer/Classes/Weapons src/NetPanzer/Interfaces	src/NetPanzer/Objectives src/NetPanzer/Particles	src/NetPanzer/PowerUps src/NetPanzer/Structs	src/NetPanzer/Units src/NetPanzer/Views/Game">kromxp at mail.berlios.de
       </A><BR>
    <I>Tue Sep  9 18:32:46 CEST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="000088.html">[Netpanzer-cvs] r1049 - in trunk/netpanzer: nbproject	src/NetPanzer/Bot src/NetPanzer/Classes	src/NetPanzer/Classes/Network src/NetPanzer/Interfaces	src/NetPanzer/Objectives src/NetPanzer/Views/Game
</A></li>
        <LI>Next message: <A HREF="000090.html">[Netpanzer-cvs] r1051 - in trunk/netpanzer: nbproject src/NetPanzer	src/NetPanzer/Classes src/NetPanzer/Interfaces src/NetPanzer/Weapons
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#89">[ date ]</a>
              <a href="thread.html#89">[ thread ]</a>
              <a href="subject.html#89">[ subject ]</a>
              <a href="author.html#89">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: kromxp
Date: 2008-09-09 18:30:13 +0200 (Tue, 09 Sep 2008)
New Revision: 1050

Added:
   trunk/netpanzer/src/NetPanzer/Units/
   trunk/netpanzer/src/NetPanzer/Units/UnitBase.hpp
   trunk/netpanzer/src/NetPanzer/Units/UnitBlackBoard.cpp
   trunk/netpanzer/src/NetPanzer/Units/UnitBlackBoard.hpp
   trunk/netpanzer/src/NetPanzer/Units/UnitBucketArray.cpp
   trunk/netpanzer/src/NetPanzer/Units/UnitBucketArray.hpp
   trunk/netpanzer/src/NetPanzer/Units/UnitInterface.cpp
   trunk/netpanzer/src/NetPanzer/Units/UnitInterface.hpp
   trunk/netpanzer/src/NetPanzer/Units/UnitLifecycles.hpp
   trunk/netpanzer/src/NetPanzer/Units/UnitList.hpp
   trunk/netpanzer/src/NetPanzer/Units/UnitOpcodeDecoder.cpp
   trunk/netpanzer/src/NetPanzer/Units/UnitOpcodeDecoder.hpp
   trunk/netpanzer/src/NetPanzer/Units/UnitOpcodeEncoder.cpp
   trunk/netpanzer/src/NetPanzer/Units/UnitOpcodeEncoder.hpp
   trunk/netpanzer/src/NetPanzer/Units/UnitOpcodes.hpp
   trunk/netpanzer/src/NetPanzer/Units/UnitProfileInterface.cpp
   trunk/netpanzer/src/NetPanzer/Units/UnitProfileInterface.hpp
   trunk/netpanzer/src/NetPanzer/Units/UnitState.cpp
   trunk/netpanzer/src/NetPanzer/Units/UnitState.hpp
   trunk/netpanzer/src/NetPanzer/Units/UnitTypes.hpp
Removed:
   trunk/netpanzer/src/NetPanzer/Classes/UnitBase.hpp
   trunk/netpanzer/src/NetPanzer/Classes/UnitBlackBoard.cpp
   trunk/netpanzer/src/NetPanzer/Classes/UnitBlackBoard.hpp
   trunk/netpanzer/src/NetPanzer/Classes/UnitBucketArray.cpp
   trunk/netpanzer/src/NetPanzer/Classes/UnitBucketArray.hpp
   trunk/netpanzer/src/NetPanzer/Classes/UnitLifecycles.hpp
   trunk/netpanzer/src/NetPanzer/Classes/UnitList.hpp
   trunk/netpanzer/src/NetPanzer/Classes/UnitOpcodeDecoder.cpp
   trunk/netpanzer/src/NetPanzer/Classes/UnitOpcodeDecoder.hpp
   trunk/netpanzer/src/NetPanzer/Classes/UnitOpcodeEncoder.cpp
   trunk/netpanzer/src/NetPanzer/Classes/UnitOpcodeEncoder.hpp
   trunk/netpanzer/src/NetPanzer/Classes/UnitOpcodes.hpp
   trunk/netpanzer/src/NetPanzer/Classes/UnitState.cpp
   trunk/netpanzer/src/NetPanzer/Classes/UnitState.hpp
   trunk/netpanzer/src/NetPanzer/Classes/Units/
   trunk/netpanzer/src/NetPanzer/Interfaces/UnitInterface.cpp
   trunk/netpanzer/src/NetPanzer/Interfaces/UnitInterface.hpp
   trunk/netpanzer/src/NetPanzer/Interfaces/UnitProfileInterface.cpp
   trunk/netpanzer/src/NetPanzer/Interfaces/UnitProfileInterface.hpp
   trunk/netpanzer/src/NetPanzer/Structs/UnitTypes.hpp
Modified:
   trunk/netpanzer/nbproject/Makefile-mac-debug.mk
   trunk/netpanzer/nbproject/configurations.xml
   trunk/netpanzer/src/NetPanzer/Bot/Bot.cpp
   trunk/netpanzer/src/NetPanzer/Bot/BotPlayer.cpp
   trunk/netpanzer/src/NetPanzer/Bot/BotTask.hpp
   trunk/netpanzer/src/NetPanzer/Bot/BotTaskList.hpp
   trunk/netpanzer/src/NetPanzer/Classes/AI/Astar.hpp
   trunk/netpanzer/src/NetPanzer/Classes/Network/ClientConnectDaemon.cpp
   trunk/netpanzer/src/NetPanzer/Classes/Network/ClientMessageRouter.cpp
   trunk/netpanzer/src/NetPanzer/Classes/Network/NetPacketDebugger.cpp
   trunk/netpanzer/src/NetPanzer/Classes/Network/PowerUpNetMessage.hpp
   trunk/netpanzer/src/NetPanzer/Classes/Network/ServerConnectDaemon.cpp
   trunk/netpanzer/src/NetPanzer/Classes/Network/ServerMessageRouter.cpp
   trunk/netpanzer/src/NetPanzer/Classes/Network/UnitNetMessage.hpp
   trunk/netpanzer/src/NetPanzer/Classes/Network/UnitSync.cpp
   trunk/netpanzer/src/NetPanzer/Classes/Network/UnitSync.hpp
   trunk/netpanzer/src/NetPanzer/Classes/OpcodeDebugger.cpp
   trunk/netpanzer/src/NetPanzer/Classes/PlacementMatrix.cpp
   trunk/netpanzer/src/NetPanzer/Classes/PlayerUnitConfig.cpp
   trunk/netpanzer/src/NetPanzer/Classes/PlayerUnitConfig.hpp
   trunk/netpanzer/src/NetPanzer/Classes/SelectionList.cpp
   trunk/netpanzer/src/NetPanzer/Classes/SelectionList.hpp
   trunk/netpanzer/src/NetPanzer/Classes/UnitMessage.hpp
   trunk/netpanzer/src/NetPanzer/Classes/Weapons/BulletWeapon.cpp
   trunk/netpanzer/src/NetPanzer/Classes/Weapons/MissleWeapon.cpp
   trunk/netpanzer/src/NetPanzer/Classes/Weapons/ShellWeapon.cpp
   trunk/netpanzer/src/NetPanzer/Classes/Weapons/Weapon.cpp
   trunk/netpanzer/src/NetPanzer/Classes/Weapons/Weapon.hpp
   trunk/netpanzer/src/NetPanzer/Classes/WorldInputCmdProcessor.cpp
   trunk/netpanzer/src/NetPanzer/Interfaces/BaseGameManager.cpp
   trunk/netpanzer/src/NetPanzer/Interfaces/GameManager.cpp
   trunk/netpanzer/src/NetPanzer/Interfaces/MiniMapInterface.cpp
   trunk/netpanzer/src/NetPanzer/Interfaces/PathScheduler.hpp
   trunk/netpanzer/src/NetPanzer/Interfaces/PlayerGameManager.cpp
   trunk/netpanzer/src/NetPanzer/Interfaces/PlayerInterface.cpp
   trunk/netpanzer/src/NetPanzer/Interfaces/PlayerInterface.hpp
   trunk/netpanzer/src/NetPanzer/Jamfile
   trunk/netpanzer/src/NetPanzer/Objectives/Objective.cpp
   trunk/netpanzer/src/NetPanzer/Objectives/Outpost.cpp
   trunk/netpanzer/src/NetPanzer/Objectives/Outpost.hpp
   trunk/netpanzer/src/NetPanzer/Particles/ChunkTrajectoryParticle2D.cpp
   trunk/netpanzer/src/NetPanzer/Particles/ParticleInterface.cpp
   trunk/netpanzer/src/NetPanzer/Particles/ParticleInterface.hpp
   trunk/netpanzer/src/NetPanzer/PowerUps/BonusUnitPowerUp.cpp
   trunk/netpanzer/src/NetPanzer/PowerUps/EnemyRadarPowerUp.cpp
   trunk/netpanzer/src/NetPanzer/PowerUps/PowerUp.cpp
   trunk/netpanzer/src/NetPanzer/PowerUps/UnitPowerUp.cpp
   trunk/netpanzer/src/NetPanzer/PowerUps/UnitPowerUp.hpp
   trunk/netpanzer/src/NetPanzer/Units/Vehicle.cpp
   trunk/netpanzer/src/NetPanzer/Units/Vehicle.hpp
   trunk/netpanzer/src/NetPanzer/Views/Game/CodeStatsView.cpp
   trunk/netpanzer/src/NetPanzer/Views/Game/GameInfoView.cpp
   trunk/netpanzer/src/NetPanzer/Views/Game/GameView.cpp
   trunk/netpanzer/src/NetPanzer/Views/Game/VehicleSelectionView.cpp
   trunk/netpanzer/src/NetPanzer/Views/Game/VehicleSelectionView.hpp
Log:
- Moved the unit related classes to src/NetPanzer/Units, #includes and netbeans project updated

Modified: trunk/netpanzer/nbproject/Makefile-mac-debug.mk
===================================================================
--- trunk/netpanzer/nbproject/Makefile-mac-debug.mk	2008-09-09 15:53:32 UTC (rev 1049)
+++ trunk/netpanzer/nbproject/Makefile-mac-debug.mk	2008-09-09 16:30:13 UTC (rev 1050)
@@ -30,6 +30,7 @@
 	${OBJECTDIR}/src/NetPanzer/Views/Game/LoadingView.o \
 	${OBJECTDIR}/src/NetPanzer/Particles/WindParticle2D.o \
 	${OBJECTDIR}/src/NetPanzer/System/SDLSound.o \
+	${OBJECTDIR}/src/NetPanzer/Units/UnitInterface.o \
 	${OBJECTDIR}/src/NetPanzer/Views/MainMenu/Multi/HostJoinTemplateView.o \
 	${OBJECTDIR}/src/NetPanzer/Interfaces/BaseGameManager.o \
 	${OBJECTDIR}/src/NetPanzer/Classes/PlayerState.o \
@@ -54,7 +55,6 @@
 	${OBJECTDIR}/src/NetPanzer/Classes/Weapons/ShellWeapon.o \
 	${OBJECTDIR}/src/NetPanzer/Classes/WorldInputCmdProcessor.o \
 	${OBJECTDIR}/src/Lib/physfs/archivers/zip.o \
-	${OBJECTDIR}/src/NetPanzer/Classes/Units/Vehicle.o \
 	${OBJECTDIR}/src/NetPanzer/Classes/MapFile.o \
 	${OBJECTDIR}/src/Lib/Util/StringUtil.o \
 	${OBJECTDIR}/src/Lib/Util/TimeStamp.o \
@@ -81,13 +81,11 @@
 	${OBJECTDIR}/src/NetPanzer/Interfaces/MapInterface.o \
 	${OBJECTDIR}/src/NetPanzer/System/SDLEvents.o \
 	${OBJECTDIR}/src/NetPanzer/Views/MainMenu/SpecialButtonView.o \
-	${OBJECTDIR}/src/NetPanzer/Interfaces/UnitProfileInterface.o \
 	${OBJECTDIR}/src/NetPanzer/Classes/TileSet.o \
 	${OBJECTDIR}/src/Lib/lua/loadlib.o \
 	${OBJECTDIR}/src/Lib/lua/lgc.o \
 	${OBJECTDIR}/src/Lib/2D/Span.o \
 	${OBJECTDIR}/src/NetPanzer/Core/main.o \
-	${OBJECTDIR}/src/NetPanzer/Classes/UnitBucketArray.o \
 	${OBJECTDIR}/src/NetPanzer/Particles/TrajectoryParticle2D.o \
 	${OBJECTDIR}/src/NetPanzer/Particles/SmokingTrajectoryParticle2D.o \
 	${OBJECTDIR}/src/NetPanzer/Views/MainMenu/Multi/GetSessionView.o \
@@ -97,6 +95,7 @@
 	${OBJECTDIR}/src/Lib/lua/lopcodes.o \
 	${OBJECTDIR}/src/NetPanzer/Interfaces/DedicatedGameManager.o \
 	${OBJECTDIR}/src/NetPanzer/Classes/Network/NetworkInterface.o \
+	${OBJECTDIR}/src/NetPanzer/Units/UnitBlackBoard.o \
 	${OBJECTDIR}/src/Lib/Types/fRect.o \
 	${OBJECTDIR}/src/NetPanzer/Interfaces/TileInterface.o \
 	${OBJECTDIR}/src/NetPanzer/Particles/CloudParticle2D.o \
@@ -104,14 +103,13 @@
 	${OBJECTDIR}/src/NetPanzer/System/DummySound.o \
 	${OBJECTDIR}/src/Lib/lua/lfunc.o \
 	${OBJECTDIR}/src/NetPanzer/Classes/Weapons/BulletWeapon.o \
-	${OBJECTDIR}/src/NetPanzer/Interfaces/UnitInterface.o \
+	${OBJECTDIR}/src/NetPanzer/Units/UnitState.o \
 	${OBJECTDIR}/src/NetPanzer/Views/MainMenu/Multi/UnitColorView.o \
 	${OBJECTDIR}/src/NetPanzer/Particles/SmolderParticleSystem2D.o \
 	${OBJECTDIR}/src/NetPanzer/Views/Game/LibView.o \
 	${OBJECTDIR}/src/NetPanzer/Views/Components/CheckBox.o \
 	${OBJECTDIR}/src/NetPanzer/PowerUps/BonusUnitPowerUp.o \
 	${OBJECTDIR}/src/Lib/INIParser/Store.o \
-	${OBJECTDIR}/src/NetPanzer/Classes/UnitOpcodeEncoder.o \
 	${OBJECTDIR}/src/Lib/physfs/physfs_byteorder.o \
 	${OBJECTDIR}/src/Lib/physfs/physfs_unicode.o \
 	${OBJECTDIR}/src/NetPanzer/Particles/GroundExplosionParticleSystem2D.o \
@@ -139,6 +137,7 @@
 	${OBJECTDIR}/src/NetPanzer/Interfaces/ConsoleInterface.o \
 	${OBJECTDIR}/src/NetPanzer/PowerUps/UnitPowerUp.o \
 	${OBJECTDIR}/src/NetPanzer/Views/Game/GameInfoView.o \
+	${OBJECTDIR}/src/NetPanzer/Units/UnitOpcodeDecoder.o \
 	${OBJECTDIR}/src/Lib/physfs/zlib123/uncompr.o \
 	${OBJECTDIR}/src/Lib/lua/lcode.o \
 	${OBJECTDIR}/src/Lib/2D/DigitText.o \
@@ -148,6 +147,7 @@
 	${OBJECTDIR}/src/NetPanzer/Views/Game/AreYouSureExitView.o \
 	${OBJECTDIR}/src/Lib/physfs/zlib123/gzio.o \
 	${OBJECTDIR}/src/NetPanzer/Classes/PlayerUnitConfig.o \
+	${OBJECTDIR}/src/NetPanzer/Units/UnitOpcodeEncoder.o \
 	${OBJECTDIR}/src/Lib/Types/iXY.o \
 	${OBJECTDIR}/src/NetPanzer/Interfaces/ChatInterface.o \
 	${OBJECTDIR}/src/Lib/lua/lapi.o \
@@ -164,13 +164,11 @@
 	${OBJECTDIR}/src/NetPanzer/Views/Components/ScrollBar.o \
 	${OBJECTDIR}/src/NetPanzer/Classes/Network/NetPacketDebugger.o \
 	${OBJECTDIR}/src/Lib/lua/print.o \
-	${OBJECTDIR}/src/NetPanzer/Classes/UnitBlackBoard.o \
 	${OBJECTDIR}/src/NetPanzer/Particles/ParticleSystem2D.o \
 	${OBJECTDIR}/src/NetPanzer/Classes/WorldMap.o \
 	${OBJECTDIR}/src/Lib/physfs/archivers/dir.o \
 	${OBJECTDIR}/src/Lib/lua/ldblib.o \
 	${OBJECTDIR}/src/NetPanzer/Views/MainMenu/MainMenuView.o \
-	${OBJECTDIR}/src/NetPanzer/Classes/UnitState.o \
 	${OBJECTDIR}/src/NetPanzer/Views/MainMenu/SkirmishView.o \
 	${OBJECTDIR}/src/Lib/physfs/zlib123/crc32.o \
 	${OBJECTDIR}/src/NetPanzer/Interfaces/PlayerGameManager.o \
@@ -200,6 +198,7 @@
 	${OBJECTDIR}/src/NetPanzer/Classes/Network/UnitSync.o \
 	${OBJECTDIR}/src/NetPanzer/Views/Components/Label.o \
 	${OBJECTDIR}/src/NetPanzer/Views/MainMenu/Multi/HostView.o \
+	${OBJECTDIR}/src/NetPanzer/Units/UnitBucketArray.o \
 	${OBJECTDIR}/src/Lib/Util/UtilInterface.o \
 	${OBJECTDIR}/src/NetPanzer/Classes/SelectionList.o \
 	${OBJECTDIR}/src/NetPanzer/Interfaces/MiniMapInterface.o \
@@ -220,7 +219,6 @@
 	${OBJECTDIR}/src/NetPanzer/Classes/Weapons/MissleWeapon.o \
 	${OBJECTDIR}/src/NetPanzer/Classes/Sprite.o \
 	${OBJECTDIR}/src/NetPanzer/Particles/SnowParticle2D.o \
-	${OBJECTDIR}/src/NetPanzer/Classes/Units/UnitGlobals.o \
 	${OBJECTDIR}/src/NetPanzer/Views/Components/Button.o \
 	${OBJECTDIR}/src/Lib/Types/iRect.o \
 	${OBJECTDIR}/src/Lib/lua/lundump.o \
@@ -232,6 +230,7 @@
 	${OBJECTDIR}/src/Lib/Network/TCPListenSocket.o \
 	${OBJECTDIR}/src/NetPanzer/PowerUps/EnemyRadarPowerUp.o \
 	${OBJECTDIR}/src/Lib/Network/TCPSocket.o \
+	${OBJECTDIR}/src/NetPanzer/Units/UnitGlobals.o \
 	${OBJECTDIR}/src/NetPanzer/Views/Game/GameTemplateView.o \
 	${OBJECTDIR}/src/NetPanzer/Interfaces/GameManager.o \
 	${OBJECTDIR}/src/NetPanzer/Bot/BotTaskList.o \
@@ -240,6 +239,7 @@
 	${OBJECTDIR}/src/Lib/physfs/platform/pocketpc.o \
 	${OBJECTDIR}/src/Lib/lua/ltable.o \
 	${OBJECTDIR}/src/NetPanzer/Particles/RadarPingParticle2D.o \
+	${OBJECTDIR}/src/NetPanzer/Units/UnitProfileInterface.o \
 	${OBJECTDIR}/src/NetPanzer/Particles/Particle2D.o \
 	${OBJECTDIR}/src/Lib/lua/lstring.o \
 	${OBJECTDIR}/src/NetPanzer/Interfaces/MapsManager.o \
@@ -252,10 +252,10 @@
 	${OBJECTDIR}/src/NetPanzer/Views/Game/ResignView.o \
 	${OBJECTDIR}/src/Lib/Util/Log.o \
 	${OBJECTDIR}/src/Lib/optionmm/command_line.o \
+	${OBJECTDIR}/src/NetPanzer/Units/Vehicle.o \
 	${OBJECTDIR}/src/NetPanzer/Views/MainMenu/MenuTemplateView.o \
 	${OBJECTDIR}/src/NetPanzer/Views/Game/VehicleSelectionView.o \
 	${OBJECTDIR}/src/NetPanzer/PowerUps/PowerUp.o \
-	${OBJECTDIR}/src/NetPanzer/Classes/UnitOpcodeDecoder.o \
 	${OBJECTDIR}/src/NetPanzer/Views/MainMenu/Multi/IPAddressView.o \
 	${OBJECTDIR}/src/Lib/physfs/zlib123/deflate.o \
 	${OBJECTDIR}/src/NetPanzer/Views/MainMenu/Multi/UnitSelectionView.o \
@@ -332,6 +332,10 @@
 	${MKDIR} -p ${OBJECTDIR}/src/NetPanzer/System
 	$(COMPILE.cc) -g -Wall -DPHYSFS_SUPPORTS_ZIP=1 -DZ_PREFIX=1 -I. -Isrc/Lib -Isrc/NetPanzer -Isrc/Lib/physfs -Isrc/Lib/physfs/zlib123 -I/Library/Frameworks/SDL.framework/Versions/A/Headers -I/Library/Frameworks/SDL_mixer.framework/Versions/A/Headers -o ${OBJECTDIR}/src/NetPanzer/System/SDLSound.o src/NetPanzer/System/SDLSound.cpp
 
+${OBJECTDIR}/src/NetPanzer/Units/UnitInterface.o: src/NetPanzer/Units/UnitInterface.cpp 
+	${MKDIR} -p ${OBJECTDIR}/src/NetPanzer/Units
+	$(COMPILE.cc) -g -Wall -DPHYSFS_SUPPORTS_ZIP=1 -DZ_PREFIX=1 -I. -Isrc/Lib -Isrc/NetPanzer -Isrc/Lib/physfs -Isrc/Lib/physfs/zlib123 -I/Library/Frameworks/SDL.framework/Versions/A/Headers -I/Library/Frameworks/SDL_mixer.framework/Versions/A/Headers -o ${OBJECTDIR}/src/NetPanzer/Units/UnitInterface.o src/NetPanzer/Units/UnitInterface.cpp
+
 ${OBJECTDIR}/src/NetPanzer/Views/MainMenu/Multi/HostJoinTemplateView.o: src/NetPanzer/Views/MainMenu/Multi/HostJoinTemplateView.cpp 
 	${MKDIR} -p ${OBJECTDIR}/src/NetPanzer/Views/MainMenu/Multi
 	$(COMPILE.cc) -g -Wall -DPHYSFS_SUPPORTS_ZIP=1 -DZ_PREFIX=1 -I. -Isrc/Lib -Isrc/NetPanzer -Isrc/Lib/physfs -Isrc/Lib/physfs/zlib123 -I/Library/Frameworks/SDL.framework/Versions/A/Headers -I/Library/Frameworks/SDL_mixer.framework/Versions/A/Headers -o ${OBJECTDIR}/src/NetPanzer/Views/MainMenu/Multi/HostJoinTemplateView.o src/NetPanzer/Views/MainMenu/Multi/HostJoinTemplateView.cpp
@@ -428,10 +432,6 @@
 	${MKDIR} -p ${OBJECTDIR}/src/Lib/physfs/archivers
 	$(COMPILE.c) -g -Wall -DPHYSFS_SUPPORTS_ZIP=1 -DZ_PREFIX=1 -I. -Isrc/Lib -Isrc/NetPanzer -Isrc/Lib/physfs -Isrc/Lib/physfs/zlib123 -I/Library/Frameworks/SDL.framework/Versions/A/Headers -I/Library/Frameworks/SDL_mixer.framework/Versions/A/Headers -o ${OBJECTDIR}/src/Lib/physfs/archivers/zip.o src/Lib/physfs/archivers/zip.c
 
-${OBJECTDIR}/src/NetPanzer/Classes/Units/Vehicle.o: src/NetPanzer/Classes/Units/Vehicle.cpp 
-	${MKDIR} -p ${OBJECTDIR}/src/NetPanzer/Classes/Units
-	$(COMPILE.cc) -g -Wall -DPHYSFS_SUPPORTS_ZIP=1 -DZ_PREFIX=1 -I. -Isrc/Lib -Isrc/NetPanzer -Isrc/Lib/physfs -Isrc/Lib/physfs/zlib123 -I/Library/Frameworks/SDL.framework/Versions/A/Headers -I/Library/Frameworks/SDL_mixer.framework/Versions/A/Headers -o ${OBJECTDIR}/src/NetPanzer/Classes/Units/Vehicle.o src/NetPanzer/Classes/Units/Vehicle.cpp
-
 ${OBJECTDIR}/src/NetPanzer/Classes/MapFile.o: src/NetPanzer/Classes/MapFile.cpp 
 	${MKDIR} -p ${OBJECTDIR}/src/NetPanzer/Classes
 	$(COMPILE.cc) -g -Wall -DPHYSFS_SUPPORTS_ZIP=1 -DZ_PREFIX=1 -I. -Isrc/Lib -Isrc/NetPanzer -Isrc/Lib/physfs -Isrc/Lib/physfs/zlib123 -I/Library/Frameworks/SDL.framework/Versions/A/Headers -I/Library/Frameworks/SDL_mixer.framework/Versions/A/Headers -o ${OBJECTDIR}/src/NetPanzer/Classes/MapFile.o src/NetPanzer/Classes/MapFile.cpp
@@ -536,10 +536,6 @@
 	${MKDIR} -p ${OBJECTDIR}/src/NetPanzer/Views/MainMenu
 	$(COMPILE.cc) -g -Wall -DPHYSFS_SUPPORTS_ZIP=1 -DZ_PREFIX=1 -I. -Isrc/Lib -Isrc/NetPanzer -Isrc/Lib/physfs -Isrc/Lib/physfs/zlib123 -I/Library/Frameworks/SDL.framework/Versions/A/Headers -I/Library/Frameworks/SDL_mixer.framework/Versions/A/Headers -o ${OBJECTDIR}/src/NetPanzer/Views/MainMenu/SpecialButtonView.o src/NetPanzer/Views/MainMenu/SpecialButtonView.cpp
 
-${OBJECTDIR}/src/NetPanzer/Interfaces/UnitProfileInterface.o: src/NetPanzer/Interfaces/UnitProfileInterface.cpp 
-	${MKDIR} -p ${OBJECTDIR}/src/NetPanzer/Interfaces
-	$(COMPILE.cc) -g -Wall -DPHYSFS_SUPPORTS_ZIP=1 -DZ_PREFIX=1 -I. -Isrc/Lib -Isrc/NetPanzer -Isrc/Lib/physfs -Isrc/Lib/physfs/zlib123 -I/Library/Frameworks/SDL.framework/Versions/A/Headers -I/Library/Frameworks/SDL_mixer.framework/Versions/A/Headers -o ${OBJECTDIR}/src/NetPanzer/Interfaces/UnitProfileInterface.o src/NetPanzer/Interfaces/UnitProfileInterface.cpp
-
 ${OBJECTDIR}/src/NetPanzer/Classes/TileSet.o: src/NetPanzer/Classes/TileSet.cpp 
 	${MKDIR} -p ${OBJECTDIR}/src/NetPanzer/Classes
 	$(COMPILE.cc) -g -Wall -DPHYSFS_SUPPORTS_ZIP=1 -DZ_PREFIX=1 -I. -Isrc/Lib -Isrc/NetPanzer -Isrc/Lib/physfs -Isrc/Lib/physfs/zlib123 -I/Library/Frameworks/SDL.framework/Versions/A/Headers -I/Library/Frameworks/SDL_mixer.framework/Versions/A/Headers -o ${OBJECTDIR}/src/NetPanzer/Classes/TileSet.o src/NetPanzer/Classes/TileSet.cpp
@@ -560,10 +556,6 @@
 	${MKDIR} -p ${OBJECTDIR}/src/NetPanzer/Core
 	$(COMPILE.cc) -g -Wall -DPHYSFS_SUPPORTS_ZIP=1 -DZ_PREFIX=1 -I. -Isrc/Lib -Isrc/NetPanzer -Isrc/Lib/physfs -Isrc/Lib/physfs/zlib123 -I/Library/Frameworks/SDL.framework/Versions/A/Headers -I/Library/Frameworks/SDL_mixer.framework/Versions/A/Headers -o ${OBJECTDIR}/src/NetPanzer/Core/main.o src/NetPanzer/Core/main.cpp
 
-${OBJECTDIR}/src/NetPanzer/Classes/UnitBucketArray.o: src/NetPanzer/Classes/UnitBucketArray.cpp 
-	${MKDIR} -p ${OBJECTDIR}/src/NetPanzer/Classes
-	$(COMPILE.cc) -g -Wall -DPHYSFS_SUPPORTS_ZIP=1 -DZ_PREFIX=1 -I. -Isrc/Lib -Isrc/NetPanzer -Isrc/Lib/physfs -Isrc/Lib/physfs/zlib123 -I/Library/Frameworks/SDL.framework/Versions/A/Headers -I/Library/Frameworks/SDL_mixer.framework/Versions/A/Headers -o ${OBJECTDIR}/src/NetPanzer/Classes/UnitBucketArray.o src/NetPanzer/Classes/UnitBucketArray.cpp
-
 ${OBJECTDIR}/src/NetPanzer/Particles/TrajectoryParticle2D.o: src/NetPanzer/Particles/TrajectoryParticle2D.cpp 
 	${MKDIR} -p ${OBJECTDIR}/src/NetPanzer/Particles
 	$(COMPILE.cc) -g -Wall -DPHYSFS_SUPPORTS_ZIP=1 -DZ_PREFIX=1 -I. -Isrc/Lib -Isrc/NetPanzer -Isrc/Lib/physfs -Isrc/Lib/physfs/zlib123 -I/Library/Frameworks/SDL.framework/Versions/A/Headers -I/Library/Frameworks/SDL_mixer.framework/Versions/A/Headers -o ${OBJECTDIR}/src/NetPanzer/Particles/TrajectoryParticle2D.o src/NetPanzer/Particles/TrajectoryParticle2D.cpp
@@ -600,6 +592,10 @@
 	${MKDIR} -p ${OBJECTDIR}/src/NetPanzer/Classes/Network
 	$(COMPILE.cc) -g -Wall -DPHYSFS_SUPPORTS_ZIP=1 -DZ_PREFIX=1 -I. -Isrc/Lib -Isrc/NetPanzer -Isrc/Lib/physfs -Isrc/Lib/physfs/zlib123 -I/Library/Frameworks/SDL.framework/Versions/A/Headers -I/Library/Frameworks/SDL_mixer.framework/Versions/A/Headers -o ${OBJECTDIR}/src/NetPanzer/Classes/Network/NetworkInterface.o src/NetPanzer/Classes/Network/NetworkInterface.cpp
 
+${OBJECTDIR}/src/NetPanzer/Units/UnitBlackBoard.o: src/NetPanzer/Units/UnitBlackBoard.cpp 
+	${MKDIR} -p ${OBJECTDIR}/src/NetPanzer/Units
+	$(COMPILE.cc) -g -Wall -DPHYSFS_SUPPORTS_ZIP=1 -DZ_PREFIX=1 -I. -Isrc/Lib -Isrc/NetPanzer -Isrc/Lib/physfs -Isrc/Lib/physfs/zlib123 -I/Library/Frameworks/SDL.framework/Versions/A/Headers -I/Library/Frameworks/SDL_mixer.framework/Versions/A/Headers -o ${OBJECTDIR}/src/NetPanzer/Units/UnitBlackBoard.o src/NetPanzer/Units/UnitBlackBoard.cpp
+
 ${OBJECTDIR}/src/Lib/Types/fRect.o: src/Lib/Types/fRect.cpp 
 	${MKDIR} -p ${OBJECTDIR}/src/Lib/Types
 	$(COMPILE.cc) -g -Wall -DPHYSFS_SUPPORTS_ZIP=1 -DZ_PREFIX=1 -I. -Isrc/Lib -Isrc/NetPanzer -Isrc/Lib/physfs -Isrc/Lib/physfs/zlib123 -I/Library/Frameworks/SDL.framework/Versions/A/Headers -I/Library/Frameworks/SDL_mixer.framework/Versions/A/Headers -o ${OBJECTDIR}/src/Lib/Types/fRect.o src/Lib/Types/fRect.cpp
@@ -628,9 +624,9 @@
 	${MKDIR} -p ${OBJECTDIR}/src/NetPanzer/Classes/Weapons
 	$(COMPILE.cc) -g -Wall -DPHYSFS_SUPPORTS_ZIP=1 -DZ_PREFIX=1 -I. -Isrc/Lib -Isrc/NetPanzer -Isrc/Lib/physfs -Isrc/Lib/physfs/zlib123 -I/Library/Frameworks/SDL.framework/Versions/A/Headers -I/Library/Frameworks/SDL_mixer.framework/Versions/A/Headers -o ${OBJECTDIR}/src/NetPanzer/Classes/Weapons/BulletWeapon.o src/NetPanzer/Classes/Weapons/BulletWeapon.cpp
 
-${OBJECTDIR}/src/NetPanzer/Interfaces/UnitInterface.o: src/NetPanzer/Interfaces/UnitInterface.cpp 
-	${MKDIR} -p ${OBJECTDIR}/src/NetPanzer/Interfaces
-	$(COMPILE.cc) -g -Wall -DPHYSFS_SUPPORTS_ZIP=1 -DZ_PREFIX=1 -I. -Isrc/Lib -Isrc/NetPanzer -Isrc/Lib/physfs -Isrc/Lib/physfs/zlib123 -I/Library/Frameworks/SDL.framework/Versions/A/Headers -I/Library/Frameworks/SDL_mixer.framework/Versions/A/Headers -o ${OBJECTDIR}/src/NetPanzer/Interfaces/UnitInterface.o src/NetPanzer/Interfaces/UnitInterface.cpp
+${OBJECTDIR}/src/NetPanzer/Units/UnitState.o: src/NetPanzer/Units/UnitState.cpp 
+	${MKDIR} -p ${OBJECTDIR}/src/NetPanzer/Units
+	$(COMPILE.cc) -g -Wall -DPHYSFS_SUPPORTS_ZIP=1 -DZ_PREFIX=1 -I. -Isrc/Lib -Isrc/NetPanzer -Isrc/Lib/physfs -Isrc/Lib/physfs/zlib123 -I/Library/Frameworks/SDL.framework/Versions/A/Headers -I/Library/Frameworks/SDL_mixer.framework/Versions/A/Headers -o ${OBJECTDIR}/src/NetPanzer/Units/UnitState.o src/NetPanzer/Units/UnitState.cpp
 
 ${OBJECTDIR}/src/NetPanzer/Views/MainMenu/Multi/UnitColorView.o: src/NetPanzer/Views/MainMenu/Multi/UnitColorView.cpp 
 	${MKDIR} -p ${OBJECTDIR}/src/NetPanzer/Views/MainMenu/Multi
@@ -656,10 +652,6 @@
 	${MKDIR} -p ${OBJECTDIR}/src/Lib/INIParser
 	$(COMPILE.cc) -g -Wall -DPHYSFS_SUPPORTS_ZIP=1 -DZ_PREFIX=1 -I. -Isrc/Lib -Isrc/NetPanzer -Isrc/Lib/physfs -Isrc/Lib/physfs/zlib123 -I/Library/Frameworks/SDL.framework/Versions/A/Headers -I/Library/Frameworks/SDL_mixer.framework/Versions/A/Headers -o ${OBJECTDIR}/src/Lib/INIParser/Store.o src/Lib/INIParser/Store.cpp
 
-${OBJECTDIR}/src/NetPanzer/Classes/UnitOpcodeEncoder.o: src/NetPanzer/Classes/UnitOpcodeEncoder.cpp 
-	${MKDIR} -p ${OBJECTDIR}/src/NetPanzer/Classes
-	$(COMPILE.cc) -g -Wall -DPHYSFS_SUPPORTS_ZIP=1 -DZ_PREFIX=1 -I. -Isrc/Lib -Isrc/NetPanzer -Isrc/Lib/physfs -Isrc/Lib/physfs/zlib123 -I/Library/Frameworks/SDL.framework/Versions/A/Headers -I/Library/Frameworks/SDL_mixer.framework/Versions/A/Headers -o ${OBJECTDIR}/src/NetPanzer/Classes/UnitOpcodeEncoder.o src/NetPanzer/Classes/UnitOpcodeEncoder.cpp
-
 ${OBJECTDIR}/src/Lib/physfs/physfs_byteorder.o: src/Lib/physfs/physfs_byteorder.c 
 	${MKDIR} -p ${OBJECTDIR}/src/Lib/physfs
 	$(COMPILE.c) -g -Wall -DPHYSFS_SUPPORTS_ZIP=1 -DZ_PREFIX=1 -I. -Isrc/Lib -Isrc/NetPanzer -Isrc/Lib/physfs -Isrc/Lib/physfs/zlib123 -I/Library/Frameworks/SDL.framework/Versions/A/Headers -I/Library/Frameworks/SDL_mixer.framework/Versions/A/Headers -o ${OBJECTDIR}/src/Lib/physfs/physfs_byteorder.o src/Lib/physfs/physfs_byteorder.c
@@ -768,6 +760,10 @@
 	${MKDIR} -p ${OBJECTDIR}/src/NetPanzer/Views/Game
 	$(COMPILE.cc) -g -Wall -DPHYSFS_SUPPORTS_ZIP=1 -DZ_PREFIX=1 -I. -Isrc/Lib -Isrc/NetPanzer -Isrc/Lib/physfs -Isrc/Lib/physfs/zlib123 -I/Library/Frameworks/SDL.framework/Versions/A/Headers -I/Library/Frameworks/SDL_mixer.framework/Versions/A/Headers -o ${OBJECTDIR}/src/NetPanzer/Views/Game/GameInfoView.o src/NetPanzer/Views/Game/GameInfoView.cpp
 
+${OBJECTDIR}/src/NetPanzer/Units/UnitOpcodeDecoder.o: src/NetPanzer/Units/UnitOpcodeDecoder.cpp 
+	${MKDIR} -p ${OBJECTDIR}/src/NetPanzer/Units
+	$(COMPILE.cc) -g -Wall -DPHYSFS_SUPPORTS_ZIP=1 -DZ_PREFIX=1 -I. -Isrc/Lib -Isrc/NetPanzer -Isrc/Lib/physfs -Isrc/Lib/physfs/zlib123 -I/Library/Frameworks/SDL.framework/Versions/A/Headers -I/Library/Frameworks/SDL_mixer.framework/Versions/A/Headers -o ${OBJECTDIR}/src/NetPanzer/Units/UnitOpcodeDecoder.o src/NetPanzer/Units/UnitOpcodeDecoder.cpp
+
 ${OBJECTDIR}/src/Lib/physfs/zlib123/uncompr.o: src/Lib/physfs/zlib123/uncompr.c 
 	${MKDIR} -p ${OBJECTDIR}/src/Lib/physfs/zlib123
 	$(COMPILE.c) -g -Wall -DPHYSFS_SUPPORTS_ZIP=1 -DZ_PREFIX=1 -I. -Isrc/Lib -Isrc/NetPanzer -Isrc/Lib/physfs -Isrc/Lib/physfs/zlib123 -I/Library/Frameworks/SDL.framework/Versions/A/Headers -I/Library/Frameworks/SDL_mixer.framework/Versions/A/Headers -o ${OBJECTDIR}/src/Lib/physfs/zlib123/uncompr.o src/Lib/physfs/zlib123/uncompr.c
@@ -804,6 +800,10 @@
 	${MKDIR} -p ${OBJECTDIR}/src/NetPanzer/Classes
 	$(COMPILE.cc) -g -Wall -DPHYSFS_SUPPORTS_ZIP=1 -DZ_PREFIX=1 -I. -Isrc/Lib -Isrc/NetPanzer -Isrc/Lib/physfs -Isrc/Lib/physfs/zlib123 -I/Library/Frameworks/SDL.framework/Versions/A/Headers -I/Library/Frameworks/SDL_mixer.framework/Versions/A/Headers -o ${OBJECTDIR}/src/NetPanzer/Classes/PlayerUnitConfig.o src/NetPanzer/Classes/PlayerUnitConfig.cpp
 
+${OBJECTDIR}/src/NetPanzer/Units/UnitOpcodeEncoder.o: src/NetPanzer/Units/UnitOpcodeEncoder.cpp 
+	${MKDIR} -p ${OBJECTDIR}/src/NetPanzer/Units
+	$(COMPILE.cc) -g -Wall -DPHYSFS_SUPPORTS_ZIP=1 -DZ_PREFIX=1 -I. -Isrc/Lib -Isrc/NetPanzer -Isrc/Lib/physfs -Isrc/Lib/physfs/zlib123 -I/Library/Frameworks/SDL.framework/Versions/A/Headers -I/Library/Frameworks/SDL_mixer.framework/Versions/A/Headers -o ${OBJECTDIR}/src/NetPanzer/Units/UnitOpcodeEncoder.o src/NetPanzer/Units/UnitOpcodeEncoder.cpp
+
 ${OBJECTDIR}/src/Lib/Types/iXY.o: src/Lib/Types/iXY.cpp 
 	${MKDIR} -p ${OBJECTDIR}/src/Lib/Types
 	$(COMPILE.cc) -g -Wall -DPHYSFS_SUPPORTS_ZIP=1 -DZ_PREFIX=1 -I. -Isrc/Lib -Isrc/NetPanzer -Isrc/Lib/physfs -Isrc/Lib/physfs/zlib123 -I/Library/Frameworks/SDL.framework/Versions/A/Headers -I/Library/Frameworks/SDL_mixer.framework/Versions/A/Headers -o ${OBJECTDIR}/src/Lib/Types/iXY.o src/Lib/Types/iXY.cpp
@@ -868,10 +868,6 @@
 	${MKDIR} -p ${OBJECTDIR}/src/Lib/lua
 	$(COMPILE.c) -g -Wall -DPHYSFS_SUPPORTS_ZIP=1 -DZ_PREFIX=1 -I. -Isrc/Lib -Isrc/NetPanzer -Isrc/Lib/physfs -Isrc/Lib/physfs/zlib123 -I/Library/Frameworks/SDL.framework/Versions/A/Headers -I/Library/Frameworks/SDL_mixer.framework/Versions/A/Headers -o ${OBJECTDIR}/src/Lib/lua/print.o src/Lib/lua/print.c
 
-${OBJECTDIR}/src/NetPanzer/Classes/UnitBlackBoard.o: src/NetPanzer/Classes/UnitBlackBoard.cpp 
-	${MKDIR} -p ${OBJECTDIR}/src/NetPanzer/Classes
-	$(COMPILE.cc) -g -Wall -DPHYSFS_SUPPORTS_ZIP=1 -DZ_PREFIX=1 -I. -Isrc/Lib -Isrc/NetPanzer -Isrc/Lib/physfs -Isrc/Lib/physfs/zlib123 -I/Library/Frameworks/SDL.framework/Versions/A/Headers -I/Library/Frameworks/SDL_mixer.framework/Versions/A/Headers -o ${OBJECTDIR}/src/NetPanzer/Classes/UnitBlackBoard.o src/NetPanzer/Classes/UnitBlackBoard.cpp
-
 ${OBJECTDIR}/src/NetPanzer/Particles/ParticleSystem2D.o: src/NetPanzer/Particles/ParticleSystem2D.cpp 
 	${MKDIR} -p ${OBJECTDIR}/src/NetPanzer/Particles
 	$(COMPILE.cc) -g -Wall -DPHYSFS_SUPPORTS_ZIP=1 -DZ_PREFIX=1 -I. -Isrc/Lib -Isrc/NetPanzer -Isrc/Lib/physfs -Isrc/Lib/physfs/zlib123 -I/Library/Frameworks/SDL.framework/Versions/A/Headers -I/Library/Frameworks/SDL_mixer.framework/Versions/A/Headers -o ${OBJECTDIR}/src/NetPanzer/Particles/ParticleSystem2D.o src/NetPanzer/Particles/ParticleSystem2D.cpp
@@ -892,10 +888,6 @@
 	${MKDIR} -p ${OBJECTDIR}/src/NetPanzer/Views/MainMenu
 	$(COMPILE.cc) -g -Wall -DPHYSFS_SUPPORTS_ZIP=1 -DZ_PREFIX=1 -I. -Isrc/Lib -Isrc/NetPanzer -Isrc/Lib/physfs -Isrc/Lib/physfs/zlib123 -I/Library/Frameworks/SDL.framework/Versions/A/Headers -I/Library/Frameworks/SDL_mixer.framework/Versions/A/Headers -o ${OBJECTDIR}/src/NetPanzer/Views/MainMenu/MainMenuView.o src/NetPanzer/Views/MainMenu/MainMenuView.cpp
 
-${OBJECTDIR}/src/NetPanzer/Classes/UnitState.o: src/NetPanzer/Classes/UnitState.cpp 
-	${MKDIR} -p ${OBJECTDIR}/src/NetPanzer/Classes
-	$(COMPILE.cc) -g -Wall -DPHYSFS_SUPPORTS_ZIP=1 -DZ_PREFIX=1 -I. -Isrc/Lib -Isrc/NetPanzer -Isrc/Lib/physfs -Isrc/Lib/physfs/zlib123 -I/Library/Frameworks/SDL.framework/Versions/A/Headers -I/Library/Frameworks/SDL_mixer.framework/Versions/A/Headers -o ${OBJECTDIR}/src/NetPanzer/Classes/UnitState.o src/NetPanzer/Classes/UnitState.cpp
-
 ${OBJECTDIR}/src/NetPanzer/Views/MainMenu/SkirmishView.o: src/NetPanzer/Views/MainMenu/SkirmishView.cpp 
 	${MKDIR} -p ${OBJECTDIR}/src/NetPanzer/Views/MainMenu
 	$(COMPILE.cc) -g -Wall -DPHYSFS_SUPPORTS_ZIP=1 -DZ_PREFIX=1 -I. -Isrc/Lib -Isrc/NetPanzer -Isrc/Lib/physfs -Isrc/Lib/physfs/zlib123 -I/Library/Frameworks/SDL.framework/Versions/A/Headers -I/Library/Frameworks/SDL_mixer.framework/Versions/A/Headers -o ${OBJECTDIR}/src/NetPanzer/Views/MainMenu/SkirmishView.o src/NetPanzer/Views/MainMenu/SkirmishView.cpp
@@ -1012,6 +1004,10 @@
 	${MKDIR} -p ${OBJECTDIR}/src/NetPanzer/Views/MainMenu/Multi
 	$(COMPILE.cc) -g -Wall -DPHYSFS_SUPPORTS_ZIP=1 -DZ_PREFIX=1 -I. -Isrc/Lib -Isrc/NetPanzer -Isrc/Lib/physfs -Isrc/Lib/physfs/zlib123 -I/Library/Frameworks/SDL.framework/Versions/A/Headers -I/Library/Frameworks/SDL_mixer.framework/Versions/A/Headers -o ${OBJECTDIR}/src/NetPanzer/Views/MainMenu/Multi/HostView.o src/NetPanzer/Views/MainMenu/Multi/HostView.cpp
 
+${OBJECTDIR}/src/NetPanzer/Units/UnitBucketArray.o: src/NetPanzer/Units/UnitBucketArray.cpp 
+	${MKDIR} -p ${OBJECTDIR}/src/NetPanzer/Units
+	$(COMPILE.cc) -g -Wall -DPHYSFS_SUPPORTS_ZIP=1 -DZ_PREFIX=1 -I. -Isrc/Lib -Isrc/NetPanzer -Isrc/Lib/physfs -Isrc/Lib/physfs/zlib123 -I/Library/Frameworks/SDL.framework/Versions/A/Headers -I/Library/Frameworks/SDL_mixer.framework/Versions/A/Headers -o ${OBJECTDIR}/src/NetPanzer/Units/UnitBucketArray.o src/NetPanzer/Units/UnitBucketArray.cpp
+
 ${OBJECTDIR}/src/Lib/Util/UtilInterface.o: src/Lib/Util/UtilInterface.cpp 
 	${MKDIR} -p ${OBJECTDIR}/src/Lib/Util
 	$(COMPILE.cc) -g -Wall -DPHYSFS_SUPPORTS_ZIP=1 -DZ_PREFIX=1 -I. -Isrc/Lib -Isrc/NetPanzer -Isrc/Lib/physfs -Isrc/Lib/physfs/zlib123 -I/Library/Frameworks/SDL.framework/Versions/A/Headers -I/Library/Frameworks/SDL_mixer.framework/Versions/A/Headers -o ${OBJECTDIR}/src/Lib/Util/UtilInterface.o src/Lib/Util/UtilInterface.cpp
@@ -1092,10 +1088,6 @@
 	${MKDIR} -p ${OBJECTDIR}/src/NetPanzer/Particles
 	$(COMPILE.cc) -g -Wall -DPHYSFS_SUPPORTS_ZIP=1 -DZ_PREFIX=1 -I. -Isrc/Lib -Isrc/NetPanzer -Isrc/Lib/physfs -Isrc/Lib/physfs/zlib123 -I/Library/Frameworks/SDL.framework/Versions/A/Headers -I/Library/Frameworks/SDL_mixer.framework/Versions/A/Headers -o ${OBJECTDIR}/src/NetPanzer/Particles/SnowParticle2D.o src/NetPanzer/Particles/SnowParticle2D.cpp
 
-${OBJECTDIR}/src/NetPanzer/Classes/Units/UnitGlobals.o: src/NetPanzer/Classes/Units/UnitGlobals.cpp 
-	${MKDIR} -p ${OBJECTDIR}/src/NetPanzer/Classes/Units
-	$(COMPILE.cc) -g -Wall -DPHYSFS_SUPPORTS_ZIP=1 -DZ_PREFIX=1 -I. -Isrc/Lib -Isrc/NetPanzer -Isrc/Lib/physfs -Isrc/Lib/physfs/zlib123 -I/Library/Frameworks/SDL.framework/Versions/A/Headers -I/Library/Frameworks/SDL_mixer.framework/Versions/A/Headers -o ${OBJECTDIR}/src/NetPanzer/Classes/Units/UnitGlobals.o src/NetPanzer/Classes/Units/UnitGlobals.cpp
-
 ${OBJECTDIR}/src/NetPanzer/Views/Components/Button.o: src/NetPanzer/Views/Components/Button.cpp 
 	${MKDIR} -p ${OBJECTDIR}/src/NetPanzer/Views/Components
 	$(COMPILE.cc) -g -Wall -DPHYSFS_SUPPORTS_ZIP=1 -DZ_PREFIX=1 -I. -Isrc/Lib -Isrc/NetPanzer -Isrc/Lib/physfs -Isrc/Lib/physfs/zlib123 -I/Library/Frameworks/SDL.framework/Versions/A/Headers -I/Library/Frameworks/SDL_mixer.framework/Versions/A/Headers -o ${OBJECTDIR}/src/NetPanzer/Views/Components/Button.o src/NetPanzer/Views/Components/Button.cpp
@@ -1140,6 +1132,10 @@
 	${MKDIR} -p ${OBJECTDIR}/src/Lib/Network
 	$(COMPILE.cc) -g -Wall -DPHYSFS_SUPPORTS_ZIP=1 -DZ_PREFIX=1 -I. -Isrc/Lib -Isrc/NetPanzer -Isrc/Lib/physfs -Isrc/Lib/physfs/zlib123 -I/Library/Frameworks/SDL.framework/Versions/A/Headers -I/Library/Frameworks/SDL_mixer.framework/Versions/A/Headers -o ${OBJECTDIR}/src/Lib/Network/TCPSocket.o src/Lib/Network/TCPSocket.cpp
 
+${OBJECTDIR}/src/NetPanzer/Units/UnitGlobals.o: src/NetPanzer/Units/UnitGlobals.cpp 
+	${MKDIR} -p ${OBJECTDIR}/src/NetPanzer/Units
+	$(COMPILE.cc) -g -Wall -DPHYSFS_SUPPORTS_ZIP=1 -DZ_PREFIX=1 -I. -Isrc/Lib -Isrc/NetPanzer -Isrc/Lib/physfs -Isrc/Lib/physfs/zlib123 -I/Library/Frameworks/SDL.framework/Versions/A/Headers -I/Library/Frameworks/SDL_mixer.framework/Versions/A/Headers -o ${OBJECTDIR}/src/NetPanzer/Units/UnitGlobals.o src/NetPanzer/Units/UnitGlobals.cpp
+
 ${OBJECTDIR}/src/NetPanzer/Views/Game/GameTemplateView.o: src/NetPanzer/Views/Game/GameTemplateView.cpp 
 	${MKDIR} -p ${OBJECTDIR}/src/NetPanzer/Views/Game
 	$(COMPILE.cc) -g -Wall -DPHYSFS_SUPPORTS_ZIP=1 -DZ_PREFIX=1 -I. -Isrc/Lib -Isrc/NetPanzer -Isrc/Lib/physfs -Isrc/Lib/physfs/zlib123 -I/Library/Frameworks/SDL.framework/Versions/A/Headers -I/Library/Frameworks/SDL_mixer.framework/Versions/A/Headers -o ${OBJECTDIR}/src/NetPanzer/Views/Game/GameTemplateView.o src/NetPanzer/Views/Game/GameTemplateView.cpp
@@ -1172,6 +1168,10 @@
 	${MKDIR} -p ${OBJECTDIR}/src/NetPanzer/Particles
 	$(COMPILE.cc) -g -Wall -DPHYSFS_SUPPORTS_ZIP=1 -DZ_PREFIX=1 -I. -Isrc/Lib -Isrc/NetPanzer -Isrc/Lib/physfs -Isrc/Lib/physfs/zlib123 -I/Library/Frameworks/SDL.framework/Versions/A/Headers -I/Library/Frameworks/SDL_mixer.framework/Versions/A/Headers -o ${OBJECTDIR}/src/NetPanzer/Particles/RadarPingParticle2D.o src/NetPanzer/Particles/RadarPingParticle2D.cpp
 
+${OBJECTDIR}/src/NetPanzer/Units/UnitProfileInterface.o: src/NetPanzer/Units/UnitProfileInterface.cpp 
+	${MKDIR} -p ${OBJECTDIR}/src/NetPanzer/Units
+	$(COMPILE.cc) -g -Wall -DPHYSFS_SUPPORTS_ZIP=1 -DZ_PREFIX=1 -I. -Isrc/Lib -Isrc/NetPanzer -Isrc/Lib/physfs -Isrc/Lib/physfs/zlib123 -I/Library/Frameworks/SDL.framework/Versions/A/Headers -I/Library/Frameworks/SDL_mixer.framework/Versions/A/Headers -o ${OBJECTDIR}/src/NetPanzer/Units/UnitProfileInterface.o src/NetPanzer/Units/UnitProfileInterface.cpp
+
 ${OBJECTDIR}/src/NetPanzer/Particles/Particle2D.o: src/NetPanzer/Particles/Particle2D.cpp 
 	${MKDIR} -p ${OBJECTDIR}/src/NetPanzer/Particles
 	$(COMPILE.cc) -g -Wall -DPHYSFS_SUPPORTS_ZIP=1 -DZ_PREFIX=1 -I. -Isrc/Lib -Isrc/NetPanzer -Isrc/Lib/physfs -Isrc/Lib/physfs/zlib123 -I/Library/Frameworks/SDL.framework/Versions/A/Headers -I/Library/Frameworks/SDL_mixer.framework/Versions/A/Headers -o ${OBJECTDIR}/src/NetPanzer/Particles/Particle2D.o src/NetPanzer/Particles/Particle2D.cpp
@@ -1220,6 +1220,10 @@
 	${MKDIR} -p ${OBJECTDIR}/src/Lib/optionmm
 	$(COMPILE.cc) -g -Wall -DPHYSFS_SUPPORTS_ZIP=1 -DZ_PREFIX=1 -I. -Isrc/Lib -Isrc/NetPanzer -Isrc/Lib/physfs -Isrc/Lib/physfs/zlib123 -I/Library/Frameworks/SDL.framework/Versions/A/Headers -I/Library/Frameworks/SDL_mixer.framework/Versions/A/Headers -o ${OBJECTDIR}/src/Lib/optionmm/command_line.o src/Lib/optionmm/command_line.cpp
 
+${OBJECTDIR}/src/NetPanzer/Units/Vehicle.o: src/NetPanzer/Units/Vehicle.cpp 
+	${MKDIR} -p ${OBJECTDIR}/src/NetPanzer/Units
+	$(COMPILE.cc) -g -Wall -DPHYSFS_SUPPORTS_ZIP=1 -DZ_PREFIX=1 -I. -Isrc/Lib -Isrc/NetPanzer -Isrc/Lib/physfs -Isrc/Lib/physfs/zlib123 -I/Library/Frameworks/SDL.framework/Versions/A/Headers -I/Library/Frameworks/SDL_mixer.framework/Versions/A/Headers -o ${OBJECTDIR}/src/NetPanzer/Units/Vehicle.o src/NetPanzer/Units/Vehicle.cpp
+
 ${OBJECTDIR}/src/NetPanzer/Views/MainMenu/MenuTemplateView.o: src/NetPanzer/Views/MainMenu/MenuTemplateView.cpp 
 	${MKDIR} -p ${OBJECTDIR}/src/NetPanzer/Views/MainMenu
 	$(COMPILE.cc) -g -Wall -DPHYSFS_SUPPORTS_ZIP=1 -DZ_PREFIX=1 -I. -Isrc/Lib -Isrc/NetPanzer -Isrc/Lib/physfs -Isrc/Lib/physfs/zlib123 -I/Library/Frameworks/SDL.framework/Versions/A/Headers -I/Library/Frameworks/SDL_mixer.framework/Versions/A/Headers -o ${OBJECTDIR}/src/NetPanzer/Views/MainMenu/MenuTemplateView.o src/NetPanzer/Views/MainMenu/MenuTemplateView.cpp
@@ -1232,10 +1236,6 @@
 	${MKDIR} -p ${OBJECTDIR}/src/NetPanzer/PowerUps
 	$(COMPILE.cc) -g -Wall -DPHYSFS_SUPPORTS_ZIP=1 -DZ_PREFIX=1 -I. -Isrc/Lib -Isrc/NetPanzer -Isrc/Lib/physfs -Isrc/Lib/physfs/zlib123 -I/Library/Frameworks/SDL.framework/Versions/A/Headers -I/Library/Frameworks/SDL_mixer.framework/Versions/A/Headers -o ${OBJECTDIR}/src/NetPanzer/PowerUps/PowerUp.o src/NetPanzer/PowerUps/PowerUp.cpp
 
-${OBJECTDIR}/src/NetPanzer/Classes/UnitOpcodeDecoder.o: src/NetPanzer/Classes/UnitOpcodeDecoder.cpp 
-	${MKDIR} -p ${OBJECTDIR}/src/NetPanzer/Classes
-	$(COMPILE.cc) -g -Wall -DPHYSFS_SUPPORTS_ZIP=1 -DZ_PREFIX=1 -I. -Isrc/Lib -Isrc/NetPanzer -Isrc/Lib/physfs -Isrc/Lib/physfs/zlib123 -I/Library/Frameworks/SDL.framework/Versions/A/Headers -I/Library/Frameworks/SDL_mixer.framework/Versions/A/Headers -o ${OBJECTDIR}/src/NetPanzer/Classes/UnitOpcodeDecoder.o src/NetPanzer/Classes/UnitOpcodeDecoder.cpp
-
 ${OBJECTDIR}/src/NetPanzer/Views/MainMenu/Multi/IPAddressView.o: src/NetPanzer/Views/MainMenu/Multi/IPAddressView.cpp 
 	${MKDIR} -p ${OBJECTDIR}/src/NetPanzer/Views/MainMenu/Multi
 	$(COMPILE.cc) -g -Wall -DPHYSFS_SUPPORTS_ZIP=1 -DZ_PREFIX=1 -I. -Isrc/Lib -Isrc/NetPanzer -Isrc/Lib/physfs -Isrc/Lib/physfs/zlib123 -I/Library/Frameworks/SDL.framework/Versions/A/Headers -I/Library/Frameworks/SDL_mixer.framework/Versions/A/Headers -o ${OBJECTDIR}/src/NetPanzer/Views/MainMenu/Multi/IPAddressView.o src/NetPanzer/Views/MainMenu/Multi/IPAddressView.cpp

Modified: trunk/netpanzer/nbproject/configurations.xml
===================================================================
--- trunk/netpanzer/nbproject/configurations.xml	2008-09-09 15:53:32 UTC (rev 1049)
+++ trunk/netpanzer/nbproject/configurations.xml	2008-09-09 16:30:13 UTC (rev 1050)
@@ -274,10 +274,6 @@
             &lt;itemPath&gt;src/NetPanzer/Classes/Network/UnitSync.hpp&lt;/itemPath&gt;
           &lt;/logicalFolder&gt;
           &lt;logicalFolder name=&quot;Units&quot; displayName=&quot;Units&quot; projectFiles=&quot;true&quot;&gt;
-            &lt;itemPath&gt;src/NetPanzer/Classes/Units/UnitGlobals.cpp&lt;/itemPath&gt;
-            &lt;itemPath&gt;src/NetPanzer/Classes/Units/UnitGlobals.hpp&lt;/itemPath&gt;
-            &lt;itemPath&gt;src/NetPanzer/Classes/Units/Vehicle.cpp&lt;/itemPath&gt;
-            &lt;itemPath&gt;src/NetPanzer/Classes/Units/Vehicle.hpp&lt;/itemPath&gt;
           &lt;/logicalFolder&gt;
           &lt;logicalFolder name=&quot;Weapons&quot; displayName=&quot;Weapons&quot; projectFiles=&quot;true&quot;&gt;
             &lt;itemPath&gt;src/NetPanzer/Classes/Weapons/BulletWeapon.cpp&lt;/itemPath&gt;
@@ -323,22 +319,8 @@
           &lt;itemPath&gt;src/NetPanzer/Classes/TileSet.hpp&lt;/itemPath&gt;
           &lt;itemPath&gt;src/NetPanzer/Classes/TipOfDay.cpp&lt;/itemPath&gt;
           &lt;itemPath&gt;src/NetPanzer/Classes/TipOfDay.hpp&lt;/itemPath&gt;
-          &lt;itemPath&gt;src/NetPanzer/Classes/UnitBase.hpp&lt;/itemPath&gt;
-          &lt;itemPath&gt;src/NetPanzer/Classes/UnitBlackBoard.cpp&lt;/itemPath&gt;
-          &lt;itemPath&gt;src/NetPanzer/Classes/UnitBlackBoard.hpp&lt;/itemPath&gt;
-          &lt;itemPath&gt;src/NetPanzer/Classes/UnitBucketArray.cpp&lt;/itemPath&gt;
-          &lt;itemPath&gt;src/NetPanzer/Classes/UnitBucketArray.hpp&lt;/itemPath&gt;
-          &lt;itemPath&gt;src/NetPanzer/Classes/UnitLifecycles.hpp&lt;/itemPath&gt;
-          &lt;itemPath&gt;src/NetPanzer/Classes/UnitList.hpp&lt;/itemPath&gt;
           &lt;itemPath&gt;src/NetPanzer/Classes/UnitMessage.hpp&lt;/itemPath&gt;
           &lt;itemPath&gt;src/NetPanzer/Classes/UnitMessageTypes.hpp&lt;/itemPath&gt;
-          &lt;itemPath&gt;src/NetPanzer/Classes/UnitOpcodeDecoder.cpp&lt;/itemPath&gt;
-          &lt;itemPath&gt;src/NetPanzer/Classes/UnitOpcodeDecoder.hpp&lt;/itemPath&gt;
-          &lt;itemPath&gt;src/NetPanzer/Classes/UnitOpcodeEncoder.cpp&lt;/itemPath&gt;
-          &lt;itemPath&gt;src/NetPanzer/Classes/UnitOpcodeEncoder.hpp&lt;/itemPath&gt;
-          &lt;itemPath&gt;src/NetPanzer/Classes/UnitOpcodes.hpp&lt;/itemPath&gt;
-          &lt;itemPath&gt;src/NetPanzer/Classes/UnitState.cpp&lt;/itemPath&gt;
-          &lt;itemPath&gt;src/NetPanzer/Classes/UnitState.hpp&lt;/itemPath&gt;
           &lt;itemPath&gt;src/NetPanzer/Classes/ViewCamera.cpp&lt;/itemPath&gt;
           &lt;itemPath&gt;src/NetPanzer/Classes/ViewCamera.hpp&lt;/itemPath&gt;
           &lt;itemPath&gt;src/NetPanzer/Classes/WadMapTable.hpp&lt;/itemPath&gt;
@@ -401,10 +383,6 @@
           &lt;itemPath&gt;src/NetPanzer/Interfaces/ServerConsole.hpp&lt;/itemPath&gt;
           &lt;itemPath&gt;src/NetPanzer/Interfaces/TileInterface.cpp&lt;/itemPath&gt;
           &lt;itemPath&gt;src/NetPanzer/Interfaces/TileInterface.hpp&lt;/itemPath&gt;
-          &lt;itemPath&gt;src/NetPanzer/Interfaces/UnitInterface.cpp&lt;/itemPath&gt;
-          &lt;itemPath&gt;src/NetPanzer/Interfaces/UnitInterface.hpp&lt;/itemPath&gt;
-          &lt;itemPath&gt;src/NetPanzer/Interfaces/UnitProfileInterface.cpp&lt;/itemPath&gt;
-          &lt;itemPath&gt;src/NetPanzer/Interfaces/UnitProfileInterface.hpp&lt;/itemPath&gt;
           &lt;itemPath&gt;src/NetPanzer/Interfaces/WorldViewInterface.cpp&lt;/itemPath&gt;
           &lt;itemPath&gt;src/NetPanzer/Interfaces/WorldViewInterface.hpp&lt;/itemPath&gt;
         &lt;/logicalFolder&gt;
@@ -501,7 +479,6 @@
         &lt;/logicalFolder&gt;
         &lt;logicalFolder name=&quot;Structs&quot; displayName=&quot;Structs&quot; projectFiles=&quot;true&quot;&gt;
           &lt;itemPath&gt;src/NetPanzer/Structs/TileSetStruct.hpp&lt;/itemPath&gt;
-          &lt;itemPath&gt;src/NetPanzer/Structs/UnitTypes.hpp&lt;/itemPath&gt;
         &lt;/logicalFolder&gt;
         &lt;logicalFolder name=&quot;System&quot; displayName=&quot;System&quot; projectFiles=&quot;true&quot;&gt;
           &lt;itemPath&gt;src/NetPanzer/System/DummySound.cpp&lt;/itemPath&gt;
@@ -515,6 +492,31 @@
           &lt;itemPath&gt;src/NetPanzer/System/Sound.cpp&lt;/itemPath&gt;
           &lt;itemPath&gt;src/NetPanzer/System/Sound.hpp&lt;/itemPath&gt;
         &lt;/logicalFolder&gt;
+        &lt;logicalFolder name=&quot;Units&quot; displayName=&quot;Units&quot; projectFiles=&quot;true&quot;&gt;
+          &lt;itemPath&gt;src/NetPanzer/Units/UnitBase.hpp&lt;/itemPath&gt;
+          &lt;itemPath&gt;src/NetPanzer/Units/UnitBlackBoard.cpp&lt;/itemPath&gt;
+          &lt;itemPath&gt;src/NetPanzer/Units/UnitBlackBoard.hpp&lt;/itemPath&gt;
+          &lt;itemPath&gt;src/NetPanzer/Units/UnitBucketArray.cpp&lt;/itemPath&gt;
+          &lt;itemPath&gt;src/NetPanzer/Units/UnitBucketArray.hpp&lt;/itemPath&gt;
+          &lt;itemPath&gt;src/NetPanzer/Units/UnitGlobals.cpp&lt;/itemPath&gt;
+          &lt;itemPath&gt;src/NetPanzer/Units/UnitGlobals.hpp&lt;/itemPath&gt;
+          &lt;itemPath&gt;src/NetPanzer/Units/UnitInterface.cpp&lt;/itemPath&gt;
+          &lt;itemPath&gt;src/NetPanzer/Units/UnitInterface.hpp&lt;/itemPath&gt;
+          &lt;itemPath&gt;src/NetPanzer/Units/UnitLifecycles.hpp&lt;/itemPath&gt;
+          &lt;itemPath&gt;src/NetPanzer/Units/UnitList.hpp&lt;/itemPath&gt;
+          &lt;itemPath&gt;src/NetPanzer/Units/UnitOpcodeDecoder.cpp&lt;/itemPath&gt;
+          &lt;itemPath&gt;src/NetPanzer/Units/UnitOpcodeDecoder.hpp&lt;/itemPath&gt;
+          &lt;itemPath&gt;src/NetPanzer/Units/UnitOpcodeEncoder.cpp&lt;/itemPath&gt;
+          &lt;itemPath&gt;src/NetPanzer/Units/UnitOpcodeEncoder.hpp&lt;/itemPath&gt;
+          &lt;itemPath&gt;src/NetPanzer/Units/UnitOpcodes.hpp&lt;/itemPath&gt;
+          &lt;itemPath&gt;src/NetPanzer/Units/UnitProfileInterface.cpp&lt;/itemPath&gt;
+          &lt;itemPath&gt;src/NetPanzer/Units/UnitProfileInterface.hpp&lt;/itemPath&gt;
+          &lt;itemPath&gt;src/NetPanzer/Units/UnitState.cpp&lt;/itemPath&gt;
+          &lt;itemPath&gt;src/NetPanzer/Units/UnitState.hpp&lt;/itemPath&gt;
+          &lt;itemPath&gt;src/NetPanzer/Units/UnitTypes.hpp&lt;/itemPath&gt;
+          &lt;itemPath&gt;src/NetPanzer/Units/Vehicle.cpp&lt;/itemPath&gt;
+          &lt;itemPath&gt;src/NetPanzer/Units/Vehicle.hpp&lt;/itemPath&gt;
+        &lt;/logicalFolder&gt;
         &lt;logicalFolder name=&quot;Views&quot; displayName=&quot;Views&quot; projectFiles=&quot;true&quot;&gt;
           &lt;logicalFolder name=&quot;Components&quot; displayName=&quot;Components&quot; projectFiles=&quot;true&quot;&gt;
             &lt;itemPath&gt;src/NetPanzer/Views/Components/Button.cpp&lt;/itemPath&gt;
@@ -1491,66 +1493,12 @@
       &lt;item path=&quot;src/NetPanzer/Classes/TipOfDay.hpp&quot;&gt;
         &lt;itemTool&gt;3&lt;/itemTool&gt;
       &lt;/item&gt;
-      &lt;item path=&quot;src/NetPanzer/Classes/UnitBase.hpp&quot;&gt;
-        &lt;itemTool&gt;3&lt;/itemTool&gt;
-      &lt;/item&gt;
-      &lt;item path=&quot;src/NetPanzer/Classes/UnitBlackBoard.cpp&quot;&gt;
-        &lt;itemTool&gt;1&lt;/itemTool&gt;
-      &lt;/item&gt;
-      &lt;item path=&quot;src/NetPanzer/Classes/UnitBlackBoard.hpp&quot;&gt;
-        &lt;itemTool&gt;3&lt;/itemTool&gt;
-      &lt;/item&gt;
-      &lt;item path=&quot;src/NetPanzer/Classes/UnitBucketArray.cpp&quot;&gt;
-        &lt;itemTool&gt;1&lt;/itemTool&gt;
-      &lt;/item&gt;
-      &lt;item path=&quot;src/NetPanzer/Classes/UnitBucketArray.hpp&quot;&gt;
-        &lt;itemTool&gt;3&lt;/itemTool&gt;
-      &lt;/item&gt;
-      &lt;item path=&quot;src/NetPanzer/Classes/UnitLifecycles.hpp&quot;&gt;
-        &lt;itemTool&gt;3&lt;/itemTool&gt;
-      &lt;/item&gt;
-      &lt;item path=&quot;src/NetPanzer/Classes/UnitList.hpp&quot;&gt;
-        &lt;itemTool&gt;3&lt;/itemTool&gt;
-      &lt;/item&gt;
       &lt;item path=&quot;src/NetPanzer/Classes/UnitMessage.hpp&quot;&gt;
         &lt;itemTool&gt;3&lt;/itemTool&gt;
       &lt;/item&gt;
       &lt;item path=&quot;src/NetPanzer/Classes/UnitMessageTypes.hpp&quot;&gt;
         &lt;itemTool&gt;3&lt;/itemTool&gt;
       &lt;/item&gt;
-      &lt;item path=&quot;src/NetPanzer/Classes/UnitOpcodeDecoder.cpp&quot;&gt;
-        &lt;itemTool&gt;1&lt;/itemTool&gt;
-      &lt;/item&gt;
-      &lt;item path=&quot;src/NetPanzer/Classes/UnitOpcodeDecoder.hpp&quot;&gt;
-        &lt;itemTool&gt;3&lt;/itemTool&gt;
-      &lt;/item&gt;
-      &lt;item path=&quot;src/NetPanzer/Classes/UnitOpcodeEncoder.cpp&quot;&gt;
-        &lt;itemTool&gt;1&lt;/itemTool&gt;
-      &lt;/item&gt;
-      &lt;item path=&quot;src/NetPanzer/Classes/UnitOpcodeEncoder.hpp&quot;&gt;
-        &lt;itemTool&gt;3&lt;/itemTool&gt;
-      &lt;/item&gt;
-      &lt;item path=&quot;src/NetPanzer/Classes/UnitOpcodes.hpp&quot;&gt;
-        &lt;itemTool&gt;3&lt;/itemTool&gt;
-      &lt;/item&gt;
-      &lt;item path=&quot;src/NetPanzer/Classes/UnitState.cpp&quot;&gt;
-        &lt;itemTool&gt;1&lt;/itemTool&gt;
-      &lt;/item&gt;
-      &lt;item path=&quot;src/NetPanzer/Classes/UnitState.hpp&quot;&gt;
-        &lt;itemTool&gt;3&lt;/itemTool&gt;
-      &lt;/item&gt;
-      &lt;item path=&quot;src/NetPanzer/Classes/Units/UnitGlobals.cpp&quot;&gt;
-        &lt;itemTool&gt;1&lt;/itemTool&gt;
-      &lt;/item&gt;
-      &lt;item path=&quot;src/NetPanzer/Classes/Units/UnitGlobals.hpp&quot;&gt;
-        &lt;itemTool&gt;3&lt;/itemTool&gt;
-      &lt;/item&gt;
-      &lt;item path=&quot;src/NetPanzer/Classes/Units/Vehicle.cpp&quot;&gt;
-        &lt;itemTool&gt;1&lt;/itemTool&gt;
-      &lt;/item&gt;
-      &lt;item path=&quot;src/NetPanzer/Classes/Units/Vehicle.hpp&quot;&gt;
-        &lt;itemTool&gt;3&lt;/itemTool&gt;
-      &lt;/item&gt;
       &lt;item path=&quot;src/NetPanzer/Classes/ViewCamera.cpp&quot;&gt;
         &lt;itemTool&gt;1&lt;/itemTool&gt;
       &lt;/item&gt;
@@ -1755,18 +1703,6 @@
       &lt;item path=&quot;src/NetPanzer/Interfaces/TileInterface.hpp&quot;&gt;
         &lt;itemTool&gt;3&lt;/itemTool&gt;
       &lt;/item&gt;
-      &lt;item path=&quot;src/NetPanzer/Interfaces/UnitInterface.cpp&quot;&gt;
-        &lt;itemTool&gt;1&lt;/itemTool&gt;
-      &lt;/item&gt;
-      &lt;item path=&quot;src/NetPanzer/Interfaces/UnitInterface.hpp&quot;&gt;
-        &lt;itemTool&gt;3&lt;/itemTool&gt;
-      &lt;/item&gt;
-      &lt;item path=&quot;src/NetPanzer/Interfaces/UnitProfileInterface.cpp&quot;&gt;
-        &lt;itemTool&gt;1&lt;/itemTool&gt;
-      &lt;/item&gt;
-      &lt;item path=&quot;src/NetPanzer/Interfaces/UnitProfileInterface.hpp&quot;&gt;
-        &lt;itemTool&gt;3&lt;/itemTool&gt;
-      &lt;/item&gt;
       &lt;item path=&quot;src/NetPanzer/Interfaces/WorldViewInterface.cpp&quot;&gt;
         &lt;itemTool&gt;1&lt;/itemTool&gt;
       &lt;/item&gt;
@@ -2019,9 +1955,6 @@
       &lt;item path=&quot;src/NetPanzer/Structs/TileSetStruct.hpp&quot;&gt;
         &lt;itemTool&gt;3&lt;/itemTool&gt;
       &lt;/item&gt;
-      &lt;item path=&quot;src/NetPanzer/Structs/UnitTypes.hpp&quot;&gt;
-        &lt;itemTool&gt;3&lt;/itemTool&gt;
-      &lt;/item&gt;
       &lt;item path=&quot;src/NetPanzer/System/DummySound.cpp&quot;&gt;
         &lt;itemTool&gt;1&lt;/itemTool&gt;
       &lt;/item&gt;
@@ -2052,6 +1985,75 @@
       &lt;item path=&quot;src/NetPanzer/System/Sound.hpp&quot;&gt;
         &lt;itemTool&gt;3&lt;/itemTool&gt;
       &lt;/item&gt;
+      &lt;item path=&quot;src/NetPanzer/Units/UnitBase.hpp&quot;&gt;
+        &lt;itemTool&gt;3&lt;/itemTool&gt;
+      &lt;/item&gt;
+      &lt;item path=&quot;src/NetPanzer/Units/UnitBlackBoard.cpp&quot;&gt;
+        &lt;itemTool&gt;1&lt;/itemTool&gt;
+      &lt;/item&gt;
+      &lt;item path=&quot;src/NetPanzer/Units/UnitBlackBoard.hpp&quot;&gt;
+        &lt;itemTool&gt;3&lt;/itemTool&gt;
+      &lt;/item&gt;
+      &lt;item path=&quot;src/NetPanzer/Units/UnitBucketArray.cpp&quot;&gt;
+        &lt;itemTool&gt;1&lt;/itemTool&gt;
+      &lt;/item&gt;
+      &lt;item path=&quot;src/NetPanzer/Units/UnitBucketArray.hpp&quot;&gt;
+        &lt;itemTool&gt;3&lt;/itemTool&gt;
+      &lt;/item&gt;
+      &lt;item path=&quot;src/NetPanzer/Units/UnitGlobals.cpp&quot;&gt;
+        &lt;itemTool&gt;1&lt;/itemTool&gt;
+      &lt;/item&gt;
+      &lt;item path=&quot;src/NetPanzer/Units/UnitGlobals.hpp&quot;&gt;
+        &lt;itemTool&gt;3&lt;/itemTool&gt;
+      &lt;/item&gt;
+      &lt;item path=&quot;src/NetPanzer/Units/UnitInterface.cpp&quot;&gt;
+        &lt;itemTool&gt;1&lt;/itemTool&gt;
+      &lt;/item&gt;
+      &lt;item path=&quot;src/NetPanzer/Units/UnitInterface.hpp&quot;&gt;
+        &lt;itemTool&gt;3&lt;/itemTool&gt;
+      &lt;/item&gt;
+      &lt;item path=&quot;src/NetPanzer/Units/UnitLifecycles.hpp&quot;&gt;
+        &lt;itemTool&gt;3&lt;/itemTool&gt;
+      &lt;/item&gt;
+      &lt;item path=&quot;src/NetPanzer/Units/UnitList.hpp&quot;&gt;
+        &lt;itemTool&gt;3&lt;/itemTool&gt;
+      &lt;/item&gt;
+      &lt;item path=&quot;src/NetPanzer/Units/UnitOpcodeDecoder.cpp&quot;&gt;
+        &lt;itemTool&gt;1&lt;/itemTool&gt;
+      &lt;/item&gt;
+      &lt;item path=&quot;src/NetPanzer/Units/UnitOpcodeDecoder.hpp&quot;&gt;
+        &lt;itemTool&gt;3&lt;/itemTool&gt;
+      &lt;/item&gt;
+      &lt;item path=&quot;src/NetPanzer/Units/UnitOpcodeEncoder.cpp&quot;&gt;
+        &lt;itemTool&gt;1&lt;/itemTool&gt;
+      &lt;/item&gt;
+      &lt;item path=&quot;src/NetPanzer/Units/UnitOpcodeEncoder.hpp&quot;&gt;
+        &lt;itemTool&gt;3&lt;/itemTool&gt;
+      &lt;/item&gt;
+      &lt;item path=&quot;src/NetPanzer/Units/UnitOpcodes.hpp&quot;&gt;
+        &lt;itemTool&gt;3&lt;/itemTool&gt;
+      &lt;/item&gt;
+      &lt;item path=&quot;src/NetPanzer/Units/UnitProfileInterface.cpp&quot;&gt;
+        &lt;itemTool&gt;1&lt;/itemTool&gt;
+      &lt;/item&gt;
+      &lt;item path=&quot;src/NetPanzer/Units/UnitProfileInterface.hpp&quot;&gt;
+        &lt;itemTool&gt;3&lt;/itemTool&gt;
+      &lt;/item&gt;
+      &lt;item path=&quot;src/NetPanzer/Units/UnitState.cpp&quot;&gt;
+        &lt;itemTool&gt;1&lt;/itemTool&gt;
+      &lt;/item&gt;
+      &lt;item path=&quot;src/NetPanzer/Units/UnitState.hpp&quot;&gt;
+        &lt;itemTool&gt;3&lt;/itemTool&gt;
+      &lt;/item&gt;
+      &lt;item path=&quot;src/NetPanzer/Units/UnitTypes.hpp&quot;&gt;
+        &lt;itemTool&gt;3&lt;/itemTool&gt;
+      &lt;/item&gt;
+      &lt;item path=&quot;src/NetPanzer/Units/Vehicle.cpp&quot;&gt;
+        &lt;itemTool&gt;1&lt;/itemTool&gt;
+      &lt;/item&gt;
+      &lt;item path=&quot;src/NetPanzer/Units/Vehicle.hpp&quot;&gt;
+        &lt;itemTool&gt;3&lt;/itemTool&gt;
+      &lt;/item&gt;
       &lt;item path=&quot;src/NetPanzer/Views/Components/Button.cpp&quot;&gt;
         &lt;itemTool&gt;1&lt;/itemTool&gt;
       &lt;/item&gt;
@@ -3223,66 +3225,12 @@
       &lt;item path=&quot;src/NetPanzer/Classes/TipOfDay.hpp&quot;&gt;
         &lt;itemTool&gt;3&lt;/itemTool&gt;
       &lt;/item&gt;
-      &lt;item path=&quot;src/NetPanzer/Classes/UnitBase.hpp&quot;&gt;
-        &lt;itemTool&gt;3&lt;/itemTool&gt;
-      &lt;/item&gt;
-      &lt;item path=&quot;src/NetPanzer/Classes/UnitBlackBoard.cpp&quot;&gt;
-        &lt;itemTool&gt;1&lt;/itemTool&gt;
-      &lt;/item&gt;
-      &lt;item path=&quot;src/NetPanzer/Classes/UnitBlackBoard.hpp&quot;&gt;
-        &lt;itemTool&gt;3&lt;/itemTool&gt;
-      &lt;/item&gt;
-      &lt;item path=&quot;src/NetPanzer/Classes/UnitBucketArray.cpp&quot;&gt;
-        &lt;itemTool&gt;1&lt;/itemTool&gt;
-      &lt;/item&gt;
-      &lt;item path=&quot;src/NetPanzer/Classes/UnitBucketArray.hpp&quot;&gt;
-        &lt;itemTool&gt;3&lt;/itemTool&gt;
-      &lt;/item&gt;
-      &lt;item path=&quot;src/NetPanzer/Classes/UnitLifecycles.hpp&quot;&gt;
-        &lt;itemTool&gt;3&lt;/itemTool&gt;
-      &lt;/item&gt;
-      &lt;item path=&quot;src/NetPanzer/Classes/UnitList.hpp&quot;&gt;
-        &lt;itemTool&gt;3&lt;/itemTool&gt;
-      &lt;/item&gt;
       &lt;item path=&quot;src/NetPanzer/Classes/UnitMessage.hpp&quot;&gt;
         &lt;itemTool&gt;3&lt;/itemTool&gt;
       &lt;/item&gt;
       &lt;item path=&quot;src/NetPanzer/Classes/UnitMessageTypes.hpp&quot;&gt;
         &lt;itemTool&gt;3&lt;/itemTool&gt;
       &lt;/item&gt;
-      &lt;item path=&quot;src/NetPanzer/Classes/UnitOpcodeDecoder.cpp&quot;&gt;
-        &lt;itemTool&gt;1&lt;/itemTool&gt;
-      &lt;/item&gt;
-      &lt;item path=&quot;src/NetPanzer/Classes/UnitOpcodeDecoder.hpp&quot;&gt;
-        &lt;itemTool&gt;3&lt;/itemTool&gt;
-      &lt;/item&gt;
-      &lt;item path=&quot;src/NetPanzer/Classes/UnitOpcodeEncoder.cpp&quot;&gt;
-        &lt;itemTool&gt;1&lt;/itemTool&gt;
-      &lt;/item&gt;
-      &lt;item path=&quot;src/NetPanzer/Classes/UnitOpcodeEncoder.hpp&quot;&gt;
-        &lt;itemTool&gt;3&lt;/itemTool&gt;
-      &lt;/item&gt;
-      &lt;item path=&quot;src/NetPanzer/Classes/UnitOpcodes.hpp&quot;&gt;
-        &lt;itemTool&gt;3&lt;/itemTool&gt;
-      &lt;/item&gt;
-      &lt;item path=&quot;src/NetPanzer/Classes/UnitState.cpp&quot;&gt;
-        &lt;itemTool&gt;1&lt;/itemTool&gt;
-      &lt;/item&gt;
-      &lt;item path=&quot;src/NetPanzer/Classes/UnitState.hpp&quot;&gt;
-        &lt;itemTool&gt;3&lt;/itemTool&gt;
-      &lt;/item&gt;
-      &lt;item path=&quot;src/NetPanzer/Classes/Units/UnitGlobals.cpp&quot;&gt;
-        &lt;itemTool&gt;1&lt;/itemTool&gt;
-      &lt;/item&gt;
-      &lt;item path=&quot;src/NetPanzer/Classes/Units/UnitGlobals.hpp&quot;&gt;
-        &lt;itemTool&gt;3&lt;/itemTool&gt;
-      &lt;/item&gt;
-      &lt;item path=&quot;src/NetPanzer/Classes/Units/Vehicle.cpp&quot;&gt;
-        &lt;itemTool&gt;1&lt;/itemTool&gt;
-      &lt;/item&gt;
-      &lt;item path=&quot;src/NetPanzer/Classes/Units/Vehicle.hpp&quot;&gt;
-        &lt;itemTool&gt;3&lt;/itemTool&gt;
-      &lt;/item&gt;
       &lt;item path=&quot;src/NetPanzer/Classes/ViewCamera.cpp&quot;&gt;
         &lt;itemTool&gt;1&lt;/itemTool&gt;
       &lt;/item&gt;
@@ -3487,18 +3435,6 @@
       &lt;item path=&quot;src/NetPanzer/Interfaces/TileInterface.hpp&quot;&gt;
         &lt;itemTool&gt;3&lt;/itemTool&gt;
       &lt;/item&gt;
-      &lt;item path=&quot;src/NetPanzer/Interfaces/UnitInterface.cpp&quot;&gt;
-        &lt;itemTool&gt;1&lt;/itemTool&gt;
-      &lt;/item&gt;
-      &lt;item path=&quot;src/NetPanzer/Interfaces/UnitInterface.hpp&quot;&gt;
-        &lt;itemTool&gt;3&lt;/itemTool&gt;
-      &lt;/item&gt;
-      &lt;item path=&quot;src/NetPanzer/Interfaces/UnitProfileInterface.cpp&quot;&gt;
-        &lt;itemTool&gt;1&lt;/itemTool&gt;
-      &lt;/item&gt;
-      &lt;item path=&quot;src/NetPanzer/Interfaces/UnitProfileInterface.hpp&quot;&gt;
-        &lt;itemTool&gt;3&lt;/itemTool&gt;
-      &lt;/item&gt;
       &lt;item path=&quot;src/NetPanzer/Interfaces/WorldViewInterface.cpp&quot;&gt;
         &lt;itemTool&gt;1&lt;/itemTool&gt;
       &lt;/item&gt;
@@ -3751,9 +3687,6 @@
       &lt;item path=&quot;src/NetPanzer/Structs/TileSetStruct.hpp&quot;&gt;
         &lt;itemTool&gt;3&lt;/itemTool&gt;
       &lt;/item&gt;
-      &lt;item path=&quot;src/NetPanzer/Structs/UnitTypes.hpp&quot;&gt;
-        &lt;itemTool&gt;3&lt;/itemTool&gt;
-      &lt;/item&gt;
       &lt;item path=&quot;src/NetPanzer/System/DummySound.cpp&quot;&gt;
         &lt;itemTool&gt;1&lt;/itemTool&gt;
       &lt;/item&gt;
@@ -3784,6 +3717,75 @@
       &lt;item path=&quot;src/NetPanzer/System/Sound.hpp&quot;&gt;
         &lt;itemTool&gt;3&lt;/itemTool&gt;
       &lt;/item&gt;
+      &lt;item path=&quot;src/NetPanzer/Units/UnitBase.hpp&quot;&gt;
+        &lt;itemTool&gt;3&lt;/itemTool&gt;
+      &lt;/item&gt;
+      &lt;item path=&quot;src/NetPanzer/Units/UnitBlackBoard.cpp&quot;&gt;
+        &lt;itemTool&gt;1&lt;/itemTool&gt;
+      &lt;/item&gt;
+      &lt;item path=&quot;src/NetPanzer/Units/UnitBlackBoard.hpp&quot;&gt;
+        &lt;itemTool&gt;3&lt;/itemTool&gt;
+      &lt;/item&gt;
+      &lt;item path=&quot;src/NetPanzer/Units/UnitBucketArray.cpp&quot;&gt;
+        &lt;itemTool&gt;1&lt;/itemTool&gt;
+      &lt;/item&gt;
+      &lt;item path=&quot;src/NetPanzer/Units/UnitBucketArray.hpp&quot;&gt;
+        &lt;itemTool&gt;3&lt;/itemTool&gt;
+      &lt;/item&gt;
+      &lt;item path=&quot;src/NetPanzer/Units/UnitGlobals.cpp&quot;&gt;
+        &lt;itemTool&gt;1&lt;/itemTool&gt;
+      &lt;/item&gt;
+      &lt;item path=&quot;src/NetPanzer/Units/UnitGlobals.hpp&quot;&gt;
+        &lt;itemTool&gt;3&lt;/itemTool&gt;
+      &lt;/item&gt;
+      &lt;item path=&quot;src/NetPanzer/Units/UnitInterface.cpp&quot;&gt;
+        &lt;itemTool&gt;1&lt;/itemTool&gt;
+      &lt;/item&gt;
+      &lt;item path=&quot;src/NetPanzer/Units/UnitInterface.hpp&quot;&gt;
+        &lt;itemTool&gt;3&lt;/itemTool&gt;
+      &lt;/item&gt;
+      &lt;item path=&quot;src/NetPanzer/Units/UnitLifecycles.hpp&quot;&gt;
+        &lt;itemTool&gt;3&lt;/itemTool&gt;
+      &lt;/item&gt;
+      &lt;item path=&quot;src/NetPanzer/Units/UnitList.hpp&quot;&gt;
+        &lt;itemTool&gt;3&lt;/itemTool&gt;
+      &lt;/item&gt;
+      &lt;item path=&quot;src/NetPanzer/Units/UnitOpcodeDecoder.cpp&quot;&gt;
+        &lt;itemTool&gt;1&lt;/itemTool&gt;
+      &lt;/item&gt;
+      &lt;item path=&quot;src/NetPanzer/Units/UnitOpcodeDecoder.hpp&quot;&gt;
+        &lt;itemTool&gt;3&lt;/itemTool&gt;
+      &lt;/item&gt;
+      &lt;item path=&quot;src/NetPanzer/Units/UnitOpcodeEncoder.cpp&quot;&gt;
+        &lt;itemTool&gt;1&lt;/itemTool&gt;
+      &lt;/item&gt;
+      &lt;item path=&quot;src/NetPanzer/Units/UnitOpcodeEncoder.hpp&quot;&gt;
+        &lt;itemTool&gt;3&lt;/itemTool&gt;
+      &lt;/item&gt;
+      &lt;item path=&quot;src/NetPanzer/Units/UnitOpcodes.hpp&quot;&gt;
+        &lt;itemTool&gt;3&lt;/itemTool&gt;
+      &lt;/item&gt;
+      &lt;item path=&quot;src/NetPanzer/Units/UnitProfileInterface.cpp&quot;&gt;
+        &lt;itemTool&gt;1&lt;/itemTool&gt;
+      &lt;/item&gt;
+      &lt;item path=&quot;src/NetPanzer/Units/UnitProfileInterface.hpp&quot;&gt;
+        &lt;itemTool&gt;3&lt;/itemTool&gt;
+      &lt;/item&gt;
+      &lt;item path=&quot;src/NetPanzer/Units/UnitState.cpp&quot;&gt;
+        &lt;itemTool&gt;1&lt;/itemTool&gt;
+      &lt;/item&gt;
+      &lt;item path=&quot;src/NetPanzer/Units/UnitState.hpp&quot;&gt;
+        &lt;itemTool&gt;3&lt;/itemTool&gt;
+      &lt;/item&gt;
+      &lt;item path=&quot;src/NetPanzer/Units/UnitTypes.hpp&quot;&gt;
+        &lt;itemTool&gt;3&lt;/itemTool&gt;
+      &lt;/item&gt;
+      &lt;item path=&quot;src/NetPanzer/Units/Vehicle.cpp&quot;&gt;
+        &lt;itemTool&gt;1&lt;/itemTool&gt;
+      &lt;/item&gt;
+      &lt;item path=&quot;src/NetPanzer/Units/Vehicle.hpp&quot;&gt;
+        &lt;itemTool&gt;3&lt;/itemTool&gt;
+      &lt;/item&gt;
       &lt;item path=&quot;src/NetPanzer/Views/Components/Button.cpp&quot;&gt;
         &lt;itemTool&gt;1&lt;/itemTool&gt;
       &lt;/item&gt;

Modified: trunk/netpanzer/src/NetPanzer/Bot/Bot.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Bot/Bot.cpp	2008-09-09 15:53:32 UTC (rev 1049)
+++ trunk/netpanzer/src/NetPanzer/Bot/Bot.cpp	2008-09-09 16:30:13 UTC (rev 1050)
@@ -22,7 +22,7 @@
 #include &quot;Bot.hpp&quot;
 
 #include &quot;Classes/PlacementMatrix.hpp&quot;
-#include &quot;Classes/UnitBase.hpp&quot;
+#include &quot;Units/UnitBase.hpp&quot;
 #include &quot;Objectives/Objective.hpp&quot;
 #include &quot;Classes/Network/TerminalNetMesg.hpp&quot;
 #include &quot;Classes/Network/NetworkClient.hpp&quot;

Modified: trunk/netpanzer/src/NetPanzer/Bot/BotPlayer.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Bot/BotPlayer.cpp	2008-09-09 15:53:32 UTC (rev 1049)
+++ trunk/netpanzer/src/NetPanzer/Bot/BotPlayer.cpp	2008-09-09 16:30:13 UTC (rev 1050)
@@ -26,13 +26,13 @@
 #include &quot;BotPlayer.hpp&quot;
 
 #include &quot;Interfaces/PlayerInterface.hpp&quot;
-#include &quot;Interfaces/UnitProfileInterface.hpp&quot;
-#include &quot;Interfaces/UnitInterface.hpp&quot;
+#include &quot;Units/UnitProfileInterface.hpp&quot;
+#include &quot;Units/UnitInterface.hpp&quot;
 #include &quot;Interfaces/MapInterface.hpp&quot;
-#include &quot;Classes/UnitBase.hpp&quot;
+#include &quot;Units/UnitBase.hpp&quot;
 #include &quot;Objectives/ObjectiveInterface.hpp&quot;
 #include &quot;Objectives/Objective.hpp&quot;
-#include &quot;Classes/Units/Vehicle.hpp&quot;
+#include &quot;Units/Vehicle.hpp&quot;
 #include &quot;Util/Log.hpp&quot;
 
 //-----------------------------------------------------------------

Modified: trunk/netpanzer/src/NetPanzer/Bot/BotTask.hpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Bot/BotTask.hpp	2008-09-09 15:53:32 UTC (rev 1049)
+++ trunk/netpanzer/src/NetPanzer/Bot/BotTask.hpp	2008-09-09 16:30:13 UTC (rev 1050)
@@ -18,7 +18,7 @@
 #ifndef BOTTASKS_H
 #define BOTTASKS_H
 
-#include &quot;Classes/UnitBase.hpp&quot;
+#include &quot;Units/UnitBase.hpp&quot;
 #include &quot;BotTaskList.hpp&quot;
 
 class BotTask {

Modified: trunk/netpanzer/src/NetPanzer/Bot/BotTaskList.hpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Bot/BotTaskList.hpp	2008-09-09 15:53:32 UTC (rev 1049)
+++ trunk/netpanzer/src/NetPanzer/Bot/BotTaskList.hpp	2008-09-09 16:30:13 UTC (rev 1050)
@@ -20,7 +20,7 @@
 
 class BotTask;
 
-#include &quot;Classes/UnitBase.hpp&quot;
+#include &quot;Units/UnitBase.hpp&quot;
 
 #include &lt;map&gt;
 typedef std::map&lt;UnitID, BotTask*&gt; bottasks_t;

Modified: trunk/netpanzer/src/NetPanzer/Classes/AI/Astar.hpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Classes/AI/Astar.hpp	2008-09-09 15:53:32 UTC (rev 1049)
+++ trunk/netpanzer/src/NetPanzer/Classes/AI/Astar.hpp	2008-09-09 16:30:13 UTC (rev 1050)
@@ -22,9 +22,9 @@
 
 #include &quot;ArrayUtil/BitArray.hpp&quot;
 #include &quot;Interfaces/MapInterface.hpp&quot;
-#include &quot;Classes/UnitBlackBoard.hpp&quot;
+#include &quot;Units/UnitBlackBoard.hpp&quot;
 #include &quot;Classes/AI/PathList.hpp&quot;
-#include &quot;Classes/UnitBase.hpp&quot;
+#include &quot;Units/UnitBase.hpp&quot;
 
 enum { _path_request_full, _path_request_update };
 enum { _slot_status_free, _slot_status_busy, _slot_status_wait, _slot_status_flush };

Modified: trunk/netpanzer/src/NetPanzer/Classes/Network/ClientConnectDaemon.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Classes/Network/ClientConnectDaemon.cpp	2008-09-09 15:53:32 UTC (rev 1049)
+++ trunk/netpanzer/src/NetPanzer/Classes/Network/ClientConnectDaemon.cpp	2008-09-09 16:30:13 UTC (rev 1050)
@@ -21,7 +21,7 @@
 #include &lt;stdio.h&gt;
 
 #include &quot;Interfaces/PlayerInterface.hpp&quot;
-#include &quot;Interfaces/UnitInterface.hpp&quot;
+#include &quot;Units/UnitInterface.hpp&quot;
 #include &quot;NetworkClient.hpp&quot;
 #include &quot;Interfaces/GameConfig.hpp&quot;
 #include &quot;Interfaces/GameManager.hpp&quot;

Modified: trunk/netpanzer/src/NetPanzer/Classes/Network/ClientMessageRouter.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Classes/Network/ClientMessageRouter.cpp	2008-09-09 15:53:32 UTC (rev 1049)
+++ trunk/netpanzer/src/NetPanzer/Classes/Network/ClientMessageRouter.cpp	2008-09-09 16:30:13 UTC (rev 1050)
@@ -30,7 +30,7 @@
 #include &quot;ObjectiveNetMessage.hpp&quot;
 
 #include &quot;Objectives/ObjectiveInterface.hpp&quot;
-#include &quot;Interfaces/UnitInterface.hpp&quot;
+#include &quot;Units/UnitInterface.hpp&quot;
 #include &quot;Interfaces/PlayerInterface.hpp&quot;
 #include &quot;Interfaces/ChatInterface.hpp&quot;
 #include &quot;Interfaces/GameControlRulesDaemon.hpp&quot;

Modified: trunk/netpanzer/src/NetPanzer/Classes/Network/NetPacketDebugger.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Classes/Network/NetPacketDebugger.cpp	2008-09-09 15:53:32 UTC (rev 1049)
+++ trunk/netpanzer/src/NetPanzer/Classes/Network/NetPacketDebugger.cpp	2008-09-09 16:30:13 UTC (rev 1050)
@@ -26,7 +26,7 @@
 #include &quot;Classes/Network/NetPacket.hpp&quot;
 #include &quot;Classes/Network/UnitNetMessage.hpp&quot;
 #include &quot;TerminalNetMesg.hpp&quot;
-#include &quot;Classes/UnitOpcodes.hpp&quot;
+#include &quot;Units/UnitOpcodes.hpp&quot;
 
 #include &quot;NetPacketDebugger.hpp&quot;
 #include &quot;Classes/OpcodeDebugger.hpp&quot;

Modified: trunk/netpanzer/src/NetPanzer/Classes/Network/PowerUpNetMessage.hpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Classes/Network/PowerUpNetMessage.hpp	2008-09-09 15:53:32 UTC (rev 1049)
+++ trunk/netpanzer/src/NetPanzer/Classes/Network/PowerUpNetMessage.hpp	2008-09-09 16:30:13 UTC (rev 1050)
@@ -21,7 +21,7 @@
 #include &quot;Core/CoreTypes.hpp&quot;
 #include &quot;NetMessage.hpp&quot;
 
-#include &quot;Classes/UnitBase.hpp&quot;
+#include &quot;Units/UnitBase.hpp&quot;
 
 enum { _net_message_id_powerup_create,
        _net_message_id_powerup_hit

Modified: trunk/netpanzer/src/NetPanzer/Classes/Network/ServerConnectDaemon.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Classes/Network/ServerConnectDaemon.cpp	2008-09-09 15:53:32 UTC (rev 1049)
+++ trunk/netpanzer/src/NetPanzer/Classes/Network/ServerConnectDaemon.cpp	2008-09-09 16:30:13 UTC (rev 1050)
@@ -24,7 +24,7 @@
 #include &quot;Interfaces/ChatInterface.hpp&quot;
 #include &quot;Core/NetworkGlobals.hpp&quot;
 #include &quot;Interfaces/PlayerInterface.hpp&quot;
-#include &quot;Interfaces/UnitInterface.hpp&quot;
+#include &quot;Units/UnitInterface.hpp&quot;
 #include &quot;Objectives/ObjectiveInterface.hpp&quot;
 #include &quot;PowerUps/PowerUpInterface.hpp&quot;
 #include &quot;Interfaces/MapInterface.hpp&quot;

Modified: trunk/netpanzer/src/NetPanzer/Classes/Network/ServerMessageRouter.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Classes/Network/ServerMessageRouter.cpp	2008-09-09 15:53:32 UTC (rev 1049)
+++ trunk/netpanzer/src/NetPanzer/Classes/Network/ServerMessageRouter.cpp	2008-09-09 16:30:13 UTC (rev 1050)
@@ -20,7 +20,7 @@
 
 #include &quot;Classes/Network/NetworkServer.hpp&quot;
 #include &quot;Classes/Network/ServerConnectDaemon.hpp&quot;
-#include &quot;Interfaces/UnitInterface.hpp&quot;
+#include &quot;Units/UnitInterface.hpp&quot;
 #include &quot;Interfaces/PlayerInterface.hpp&quot;
 #include &quot;Objectives/ObjectiveInterface.hpp&quot;
 #include &quot;Interfaces/GameManager.hpp&quot;

Modified: trunk/netpanzer/src/NetPanzer/Classes/Network/UnitNetMessage.hpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Classes/Network/UnitNetMessage.hpp	2008-09-09 15:53:32 UTC (rev 1049)
+++ trunk/netpanzer/src/NetPanzer/Classes/Network/UnitNetMessage.hpp	2008-09-09 16:30:13 UTC (rev 1050)
@@ -19,9 +19,9 @@
 #define _UNITNETMESSAGE_HPP
 
 #include &quot;NetMessage.hpp&quot;
-#include &quot;Classes/UnitState.hpp&quot;
-#include &quot;Classes/UnitBase.hpp&quot;
-#include &quot;Classes/UnitOpcodes.hpp&quot;
+#include &quot;Units/UnitState.hpp&quot;
+#include &quot;Units/UnitBase.hpp&quot;
+#include &quot;Units/UnitOpcodes.hpp&quot;
 
 #define _OPCODE_MESSAGE_LIMIT 488
 

Modified: trunk/netpanzer/src/NetPanzer/Classes/Network/UnitSync.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Classes/Network/UnitSync.cpp	2008-09-09 15:53:32 UTC (rev 1049)
+++ trunk/netpanzer/src/NetPanzer/Classes/Network/UnitSync.cpp	2008-09-09 16:30:13 UTC (rev 1050)
@@ -19,8 +19,8 @@
 
 #include &quot;UnitSync.hpp&quot;
 #include &quot;Classes/Network/NetworkServer.hpp&quot;
-#include &quot;Interfaces/UnitInterface.hpp&quot;
-#include &quot;Classes/UnitBase.hpp&quot;
+#include &quot;Units/UnitInterface.hpp&quot;
+#include &quot;Units/UnitBase.hpp&quot;
 #include &quot;Interfaces/MapInterface.hpp&quot;
 #include &quot;Classes/Network/UnitNetMessage.hpp&quot;
 

Modified: trunk/netpanzer/src/NetPanzer/Classes/Network/UnitSync.hpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Classes/Network/UnitSync.hpp	2008-09-09 15:53:32 UTC (rev 1049)
+++ trunk/netpanzer/src/NetPanzer/Classes/Network/UnitSync.hpp	2008-09-09 16:30:13 UTC (rev 1050)
@@ -18,7 +18,7 @@
 #ifndef __UNITSYNC_HPP__
 #define __UNITSYNC_HPP__
 
-#include &quot;Classes/UnitBase.hpp&quot;
+#include &quot;Units/UnitBase.hpp&quot;
 
 class ClientSocket;
 

Modified: trunk/netpanzer/src/NetPanzer/Classes/OpcodeDebugger.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Classes/OpcodeDebugger.cpp	2008-09-09 15:53:32 UTC (rev 1049)
+++ trunk/netpanzer/src/NetPanzer/Classes/OpcodeDebugger.cpp	2008-09-09 16:30:13 UTC (rev 1050)
@@ -23,7 +23,7 @@
 #include &lt;unistd.h&gt;
 
 #include &quot;Classes/OpcodeDebugger.hpp&quot;
-#include &quot;Classes/UnitOpcodes.hpp&quot;
+#include &quot;Units/UnitOpcodes.hpp&quot;
 
 void OpcodeDebugger::logOpcode(std::ostream&amp; log, UnitOpcode* opcode)
 {

Modified: trunk/netpanzer/src/NetPanzer/Classes/PlacementMatrix.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Classes/PlacementMatrix.cpp	2008-09-09 15:53:32 UTC (rev 1049)
+++ trunk/netpanzer/src/NetPanzer/Classes/PlacementMatrix.cpp	2008-09-09 16:30:13 UTC (rev 1050)
@@ -18,7 +18,7 @@
 #include &lt;config.h&gt;
 #include &quot;Classes/PlacementMatrix.hpp&quot;
 #include &quot;Interfaces/MapInterface.hpp&quot;
-#include &quot;Classes/UnitBlackBoard.hpp&quot;
+#include &quot;Units/UnitBlackBoard.hpp&quot;
 
 void PlacementMatrix::reset( iXY ini_map_loc )
 {

Modified: trunk/netpanzer/src/NetPanzer/Classes/PlayerUnitConfig.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Classes/PlayerUnitConfig.cpp	2008-09-09 15:53:32 UTC (rev 1049)
+++ trunk/netpanzer/src/NetPanzer/Classes/PlayerUnitConfig.cpp	2008-09-09 16:30:13 UTC (rev 1050)
@@ -18,7 +18,7 @@
 #include &lt;config.h&gt;
 #include &quot;Classes/PlayerUnitConfig.hpp&quot;
 #include &quot;Interfaces/GameConfig.hpp&quot;
-#include &quot;Interfaces/UnitProfileInterface.hpp&quot;
+#include &quot;Units/UnitProfileInterface.hpp&quot;
 
 PlayerUnitConfig::PlayerUnitConfig()
 {

Modified: trunk/netpanzer/src/NetPanzer/Classes/PlayerUnitConfig.hpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Classes/PlayerUnitConfig.hpp	2008-09-09 15:53:32 UTC (rev 1049)
+++ trunk/netpanzer/src/NetPanzer/Classes/PlayerUnitConfig.hpp	2008-09-09 16:30:13 UTC (rev 1050)
@@ -18,7 +18,7 @@
 #ifndef _PLAYERUNITCONFIG_HPP
 #define _PLAYERUNITCONFIG_HPP
 
-#include &quot;Structs/UnitTypes.hpp&quot;
+#include &quot;Units/UnitTypes.hpp&quot;
 
 #include &lt;vector&gt;
 

Modified: trunk/netpanzer/src/NetPanzer/Classes/SelectionList.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Classes/SelectionList.cpp	2008-09-09 15:53:32 UTC (rev 1049)
+++ trunk/netpanzer/src/NetPanzer/Classes/SelectionList.cpp	2008-09-09 16:30:13 UTC (rev 1050)
@@ -17,10 +17,10 @@
 */
 #include &lt;config.h&gt;
 #include &quot;SelectionList.hpp&quot;
-#include &quot;Interfaces/UnitInterface.hpp&quot;
+#include &quot;Units/UnitInterface.hpp&quot;
 #include &quot;Interfaces/PlayerInterface.hpp&quot;
 #include &quot;Util/Log.hpp&quot;
-#include &quot;Classes/UnitBase.hpp&quot;
+#include &quot;Units/UnitBase.hpp&quot;
 #include &quot;Interfaces/WorldViewInterface.hpp&quot;
 #include &lt;algorithm&gt;
 

Modified: trunk/netpanzer/src/NetPanzer/Classes/SelectionList.hpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Classes/SelectionList.hpp	2008-09-09 15:53:32 UTC (rev 1049)
+++ trunk/netpanzer/src/NetPanzer/Classes/SelectionList.hpp	2008-09-09 16:30:13 UTC (rev 1050)
@@ -18,8 +18,8 @@
 #ifndef _SELECTIONLIST_HPP
 #define _SELECTIONLIST_HPP
 
-#include &quot;Classes/UnitState.hpp&quot;
-#include &quot;Interfaces/UnitInterface.hpp&quot;
+#include &quot;Units/UnitState.hpp&quot;
+#include &quot;Units/UnitInterface.hpp&quot;
 
 class SelectionList
 {

Deleted: trunk/netpanzer/src/NetPanzer/Classes/UnitBase.hpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Classes/UnitBase.hpp	2008-09-09 15:53:32 UTC (rev 1049)
+++ trunk/netpanzer/src/NetPanzer/Classes/UnitBase.hpp	2008-09-09 16:30:13 UTC (rev 1050)
@@ -1,66 +0,0 @@
-/*
-Copyright (C) 1998 Pyrosoft Inc. (www.pyrosoftgames.com), Matthew Bogue
- 
-This program is free software; you can redistribute it and/or modify
-it under the terms of the GNU General Public License as published by
-the Free Software Foundation; either version 2 of the License, or
-(at your option) any later version.
- 
-This program is distributed in the hope that it will be useful,
-but WITHOUT ANY WARRANTY; without even the implied warranty of
-MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-GNU General Public License for more details.
- 
-You should have received a copy of the GNU General Public License
-along with this program; if not, write to the Free Software
-Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
-*/
-#ifndef _UNITBASE_HPP
-#define _UNITBASE_HPP
-
-#include &quot;Core/CoreTypes.hpp&quot;
-#include &quot;Classes/UnitState.hpp&quot;
-
-class UnitMessage;
-class UnitOpcode;
-class SpriteSorter;
-class PlayerState;
-
-class UnitBase
-{
-public:
-    PlayerState* player;
-    UnitID       id;
-    UnitState    unit_state;
-    bool         in_sync_flag;
-
-    UnitBase(PlayerState* newPlayer, UnitID newId)
-        : player(newPlayer), id(newId)
-    { }
-    virtual ~UnitBase()
-    { }
-
-    virtual void processMessage(const UnitMessage* ) = 0;
-    virtual void evalCommandOpcode(const UnitOpcode* ) = 0;
-    virtual void updateState() = 0;
-    virtual void syncUnit() = 0;
-    virtual void offloadGraphics(SpriteSorter&amp; ) = 0;
-    virtual void soundSelected() = 0;
-
-private:
-    friend class UnitInterface;
-    void setID(UnitID id)
-    {
-        this-&gt;id = id;
-    }
-
-    UnitID getID() const
-    {
-        return id;
-    }
-
-protected:
-    UnitBase *groupLinkNext;
-};
-
-#endif // ** _UNITBASE_HPP

Deleted: trunk/netpanzer/src/NetPanzer/Classes/UnitBlackBoard.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Classes/UnitBlackBoard.cpp	2008-09-09 15:53:32 UTC (rev 1049)
+++ trunk/netpanzer/src/NetPanzer/Classes/UnitBlackBoard.cpp	2008-09-09 16:30:13 UTC (rev 1050)
@@ -1,52 +0,0 @@
-/*
-Copyright (C) 1998 Pyrosoft Inc. (www.pyrosoftgames.com), Matthew Bogue
- 
-This program is free software; you can redistribute it and/or modify
-it under the terms of the GNU General Public License as published by
-the Free Software Foundation; either version 2 of the License, or
-(at your option) any later version.
- 
-This program is distributed in the hope that it will be useful,
-but WITHOUT ANY WARRANTY; without even the implied warranty of
-MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-GNU General Public License for more details.
- 
-You should have received a copy of the GNU General Public License
-along with this program; if not, write to the Free Software
-Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
-*/
-#include &lt;config.h&gt;
-#include &quot;Classes/UnitBlackBoard.hpp&quot;
-
-#include &quot;Interfaces/MapInterface.hpp&quot;
-
-BitArray UnitBlackBoard::unit_loc_map;
-
-void UnitBlackBoard::initializeBlackBoard( void )
-{
-    unit_loc_map.initialize( MapInterface::getWidth(),
-                             MapInterface::getHeight() );
-
-    unit_loc_map.clear();
-}
-
-void UnitBlackBoard::resetBlackBoard()
-{
-    unit_loc_map.clear();
-}
-
-
-void UnitBlackBoard::updateUnitLocs( void )
-{
-    unsigned long i,k,x_limit,y_limit;
-
-    x_limit = unit_loc_map.x_size;
-    y_limit = unit_loc_map.y_size;
-
-    for( i = 0; i &lt; y_limit; i++ )
-        for ( k = 0; k &lt; x_limit; k++ ) {
-            if ( unit_loc_map.getBit( k, i ) == true )
-                MapInterface::markLocHack( iXY( k, i ) );
-        }
-
-}

Deleted: trunk/netpanzer/src/NetPanzer/Classes/UnitBlackBoard.hpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Classes/UnitBlackBoard.hpp	2008-09-09 15:53:32 UTC (rev 1049)
+++ trunk/netpanzer/src/NetPanzer/Classes/UnitBlackBoard.hpp	2008-09-09 16:30:13 UTC (rev 1050)
@@ -1,56 +0,0 @@
-/*
-Copyright (C) 1998 Pyrosoft Inc. (www.pyrosoftgames.com), Matthew Bogue
- 
-This program is free software; you can redistribute it and/or modify
-it under the terms of the GNU General Public License as published by
-the Free Software Foundation; either version 2 of the License, or
-(at your option) any later version.
- 
-This program is distributed in the hope that it will be useful,
-but WITHOUT ANY WARRANTY; without even the implied warranty of
-MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-GNU General Public License for more details.
- 
-You should have received a copy of the GNU General Public License
-along with this program; if not, write to the Free Software
-Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
-*/
-#ifndef _UNITBLACKBOARD_HPP
-#define _UNITBLACKBOARD_HPP
-
-#include &quot;ArrayUtil/BitArray.hpp&quot;
-#include &quot;Types/iXY.hpp&quot;
-
-class UnitBlackBoard
-{
-protected:
-    friend class Vehicle;
-    
-    static BitArray unit_loc_map;
-
-    static inline void markUnitLoc( iXY &amp;unit_map_loc )
-    {
-        unit_loc_map.setBit( unit_map_loc.x, unit_map_loc.y );
-    }
-
-    static inline void unmarkUnitLoc( iXY &amp;unit_map_loc )
-    {
-        unit_loc_map.clearBit( unit_map_loc.x, unit_map_loc.y );
-    }
-
-public:
-    static void initializeBlackBoard( void );
-
-    static void resetBlackBoard();
-
-    static void updateUnitLocs( void );
-
-    static inline bool unitOccupiesLoc( iXY &amp;unit_map_loc )
-    {
-        return( unit_loc_map.getBit( unit_map_loc.x, unit_map_loc.y ) );
-    }
-
-
-};
-
-#endif // ** _UNITBLACKBOARD_HPP

Deleted: trunk/netpanzer/src/NetPanzer/Classes/UnitBucketArray.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Classes/UnitBucketArray.cpp	2008-09-09 15:53:32 UTC (rev 1049)
+++ trunk/netpanzer/src/NetPanzer/Classes/UnitBucketArray.cpp	2008-09-09 16:30:13 UTC (rev 1050)
@@ -1,296 +0,0 @@
-/*
-Copyright (C) 1998 Pyrosoft Inc. (www.pyrosoftgames.com), Matthew Bogue
- 
-This program is free software; you can redistribute it and/or modify
-it under the terms of the GNU General Public License as published by
-the Free Software Foundation; either version 2 of the License, or
-(at your option) any later version.
- 
-This program is distributed in the hope that it will be useful,
-but WITHOUT ANY WARRANTY; without even the implied warranty of
-MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-GNU General Public License for more details.
- 
-You should have received a copy of the GNU General Public License
-along with this program; if not, write to the Free Software
-Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
-*/
-#include &lt;config.h&gt;
-
-#include &quot;2D/Palette.hpp&quot;
-#include &quot;Classes/UnitBucketArray.hpp&quot;
-
-UnitBucketArray::UnitBucketArray( )
-        : UnitBucketArrayTemplate( )
-{
-    map_x_sample_factor = 0;
-    map_y_sample_factor = 0;
-}
-
-UnitBucketArray::~UnitBucketArray( )
-{
-}
-
-void
-UnitBucketArray::initialize( iXY map_size, iXY tile_size )
-{
-    initialize( map_size, tile_size, 10, 10 );
-}
-
-void
-UnitBucketArray::initialize( iXY map_size, iXY tile_size,
-        long x_super_sample, long y_super_sample )
-{
-    unsigned long rows, columns;
-
-    assert( x_super_sample &gt;= 1 );
-    assert( y_super_sample &gt;= 1 );
-
-    UnitBucketArray::tile_size = tile_size;
-    UnitBucketArray::map_size = map_size;
-    UnitBucketArray::map_size_x = map_size.x;
-    UnitBucketArray::map_size_y = map_size.y;
-
-    map_x_sample_factor = x_super_sample;
-    map_y_sample_factor = y_super_sample;
-
-    while( (map_size.x % map_x_sample_factor) &gt; 0 ) {
-        map_x_sample_factor++;
-    }
-
-    while( (map_size.y % map_y_sample_factor) &gt; 0 ) {
-        map_y_sample_factor++;
-    }
-
-    pixel_x_sample_factor = tile_size.x * map_x_sample_factor;
-    pixel_y_sample_factor = tile_size.y * map_y_sample_factor;
-
-    rows = (unsigned long) map_size.y / map_y_sample_factor;
-    columns = (unsigned long) map_size.x / map_x_sample_factor;
-
-    UnitBucketArrayTemplate::initialize( rows, columns );
-}
-
-iRect
-UnitBucketArray::worldRectToBucketRectClip( iRect &amp;world_rect )
-{
-    long bucket_max_x;
-    long bucket_max_y;
-
-    bucket_max_x = world_rect.max.x / pixel_x_sample_factor;
-    if ( bucket_max_x &gt;= (long) column_size ) {
-        bucket_max_x = column_size - 1;
-    }
-
-    bucket_max_y = world_rect.max.y / pixel_y_sample_factor;
-    if ( bucket_max_y &gt;= (long) row_size ) {
-        bucket_max_y = row_size  - 1;
-    }
-
-    return( iRect( world_rect.min.x / pixel_x_sample_factor,
-                   world_rect.min.y / pixel_y_sample_factor,
-                   bucket_max_x,
-                   bucket_max_y
-                 )
-          );
-}
-
-UnitBucketList*
-UnitBucketArray::getBucketAssocWorldLoc( iXY world_loc )
-{
-    long bucket_index;
-
-    bucket_index = ((world_loc.y / pixel_y_sample_factor) * column_size) +
-                   (world_loc.x / pixel_x_sample_factor);
-
-    assert( bucket_index &lt; (long) size );
-
-    return( &amp;(array[ bucket_index ]) );
-}
-
-UnitBucketList*
-UnitBucketArray::getBucketAssocMapLoc( iXY map_loc )
-{
-    long bucket_index;
-
-    bucket_index = ((map_loc.y / map_y_sample_factor) * column_size) +
-                   (map_loc.x / map_x_sample_factor);
-
-    assert( bucket_index &lt; (long) size );
-
-    return( &amp;(array[ bucket_index ]) );
-}
-
-void
-UnitBucketArray::addUnit( UnitBase *unit )
-{
-    UnitBucketPointer *unit_bucket_ptr;
-    long bucket_index;
-
-    bucket_index = ((unit-&gt;unit_state.location.y / pixel_y_sample_factor) * column_size) +
-                   (unit-&gt;unit_state.location.x / pixel_x_sample_factor);
-
-    assert( bucket_index &lt; (long) size );
-
-    unit_bucket_ptr = new UnitBucketPointer(unit);
-
-    array[ bucket_index ].addFront( unit_bucket_ptr );
-}
-
-void
-UnitBucketArray::addUnit( UnitBucketPointer *unit_bucket_ptr )
-{
-    long bucket_index;
-    UnitBase *unit;
-
-    unit = unit_bucket_ptr-&gt;unit;
-
-    bucket_index = ((unit-&gt;unit_state.location.y / pixel_y_sample_factor) * column_size) +
-                   (unit-&gt;unit_state.location.x / pixel_x_sample_factor);
-
-    assert( bucket_index &lt; (long) size );
-
-    array[ bucket_index ].addFront( unit_bucket_ptr );
-}
-
-
-long
-UnitBucketArray::getUnitBucketIndex(UnitID unit_id)
-{
-    for( unsigned long bucket_index = 0; bucket_index &lt; size; bucket_index++ ) {
-        UnitBucketPointer *traversal_ptr;
-
-        traversal_ptr = array[ bucket_index ].getFront();
-
-        while( traversal_ptr != 0 ) {
-            if( traversal_ptr-&gt;unit-&gt;id == unit_id )
-                return (long) bucket_index;
-
-            traversal_ptr = traversal_ptr-&gt;next;
-        }
-
-    }
-
-    return -1;
-}
-
-UnitBase*
-UnitBucketArray::getUnit(UnitID unit_id, unsigned long bucket_index)
-{
-    UnitBucketPointer *traversal_ptr = array[bucket_index].getFront();
-
-    while( traversal_ptr != 0 ) {
-        if(traversal_ptr-&gt;unit-&gt;id == unit_id)
-            return traversal_ptr-&gt;unit;
-
-        traversal_ptr = traversal_ptr-&gt;next;
-    }
-
-    return 0;
-}
-
-UnitBase* UnitBucketArray::getUnitAtWorldLoc(UnitID unit_id, iXY world_loc)
-{
-    long bucket_index;
-
-    bucket_index = ((world_loc.y / pixel_y_sample_factor) * column_size) +
-                   (world_loc.x / pixel_x_sample_factor);
-
-    assert( bucket_index &lt; (long) size );
-
-    UnitBucketPointer *traversal_ptr;
-
-    traversal_ptr = array[ bucket_index ].getFront();
-
-    while( traversal_ptr != 0 ) {
-        if(traversal_ptr-&gt;unit-&gt;id == unit_id)
-            return traversal_ptr-&gt;unit;
-
-        traversal_ptr = traversal_ptr-&gt;next;
-    }
-
-    return 0;
-}
-
-UnitBase*
-UnitBucketArray::getUnitAtMapLoc(UnitID unit_id, iXY map_loc)
-{
-    long bucket_index;
-
-    bucket_index = ((map_loc.y / map_y_sample_factor) * column_size) +
-                   (map_loc.x / map_x_sample_factor);
-
-    assert( bucket_index &lt; (long) size );
-
-    UnitBucketPointer *traversal_ptr;
-
-    traversal_ptr = array[ bucket_index ].getFront();
-
-    while( traversal_ptr != 0 ) {
-        if(traversal_ptr-&gt;unit-&gt;id == unit_id)
-            return traversal_ptr-&gt;unit;
-
-        traversal_ptr = traversal_ptr-&gt;next;
-    }
-
-    return 0;
-}
-
-bool
-UnitBucketArray::moveUnit(UnitID unit_id, unsigned long from_bucket_index,
-			       unsigned long to_bucket_index )
-{
-    assert(from_bucket_index &lt; size);
-    assert(to_bucket_index &lt; size);
-    
-    bool found = false;
-    UnitBucketPointer *traversal_ptr;
-    UnitBucketPointer *move_ptr;
-
-    traversal_ptr = array[ from_bucket_index ].getFront();
-
-    while( (traversal_ptr != 0) &amp;&amp; (found == false) ) {
-        if(traversal_ptr-&gt;unit-&gt;id == unit_id) {
-            move_ptr = traversal_ptr;
-            traversal_ptr = traversal_ptr-&gt;next;
-            array[ from_bucket_index ].removeObject( move_ptr );
-            array[ to_bucket_index ].addFront( move_ptr );
-            found = true;
-        } else {
-            traversal_ptr = traversal_ptr-&gt;next;
-        }
-    }
-
-    if ( found == false ) {
-        long from_bucket_index = getUnitBucketIndex( unit_id );
-        if(from_bucket_index != -1) {
-            return( moveUnit( unit_id, from_bucket_index, to_bucket_index ) );
-        } else
-            return false;
-    }
-
-    return true;
-}
-
-bool
-UnitBucketArray::deleteUnitBucketPointer(UnitID unit_id, iXY world_loc)
-{
-    long bucket_index;
-
-    bucket_index = worldLocToBucketIndex( world_loc );
-
-    UnitBucketPointer *traversal_ptr;
-
-    traversal_ptr = array[ bucket_index ].getFront();
-
-    while( traversal_ptr != 0 ) {
-        if(traversal_ptr-&gt;unit-&gt;id == unit_id) {
-            array[ bucket_index ].deleteObject( traversal_ptr );
-            return true;
-        }
-
-        traversal_ptr = traversal_ptr-&gt;next;
-    }
-
-    return false;
-}

Deleted: trunk/netpanzer/src/NetPanzer/Classes/UnitBucketArray.hpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Classes/UnitBucketArray.hpp	2008-09-09 15:53:32 UTC (rev 1049)
+++ trunk/netpanzer/src/NetPanzer/Classes/UnitBucketArray.hpp	2008-09-09 16:30:13 UTC (rev 1050)
@@ -1,155 +0,0 @@
-/*
-Copyright (C) 1998 Pyrosoft Inc. (www.pyrosoftgames.com), Matthew Bogue
- 
-This program is free software; you can redistribute it and/or modify
-it under the terms of the GNU General Public License as published by
-the Free Software Foundation; either version 2 of the License, or
-(at your option) any later version.
- 
-This program is distributed in the hope that it will be useful,
-but WITHOUT ANY WARRANTY; without even the implied warranty of
-MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-GNU General Public License for more details.
- 
-You should have received a copy of the GNU General Public License
-along with this program; if not, write to the Free Software
-Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
-*/
-#ifndef _UNIT_BUCKET_ARRAY_HPP
-#define _UNIT_BUCKET_ARRAY_HPP
-
-#include &quot;ArrayUtil/BucketArrayTemplate.hpp&quot;
-
-#include &quot;Classes/UnitBase.hpp&quot;
-
-class UnitBucketPointer
-{
-public:
-    UnitBase *unit;
-
-    UnitBucketPointer()
-    {
-        unit = 0;
-        next = 0;
-        prev = 0;
-    }
-
-    UnitBucketPointer(UnitBase *unit)
-    {
-        UnitBucketPointer::unit = unit;
-        next = 0;
-        prev = 0;
-    }
-
-    UnitBucketPointer *next;
-    UnitBucketPointer *prev;
-};
-
-typedef BucketArrayTemplate&lt; UnitBucketPointer &gt; UnitBucketArrayTemplate;
-typedef LinkListDoubleTemplate&lt; UnitBucketPointer &gt; UnitBucketList;
-
-class UnitBucketArray : public UnitBucketArrayTemplate
-{
-protected:
-    long map_x_sample_factor;
-    long map_y_sample_factor;
-    long pixel_x_sample_factor;
-    long pixel_y_sample_factor;
-    iXY map_size;
-    long map_size_x;
-    long map_size_y;
-    iXY tile_size;
-
-public:
-
-    UnitBucketArray( );
-    ~UnitBucketArray( );
-
-    void initialize( iXY map_size, iXY tile_size);
-    void initialize( iXY map_size, iXY tile_size, long x_super_sample, long y_super_sample );
-
-    inline long getXSample( void )
-    {
-        return( map_x_sample_factor );
-    }
-
-    inline long getYSample( void )
-    {
-        return( map_y_sample_factor );
-    }
-
-    inline iXY getSample( void )
-    {
-        return( iXY( map_x_sample_factor, map_y_sample_factor) );
-    }
-
-    inline unsigned long mapLocToBucketIndex( iXY map_loc )
-    {
-        long bucket_index;
-
-        bucket_index = ((map_loc.y / map_y_sample_factor) * column_size) +
-                       (map_loc.x / map_x_sample_factor);
-
-        return( bucket_index );
-    }
-
-    inline unsigned long worldLocToBucketIndex( iXY world_loc )
-    {
-        long bucket_index;
-
-        bucket_index = ((world_loc.y / pixel_y_sample_factor) * column_size) +
-                       (world_loc.x / pixel_x_sample_factor);
-
-        return( bucket_index );
-    }
-
-    inline iXY mapLocToBucketLoc( iXY map_loc )
-    {
-        return( iXY( (map_loc.x / map_x_sample_factor), (map_loc.y / map_y_sample_factor) ) );
-    }
-
-    inline iXY worldLocToBucketLoc( iXY world_loc )
-    {
-        return( iXY(  (world_loc.x / pixel_x_sample_factor) , (world_loc.y / pixel_y_sample_factor) ) );
-    }
-
-    inline iRect worldRectToBucketRect( iRect &amp;world_rect )
-    {
-        return( iRect( world_rect.min.x / pixel_x_sample_factor,
-                       world_rect.min.y / pixel_y_sample_factor,
-                       world_rect.max.x / pixel_x_sample_factor,
-                       world_rect.max.y / pixel_y_sample_factor  )
-              );
-    }
-
-    iRect worldRectToBucketRectClip( iRect &amp;world_rect );
-
-
-    inline iRect mapRectToBucketRect( iRect &amp;map_rect )
-    {
-        return( iRect( map_rect.min.x / map_x_sample_factor,
-                       map_rect.min.y / map_y_sample_factor,
-                       map_rect.max.x / map_x_sample_factor,
-                       map_rect.max.y / map_y_sample_factor  )
-              );
-    }
-
-    UnitBucketList * getBucketAssocWorldLoc( iXY world_loc );
-    UnitBucketList * getBucketAssocMapLoc( iXY map_loc );
-
-    void addUnit( UnitBase *unit );
-    void addUnit( UnitBucketPointer *unit_bucket_ptr );
-
-    long getUnitBucketIndex( UnitID unit_id );
-
-    UnitBase * getUnit( UnitID unit_id, unsigned long bucket_index );
-    UnitBase * getUnitAtWorldLoc( UnitID unit_id, iXY world_loc );
-    UnitBase * getUnitAtMapLoc( UnitID unit_id, iXY map_loc );
-
-    bool moveUnit( UnitID unit_id, unsigned long from_bucket_index, unsigned long to_bucket_index );
-
-    bool deleteUnitBucketPointer( UnitID unit_id, iXY world_loc );
-};
-
-#endif // ** _UNIT_BUCKET_ARRAY_HPP
-

Deleted: trunk/netpanzer/src/NetPanzer/Classes/UnitLifecycles.hpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Classes/UnitLifecycles.hpp	2008-09-09 15:53:32 UTC (rev 1049)
+++ trunk/netpanzer/src/NetPanzer/Classes/UnitLifecycles.hpp	2008-09-09 16:30:13 UTC (rev 1050)
@@ -1,26 +0,0 @@
-/*
-Copyright (C) 1998 Pyrosoft Inc. (www.pyrosoftgames.com), Matthew Bogue
- 
-This program is free software; you can redistribute it and/or modify
-it under the terms of the GNU General Public License as published by
-the Free Software Foundation; either version 2 of the License, or
-(at your option) any later version.
- 
-This program is distributed in the hope that it will be useful,
-but WITHOUT ANY WARRANTY; without even the implied warranty of
-MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-GNU General Public License for more details.
- 
-You should have received a copy of the GNU General Public License
-along with this program; if not, write to the Free Software
-Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
-*/
-#ifndef _UNITLIFECYCLES_HPP
-#define _UNITLIFECYCLES_HPP
-
-#define _UNIT_LIFECYCLE_ACTIVE           0x01
-#define _UNIT_LIFECYCLE_PENDING_DESTRUCT 0x02
-#define _UNIT_LIFECYCLE_DESTROYED        0x03
-#define _UNIT_LIFECYCLE_INACTIVE         0x04
-
-#endif // ** _UNITLIFECYCLES_HPP

Deleted: trunk/netpanzer/src/NetPanzer/Classes/UnitList.hpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Classes/UnitList.hpp	2008-09-09 15:53:32 UTC (rev 1049)
+++ trunk/netpanzer/src/NetPanzer/Classes/UnitList.hpp	2008-09-09 16:30:13 UTC (rev 1050)
@@ -1,223 +0,0 @@
-/*
-Copyright (C) 1998 Pyrosoft Inc. (www.pyrosoftgames.com), Matthew Bogue
- 
-This program is free software; you can redistribute it and/or modify
-it under the terms of the GNU General Public License as published by
-the Free Software Foundation; either version 2 of the License, or
-(at your option) any later version.
- 
-This program is distributed in the hope that it will be useful,
-but WITHOUT ANY WARRANTY; without even the implied warranty of
-MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-GNU General Public License for more details.
- 
-You should have received a copy of the GNU General Public License
-along with this program; if not, write to the Free Software
-Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
-*/
-#ifndef _UNITLIST_HPP
-#define _UNITLIST_HPP
-
-#include &lt;vector&gt;
-#include &lt;algorithm&gt;
-#include &lt;assert.h&gt;
-
-#include &quot;Classes/UnitBase.hpp&quot;
-
-#if 0
-
-class UnitList
-{
-private:
-    class IdUnit
-    {
-    public:
-	IdUnit(UnitBase* newunit, size_t newid)
-	    : unit(newunit), id(newid)
-	{
-	}
-
-        bool operator&lt; (const IdUnit&amp; otherunitid) const
-        {
-            return id &lt; otherunitid.id;
-        }
-
-	bool operator&lt; (const size_t&amp; compareid) const
-	{
-	    return id &lt; compareid;
-	}
-
-	bool operator == (const size_t&amp; compareid) const
-	{
-	    return id == compareid;
-	}
-
-	UnitBase* unit;
-	size_t id;
-    };
-    
-    std::vector&lt;IdUnit&gt; unitlist;
-    size_t unitlistsize;
-    typedef std::vector&lt;IdUnit&gt;::iterator unititerator;
-    typedef std::vector&lt;IdUnit&gt;::const_iterator const_unititerator;
-    
-public:
-    class iterator
-    {
-    public:
-	iterator&amp; operator++ ()
-	{
-	    ++i;
-	    return *this;
-	}
-
-	UnitBase* operator*() const
-	{
-	    return i-&gt;unit;
-	}
-
-	UnitBase* operator-&gt;() const
-	{
-	    return i-&gt;unit;
-	}
-
-	bool operator!=(const iterator&amp; other) const
-	{
-	    return i != other.i;
-	}
-
-	bool operator== (const iterator&amp; other) const
-	{
-	    return i == other.i;
-	}
-	
-    private:
-	friend class UnitList;
-	iterator(unititerator newi)
-	    : i(newi)
-	{
-	}
-	unititerator i;
-    };
-
-    class AsyncIterator 
-    {
-    public:
-        UnitBase* next()
-        {
-            unititerator i
-                = std::lower_bound(unitlist-&gt;unitlist.begin(),
-                        unitlist-&gt;unitlist.end(), IdUnit(0, currentid));
-            if(i == unitlist-&gt;unitlist.end())
-                return 0;
-            UnitBase* unit = i-&gt;unit;
-
-            currentid = i-&gt;id + 1;
-	    
-            return unit;
-        }
-
-    private:
-        friend class UnitList;
-        AsyncIterator(UnitList* newunitlist, size_t startid)
-            : currentid(startid), unitlist(newunitlist)             
-        {
-        }
-        
-        size_t currentid;
-        UnitList* unitlist;
-    };
-    
-    UnitList()
-	: unitlistsize(0)
-    { }
-
-    iterator begin()
-    {
-	return iterator(unitlist.begin());
-    }
-
-    iterator end()
-    {
-	return iterator(unitlist.end());
-    }
-
-    AsyncIterator getAsyncIterator()
-    {
-        return AsyncIterator(this, 0);
-    }
-
-    UnitBase* operator[] (size_t index) const
-    {
-	const_unititerator i 
-	    = std::lower_bound(unitlist.begin(), unitlist.end(), index);
-	if(i == unitlist.end() || i-&gt;id != index)
-            return 0;
-        
-	return i-&gt;unit;
-    }
-
-    void insert(UnitBase *unit, size_t index)
-    {
-	unititerator i 
-            = std::lower_bound(unitlist.begin(), unitlist.end(), index);
-
-        unitlist.insert(i, IdUnit(unit, index));
-	++unitlistsize;
-    }
-
-    void insert(UnitBase *unit, const UnitID &amp;unitID)
-    {
-	insert(unit, unitID.getIndex());
-    }
-
-    /** remember that erasing invalidates all existing iterators over the
-     * list. The only valid iterator is the returned from this function (which
-     * points to the next elements after the one removed)
-     */
-    iterator erase(iterator i)
-    {
-	--unitlistsize;
-	return unitlist.erase(i.i);
-    }
-
-    bool contains(size_t index) const
-    {
-	const_unititerator i 
-	    = std::lower_bound(unitlist.begin(), unitlist.end(), index);
-
-	return i != unitlist.end();
-    }
-
-    bool contains(const UnitID &amp;unitID) const
-    {
-	return contains(unitID.getIndex());
-    }
-
-    iterator find(size_t index)
-    {
-	unititerator i
-	    = std::lower_bound(unitlist.begin(), unitlist.end(), index);
-	
-	if(i == unitlist.end() || i-&gt;id != index)
-	    i = unitlist.end();
-
-	return iterator(i);
-    }
-
-    void clear()
-    {
-	unitlist.clear();
-        unitlistsize = 0;
-    }
-
-    size_t size() const
-    {
-	return unitlistsize;
-    }
-};
-
-#endif
-
-#endif
-

Modified: trunk/netpanzer/src/NetPanzer/Classes/UnitMessage.hpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Classes/UnitMessage.hpp	2008-09-09 15:53:32 UTC (rev 1049)
+++ trunk/netpanzer/src/NetPanzer/Classes/UnitMessage.hpp	2008-09-09 16:30:13 UTC (rev 1050)
@@ -18,7 +18,7 @@
 #ifndef _UNITMESSAGE_HPP
 #define _UNITMESSAGE_HPP
 
-#include &quot;Classes/UnitBase.hpp&quot;
+#include &quot;Units/UnitBase.hpp&quot;
 
 enum { _umesg_flag_unique          = 0x01,
        _umesg_flag_broadcast       = 0x02,

Deleted: trunk/netpanzer/src/NetPanzer/Classes/UnitOpcodeDecoder.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Classes/UnitOpcodeDecoder.cpp	2008-09-09 15:53:32 UTC (rev 1049)
+++ trunk/netpanzer/src/NetPanzer/Classes/UnitOpcodeDecoder.cpp	2008-09-09 16:30:13 UTC (rev 1050)
@@ -1,64 +0,0 @@
-/*
-Copyright (C) 1998 Pyrosoft Inc. (www.pyrosoftgames.com), Matthew Bogue
- 
-This program is free software; you can redistribute it and/or modify
-it under the terms of the GNU General Public License as published by
-the Free Software Foundation; either version 2 of the License, or
-(at your option) any later version.
- 
-This program is distributed in the hope that it will be useful,
-but WITHOUT ANY WARRANTY; without even the implied warranty of
-MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-GNU General Public License for more details.
- 
-You should have received a copy of the GNU General Public License
-along with this program; if not, write to the Free Software
-Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
-*/
-#include &lt;config.h&gt;
-
-#include &quot;UnitOpcodeDecoder.hpp&quot;
-#include &quot;Util/Log.hpp&quot;
-
-UnitOpcodeDecoder::UnitOpcodeDecoder()
-{
-    memset(&amp;opcode_message, 0, sizeof(opcode_message));
-    reset();
-}
-
-UnitOpcodeDecoder::~UnitOpcodeDecoder()
-{
-}
-
-void
-UnitOpcodeDecoder::reset()
-{
-    opcode_index = 0;
-}
-
-void
-UnitOpcodeDecoder::setMessage(const NetMessage* message)
-{
-    if(message-&gt;getSize() &gt; sizeof(opcode_message)) {
-        LOGGER.warning(&quot;Opcodemessage too big.&quot;);
-        memset(&amp;opcode_message, 0, sizeof(opcode_message));
-        reset();
-        return;
-    }
-
-    memcpy(&amp;opcode_message, message, message-&gt;getSize());
-    reset();
-}
-
-bool
-UnitOpcodeDecoder::decode(UnitOpcode** opcode)
-{
-    if(opcode_index + opcode_message.getHeaderSize() &gt;=
-            opcode_message.getSize())
-        return false;
-    
-    *opcode = (UnitOpcode*) (opcode_message.data + opcode_index);
-    opcode_index += UnitOpcode::getSize();
-    return true;
-}
-

Deleted: trunk/netpanzer/src/NetPanzer/Classes/UnitOpcodeDecoder.hpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Classes/UnitOpcodeDecoder.hpp	2008-09-09 15:53:32 UTC (rev 1049)
+++ trunk/netpanzer/src/NetPanzer/Classes/UnitOpcodeDecoder.hpp	2008-09-09 16:30:13 UTC (rev 1050)
@@ -1,41 +0,0 @@
-/*
-Copyright (C) 1998 Pyrosoft Inc. (www.pyrosoftgames.com), Matthew Bogue
- 
-This program is free software; you can redistribute it and/or modify
-it under the terms of the GNU General Public License as published by
-the Free Software Foundation; either version 2 of the License, or
-(at your option) any later version.
- 
-This program is distributed in the hope that it will be useful,
-but WITHOUT ANY WARRANTY; without even the implied warranty of
-MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-GNU General Public License for more details.
- 
-You should have received a copy of the GNU General Public License
-along with this program; if not, write to the Free Software
-Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
-*/
-#ifndef __UNITOPCODEDECODER_HPP__
-#define __UNITOPCODEDECODER_HPP__
-
-#include &quot;Classes/UnitOpcodes.hpp&quot;
-#include &quot;Classes/Network/UnitNetMessage.hpp&quot;
-
-class UnitOpcodeDecoder
-{
-private:
-    UnitOpcodeMessage opcode_message;
-    size_t opcode_index;
-
-    void reset();
-    
-public:
-    UnitOpcodeDecoder();
-    ~UnitOpcodeDecoder();
-    
-    void setMessage(const NetMessage* message);
-    bool decode(UnitOpcode** opcode);
-};
-
-#endif
-

Deleted: trunk/netpanzer/src/NetPanzer/Classes/UnitOpcodeEncoder.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Classes/UnitOpcodeEncoder.cpp	2008-09-09 15:53:32 UTC (rev 1049)
+++ trunk/netpanzer/src/NetPanzer/Classes/UnitOpcodeEncoder.cpp	2008-09-09 16:30:13 UTC (rev 1050)
@@ -1,66 +0,0 @@
-/*
-Copyright (C) 1998 Pyrosoft Inc. (www.pyrosoftgames.com), Matthew Bogue
- 
-This program is free software; you can redistribute it and/or modify
-it under the terms of the GNU General Public License as published by
-the Free Software Foundation; either version 2 of the License, or
-(at your option) any later version.
- 
-This program is distributed in the hope that it will be useful,
-but WITHOUT ANY WARRANTY; without even the implied warranty of
-MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-GNU General Public License for more details.
- 
-You should have received a copy of the GNU General Public License
-along with this program; if not, write to the Free Software
-Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
-*/
-#include &lt;config.h&gt;
-
-#include &quot;Classes/UnitOpcodeEncoder.hpp&quot;
-#include &quot;Classes/Network/NetworkServer.hpp&quot;
-#include &quot;Classes/Network/NetworkState.hpp&quot;
-#include &quot;Interfaces/ConsoleInterface.hpp&quot;
-#include &quot;Classes/OpcodeDebugger.hpp&quot;
-#include &quot;Classes/Network/UnitNetMessage.hpp&quot;
-#include &quot;Util/Log.hpp&quot;
-
-UnitOpcodeEncoder::UnitOpcodeEncoder()
-{
-    reset();
-}
-
-UnitOpcodeEncoder::~UnitOpcodeEncoder()
-{
-}
-
-void
-UnitOpcodeEncoder::reset()
-{
-    opcode_index = 0;
-}
-
-void
-UnitOpcodeEncoder::encode(const UnitOpcode *opcode)
-{
-    if(opcode_index + UnitOpcode::getSize() &gt; sizeof(opcode_message.data)) {
-        send();
-    }
-   
-    memcpy(opcode_message.data + opcode_index, opcode, UnitOpcode::getSize());
-    opcode_index += UnitOpcode::getSize();
-}
-
-void
-UnitOpcodeEncoder::send()
-{
-    if (!opcode_index)
-        return;
-
-    size_t size = opcode_message.getHeaderSize() + opcode_index;
-    SERVER-&gt;broadcastMessage(&amp;opcode_message, size);
-
-    reset();
-    NetworkState::incOpcodesSent();
-}
-

Deleted: trunk/netpanzer/src/NetPanzer/Classes/UnitOpcodeEncoder.hpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Classes/UnitOpcodeEncoder.hpp	2008-09-09 15:53:32 UTC (rev 1049)
+++ trunk/netpanzer/src/NetPanzer/Classes/UnitOpcodeEncoder.hpp	2008-09-09 16:30:13 UTC (rev 1050)
@@ -1,40 +0,0 @@
-/*
-Copyright (C) 1998 Pyrosoft Inc. (www.pyrosoftgames.com), Matthew Bogue
- 
-This program is free software; you can redistribute it and/or modify
-it under the terms of the GNU General Public License as published by
-the Free Software Foundation; either version 2 of the License, or
-(at your option) any later version.
- 
-This program is distributed in the hope that it will be useful,
-but WITHOUT ANY WARRANTY; without even the implied warranty of
-MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-GNU General Public License for more details.
- 
-You should have received a copy of the GNU General Public License
-along with this program; if not, write to the Free Software
-Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
-*/
-#ifndef _UNITOPCODEENCODER_HPP
-#define _UNITOPCODEENCODER_HPP
-
-#include &quot;Classes/UnitOpcodes.hpp&quot;
-#include &quot;Classes/Network/UnitNetMessage.hpp&quot;
-
-class UnitOpcodeEncoder
-{
-private:
-    UnitOpcodeMessage opcode_message;
-    size_t opcode_index;
-
-    void reset();
-
-public:
-    UnitOpcodeEncoder();
-    ~UnitOpcodeEncoder();
-    
-    void encode(const UnitOpcode *opcode);
-    void send();
-};
-
-#endif

Deleted: trunk/netpanzer/src/NetPanzer/Classes/UnitOpcodes.hpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Classes/UnitOpcodes.hpp	2008-09-09 15:53:32 UTC (rev 1049)
+++ trunk/netpanzer/src/NetPanzer/Classes/UnitOpcodes.hpp	2008-09-09 16:30:13 UTC (rev 1050)
@@ -1,295 +0,0 @@
-/*
-Copyright (C) 1998 Pyrosoft Inc. (www.pyrosoftgames.com), Matthew Bogue
- 
-This program is free software; you can redistribute it and/or modify
-it under the terms of the GNU General Public License as published by
-the Free Software Foundation; either version 2 of the License, or
-(at your option) any later version.
- 
-This program is distributed in the hope that it will be useful,
-but WITHOUT ANY WARRANTY; without even the implied warranty of
-MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-GNU General Public License for more details.
- 
-You should have received a copy of the GNU General Public License
-along with this program; if not, write to the Free Software
-Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
-*/
-#ifndef _UNITOPCODES_HPP
-#define _UNITOPCODES_HPP
-
-#include &quot;Classes/UnitBase.hpp&quot;
-#include &lt;queue&gt;
-
-enum { _unit_opcode_flag_sync = 0x01 };
-
-/** The following is a tricky macro to ensure a struct has a specific size. THe
- * check is done at compiletime. The trick is that C doesn't allow duplicate
- * case labels...
- */
-#define ASSERT_SIZE(mystruct, size)                                     \
-    namespace TRICKYTESTS { static inline void mystruct##_test() {      \
-        int i=0; switch(i) { case 0: ; case (sizeof(mystruct) == (size)): ; } \
-    } }
-
-#ifdef MSVC
-#pragma pack(1)
-#endif
-
-// do not use this directly, cast to 1 of the UnitOpcode classes...
-struct UnitOpcodeStruct
-{
-public:
-    Uint8 opcode;
-private:
-    Uint16 unit_index;
-public:
-    Uint8 flags;
-private:
-    Uint8 op_data[7];
-} __attribute__((packed));
-
-typedef std::queue&lt;UnitOpcodeStruct&gt; UnitOpcodeQueue;
-
-class UnitOpcode
-{
-public:
-    Uint8 opcode;
-    //Uint8 player_index;
-private:
-    Uint16 unit_id;
-public:
-    Uint8 flags;
-
-    static size_t getSize()
-    {
-        return sizeof(UnitOpcodeStruct);
-    }
-
-    void setUnitID(UnitID id)
-    {
-        unit_id = htol16(id);
-    }
-
-    UnitID getUnitID() const
-    {
-        return ltoh16(unit_id);
-    }
-} __attribute__((packed));
-
-ASSERT_SIZE(UnitOpcode, sizeof(UnitOpcodeStruct)-7)
-
-#define _UNIT_OPCODE_MOVE 1
-
-class MoveOpcode : public UnitOpcode
-{
-private:
-    Uint32 square;
-
-public:
-    Sint8 loc_x_offset;
-    Sint8 loc_y_offset;
-    Uint8 pad[1];
-
-    MoveOpcode( )
-    {
-        flags = 0;
-        opcode = _UNIT_OPCODE_MOVE;
-
-        square = 0;
-        loc_x_offset = 0;
-        loc_y_offset = 0;
-        pad[0] = 0;
-    }
-
-    void setSquare(Uint32 square)
-    {
-        this-&gt;square = htol32(square);
-    }
-
-    Uint32 getSquare() const
-    {
-        return ltoh32(square);
-    }
-} __attribute__((packed));
-
-ASSERT_SIZE(MoveOpcode, 7 + sizeof(UnitOpcode))
-
-#define _UNIT_OPCODE_TURRET_TRACK_POINT 2
-
-class TurretTrackPointOpcode : public UnitOpcode
-{
-private:
-    Uint16 target_x;
-    Uint16 target_y;
-
-public:
-    Uint8  activate;
-    Uint8 pad[2];
-
-    TurretTrackPointOpcode( )
-    {
-        flags = 0;
-        opcode = _UNIT_OPCODE_TURRET_TRACK_POINT;
-
-        target_x = target_y = 0;
-        activate = false;
-        pad[0] = pad[1] = 0;
-    }
-
-    void setTarget(iXY pos)
-    {
-        target_x = htol16(pos.x);
-        target_y = htol16(pos.y);
-    }
-
-    iXY getTarget() const
-    {
-        return iXY(ltoh16(target_x), ltoh16(target_y));
-    }
-} __attribute__((packed));
-
-ASSERT_SIZE(TurretTrackPointOpcode, 7 + sizeof(UnitOpcode))
-
-#define _UNIT_OPCODE_TURRET_TRACK_TARGET 3
-
-class TurretTrackTargetOpcode : public UnitOpcode
-{
-private:
-    Uint16 targetUnitID;
-public:
-    Uint8 activate;
-    Uint8 pad[4];
-
-    TurretTrackTargetOpcode( )
-    {
-        flags = 0;
-        opcode = _UNIT_OPCODE_TURRET_TRACK_TARGET;
-
-        targetUnitID = 0;
-        activate = false;
-        pad[0] = pad[1] = pad[2] = pad[3] = 0;
-    }
-
-    void setTargetUnitID(UnitID id)
-    {
-        targetUnitID = htol16(id);
-    }
-    
-    UnitID getTargetUnitID() const
-    {
-        return ltoh16(targetUnitID);
-    }
-} __attribute__((packed));
-
-ASSERT_SIZE(TurretTrackTargetOpcode, 7 + sizeof(UnitOpcode))
-
-#define _UNIT_OPCODE_FIRE_WEAPON 4
-
-class FireWeaponOpcode : public UnitOpcode
-{
-private:
-    Uint16 x;
-    Uint16 y;
-    Uint8 pad[3];
-    
-public:
-
-    FireWeaponOpcode( )
-    {
-        flags = 0;
-        opcode = _UNIT_OPCODE_FIRE_WEAPON;
-
-        x = y = 0;
-        pad[0] = pad[1] = pad[2] = 0;
-    }
-
-    void setTarget(iXY target)
-    {
-        x = htol16(target.x);
-        y = htol16(target.y);
-    }
-
-    iXY getTarget() const
-    {
-        return iXY(ltoh16(x), ltoh16(y));
-    }
-} __attribute__((packed));
-
-ASSERT_SIZE(FireWeaponOpcode, 7 + sizeof(UnitOpcode))
-
-#define _UNIT_OPCODE_SYNC_UNIT 5
-
-class SyncUnitOpcode : public UnitOpcode
-{
-public:
-    Uint8 pad[7];
-
-    SyncUnitOpcode( )
-    {
-        flags = 0;
-        opcode = _UNIT_OPCODE_SYNC_UNIT;
-
-        for(int i=0;i&lt;7;i++)
-            pad[i] = 0;
-    }
-
-} __attribute__((packed));
-
-ASSERT_SIZE(SyncUnitOpcode, 7 + sizeof(UnitOpcode))
-
-#define _UNIT_OPCODE_UPDATE_STATE 6
-
-class UpdateStateUnitOpcode : public UnitOpcode
-{
-private:
-    Sint16 hit_points;
-public:
-    Uint8 pad[5];
-
-    UpdateStateUnitOpcode( )
-    {
-        flags = 0;
-        opcode = _UNIT_OPCODE_UPDATE_STATE;
-
-        for(int i=0; i&lt;5; i++)
-            pad[i] = 0;
-    }
-
-    void setHitPoints(Sint16 newhitpoints)
-    {
-        hit_points = htol16(newhitpoints);
-    }
-
-    Sint16 getHitPoints() const
-    {
-        return ltoh16(hit_points);
-    }
-} __attribute__((packed));
-
-ASSERT_SIZE(UpdateStateUnitOpcode, 7 + sizeof(UnitOpcode))
-
-#define _UNIT_OPCODE_DESTRUCT 7
-
-class DestructUnitOpcode : public UnitOpcode
-{
-public:
-    unsigned char pad[7];
-
-    DestructUnitOpcode( )
-    {
-        flags = 0;
-        opcode = _UNIT_OPCODE_DESTRUCT;
-
-        for(int i=0; i&lt;7; i++)
-            pad[i] = 0;
-    }
-} __attribute__((packed));
-
-ASSERT_SIZE(DestructUnitOpcode, 7 + sizeof(UnitOpcode))
-
-#ifdef MSVC
-#pragma pack()
-#endif
-
-#endif

Deleted: trunk/netpanzer/src/NetPanzer/Classes/UnitState.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Classes/UnitState.cpp	2008-09-09 15:53:32 UTC (rev 1049)
+++ trunk/netpanzer/src/NetPanzer/Classes/UnitState.cpp	2008-09-09 16:30:13 UTC (rev 1050)
@@ -1,123 +0,0 @@
-/*
-Copyright (C) 1998 Pyrosoft Inc. (www.pyrosoftgames.com), Matthew Bogue
- 
-This program is free software; you can redistribute it and/or modify
-it under the terms of the GNU General Public License as published by
-the Free Software Foundation; either version 2 of the License, or
-(at your option) any later version.
- 
-This program is distributed in the hope that it will be useful,
-but WITHOUT ANY WARRANTY; without even the implied warranty of
-MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-GNU General Public License for more details.
- 
-You should have received a copy of the GNU General Public License
-along with this program; if not, write to the Free Software
-Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
-*/
-#include &lt;config.h&gt;
-#include &quot;Util/Endian.hpp&quot;
-#include &quot;Classes/UnitState.hpp&quot;
-
-UnitState::UnitState()
-{
-    body_angle.set( 0, 10 );
-    turret_angle.set( 0, 10 );
-
-    // ** NOTE: TEMPORARY UNTIL UNIT PROPERITIES CODED
-
-    bbox.setBounds( iXY( -25, -15 ), iXY( 25, 35 ) );
-
-    select = false;
-    orientation = 0;
-    speed_rate = 20;
-    speed_factor = 2;
-
-    hit_points = 100;
-    damage_factor = 30;
-    weapon_range = 409600;
-    defend_range = 100;
-    reload_time = 45;
-
-    threat_level = _threat_level_all_clear;
-}
-
-int UnitState::percentDamageInt( void )
-{
-    int damage_percentage;
-
-    damage_percentage = (int)  ( (1 - ( ( (float) hit_points ) / ( (float) max_hit_points) ) ) * 100 );
-
-    return( damage_percentage );
-}
-
-float UnitState::percentDamageFloat( void )
-{
-    float damage_percentage;
-
-    damage_percentage = ( (1 - ( ( (float) hit_points ) / ( (float) max_hit_points) ) ) * 100 );
-
-    return( damage_percentage );
-}
-
-NetworkUnitState UnitState::getNetworkUnitState() const
-{
-    NetworkUnitState state;
-
-    state.unit_type = unit_type;
-    state.location_x = htol32(location.x);
-    state.location_y = htol32(location.y);
-    state.bbox_min_x = htol32(bbox.min.x);
-    state.bbox_min_y = htol32(bbox.min.y);
-    state.bbox_max_x = htol32(bbox.max.x);
-    state.bbox_max_y = htol32(bbox.max.y);
-
-    state.body_angle = body_angle.getNetworkAngleInt();
-    state.turret_angle = turret_angle.getNetworkAngleInt();
-    state.orientation = htol16(orientation);
-    state.speed_rate = htol16(speed_rate);
-    state.speed_factor = htol16(speed_factor);
-    
-    state.reload_time = htol16(reload_time);
-    state.max_hit_points = htol16(max_hit_points);
-    state.hit_points = htol16(hit_points);
-    state.damage_factor = htol16(damage_factor);
-    state.weapon_range = htol32(weapon_range);
-    state.defend_range = htol32(defend_range);
-    
-    state.threat_level = threat_level;
-    state.lifecycle_state = lifecycle_state;
-
-    return state;
-}
-
-void UnitState::setFromNetworkUnitState(const NetworkUnitState&amp; state)
-{
-    select = false;
-
-    unit_type = state.unit_type;
-    location.x = ltoh32(state.location_x);
-    location.y = ltoh32(state.location_y);
-    bbox.min.x = ltoh32(state.bbox_min_x);
-    bbox.min.y = ltoh32(state.bbox_min_y);
-    bbox.max.x = ltoh32(state.bbox_max_x);
-    bbox.max.y = ltoh32(state.bbox_max_y);
-
-    body_angle.setFromNetworkAngleInt(state.body_angle);
-    turret_angle.setFromNetworkAngleInt(state.turret_angle);
-
-    orientation = ltoh16(state.orientation);
-    speed_rate = ltoh16(state.speed_rate);
-    speed_factor = ltoh16(state.speed_factor);
-    
-    reload_time = ltoh16(state.reload_time);
-    max_hit_points = ltoh16(state.max_hit_points);
-    hit_points = ltoh16(state.hit_points);
-    damage_factor = ltoh16(state.damage_factor);
-    weapon_range = ltoh32(state.weapon_range);
-    defend_range = ltoh32(state.defend_range);
-
-    threat_level = state.threat_level;
-    lifecycle_state = state.lifecycle_state;
-}
-

Deleted: trunk/netpanzer/src/NetPanzer/Classes/UnitState.hpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Classes/UnitState.hpp	2008-09-09 15:53:32 UTC (rev 1049)
+++ trunk/netpanzer/src/NetPanzer/Classes/UnitState.hpp	2008-09-09 16:30:13 UTC (rev 1050)
@@ -1,120 +0,0 @@
-/*
-Copyright (C) 1998 Pyrosoft Inc. (www.pyrosoftgames.com), Matthew Bogue
- 
-This program is free software; you can redistribute it and/or modify
-it under the terms of the GNU General Public License as published by
-the Free Software Foundation; either version 2 of the License, or
-(at your option) any later version.
- 
-This program is distributed in the hope that it will be useful,
-but WITHOUT ANY WARRANTY; without even the implied warranty of
-MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-GNU General Public License for more details.
- 
-You should have received a copy of the GNU General Public License
-along with this program; if not, write to the Free Software
-Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
-*/
-#ifndef _UNITSTATE_HPP
-#define _UNITSTATE_HPP
-
-#include &lt;string.h&gt;
-
-#include &quot;ArrayUtil/BoundBox.hpp&quot;
-#include &quot;Types/Angle.hpp&quot;
-
-#include &quot;UnitLifecycles.hpp&quot;
-
-enum { _threat_level_all_clear,
-       _threat_level_under_attack,
-       _threat_level_defending
-     };
-
-#ifdef MSVC
-#pragma pack(1)
-#endif
-
-class NetworkUnitState
-{
-public:
-    NetworkUnitState()
-    { }
-
-private:
-    Uint8     unit_type;
-
-    Sint32     location_x;
-    Sint32     location_y;
-    Sint32     bbox_min_x;
-    Sint32     bbox_min_y;
-    Sint32     bbox_max_x;
-    Sint32     bbox_max_y;
-    
-    NetworkAngleInt body_angle;
-    NetworkAngleInt turret_angle;
-
-    Uint16    orientation;
-    Uint16    speed_rate;
-    Uint16    speed_factor;
-
-    Uint16    reload_time;
-    Sint16     max_hit_points;
-    Sint16     hit_points;
-    Uint16    damage_factor;
-    Uint32    weapon_range;
-    Uint32    defend_range;
-
-    Uint8 threat_level;
-    Uint8 lifecycle_state;
-
-    friend class UnitState;
-} __attribute__((packed));
-
-#ifdef MSVC
-#pragma pack()
-#endif
-
-class UnitState
-{
-public:
-    unsigned char  unit_type;
-
-    /// true if the unit is currently selected
-    bool           select;
-    /// position of the unit
-    iXY            location;
-    BoundBox       bbox;
-
-    AngleInt       body_angle;
-    AngleInt       turret_angle;
-
-    unsigned short orientation;
-    unsigned short speed_rate;
-    unsigned short speed_factor;
-
-    unsigned short reload_time;
-    short	   max_hit_points;
-    short          hit_points;
-    unsigned short damage_factor;
-    unsigned long  weapon_range;
-    unsigned long  defend_range;
-
-    unsigned char  threat_level;
-    unsigned char  lifecycle_state;
-
-    UnitState( );
-
-    bool bounds(const iXY&amp; loc) const
-    {
-        return( bbox.bounds( location, loc ) );
-    }
-
-    int percentDamageInt();
-    float percentDamageFloat();
-
-    NetworkUnitState getNetworkUnitState() const;
-    void setFromNetworkUnitState(const NetworkUnitState&amp; state);
-};
-
-#endif
-

Modified: trunk/netpanzer/src/NetPanzer/Classes/Weapons/BulletWeapon.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Classes/Weapons/BulletWeapon.cpp	2008-09-09 15:53:32 UTC (rev 1049)
+++ trunk/netpanzer/src/NetPanzer/Classes/Weapons/BulletWeapon.cpp	2008-09-09 16:30:13 UTC (rev 1050)
@@ -20,7 +20,7 @@
 #include &quot;BulletWeapon.hpp&quot;
 #include &quot;Classes/UnitMessageTypes.hpp&quot;
 #include &quot;Classes/Network/NetworkState.hpp&quot;
-#include &quot;Interfaces/UnitInterface.hpp&quot;
+#include &quot;Units/UnitInterface.hpp&quot;
 #include &quot;Interfaces/WorldViewInterface.hpp&quot;
 #include &quot;System/Sound.hpp&quot;
 #include &quot;Particles/ParticleInterface.hpp&quot;

Modified: trunk/netpanzer/src/NetPanzer/Classes/Weapons/MissleWeapon.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Classes/Weapons/MissleWeapon.cpp	2008-09-09 15:53:32 UTC (rev 1049)
+++ trunk/netpanzer/src/NetPanzer/Classes/Weapons/MissleWeapon.cpp	2008-09-09 16:30:13 UTC (rev 1050)
@@ -21,7 +21,7 @@
 #include &quot;Classes/UnitMessageTypes.hpp&quot;
 #include &quot;Classes/Network/NetworkState.hpp&quot;
 #include &quot;Interfaces/GameConfig.hpp&quot;
-#include &quot;Interfaces/UnitInterface.hpp&quot;
+#include &quot;Units/UnitInterface.hpp&quot;
 #include &quot;Interfaces/WorldViewInterface.hpp&quot;
 #include &quot;System/Sound.hpp&quot;
 #include &quot;Particles/ParticleInterface.hpp&quot;

Modified: trunk/netpanzer/src/NetPanzer/Classes/Weapons/ShellWeapon.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Classes/Weapons/ShellWeapon.cpp	2008-09-09 15:53:32 UTC (rev 1049)
+++ trunk/netpanzer/src/NetPanzer/Classes/Weapons/ShellWeapon.cpp	2008-09-09 16:30:13 UTC (rev 1050)
@@ -19,7 +19,7 @@
 
 #include &quot;ShellWeapon.hpp&quot;
 #include &quot;Classes/UnitMessageTypes.hpp&quot;
-#include &quot;Interfaces/UnitInterface.hpp&quot;
+#include &quot;Units/UnitInterface.hpp&quot;
 #include &quot;Classes/Network/NetworkState.hpp&quot;
 #include &quot;Interfaces/WorldViewInterface.hpp&quot;
 #include &quot;System/Sound.hpp&quot;

Modified: trunk/netpanzer/src/NetPanzer/Classes/Weapons/Weapon.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Classes/Weapons/Weapon.cpp	2008-09-09 15:53:32 UTC (rev 1049)
+++ trunk/netpanzer/src/NetPanzer/Classes/Weapons/Weapon.cpp	2008-09-09 16:30:13 UTC (rev 1050)
@@ -22,7 +22,7 @@
 #include &quot;Classes/Weapons/Weapon.hpp&quot;
 
 #include &quot;Classes/UnitMessageTypes.hpp&quot;
-#include &quot;Interfaces/UnitInterface.hpp&quot;
+#include &quot;Units/UnitInterface.hpp&quot;
 
 #include &quot;Classes/Network/NetworkState.hpp&quot;
 

Modified: trunk/netpanzer/src/NetPanzer/Classes/Weapons/Weapon.hpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Classes/Weapons/Weapon.hpp	2008-09-09 15:53:32 UTC (rev 1049)
+++ trunk/netpanzer/src/NetPanzer/Classes/Weapons/Weapon.hpp	2008-09-09 16:30:13 UTC (rev 1050)
@@ -18,7 +18,7 @@
 #ifndef _WEAPON_HPP
 #define _WEAPON_HPP
 
-#include &quot;Classes/UnitBase.hpp&quot;
+#include &quot;Units/UnitBase.hpp&quot;
 #include &quot;Classes/Projectile.hpp&quot;
 #include &quot;Util/BresenhamLine.hpp&quot;
 #include &quot;Util/Timer.hpp&quot;

Modified: trunk/netpanzer/src/NetPanzer/Classes/WorldInputCmdProcessor.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Classes/WorldInputCmdProcessor.cpp	2008-09-09 15:53:32 UTC (rev 1049)
+++ trunk/netpanzer/src/NetPanzer/Classes/WorldInputCmdProcessor.cpp	2008-09-09 16:30:13 UTC (rev 1050)
@@ -24,7 +24,7 @@
 
 #include &quot;Interfaces/WorldViewInterface.hpp&quot;
 #include &quot;Interfaces/MapInterface.hpp&quot;
-#include &quot;Interfaces/UnitInterface.hpp&quot;
+#include &quot;Units/UnitInterface.hpp&quot;
 #include &quot;Objectives/ObjectiveInterface.hpp&quot;
 #include &quot;Interfaces/PlayerInterface.hpp&quot;
 #include &quot;Interfaces/ChatInterface.hpp&quot;
@@ -49,7 +49,7 @@
 
 #include &quot;Interfaces/ConsoleInterface.hpp&quot;
 
-#include &quot;Classes/Units/Vehicle.hpp&quot;
+#include &quot;Units/Vehicle.hpp&quot;
 
 WorldInputCmdProcessor COMMAND_PROCESSOR;
 

Modified: trunk/netpanzer/src/NetPanzer/Interfaces/BaseGameManager.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Interfaces/BaseGameManager.cpp	2008-09-09 15:53:32 UTC (rev 1049)
+++ trunk/netpanzer/src/NetPanzer/Interfaces/BaseGameManager.cpp	2008-09-09 16:30:13 UTC (rev 1050)
@@ -33,14 +33,14 @@
 #include &quot;Interfaces/GameManager.hpp&quot;
 #include &quot;System/DummySound.hpp&quot;
 #include &quot;Interfaces/PlayerInterface.hpp&quot;
-#include &quot;Interfaces/UnitInterface.hpp&quot;
-#include &quot;Classes/UnitBlackBoard.hpp&quot;
+#include &quot;Units/UnitInterface.hpp&quot;
+#include &quot;Units/UnitBlackBoard.hpp&quot;
 #include &quot;Particles/Particle2D.hpp&quot;
 #include &quot;Particles/ParticleSystem2D.hpp&quot;
 #include &quot;Particles/ParticleInterface.hpp&quot;
 #include &quot;PathScheduler.hpp&quot;
 #include &quot;Interfaces/ProjectileInterface.hpp&quot;
-#include &quot;Interfaces/UnitProfileInterface.hpp&quot;
+#include &quot;Units/UnitProfileInterface.hpp&quot;
 #include &quot;Objectives/ObjectiveInterface.hpp&quot;
 #include &quot;Interfaces/ConsoleInterface.hpp&quot;
 #include &quot;MapsManager.hpp&quot;
@@ -50,7 +50,7 @@
 #include &quot;Util/FileSystem.hpp&quot;
 #include &quot;Classes/SelectionBoxSprite.hpp&quot;
 
-#include &quot;Classes/Units/UnitGlobals.hpp&quot;
+#include &quot;Units/UnitGlobals.hpp&quot;
 #include &quot;2D/ColorTable.hpp&quot;
 #include &quot;2D/Palette.hpp&quot;
 

Modified: trunk/netpanzer/src/NetPanzer/Interfaces/GameManager.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Interfaces/GameManager.cpp	2008-09-09 15:53:32 UTC (rev 1049)
+++ trunk/netpanzer/src/NetPanzer/Interfaces/GameManager.cpp	2008-09-09 16:30:13 UTC (rev 1050)
@@ -43,13 +43,13 @@
 #include &quot;PowerUps/PowerUpInterface.hpp&quot;
 #include &quot;Interfaces/ProjectileInterface.hpp&quot;
 #include &quot;Interfaces/TileInterface.hpp&quot;
-#include &quot;Interfaces/UnitInterface.hpp&quot;
-#include &quot;Interfaces/UnitProfileInterface.hpp&quot;
+#include &quot;Units/UnitInterface.hpp&quot;
+#include &quot;Units/UnitProfileInterface.hpp&quot;
 #include &quot;Interfaces/WorldViewInterface.hpp&quot;
 
 #include &quot;Classes/ScreenSurface.hpp&quot;
 #include &quot;Classes/TileEngine.hpp&quot;
-#include &quot;Classes/UnitBlackBoard.hpp&quot;
+#include &quot;Units/UnitBlackBoard.hpp&quot;
 #include &quot;Classes/WorldInputCmdProcessor.hpp&quot;
 #include &quot;Classes/SelectionBoxSprite.hpp&quot;
 #include &quot;Classes/SpriteSorter.hpp&quot;
@@ -62,8 +62,8 @@
 #include &quot;Classes/Network/NetworkClient.hpp&quot;
 #include &quot;Classes/Network/SystemNetMessage.hpp&quot;
 #include &quot;Classes/Network/ConnectNetMessage.hpp&quot;
-#include &quot;Classes/Units/Vehicle.hpp&quot;
-#include &quot;Classes/Units/UnitGlobals.hpp&quot;
+#include &quot;Units/Vehicle.hpp&quot;
+#include &quot;Units/UnitGlobals.hpp&quot;
 
 #include &quot;2D/Palette.hpp&quot;
 #include &quot;Views/Components/Desktop.hpp&quot;

Modified: trunk/netpanzer/src/NetPanzer/Interfaces/MiniMapInterface.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Interfaces/MiniMapInterface.cpp	2008-09-09 15:53:32 UTC (rev 1049)
+++ trunk/netpanzer/src/NetPanzer/Interfaces/MiniMapInterface.cpp	2008-09-09 16:30:13 UTC (rev 1050)
@@ -20,7 +20,7 @@
 
 #include &quot;Classes/WorldInputCmdProcessor.hpp&quot;
 
-#include &quot;Interfaces/UnitInterface.hpp&quot;
+#include &quot;Units/UnitInterface.hpp&quot;
 #include &quot;Interfaces/PlayerInterface.hpp&quot;
 #include &quot;Interfaces/WorldViewInterface.hpp&quot;
 #include &quot;Interfaces/MapInterface.hpp&quot;

Modified: trunk/netpanzer/src/NetPanzer/Interfaces/PathScheduler.hpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Interfaces/PathScheduler.hpp	2008-09-09 15:53:32 UTC (rev 1049)
+++ trunk/netpanzer/src/NetPanzer/Interfaces/PathScheduler.hpp	2008-09-09 16:30:13 UTC (rev 1050)
@@ -20,7 +20,7 @@
 
 #include &quot;Classes/AI/Astar.hpp&quot;
 #include &quot;Classes/AI/PathList.hpp&quot;
-#include &quot;Classes/UnitBase.hpp&quot;
+#include &quot;Units/UnitBase.hpp&quot;
 #include &quot;ArrayUtil/QueueTemplate.hpp&quot;
 #include &quot;ArrayUtil/ArrayTemplate.hpp&quot;
 

Modified: trunk/netpanzer/src/NetPanzer/Interfaces/PlayerGameManager.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Interfaces/PlayerGameManager.cpp	2008-09-09 15:53:32 UTC (rev 1049)
+++ trunk/netpanzer/src/NetPanzer/Interfaces/PlayerGameManager.cpp	2008-09-09 16:30:13 UTC (rev 1050)
@@ -38,13 +38,13 @@
 #include &quot;PowerUps/PowerUpInterface.hpp&quot;
 #include &quot;Interfaces/ProjectileInterface.hpp&quot;
 #include &quot;Interfaces/TileInterface.hpp&quot;
-#include &quot;Interfaces/UnitInterface.hpp&quot;
-#include &quot;Interfaces/UnitProfileInterface.hpp&quot;
+#include &quot;Units/UnitInterface.hpp&quot;
+#include &quot;Units/UnitProfileInterface.hpp&quot;
 #include &quot;Interfaces/WorldViewInterface.hpp&quot;
 
 #include &quot;Classes/ScreenSurface.hpp&quot;
 #include &quot;Classes/TileEngine.hpp&quot;
-#include &quot;Classes/UnitBlackBoard.hpp&quot;
+#include &quot;Units/UnitBlackBoard.hpp&quot;
 #include &quot;Classes/WorldInputCmdProcessor.hpp&quot;
 #include &quot;Classes/SelectionBoxSprite.hpp&quot;
 #include &quot;Classes/SpriteSorter.hpp&quot;
@@ -57,8 +57,8 @@
 #include &quot;Classes/Network/NetworkState.hpp&quot;
 #include &quot;Classes/Network/SystemNetMessage.hpp&quot;
 #include &quot;Classes/Network/ConnectNetMessage.hpp&quot;
-#include &quot;Classes/Units/Vehicle.hpp&quot;
-#include &quot;Classes/Units/UnitGlobals.hpp&quot;
+#include &quot;Units/Vehicle.hpp&quot;
+#include &quot;Units/UnitGlobals.hpp&quot;
 
 #include &quot;2D/Palette.hpp&quot;
 #include &quot;Views/Components/Desktop.hpp&quot;

Modified: trunk/netpanzer/src/NetPanzer/Interfaces/PlayerInterface.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Interfaces/PlayerInterface.cpp	2008-09-09 15:53:32 UTC (rev 1049)
+++ trunk/netpanzer/src/NetPanzer/Interfaces/PlayerInterface.cpp	2008-09-09 16:30:13 UTC (rev 1050)
@@ -19,7 +19,7 @@
 #include &lt;stdexcept&gt;
 
 #include &quot;Interfaces/PlayerInterface.hpp&quot;
-#include &quot;Interfaces/UnitInterface.hpp&quot;
+#include &quot;Units/UnitInterface.hpp&quot;
 #include &quot;Objectives/ObjectiveInterface.hpp&quot;
 #include &quot;Interfaces/ConsoleInterface.hpp&quot;
 

Modified: trunk/netpanzer/src/NetPanzer/Interfaces/PlayerInterface.hpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Interfaces/PlayerInterface.hpp	2008-09-09 15:53:32 UTC (rev 1049)
+++ trunk/netpanzer/src/NetPanzer/Interfaces/PlayerInterface.hpp	2008-09-09 16:30:13 UTC (rev 1050)
@@ -20,7 +20,7 @@
 
 #include &lt;SDL_thread.h&gt;
 #include &quot;Classes/PlayerState.hpp&quot;
-#include &quot;Interfaces/UnitInterface.hpp&quot;
+#include &quot;Units/UnitInterface.hpp&quot;
 
 class PlayerInterface
 {

Deleted: trunk/netpanzer/src/NetPanzer/Interfaces/UnitInterface.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Interfaces/UnitInterface.cpp	2008-09-09 15:53:32 UTC (rev 1049)
+++ trunk/netpanzer/src/NetPanzer/Interfaces/UnitInterface.cpp	2008-09-09 16:30:13 UTC (rev 1050)
@@ -1,844 +0,0 @@
-/*
-Copyright (C) 1998 Pyrosoft Inc. (www.pyrosoftgames.com), Matthew Bogue
- 
-This program is free software; you can redistribute it and/or modify
-it under the terms of the GNU General Public License as published by
-the Free Software Foundation; either version 2 of the License, or
-(at your option) any later version.
- 
-This program is distributed in the hope that it will be useful,
-but WITHOUT ANY WARRANTY; without even the implied warranty of
-MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-GNU General Public License for more details.
- 
-You should have received a copy of the GNU General Public License
-along with this program; if not, write to the Free Software
-Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
-*/
-#include &lt;config.h&gt;
-
-#include &lt;iostream&gt;
-
-#include &quot;Interfaces/UnitInterface.hpp&quot;
-#include &quot;Interfaces/UnitProfileInterface.hpp&quot;
-#include &quot;Interfaces/PlayerInterface.hpp&quot;
-#include &quot;Interfaces/MapInterface.hpp&quot;
-#include &quot;Interfaces/WorldViewInterface.hpp&quot;
-
-#include &quot;Classes/Units/Vehicle.hpp&quot;
-
-#include &quot;Types/iXY.hpp&quot;
-#include &quot;Util/Timer.hpp&quot;
-#include &quot;Classes/Network/NetworkServer.hpp&quot;
-#include &quot;Classes/Network/NetworkState.hpp&quot;
-#include &quot;Classes/Network/NetMessageEncoder.hpp&quot;
-#include &quot;Console.hpp&quot;
-#include &quot;Classes/UnitOpcodeDecoder.hpp&quot;
-
-#include &quot;Classes/UnitMessageTypes.hpp&quot;
-#include &quot;Classes/Network/PlayerNetMessage.hpp&quot;
-#include &quot;Classes/Network/NetPacket.hpp&quot;
-#include &quot;Classes/Network/TerminalNetMesg.hpp&quot;
-
-#include &quot;System/Sound.hpp&quot;
-#include &quot;Particles/ParticleInterface.hpp&quot;
-#include &quot;Util/Log.hpp&quot;
-
-
-//UnitList * UnitInterface::unit_lists;
-UnitInterface::Units UnitInterface::units;
-UnitInterface::PlayerUnitList* UnitInterface::playerUnitLists = 0;
-UnitBucketArray UnitInterface::unit_bucket_array;
-
-unsigned short UnitInterface::max_players;
-PlacementMatrix UnitInterface::unit_placement_matrix;
-
-UnitID UnitInterface::lastUnitID;
-
-UnitOpcodeEncoder UnitInterface::opcode_encoder;
-
-Timer UnitInterface::message_timer;
-Timer UnitInterface::no_guarantee_message_timer;
-
-unsigned long   UnitInterface::sync_units_iterator;
-bool	        UnitInterface::sync_units_complete_flag;
-unsigned short  UnitInterface::sync_units_list_index;
-unsigned long   UnitInterface::sync_units_total_units;
-unsigned long   UnitInterface::sync_units_in_sync_count;
-unsigned long   UnitInterface::sync_units_in_sync_partial_count;
-size_t          UnitInterface::units_per_player;
-Timer		UnitInterface::sync_units_packet_timer;
-
-
-// ******************************************************************
-
-void UnitInterface::initialize( unsigned long max_units )
-{
-    max_players = PlayerInterface::getMaxPlayers();
-
-    //unit_lists = new UnitList [ max_players ];
-    playerUnitLists = new PlayerUnitList[max_players];
-
-    unit_bucket_array.initialize(MapInterface::getSize(), TileInterface::getTileSize() );
-
-    lastUnitID = 0;
-    message_timer.changeRate( 8 );
-    no_guarantee_message_timer.changeRate( 15 );
-
-    units_per_player = max_units;
-}
-
-// ******************************************************************
-
-void UnitInterface::cleanUp()
-{
-    // XXX why doesn't clean the unit_bucket_array?
-    delete[] playerUnitLists;
-    playerUnitLists = 0;
-
-    for(Units::iterator i = units.begin(); i != units.end(); ++i)
-        delete i-&gt;second;
-    units.clear();
-}
-
-void
-UnitInterface::reset()
-{
-    for(size_t i = 0; i &lt; max_players; i++ ) {
-        playerUnitLists[i].clear();
-    }
-
-    unit_bucket_array.initialize( MapInterface::getSize(), TileInterface::getTileSize() );
-
-    for(Units::iterator i = units.begin(); i != units.end(); ++i)
-        delete i-&gt;second;
-    units.clear();
-}
-
-void
-UnitInterface::processNetPacket(const NetPacket* packet)
-{
-    const NetMessage* message = packet-&gt;getNetMessage();
-    const TerminalUnitCmdRequest* terminal_command =
-        (const TerminalUnitCmdRequest*) message;
-
-    const PlayerState* player 
-        = PlayerInterface::getPlayer(packet-&gt;fromPlayer);
-    if(player == 0)
-    {
-        LOGGER.warning(&quot;UnitInterface: Player not found '%u'?!?&quot;,
-                packet-&gt;fromPlayer);
-        return;
-    }
-    
-    sendMessage(&amp;(terminal_command-&gt;comm_request) , player);
-}
-
-void
-UnitInterface::sendMessage(const UnitMessage* message,const PlayerState* player)
-{
-    if (message-&gt;isFlagged(_umesg_flag_unique)) {
-        UnitBase* unit = getUnit(message-&gt;getUnitID());
-        if(unit == 0)
-            return;
-        if(player &amp;&amp; unit-&gt;player != player) {
-            LOGGER.warning(
-                &quot;Terminal request for unit (%u) not owned by player (%u).\n&quot;,
-                unit-&gt;id, player-&gt;getID());
-            return;
-        }
-                    
-        unit-&gt;processMessage(message);
-    } else if (message-&gt;isFlagged( _umesg_flag_broadcast) ) {
-        if(message-&gt;message_id != _umesg_weapon_hit) {
-            LOGGER.warning(&quot;Broadcast flag only allowed for weapon hit.&quot;);
-            if(player) {
-                LOGGER.warning(&quot;from player %u.\n&quot;, player-&gt;getID());
-            }
-            return;
-        }
-            
-        for(Units::iterator i = units.begin(); i != units.end(); ++i) {
-            UnitBase* unit = i-&gt;second;
-            unit-&gt;processMessage(message);
-        }
-    } else if (message-&gt;isFlagged( _umesg_flag_manager_request) ) {
-        if(player) {
-            LOGGER.warning(
-                    &quot;UnitManagerMessage sent out by player %u not allowed.&quot;,
-                    player-&gt;getID());
-            return;
-        }
-  	processManagerMessage(message);
-    }
-}
-
-// ******************************************************************
-
-void UnitInterface::removeUnit(Units::iterator i)
-{
-    UnitBase* unit = i-&gt;second;
-    
-    // unit explosion particles
-    ParticleInterface::addHit(unit-&gt;unit_state);
-    
-    // unit explosion sound
-    sound-&gt;playAmbientSound(&quot;expl&quot;,                   
-            WorldViewInterface::getCameraDistance(
-                unit-&gt;unit_state.location ) );
-    
-    // delete the unit
-    unit_bucket_array.deleteUnitBucketPointer(unit-&gt;id, 
-            unit-&gt;unit_state.location );
-    PlayerUnitList&amp; plist =
-        playerUnitLists[unit-&gt;player-&gt;getID()];
-    
-    PlayerUnitList::iterator pi
-        = std::find(plist.begin(), plist.end(), unit);
-    assert(pi != plist.end());
-    if(pi != plist.end())
-        plist.erase(pi);
-
-    units.erase(i);
-    delete unit;
-}
-
-// ******************************************************************
-
-void UnitInterface::updateUnitStatus()
-{
-    for(Units::iterator i = units.begin(); i != units.end(); /*nothing*/ ) {
-        UnitBase* unit = i-&gt;second;
-	    
-        if (unit-&gt;unit_state.lifecycle_state == _UNIT_LIFECYCLE_INACTIVE) {
-            Units::iterator next = i;
-            ++next;
-            removeUnit(i);
-            i = next;
-            continue;
-        }
-	    
-        unsigned long pre_update_bucket_index;
-        unsigned long post_update_bucket_index;
-
-        pre_update_bucket_index 
-            = unit_bucket_array.worldLocToBucketIndex(
-                    unit-&gt;unit_state.location );
-        unit-&gt;updateState();
-
-        post_update_bucket_index 
-            = unit_bucket_array.worldLocToBucketIndex(
-                    unit-&gt;unit_state.location );
-
-        if ( post_update_bucket_index != pre_update_bucket_index ) {
-            unit_bucket_array.moveUnit(unit-&gt;id,
-                    pre_update_bucket_index, post_update_bucket_index );
-        }
-        ++i;
-    }
-
-    if ( NetworkState::status == _network_state_server ) {
-        if (message_timer.count()) {
-            opcode_encoder.send();
-        }
-    }
-}
-
-void UnitInterface::offloadGraphics(SpriteSorter&amp; sorter)
-{
-    iRect world_window_rect;
-    iRect bucket_rect;
-    UnitBucketList *bucket_list;
-
-    world_window_rect = sorter.getWorldWindow();
-    bucket_rect = unit_bucket_array.worldRectToBucketRectClip(world_window_rect);
-
-    for(long row_index = bucket_rect.min.y;
-            row_index &lt;= bucket_rect.max.y; row_index++ ) {
-        for(long column_index = bucket_rect.min.x;
-                column_index &lt;= bucket_rect.max.x; column_index++ ) {
-            bucket_list = unit_bucket_array.getBucket(row_index, column_index);
-
-            for(UnitBucketPointer* t = bucket_list-&gt;getFront();
-                    t != 0; t = t-&gt;next) {
-                t-&gt;unit-&gt;offloadGraphics(sorter);
-            }
-        }
-    }
-}
-
-// ******************************************************************
-
-UnitID UnitInterface::newUnitID()
-{
-    UnitID newID = lastUnitID++;
-    while(getUnit(newID) != 0)
-        newID = lastUnitID++;
-
-    return newID;
-}
-
-// ******************************************************************
-
-UnitBase * UnitInterface::newUnit( unsigned short unit_type,
-                                   const iXY &amp;location,
-                                   unsigned short player_index,
-                                   UnitID id)
-{
-    UnitBase* unit = 0;
-    bool color_flag;
-    unsigned char unit_flag;
-
-    if ( player_index == PlayerInterface::getLocalPlayerIndex() ) {
-        color_flag = true;
-    } else {
-        color_flag = false;
-    }
-
-    PlayerState* player = PlayerInterface::getPlayer( player_index );
-    unit_flag = player-&gt;getFlag();
-
-    if ( unit_type &lt; UnitProfileInterface::getNumUnitTypes() )
-    {
-        unit = new Vehicle(player, unit_type, id, location);        
-    }
-    else
-    {   // XXX change for a error window
-        assert(&quot;unknown unit_type&quot; == 0);        
-    }
-
-    return unit;
-}
-
-// ******************************************************************
-
-void UnitInterface::addNewUnit(UnitBase *unit)
-{
-    units.insert(std::make_pair(unit-&gt;id, unit));
-   
-    Uint16 player_index = unit-&gt;player-&gt;getID();
-    playerUnitLists[player_index].push_back(unit);
-
-    unit_bucket_array.addUnit(unit);
-}
-
-// ******************************************************************
-
-void UnitInterface::sortBucketArray()
-{
-    unsigned long bucket_count;
-    unsigned long bucket_index;
-    UnitBucketList *bucket_list;
-    UnitBucketPointer *traversal_ptr;
-
-    bucket_count = unit_bucket_array.getSize();
-
-    for( bucket_index = 0; bucket_index &lt; bucket_count; bucket_index++ ) {
-        bucket_list = unit_bucket_array.getBucket( bucket_index );
-
-        traversal_ptr = bucket_list-&gt;getFront();
-
-        while( traversal_ptr != 0 ) {
-            unsigned long unit_bucket_index;
-
-            unit_bucket_index = unit_bucket_array.worldLocToBucketIndex( traversal_ptr-&gt;unit-&gt;unit_state.location );
-
-            if( unit_bucket_index != bucket_index ) {
-                unit_bucket_array.moveUnit( traversal_ptr-&gt;unit-&gt;id,
-                        bucket_index, unit_bucket_index );
-            }
-
-            traversal_ptr = traversal_ptr-&gt;next;
-        } // ** while
-    }
-}
-
-// ******************************************************************
-
-UnitBase*
-UnitInterface::getUnit(UnitID id)
-{
-    Units::iterator i = units.find(id);
-    if(i == units.end()) {
-        return 0;
-    }
-
-    return i-&gt;second;
-}
-
-// ******************************************************************
-UnitBase* UnitInterface::createUnit( unsigned short unit_type,
-                                      const iXY &amp;location,
-                                      Uint16 player_id)
-{
-    if (playerUnitLists[player_id].size() &gt;= units_per_player)
-	return 0;
-
-    UnitBase* unit = newUnit(unit_type, location, player_id, newUnitID());
-    addNewUnit(unit);
-
-    return unit;
-}
-
-// ******************************************************************
-
-void UnitInterface::spawnPlayerUnits(const iXY &amp;location,
-                                     Uint16 player_id,
-                                     const PlayerUnitConfig &amp;unit_config)
-{
-    iXY next_loc;
-    UnitBase *unit;
-    unsigned long unit_type_index;
-    unsigned long unit_spawn_count;
-    unsigned long unit_spawn_index;
-
-    NetMessageEncoder encoder;
-
-    unit_placement_matrix.reset( location );
-
-    for ( unit_type_index = 0; unit_type_index &lt; UnitProfileInterface::getNumUnitTypes(); unit_type_index++ ) {
-
-        unit_spawn_count = unit_config.getSpawnUnitCount( unit_type_index );
-        for ( unit_spawn_index = 0; unit_spawn_index &lt; unit_spawn_count; unit_spawn_index++ ) {
-            unit_placement_matrix.getNextEmptyLoc( &amp;next_loc );
-            unit = createUnit(unit_type_index, next_loc, player_id);
-
-            assert(unit != 0);
-            UnitRemoteCreate create_mesg(unit-&gt;player-&gt;getID(), unit-&gt;id,
-                    next_loc.x, next_loc.y, unit-&gt;unit_state.unit_type);
-            encoder.encodeMessage(&amp;create_mesg, sizeof(create_mesg));
-        } // ** for unit_spawn_index
-    } // ** for unit_type_index
-
-    encoder.sendEncodedMessage();
-}
-
-// ******************************************************************
-
-void
-UnitInterface::queryUnitsAt(std::vector&lt;UnitID&gt;&amp; working_list,
-        const iXY&amp; point, Uint16 player_id, unsigned char search_flags)
-{
-    for(Units::iterator i = units.begin(); i != units.end(); ++i) {
-        UnitBase* unit = i-&gt;second;
-        if(!unit-&gt;unit_state.bounds(point))
-            continue;
-
-        if(search_flags == _search_exclude_player
-                &amp;&amp; unit-&gt;player-&gt;getID() == player_id)
-            continue;
-        if(search_flags == _search_player
-                &amp;&amp; unit-&gt;player-&gt;getID() != player_id)
-            continue;
-
-        working_list.push_back(unit-&gt;id);
-    }
-}
-
-// ******************************************************************
-
-void
-UnitInterface::queryUnitsAt(std::vector&lt;UnitID&gt;&amp; working_list,
-        const iRect&amp; rect, Uint16 player_id, unsigned char search_flags)
-{
-    for(Units::iterator i = units.begin(); i != units.end(); ++i) {
-        UnitBase* unit = i-&gt;second;
-        if(!rect.contains(unit-&gt;unit_state.location))
-            continue;
-
-        if(search_flags == _search_exclude_player
-                &amp;&amp; unit-&gt;player-&gt;getID() == player_id)
-            continue;
-        if(search_flags == _search_player
-                &amp;&amp; unit-&gt;player-&gt;getID() != player_id)
-            continue;
-
-        working_list.push_back(unit-&gt;id);
-    }
-}
-
-/****************************************************************************/
-
-bool UnitInterface::queryClosestUnit( UnitBase **closest_unit_ptr,
-                                       iXY &amp;loc, Uint16 player_id,
-                                       unsigned char search_flags )
-{
-    long closest_magnitude = 0;
-    UnitBase* closest_unit = 0;
-
-    for(Units::iterator i = units.begin(); i != units.end(); ++i) {
-        UnitBase* unit = i-&gt;second;
-
-        if(search_flags == _search_exclude_player
-                &amp;&amp; unit-&gt;player-&gt;getID() == player_id)
-            continue;
-        if(search_flags == _search_player
-                &amp;&amp; unit-&gt;player-&gt;getID() != player_id)
-            continue;
-
-        iXY delta;
-        long temp_mag;
-
-        if ( closest_unit == 0 ) {
-            closest_unit = unit;
-            delta  = loc - unit-&gt;unit_state.location;
-            closest_magnitude = long(delta.mag2());
-        } else {
-            delta  = loc - unit-&gt;unit_state.location;
-            temp_mag = long(delta.mag2());
-            
-            if ( closest_magnitude &gt; temp_mag ) {
-                closest_unit = unit;
-                closest_magnitude = temp_mag;
-            }
-        }
-    }
-
-    if(closest_unit != 0) {
-        *closest_unit_ptr = closest_unit;
-        return true;
-    }
-
-    *closest_unit_ptr = 0;
-    return false;
-}
-
-bool UnitInterface::queryClosestUnit( UnitBase **closest_unit_ptr, iRect &amp;bounding_rect, iXY &amp;loc )
-{
-    UnitBase *closest_unit = 0;
-    long closest_magnitude = 0;
-    iRect bucket_rect;
-    UnitBucketList *bucket_list;
-    UnitBucketPointer *traversal_ptr;
-
-    bucket_rect = unit_bucket_array.worldRectToBucketRect( bounding_rect );
-
-    for( long row_index = bucket_rect.min.y; row_index &lt;= bucket_rect.max.y; row_index++ ) {
-        for( long column_index = bucket_rect.min.x; column_index &lt;= bucket_rect.max.x; column_index++ ) {
-            bucket_list = unit_bucket_array.getBucket( row_index, column_index );
-
-            traversal_ptr = bucket_list-&gt;getFront();
-
-            while( traversal_ptr != 0 ) {
-                iXY delta;
-                long temp_mag;
-
-                if ( closest_unit == 0 ) {
-                    closest_unit = traversal_ptr-&gt;unit;
-                    delta  = loc - traversal_ptr-&gt;unit-&gt;unit_state.location;
-                    closest_magnitude = long(delta.mag2());
-                } else {
-                    delta  = loc - traversal_ptr-&gt;unit-&gt;unit_state.location;
-                    temp_mag = long(delta.mag2());
-
-                    if ( closest_magnitude &gt; temp_mag ) {
-                        closest_unit = traversal_ptr-&gt;unit;
-                        closest_magnitude = temp_mag;
-                    }
-                }
-
-                traversal_ptr = traversal_ptr-&gt;next;
-            }
-        }
-    }
-
-    if( closest_unit != 0 ) {
-        *closest_unit_ptr = closest_unit;
-        return true;
-    }
-
-    *closest_unit_ptr = 0;
-    return false;
-}
-
-// ******************************************************************
-
-bool UnitInterface::queryClosestEnemyUnit(UnitBase **closest_unit_ptr,
-        iXY &amp;loc, Uint16 player_index)
-{
-    UnitBase *closest_unit = 0;
-    long closest_magnitude = 0;
-
-    for(Units::iterator i = units.begin(); i != units.end(); ++i) {
-        UnitBase* unit = i-&gt;second;
-        Uint16 unitPlayerID = unit-&gt;player-&gt;getID();
-        
-        if(unitPlayerID == player_index
-                || PlayerInterface::isAllied(player_index, unitPlayerID))
-            continue;
-
-        iXY delta;
-        long temp_mag;
-
-        if ( closest_unit == 0 ) {
-            closest_unit = unit;
-            delta  = loc - unit-&gt;unit_state.location;
-            closest_magnitude = long(delta.mag2());
-        } else {
-            delta  = loc - unit-&gt;unit_state.location;
-            temp_mag = long(delta.mag2());
-            
-            if ( closest_magnitude &gt; temp_mag ) {
-                closest_unit = unit;
-                closest_magnitude = temp_mag;
-            }
-        }
-    }
-
-    if( closest_unit != 0 ) {
-        *closest_unit_ptr = closest_unit;
-        return true;
-    }
-
-    *closest_unit_ptr = 0;
-    return false;
-}
-
-// ******************************************************************
-
-unsigned char UnitInterface::queryUnitLocationStatus(iXY loc)
-{
-    Uint16 player_id = PlayerInterface::getLocalPlayerIndex();
-
-    std::vector&lt;UnitID&gt; locUnits;
-    queryUnitsAt(locUnits, loc, player_id, 0);
-    if(locUnits.size() == 0) {
-        return _no_unit_found;
-    }
-
-    UnitID id = locUnits[0];
-    UnitBase* unit = getUnit(id);
-    if(!unit) {
-        return _no_unit_found;
-    }
-    if(unit-&gt;player-&gt;getID() == player_id) {
-        return _unit_player;
-    }
-    if(PlayerInterface::isAllied(player_id, unit-&gt;player-&gt;getID())) {
-        return _unit_allied;
-    }
-
-    return _unit_enemy;
-}
-
-// ******************************************************************
-
-bool UnitInterface::queryUnitAtMapLoc(iXY map_loc, UnitID *queary_unit_id)
-{
-    iXY unit_map_loc;
-
-    for(Units::iterator i = units.begin(); i != units.end(); ++i) {
-        UnitBase* unit = i-&gt;second;
-        UnitState* unit_state = &amp; unit-&gt;unit_state;
-            
-        MapInterface::pointXYtoMapXY( unit_state-&gt;location, &amp;unit_map_loc );
-        if( map_loc == unit_map_loc ) {
-            *queary_unit_id = unit-&gt;id;
-            return true;
-        }
-    }
-
-    return false;
-}
-
-// ******************************************************************
-
-void UnitInterface::processManagerMessage(const UnitMessage* message)
-{
-    switch(message-&gt;message_id) {
-        case _umesg_end_lifecycle:
-            unitManagerMesgEndLifecycle(message);
-            break;
-        default:
-            LOGGER.warning(&quot;Unknown unit Manage Message type (%u).&quot;,
-                    message-&gt;message_id);
-#ifdef DEBUG
-            assert(false);
-#endif
-    }
-}
-
-// ******************************************************************
-
-void UnitInterface::unitManagerMesgEndLifecycle(const UnitMessage* message)
-{
-    const UMesgEndLifeCycleUpdate *lifecycle_update
-        = (const UMesgEndLifeCycleUpdate *) message;
-
-    UnitBase* unit1 = getUnit(lifecycle_update-&gt;getDestroyer());
-    UnitBase* unit2 = getUnit(lifecycle_update-&gt;getDestroyed());
-    if(unit1 == 0 || unit2 == 0) {
-        LOGGER.warning(
-                &quot;Unit in EndLifeCycle message doesn't exist anymore&quot;
-                &quot;(u1: %u u2: %u)&quot;, lifecycle_update-&gt;getDestroyer(),
-                lifecycle_update-&gt;getDestroyed());
-        return;
-    }
-    PlayerState* player1 = unit1-&gt;player;
-    PlayerState* player2 = unit2-&gt;player;
-
-    int unittype1 = unit1-&gt;unit_state.unit_type;
-    const std::string&amp; unitname1 = 
-        UnitProfileInterface::getUnitProfile(unittype1)-&gt;unitname;
-    int unittype2 = unit2-&gt;unit_state.unit_type;
-    const std::string&amp; unitname2 =
-        UnitProfileInterface::getUnitProfile(unittype2)-&gt;unitname;
-    if(Console::server) {
-        *Console::server &lt;&lt; &quot;'&quot; &lt;&lt; player1-&gt;getName() &lt;&lt; &quot;' killed a '&quot;
-            &lt;&lt; unitname2 &lt;&lt; &quot;' from '&quot; &lt;&lt; player2-&gt;getName() 
-            &lt;&lt; &quot;' with his '&quot; &lt;&lt; unitname1 &lt;&lt; &quot;'.&quot; &lt;&lt; std::endl;
-    }
-
-    // killing own units doesn't give score
-    if(player1 != player2) {
-        PlayerInterface::setKill(unit1-&gt;player, unit2-&gt;player,
-                (UnitType) lifecycle_update-&gt;unit_type);
-        
-        PlayerScoreUpdate score_update;
-        score_update.set(player1-&gt;getID(), player2-&gt;getID(),
-                (UnitType) lifecycle_update-&gt;unit_type);
-        SERVER-&gt;broadcastMessage(&amp;score_update, sizeof(PlayerScoreUpdate));
-    }
-}
-
-
-// ******************************************************************
-
-void UnitInterface::unitSyncMessage(const NetMessage *net_message)
-{
-    const UnitIniSyncMessage* sync_message 
-        = (const UnitIniSyncMessage *) net_message;
-
-    try {
-        std::map&lt;UnitID, UnitBase*&gt;::iterator uit = units.find(sync_message-&gt;getUnitID());
-        if ( uit != units.end() ) {
-            LOGGER.warning(&quot;UnitInterface::unitSyncMessage() Received an existing unit [%d]&quot;,
-                            sync_message-&gt;getUnitID());
-            return;
-        }
-        UnitBase* unit = newUnit(sync_message-&gt;unit_type,
-                iXY(sync_message-&gt;getLocX(), sync_message-&gt;getLocY()),
-                sync_message-&gt;getPlayerID(), sync_message-&gt;getUnitID());
-        unit-&gt;in_sync_flag = false;
-        addNewUnit(unit);
-    } catch(std::exception&amp; e) {
-        LOGGER.warning(&quot;UnitInterface::unitSyncMessage() Couldn't sync unit '%s'&quot;, e.what());
-    }
-}
-
-// ******************************************************************
-
-void UnitInterface::unitOpcodeMessage(const NetMessage *net_message)
-{
-    UnitOpcodeDecoder decoder;
-    decoder.setMessage(net_message);
-
-    UnitOpcode* opcode;
-    while(decoder.decode(&amp;opcode)) {
-        UnitBase* unit = getUnit(opcode-&gt;getUnitID());
-
-        if(!unit) {
-            LOGGER.debug(&quot;Update for non-existant unit: %d&quot;,
-                    opcode-&gt;getUnitID());
-            continue;
-        }
-        
-        unit-&gt;evalCommandOpcode(opcode);
-    }
-}
-
-// ******************************************************************
-
-void UnitInterface::unitDestroyMessage(const NetMessage *net_message)
-{
-    const UnitRemoteDestroy* remote_destroy 
-        = (const UnitRemoteDestroy *) net_message;
-
-    Units::iterator i = units.find(remote_destroy-&gt;getUnitToDestroy());
-    if(i != units.end()) {
-        removeUnit(i);
-    }
-}
-
-// ******************************************************************
-
-void UnitInterface::unitCreateMessage(const NetMessage* net_message)
-{
-    const UnitRemoteCreate* create_mesg 
-        = (const UnitRemoteCreate *) net_message;
-
-    Uint16 player_index = create_mesg-&gt;getPlayerID();
-
-    try {
-        std::map&lt;UnitID, UnitBase*&gt;::iterator uit = units.find(create_mesg-&gt;getUnitID());
-        if ( uit != units.end() ) {
-            LOGGER.warning(&quot;UnitInterface::unitCreateMessage() Received an existing unit [%d]&quot;,
-                            create_mesg-&gt;getUnitID());
-            return;
-        }
-        UnitBase* unit = newUnit(create_mesg-&gt;unit_type,
-                iXY(create_mesg-&gt;getLocX(), create_mesg-&gt;getLocY()),
-                player_index,
-                create_mesg-&gt;getUnitID());
-        addNewUnit(unit);
-    } catch(std::exception&amp; e) {
-        LOGGER.warning(&quot;UnitInterface::unitSyncMessage() Couldn't create new unit '%s'&quot;, e.what());
-    }
-}
-
-// ******************************************************************
-
-void UnitInterface::unitSyncIntegrityCheckMessage(const NetMessage* )
-{
-    sortBucketArray();
-}
-
-// ******************************************************************
-void UnitInterface::processNetMessage(const NetMessage* net_message)
-{
-    switch(net_message-&gt;message_id)  {
-        case _net_message_id_ini_sync_mesg:
-            unitSyncMessage(net_message);
-            break;
-
-        case _net_message_id_opcode_mesg:
-            unitOpcodeMessage(net_message);
-            break;
-
-        case _net_message_id_destroy_unit:
-            unitDestroyMessage(net_message);
-            break;
-
-        case _net_message_id_create_unit:
-            unitCreateMessage(net_message);
-            break;
-
-        case _net_message_id_unit_sync_integrity_check:
-            unitSyncIntegrityCheckMessage(net_message);
-            break;
-
-        default:
-            LOGGER.warning(&quot;Unknown message id in UnitMessage (%d)&quot;,
-                    net_message-&gt;message_id);
-#ifdef DEBUG
-            assert(false);
-#endif
-            break;
-    }
-}
-
-// ******************************************************************
-
-void UnitInterface::destroyPlayerUnits(Uint16 player_id)
-{
-    UMesgSelfDestruct self_destruct;
-    self_destruct.setHeader(0, _umesg_flag_unique);
-
-    PlayerUnitList&amp; unitlist = playerUnitLists[player_id];
-    for(PlayerUnitList::iterator i = unitlist.begin();
-            i != unitlist.end(); ++i) {
-        UnitBase* unit = *i;
-        unit-&gt;processMessage(&amp;self_destruct);
-    }
-}
-

Deleted: trunk/netpanzer/src/NetPanzer/Interfaces/UnitInterface.hpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Interfaces/UnitInterface.hpp	2008-09-09 15:53:32 UTC (rev 1049)
+++ trunk/netpanzer/src/NetPanzer/Interfaces/UnitInterface.hpp	2008-09-09 16:30:13 UTC (rev 1050)
@@ -1,186 +0,0 @@
-/*
-Copyright (C) 1998 Pyrosoft Inc. (www.pyrosoftgames.com), Matthew Bogue
- 
-This program is free software; you can redistribute it and/or modify
-it under the terms of the GNU General Public License as published by
-the Free Software Foundation; either version 2 of the License, or
-(at your option) any later version.
- 
-This program is distributed in the hope that it will be useful,
-but WITHOUT ANY WARRANTY; without even the implied warranty of
-MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-GNU General Public License for more details.
- 
-You should have received a copy of the GNU General Public License
-along with this program; if not, write to the Free Software
-Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
-*/
-#ifndef _UNITINTERFACE_HPP
-#define _UNITINTERFACE_HPP
-
-#include &lt;vector&gt;
-#include &lt;map&gt;
-#include &quot;Classes/UnitList.hpp&quot;
-#include &quot;Classes/UnitBucketArray.hpp&quot;
-#include &quot;Classes/UnitMessage.hpp&quot;
-#include &quot;Classes/PlayerState.hpp&quot;
-#include &quot;Util/Timer.hpp&quot;
-#include &quot;Classes/PlacementMatrix.hpp&quot;
-
-#include &quot;Classes/Network/UnitNetMessage.hpp&quot;
-#include &quot;Classes/UnitOpcodeEncoder.hpp&quot;
-
-enum { _search_all_players,
-       _search_player,
-       _search_exclude_player,
-       _search_enemy_only };
-
-enum { _no_unit_found, _unit_player, _unit_allied, _unit_enemy };
-
-class NetPacket;
-
-class UnitInterface
-{
-public:
-    typedef std::map&lt;UnitID, UnitBase*&gt; Units;
-    typedef std::vector&lt;UnitBase*&gt; PlayerUnitList;
-    
-private:
-    static Units units;
-    static PlayerUnitList* playerUnitLists;
-        
-    static UnitBucketArray unit_bucket_array;
-    static unsigned short max_players;
-    static size_t units_per_player;
-    static PlacementMatrix unit_placement_matrix;
-
-    static Uint16 lastUnitID;
-    static UnitID newUnitID();
-
-    static UnitBase* newUnit(unsigned short unit_type,
-                             const iXY &amp;location,
-                             unsigned short player_index,
-                             UnitID id);
-    static void addNewUnit(UnitBase *unit);
-    static void removeUnit(Units::iterator i);
-
-    static void sortBucketArray();
-
-public:
-    static void initialize( unsigned long max_units );
-    static void cleanUp();
-    static void reset();
-
-    static const Units&amp; getUnits()
-    {
-        return units;
-    }
-
-    static const PlayerUnitList&amp; getPlayerUnits(Uint16 player_id)
-    {
-        assert(player_id &lt; max_players);
-        return playerUnitLists[player_id];
-    }
-
-#if 0
-    static UnitList * getUnitList(size_t player)
-    {
-        assert( (player &lt; max_players) );
-        return ( &amp;unit_lists[ player ] );
-    }
-#endif
-
-    static size_t getUnitCount(unsigned short player_index)
-    {
-        assert( (player_index &lt; max_players) );
-        return playerUnitLists[player_index].size();
-    }
-
-    static size_t getTotalUnitCount()
-    {
-        return units.size();
-    }
-
-    static UnitBase* getUnit(UnitID unit_id);
-
-    static void processNetPacket(const NetPacket* packet);
-    static void sendMessage(const UnitMessage* message,
-            const PlayerState* player = 0);
-
-    static void updateUnitStatus();
-
-    static void offloadGraphics( SpriteSorter &amp;sorter );
-
-    static UnitBase* createUnit( unsigned short unit_type,
-                                  const iXY &amp;location,
-                                  Uint16 player_id);
-
-    static void spawnPlayerUnits( const iXY &amp;location,
-                                  Uint16 player_id,
-                                  const PlayerUnitConfig &amp;unit_config );
-
-    static void queryUnitsAt(std::vector&lt;UnitID&gt;&amp; working_list,
-                             const iXY&amp; point, Uint16 player_id,
-                             unsigned char search_flags);
-
-    static void queryUnitsAt(std::vector&lt;UnitID&gt;&amp; working_list,
-                            const iRect&amp; rect, Uint16 player_id,
-                            unsigned char search_flags);
-
-    static bool queryClosestUnit( UnitBase **closest_unit_ptr,
-                                   iXY &amp;loc,
-                                   Uint16 player_id,
-                                   unsigned char search_flags );
-
-    static bool queryClosestUnit( UnitBase **closest_unit_ptr,
-                                   iRect &amp;bounding_rect,
-                                   iXY &amp;loc );
-
-    static bool queryClosestEnemyUnit(UnitBase **closest_unit_ptr,
-                                      iXY &amp;loc,
-                                      Uint16 player_index);
-
-    static bool queryUnitAtMapLoc( iXY map_loc, UnitID *query_unit_id );
-
-    static unsigned char queryUnitLocationStatus( iXY loc );
-
-protected:
-    // Unit Message Handler Methods
-    static void processManagerMessage(const UnitMessage *message);
-    static void unitManagerMesgEndLifecycle(const UnitMessage *message);
-
-protected:
-    friend class Vehicle;
-    
-    // Network Message Handler Variables
-    static Timer message_timer;
-    static Timer no_guarantee_message_timer;
-    static UnitOpcodeEncoder opcode_encoder;
-
-    // Network Message Handler Methods
-    static void sendOpcode(const UnitOpcode* opcode)
-    {
-        opcode_encoder.encode(opcode);
-    }
-
-    static void unitSyncMessage(const NetMessage *net_message );
-    static void unitOpcodeMessage(const NetMessage *net_message );
-    static void unitDestroyMessage(const NetMessage *net_message );
-    static void unitCreateMessage(const NetMessage *net_message );
-    static void unitSyncIntegrityCheckMessage(const NetMessage *net_message );
-
-protected:
-    static unsigned long  sync_units_iterator;
-    static bool	      sync_units_complete_flag;
-    static unsigned short sync_units_list_index;
-    static Timer	  sync_units_packet_timer;
-    static unsigned long  sync_units_in_sync_count;
-    static unsigned long  sync_units_in_sync_partial_count;
-    static unsigned long  sync_units_total_units;
-
-public:
-    static void processNetMessage(const NetMessage *net_message );
-    static void destroyPlayerUnits(Uint16 player_id);
-};
-
-#endif // ** _UNITINTERFACE_HPP

Deleted: trunk/netpanzer/src/NetPanzer/Interfaces/UnitProfileInterface.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Interfaces/UnitProfileInterface.cpp	2008-09-09 15:53:32 UTC (rev 1049)
+++ trunk/netpanzer/src/NetPanzer/Interfaces/UnitProfileInterface.cpp	2008-09-09 16:30:13 UTC (rev 1050)
@@ -1,452 +0,0 @@
-/*
-Copyright (C) 1998 Pyrosoft Inc. (www.pyrosoftgames.com), Matthew Bogue
- 
-This program is free software; you can redistribute it and/or modify
-it under the terms of the GNU General Public License as published by
-the Free Software Foundation; either version 2 of the License, or
-(at your option) any later version.
- 
-This program is distributed in the hope that it will be useful,
-but WITHOUT ANY WARRANTY; without even the implied warranty of
-MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-GNU General Public License for more details.
- 
-You should have received a copy of the GNU General Public License
-along with this program; if not, write to the Free Software
-Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
-*/
-#include &lt;config.h&gt;
-
-#include &quot;Interfaces/UnitProfileInterface.hpp&quot;
-#include &quot;Util/Exception.hpp&quot;
-#include &quot;Util/FileSystem.hpp&quot;
-#include &quot;Util/Log.hpp&quot;
-#include &lt;ctype.h&gt;
-#include &lt;memory&gt;
-#include &lt;string.h&gt;
-
-typedef
-struct
-{
-    char params[32][128];
-    short param_count;
-}
-parameter_list;
-
-#define _MAX_KEY_LENGTH 64
-
-char field_headers[28][64] =
-{ 
-    &quot;[TURRET_PLACEMENT]&quot;, &quot;[MOVE_OFFSET]&quot;, &quot;HITPOINTS&quot;,
-    &quot;ATTACK_FACTOR&quot;, &quot;RELOAD_TIME&quot;, &quot;REACTION_TIME&quot;, &quot;RANGE_MAX&quot;, &quot;REGEN_TIME&quot;,
-    &quot;DEFEND_RANGE&quot;, &quot;SPEED_RATE&quot;, &quot;SPEED_FACTOR&quot;, &quot;REPATH_TIME&quot;, &quot;FUEL_CAPACITY&quot;,
-    &quot;TRACKING_RATE&quot;, &quot;JAMM_ABLE&quot;, &quot;JAMMING_TIME&quot;, &quot;JAMMING_RANGE&quot;, &quot;FUELING_RANGE&quot;,
-    &quot;IMAGE&quot;,&quot;BODYSPRITE&quot;, &quot;BODYSHADOW&quot;, &quot;TURRETSPRITE&quot;, &quot;TURRETSHADOW&quot;, &quot;SOUNDSELECTED&quot;,
-    &quot;FIRESOUND&quot;, &quot;WEAPON&quot;, &quot;BOUNDBOX&quot;, 
-    &quot;END&quot;
-};
-
-enum
-{ 
-    _turret_place, _move_offset, _hit_points, _attack_x, _reload_time,
-    _react_time, _range_max, _regen_time, _defend_range, _speed_rate, _speed_factor, _repath_time, _fuel_capacity,
-    _tracking_rate, _jamm_able, _jamming_time, _jamming_range, _fueling_range,
-    _image, _bodysprite, _bodyshadow, _turretsprite, _turretshadow, _soundselected,
-    _firesound, _weapontype, _boundbox,
-    _end
-};
-
-short max_field_key = 28;
-
-
-//****************************************************************************************
-
-char * extract_spaces(char *string,int index)
-
-{
-    int i=0;
-    char *stroffset;
-
-    stroffset = string+index;
-
-    while( *(stroffset+i) == ' ' )/* extract leading spaces just encase */
-        i++;
-
-    return(stroffset+i);
-}
-
-//****************************************************************************************
-
-void find_keyword(char *string, int *command, char *key_list, char max_key_list )
-{
-    int comindex;    /* index to config commands */
-    short int notfound=1;
-    char *str;
-
-    str = extract_spaces(string,0);
-
-    for(comindex=0; ( (comindex &lt; max_key_list )  &amp;&amp; notfound); comindex++ ) {
-        notfound = strncasecmp( str, &amp;key_list[ comindex * _MAX_KEY_LENGTH ], strlen( &amp;key_list[ comindex * _MAX_KEY_LENGTH ]) );
-    }
-
-    comindex = comindex-1;
-
-    if ( (comindex == max_key_list - 1 ) &amp;&amp; (notfound != 0) ) /* Checks if no commands found */
-        *command = max_key_list;
-    else
-        *command = comindex;
-
-}
-//****************************************************************************************
-
-short extract_token( char *token, char **string )
-{
-    char token_char = ' ';
-    char *str;
-    short index = 0;
-    short token_index = 0;
-
-    str = *string;
-
-    str = extract_spaces( str, 0 );
-
-    while( (str[index] != 0) &amp;&amp; (str[ index ] != token_char) ) {
-        if (str[index] == '&quot;')
-            token_char = '&quot;';
-        else
-            if ( (str[index] != '\n') &amp;&amp; (str[index] != '\r') ) {
-                token[ token_index ] = str[index];
-                token_index++;
-            }
-
-        index++;
-    }
-
-    token[ token_index ] = 0;
-
-    *string = (str+index);
-
-    if(str[index] == 0)
-        *string = 0;
-
-    if ( token_index == 0 )
-        return (false);
-
-    return (true);
-
-}
-
-void string_to_params( char *string, parameter_list *params )
-{
-    params-&gt;param_count = 0;
-
-    if( extract_token( params-&gt;params[ params-&gt;param_count ], &amp;string ) )
-        params-&gt;param_count++;
-
-
-    while ( string != 0 ) {
-        if( extract_token( params-&gt;params[ params-&gt;param_count ], &amp;string ) )
-            params-&gt;param_count++;
-    }
-
-}
-
-
-void read_vehicle_profile(const std::string&amp; unitName, UnitProfile *profile)
-{
-    int field;
-    char temp_str[256];
-    parameter_list param_list;
-    int temp_int;
-    short not_done = true;
-
-    std::string file_path = &quot;units/profiles/&quot;;
-    file_path += unitName;
-    file_path += &quot;.pfl&quot;;
-
-    profile-&gt;unitname = unitName;
-    
-    try {
-	std::auto_ptr&lt;filesystem::ReadFile&gt; file(
-                filesystem::openRead(file_path));
-
-	while( not_done ) {
-	    for(int i=0; i&lt;256; i++)
-        {
-            file-&gt;read(&amp;(temp_str[i]), 1, 1);
-            if(temp_str[i] == '\n')
-            {
-                temp_str[i] = 0;
-                break;
-            }
-	    }
-        
-	    string_to_params( temp_str, &amp;param_list );
-	    find_keyword( param_list.params[0], &amp;field, (char * ) field_headers, max_field_key );
-
-	    switch(field) {
-		case _hit_points:
-		    {
- 			sscanf( param_list.params[1], &quot;%d&quot;, &amp;temp_int );
-			profile-&gt;hit_points = (short) temp_int;
-		    }
-		    break;
-
-		case _attack_x:
-		    {
-   			sscanf( param_list.params[1], &quot;%d&quot;, &amp;temp_int );
-			profile-&gt;attack_factor = (short) temp_int;
-		    }
-		    break;
-
-		case _reload_time:
-		    {
-			sscanf( param_list.params[1], &quot;%d&quot;, &amp;temp_int );
-			profile-&gt;reload_time = (char) temp_int;
-		    }
-		    break;
-
-		case _react_time :
-		    {
-			sscanf( param_list.params[1], &quot;%d&quot;, &amp;temp_int );
-			profile-&gt;reaction_time = (char) temp_int;
-		    }
-		    break;
-
-		case _range_max : 
-		    {
-			sscanf( param_list.params[1], &quot;%d&quot;, &amp;temp_int );
-			profile-&gt;attack_range = (long) temp_int;
-		    }
-		    break;
-
-		case _regen_time: 
-		    {
-			sscanf( param_list.params[1], &quot;%d&quot;, &amp;temp_int );
-			profile-&gt;regen_time = (short) temp_int;
-		    }
-		    break;
-
-		case _defend_range: 
-		    {
-			sscanf( param_list.params[1], &quot;%d&quot;, &amp;temp_int );
-			profile-&gt;defend_range = (long) temp_int;
-		    }
-		    break;
-
-		case _speed_rate: 
-		    {
-			sscanf( param_list.params[1], &quot;%d&quot;, &amp;temp_int );
-			profile-&gt;speed_rate = (char) temp_int;
-		    }
-		    break;
-
-		case _speed_factor:
-		    {
-			sscanf( param_list.params[1], &quot;%d&quot;, &amp;temp_int );
-			profile-&gt;speed_factor = (char) temp_int;
-		    }
-		    break;
-
-		case _repath_time: 
-		    {
-			sscanf( param_list.params[1], &quot;%d&quot;, &amp;temp_int );
-			profile-&gt;repath_time = (char) temp_int;
-		    }
-		    break;
-
-		case _fuel_capacity:
-		    {
-			sscanf( param_list.params[1], &quot;%d&quot;, &amp;temp_int );
-			profile-&gt;fuel_capacity = (short ) temp_int;
-		    }
-		    break;
-
-		case _tracking_rate:
-		    {
-			sscanf( param_list.params[1], &quot;%d&quot;, &amp;temp_int );
-			profile-&gt;tracking_rate = (char) temp_int;
-		    }
-		    break;
-
-		case _jamm_able:
-		    {
-			sscanf( param_list.params[1], &quot;%d&quot;, &amp;temp_int );
-			profile-&gt;jammable = (char) temp_int;
-		    }
-		    break;
-
-		case _jamming_time:
-		    {
-			sscanf( param_list.params[1], &quot;%d&quot;, &amp;temp_int );
-			profile-&gt;jamming_time = (char) temp_int;
-		    }
-		    break;
-
-		case _jamming_range:
-		    {
-			sscanf( param_list.params[1], &quot;%d&quot;, &amp;temp_int );
-			profile-&gt;jamming_range = (long) temp_int;
-		    }
-		    break;
-
-		case _fueling_range:
-		    {
-			sscanf( param_list.params[1], &quot;%d&quot;, &amp;temp_int );
-			profile-&gt;fueling_range = (long) temp_int;
-		    }
-		    break;
-        
-        case _image:
-            profile-&gt;imagefile = param_list.params[1];
-            break;
-        
-        case _bodysprite:
-            profile-&gt;bodySprite.load(param_list.params[1]);
-            break;
-
-        case _bodyshadow:
-            profile-&gt;bodyShadow.load(param_list.params[1]);
-            break;
-            
-        case _turretsprite:
-            profile-&gt;turretSprite.load(param_list.params[1]);
-            break;
-
-        case _turretshadow:
-            profile-&gt;turretShadow.load(param_list.params[1]);
-            break;
-                
-        case _soundselected:
-            profile-&gt;soundSelected = param_list.params[1];
-            break;
-
-        case _firesound:
-            profile-&gt;fireSound = param_list.params[1];
-            break;
-            
-        case _weapontype:
-            profile-&gt;weaponType = param_list.params[1];
-            break;
-                
-        case _boundbox:
-            sscanf( param_list.params[1], &quot;%d&quot;, &amp;temp_int );
-            profile-&gt;boundBox = (short) temp_int;
-            break;
-                
-		case _end :
-		    {
-			not_done = false;
-		    }
-		    break;
-	    } // ** switch
-	} // ** while ( !feof )
-    } catch(std::exception&amp; e) {
-	throw Exception(&quot;Error while reading unitprofile '%s': %s&quot;,
-		file_path.c_str(), e.what());
-    }
-} // function
-
-vector&lt;UnitProfile *&gt; UnitProfileInterface::profiles;
-
-void
-UnitProfileInterface::clearProfiles()
-{
-    vector&lt;UnitProfile *&gt;::iterator i = profiles.begin();
-    while ( i != profiles.end() )
-    {
-        delete *i;
-        i++;
-    }
-    profiles.clear();
-}
-
-void UnitProfileInterface::loadUnitProfiles( void )
-{
-    clearProfiles();
-    UnitProfile * p;
-    
-    p = new UnitProfile();
-    read_vehicle_profile(&quot;Manta&quot;, p);
-    p-&gt;unit_type = profiles.size();
-    profiles.push_back(p);
-    
-    p = new UnitProfile();
-    read_vehicle_profile(&quot;Panther1&quot;, p);
-    p-&gt;unit_type = profiles.size();
-    profiles.push_back(p);
-
-    p = new UnitProfile();
-    read_vehicle_profile(&quot;Titan&quot;, p);
-    p-&gt;unit_type = profiles.size();
-    profiles.push_back(p);
-
-    p = new UnitProfile();
-    read_vehicle_profile(&quot;Stinger&quot;, p);
-    p-&gt;unit_type = profiles.size();
-    profiles.push_back(p);
-    
-    p = new UnitProfile();
-    read_vehicle_profile(&quot;Bobcat&quot;, p);
-    p-&gt;unit_type = profiles.size();
-    profiles.push_back(p);
-    
-    p = new UnitProfile();
-    read_vehicle_profile(&quot;Bear&quot;, p);
-    p-&gt;unit_type = profiles.size();
-    profiles.push_back(p);
-
-    p = new UnitProfile();
-    read_vehicle_profile(&quot;Archer&quot;, p);
-    p-&gt;unit_type = profiles.size();
-    profiles.push_back(p);
-
-    p = new UnitProfile();
-    read_vehicle_profile(&quot;Wolf&quot;, p);
-    p-&gt;unit_type = profiles.size();
-    profiles.push_back(p);
-    
-    p = new UnitProfile();
-    read_vehicle_profile(&quot;Drake&quot;, p);
-    p-&gt;unit_type = profiles.size();
-    profiles.push_back(p);
-
-    p = new UnitProfile();
-    read_vehicle_profile(&quot;SPanzer&quot;, p); // should be scout or humvee?
-    p-&gt;unit_type = profiles.size();
-    profiles.push_back(p);
-}
-
-UnitProfile * UnitProfileInterface::getUnitProfile( unsigned short unit_type )
-{
-    if ( unit_type &lt; profiles.size() )
-        return profiles[unit_type];
-    return 0;
-}
-
-UnitProfile *
-UnitProfileInterface::getProfileByName( const std::string &amp;name )
-{
-    vector&lt;UnitProfile *&gt;::iterator i = profiles.begin();
-    while ( i != profiles.end() )
-    {
-        if ( name.length() != (*i)-&gt;unitname.length() )
-        {
-            i++;
-            continue; // continue if size !=
-        }
-
-        std::string::size_type s = 0;
-        while ( s &lt; name.length()
-               &amp;&amp; toupper(name[s]) == toupper((*i)-&gt;unitname[s]) )
-        {
-            s++;
-        }
-        
-        if ( s == name.length() )
-            return *i;
-        
-        i++;
-    }
-    return 0; // null pointer warning
-}

Deleted: trunk/netpanzer/src/NetPanzer/Interfaces/UnitProfileInterface.hpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Interfaces/UnitProfileInterface.hpp	2008-09-09 15:53:32 UTC (rev 1049)
+++ trunk/netpanzer/src/NetPanzer/Interfaces/UnitProfileInterface.hpp	2008-09-09 16:30:13 UTC (rev 1050)
@@ -1,82 +0,0 @@
-/*
-Copyright (C) 1998 Pyrosoft Inc. (www.pyrosoftgames.com), Matthew Bogue
- 
-This program is free software; you can redistribute it and/or modify
-it under the terms of the GNU General Public License as published by
-the Free Software Foundation; either version 2 of the License, or
-(at your option) any later version.
- 
-This program is distributed in the hope that it will be useful,
-but WITHOUT ANY WARRANTY; without even the implied warranty of
-MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-GNU General Public License for more details.
- 
-You should have received a copy of the GNU General Public License
-along with this program; if not, write to the Free Software
-Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
-*/
-#ifndef _UNITPROFILEINTERFACE_HPP
-#define _UNITPROFILEINTERFACE_HPP
-
-#include &lt;string&gt;
-#include &lt;vector&gt;
-
-using namespace std;
-
-#include &quot;Structs/UnitTypes.hpp&quot;
-#include &quot;Classes/UnitState.hpp&quot;
-#include &quot;2D/PackedSurface.hpp&quot;
-
-class UnitProfile
-{
-public:
-    std::string unitname;
-    unsigned short unit_type;
-
-    short hit_points;
-    short attack_factor;
-    long  attack_range;
-    long  defend_range;
-    char  reaction_time;
-    char  speed_factor;
-    char  speed_rate;
-    char  tracking_rate;
-    short fuel_capacity;
-    char  reload_time;
-    char  repath_time;
-    short regen_time;
-    char  jammable;
-    char  jamming_time;
-    // ** for fuel truck only
-    long  fueling_range;
-    // ** for ecm truck only **
-    long  jamming_range;
-    std::string imagefile;
-    PackedSurface bodySprite;
-    PackedSurface bodyShadow;
-    PackedSurface turretSprite;
-    PackedSurface turretShadow;
-    std::string soundSelected;
-    std::string fireSound;
-    std::string weaponType;
-    short boundBox;
-};
-
-class UnitProfileInterface
-{
-protected:
-    static vector&lt;UnitProfile *&gt; profiles;
-    static void clearProfiles();
-    
-public:
-    static void loadUnitProfiles( void );
-    static UnitProfile * getUnitProfile( unsigned short unit_type );
-    static UnitProfile * getProfileByName( const std::string &amp;name );
-    static unsigned short getNumUnitTypes()
-    {
-        return profiles.size();
-    }
-};
-
-
-#endif // ** _UNITPROFILEINTERFACE_HPP

Modified: trunk/netpanzer/src/NetPanzer/Jamfile
===================================================================
--- trunk/netpanzer/src/NetPanzer/Jamfile	2008-09-09 15:53:32 UTC (rev 1049)
+++ trunk/netpanzer/src/NetPanzer/Jamfile	2008-09-09 16:30:13 UTC (rev 1050)
@@ -9,7 +9,6 @@
     Port
     Classes
     Classes/AI
-    Classes/Units
     Classes/Weapons
     Classes/Network
     Network
@@ -21,7 +20,7 @@
     System
     PowerUps
     Objectives
-#    Panels
+    Units
 ;
 
 SOURCES = ;

Modified: trunk/netpanzer/src/NetPanzer/Objectives/Objective.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Objectives/Objective.cpp	2008-09-09 15:53:32 UTC (rev 1049)
+++ trunk/netpanzer/src/NetPanzer/Objectives/Objective.cpp	2008-09-09 16:30:13 UTC (rev 1050)
@@ -20,7 +20,7 @@
 #include &quot;Outpost.hpp&quot;
 #include &quot;Interfaces/PlayerInterface.hpp&quot;
 #include &quot;Interfaces/ConsoleInterface.hpp&quot;
-#include &quot;Interfaces/UnitProfileInterface.hpp&quot;
+#include &quot;Units/UnitProfileInterface.hpp&quot;
 #include &quot;Util/Log.hpp&quot;
 
 Objective::Objective(ObjectiveID ID, iXY location, BoundBox area)

Modified: trunk/netpanzer/src/NetPanzer/Objectives/Outpost.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Objectives/Outpost.cpp	2008-09-09 15:53:32 UTC (rev 1049)
+++ trunk/netpanzer/src/NetPanzer/Objectives/Outpost.cpp	2008-09-09 16:30:13 UTC (rev 1050)
@@ -18,8 +18,8 @@
 #include &lt;config.h&gt;
 #include &quot;Outpost.hpp&quot;
 
-#include &quot;Interfaces/UnitInterface.hpp&quot;
-#include &quot;Interfaces/UnitProfileInterface.hpp&quot;
+#include &quot;Units/UnitInterface.hpp&quot;
+#include &quot;Units/UnitProfileInterface.hpp&quot;
 #include &quot;Interfaces/PlayerInterface.hpp&quot;
 #include &quot;Interfaces/MapInterface.hpp&quot;
 #include &quot;Interfaces/ConsoleInterface.hpp&quot;

Modified: trunk/netpanzer/src/NetPanzer/Objectives/Outpost.hpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Objectives/Outpost.hpp	2008-09-09 15:53:32 UTC (rev 1049)
+++ trunk/netpanzer/src/NetPanzer/Objectives/Outpost.hpp	2008-09-09 16:30:13 UTC (rev 1050)
@@ -21,7 +21,7 @@
 #include &quot;Objectives/Objective.hpp&quot;
 #include &quot;Util/Timer.hpp&quot;
 #include &quot;Classes/SelectionBoxSprite.hpp&quot;
-#include &quot;Classes/UnitBase.hpp&quot;
+#include &quot;Units/UnitBase.hpp&quot;
 
 class Outpost : public Objective
 {

Modified: trunk/netpanzer/src/NetPanzer/Particles/ChunkTrajectoryParticle2D.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Particles/ChunkTrajectoryParticle2D.cpp	2008-09-09 15:53:32 UTC (rev 1049)
+++ trunk/netpanzer/src/NetPanzer/Particles/ChunkTrajectoryParticle2D.cpp	2008-09-09 16:30:13 UTC (rev 1050)
@@ -23,9 +23,9 @@
 #include &quot;Interfaces/GameConfig.hpp&quot;
 #include &quot;Util/Math.hpp&quot;
 #include &quot;Interfaces/TileInterface.hpp&quot;
-#include &quot;Classes/Units/UnitGlobals.hpp&quot;
+#include &quot;Units/UnitGlobals.hpp&quot;
 #include &quot;Particles/ParticleInterface.hpp&quot;
-#include &quot;Interfaces/UnitProfileInterface.hpp&quot;
+#include &quot;Units/UnitProfileInterface.hpp&quot;
 
 
 PackedSurface ChunkTrajectoryParticle2D::staticPackedGroundChunks;

Modified: trunk/netpanzer/src/NetPanzer/Particles/ParticleInterface.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Particles/ParticleInterface.cpp	2008-09-09 15:53:32 UTC (rev 1049)
+++ trunk/netpanzer/src/NetPanzer/Particles/ParticleInterface.cpp	2008-09-09 16:30:13 UTC (rev 1050)
@@ -35,14 +35,14 @@
 //#include &quot;RadarPingParticle2D.hpp&quot;
 //#include &quot;MovementDirtPuffParticle2D.hpp&quot;
 #include &quot;VectorPuffParticle2D.hpp&quot;
-#include &quot;Structs/UnitTypes.hpp&quot;
+#include &quot;Units/UnitTypes.hpp&quot;
 #include &quot;Interfaces/WorldViewInterface.hpp&quot;
 #include &quot;Interfaces/ConsoleInterface.hpp&quot;
 #include &quot;ChunkTrajectoryParticle2D.hpp&quot;
 //#include &quot;SmokingTrajectoryParticle2D.hpp&quot;
-#include &quot;Interfaces/UnitProfileInterface.hpp&quot;
+#include &quot;Units/UnitProfileInterface.hpp&quot;
 #include &quot;TemplateMuzzleSystem.hpp&quot;
-#include &quot;Classes/Units/UnitGlobals.hpp&quot;
+#include &quot;Units/UnitGlobals.hpp&quot;
 #include &quot;CraterParticle2D.hpp&quot;
 #include &quot;Util/Exception.hpp&quot;
 #include &quot;System/Sound.hpp&quot;

Modified: trunk/netpanzer/src/NetPanzer/Particles/ParticleInterface.hpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Particles/ParticleInterface.hpp	2008-09-09 15:53:32 UTC (rev 1049)
+++ trunk/netpanzer/src/NetPanzer/Particles/ParticleInterface.hpp	2008-09-09 16:30:13 UTC (rev 1050)
@@ -24,8 +24,8 @@
 #include &quot;Types/iRect.hpp&quot;
 #include &quot;PuffParticle2D.hpp&quot;
 #include &quot;ParticleSystemGlobals.hpp&quot;
-#include &quot;Structs/UnitTypes.hpp&quot;
-#include &quot;Classes/UnitState.hpp&quot;
+#include &quot;Units/UnitTypes.hpp&quot;
+#include &quot;Units/UnitState.hpp&quot;
 
 #include &lt;vector&gt;
 

Modified: trunk/netpanzer/src/NetPanzer/PowerUps/BonusUnitPowerUp.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/PowerUps/BonusUnitPowerUp.cpp	2008-09-09 15:53:32 UTC (rev 1049)
+++ trunk/netpanzer/src/NetPanzer/PowerUps/BonusUnitPowerUp.cpp	2008-09-09 16:30:13 UTC (rev 1050)
@@ -19,12 +19,12 @@
 #include &quot;BonusUnitPowerUp.hpp&quot;
 
 #include &lt;stdlib.h&gt;
-#include &quot;Structs/UnitTypes.hpp&quot;
-#include &quot;Interfaces/UnitInterface.hpp&quot;
+#include &quot;Units/UnitTypes.hpp&quot;
+#include &quot;Units/UnitInterface.hpp&quot;
 #include &quot;Interfaces/PlayerInterface.hpp&quot;
 #include &quot;Interfaces/MapInterface.hpp&quot;
 #include &quot;Interfaces/ConsoleInterface.hpp&quot;
-#include &quot;Interfaces/UnitProfileInterface.hpp&quot;
+#include &quot;Units/UnitProfileInterface.hpp&quot;
 
 #include &quot;Classes/Network/NetworkServer.hpp&quot;
 #include &quot;Classes/Network/NetworkState.hpp&quot;

Modified: trunk/netpanzer/src/NetPanzer/PowerUps/EnemyRadarPowerUp.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/PowerUps/EnemyRadarPowerUp.cpp	2008-09-09 15:53:32 UTC (rev 1049)
+++ trunk/netpanzer/src/NetPanzer/PowerUps/EnemyRadarPowerUp.cpp	2008-09-09 16:30:13 UTC (rev 1050)
@@ -19,8 +19,8 @@
 #include &quot;EnemyRadarPowerUp.hpp&quot;
 
 #include &lt;stdlib.h&gt;
-#include &quot;Structs/UnitTypes.hpp&quot;
-#include &quot;Interfaces/UnitInterface.hpp&quot;
+#include &quot;Units/UnitTypes.hpp&quot;
+#include &quot;Units/UnitInterface.hpp&quot;
 #include &quot;Interfaces/PlayerInterface.hpp&quot;
 #include &quot;Interfaces/MapInterface.hpp&quot;
 #include &quot;Interfaces/MiniMapInterface.hpp&quot;

Modified: trunk/netpanzer/src/NetPanzer/PowerUps/PowerUp.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/PowerUps/PowerUp.cpp	2008-09-09 15:53:32 UTC (rev 1049)
+++ trunk/netpanzer/src/NetPanzer/PowerUps/PowerUp.cpp	2008-09-09 16:30:13 UTC (rev 1050)
@@ -18,8 +18,8 @@
 #include &lt;config.h&gt;
 #include &quot;PowerUps/PowerUp.hpp&quot;
 
-#include &quot;Classes/UnitBlackBoard.hpp&quot;
-#include &quot;Interfaces/UnitInterface.hpp&quot;
+#include &quot;Units/UnitBlackBoard.hpp&quot;
+#include &quot;Units/UnitInterface.hpp&quot;
 #include &quot;Interfaces/MapInterface.hpp&quot;
 #include &quot;Classes/Network/NetworkState.hpp&quot;
 

Modified: trunk/netpanzer/src/NetPanzer/PowerUps/UnitPowerUp.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/PowerUps/UnitPowerUp.cpp	2008-09-09 15:53:32 UTC (rev 1049)
+++ trunk/netpanzer/src/NetPanzer/PowerUps/UnitPowerUp.cpp	2008-09-09 16:30:13 UTC (rev 1050)
@@ -19,8 +19,8 @@
 #include &quot;UnitPowerUp.hpp&quot;
 
 #include &lt;stdlib.h&gt;
-#include &quot;Structs/UnitTypes.hpp&quot;
-#include &quot;Interfaces/UnitInterface.hpp&quot;
+#include &quot;Units/UnitTypes.hpp&quot;
+#include &quot;Units/UnitInterface.hpp&quot;
 #include &quot;Classes/UnitMessageTypes.hpp&quot;
 #include &quot;Interfaces/PlayerInterface.hpp&quot;
 #include &quot;Interfaces/MapInterface.hpp&quot;

Modified: trunk/netpanzer/src/NetPanzer/PowerUps/UnitPowerUp.hpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/PowerUps/UnitPowerUp.hpp	2008-09-09 15:53:32 UTC (rev 1049)
+++ trunk/netpanzer/src/NetPanzer/PowerUps/UnitPowerUp.hpp	2008-09-09 16:30:13 UTC (rev 1050)
@@ -19,7 +19,7 @@
 #define _UNIT_POWERUP_HPP
 
 #include &quot;PowerUps/PowerUp.hpp&quot;
-#include &quot;Classes/UnitState.hpp&quot;
+#include &quot;Units/UnitState.hpp&quot;
 
 class UnitPowerUp : public PowerUp
 {

Deleted: trunk/netpanzer/src/NetPanzer/Structs/UnitTypes.hpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Structs/UnitTypes.hpp	2008-09-09 15:53:32 UTC (rev 1049)
+++ trunk/netpanzer/src/NetPanzer/Structs/UnitTypes.hpp	2008-09-09 16:30:13 UTC (rev 1050)
@@ -1,37 +0,0 @@
-/*
-Copyright (C) 1998 Pyrosoft Inc. (www.pyrosoftgames.com), Matthew Bogue
- 
-This program is free software; you can redistribute it and/or modify
-it under the terms of the GNU General Public License as published by
-the Free Software Foundation; either version 2 of the License, or
-(at your option) any later version.
- 
-This program is distributed in the hope that it will be useful,
-but WITHOUT ANY WARRANTY; without even the implied warranty of
-MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-GNU General Public License for more details.
- 
-You should have received a copy of the GNU General Public License
-along with this program; if not, write to the Free Software
-Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
-*/
-#ifndef _UNITTYPES_HPP
-#define _UNITTYPES_HPP
-
-#define _MAX_UNIT_TYPES 10
-
-enum UnitType {
-    _unit_type_valentine = 0,   // now called manta
-    _unit_type_leopard,     // now called panther
-    _unit_type_abrams,      // now called titan
-    _unit_type_hammerhead,  // now called stinger
-    _unit_type_lynx,        // now called bobcat
-    _unit_type_spahpanzer,  // now called bear
-    _unit_type_archer,      
-    _unit_type_scorpion,    // now called wolf
-    _unit_type_m109,        // now called drake
-    _unit_type_humvee,      // now called scout
-    _unit_type_null
-};
-
-#endif //** _UNITTYPES_HPP

Copied: trunk/netpanzer/src/NetPanzer/Units (from rev 1049, trunk/netpanzer/src/NetPanzer/Classes/Units)

Copied: trunk/netpanzer/src/NetPanzer/Units/UnitBase.hpp (from rev 1049, trunk/netpanzer/src/NetPanzer/Classes/UnitBase.hpp)
===================================================================
--- trunk/netpanzer/src/NetPanzer/Classes/UnitBase.hpp	2008-09-09 15:53:32 UTC (rev 1049)
+++ trunk/netpanzer/src/NetPanzer/Units/UnitBase.hpp	2008-09-09 16:30:13 UTC (rev 1050)
@@ -0,0 +1,66 @@
+/*
+Copyright (C) 1998 Pyrosoft Inc. (www.pyrosoftgames.com), Matthew Bogue
+ 
+This program is free software; you can redistribute it and/or modify
+it under the terms of the GNU General Public License as published by
+the Free Software Foundation; either version 2 of the License, or
+(at your option) any later version.
+ 
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+ 
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
+*/
+#ifndef _UNITBASE_HPP
+#define _UNITBASE_HPP
+
+#include &quot;Core/CoreTypes.hpp&quot;
+#include &quot;Units/UnitState.hpp&quot;
+
+class UnitMessage;
+class UnitOpcode;
+class SpriteSorter;
+class PlayerState;
+
+class UnitBase
+{
+public:
+    PlayerState* player;
+    UnitID       id;
+    UnitState    unit_state;
+    bool         in_sync_flag;
+
+    UnitBase(PlayerState* newPlayer, UnitID newId)
+        : player(newPlayer), id(newId)
+    { }
+    virtual ~UnitBase()
+    { }
+
+    virtual void processMessage(const UnitMessage* ) = 0;
+    virtual void evalCommandOpcode(const UnitOpcode* ) = 0;
+    virtual void updateState() = 0;
+    virtual void syncUnit() = 0;
+    virtual void offloadGraphics(SpriteSorter&amp; ) = 0;
+    virtual void soundSelected() = 0;
+
+private:
+    friend class UnitInterface;
+    void setID(UnitID id)
+    {
+        this-&gt;id = id;
+    }
+
+    UnitID getID() const
+    {
+        return id;
+    }
+
+protected:
+    UnitBase *groupLinkNext;
+};
+
+#endif // ** _UNITBASE_HPP

Copied: trunk/netpanzer/src/NetPanzer/Units/UnitBlackBoard.cpp (from rev 1049, trunk/netpanzer/src/NetPanzer/Classes/UnitBlackBoard.cpp)
===================================================================
--- trunk/netpanzer/src/NetPanzer/Classes/UnitBlackBoard.cpp	2008-09-09 15:53:32 UTC (rev 1049)
+++ trunk/netpanzer/src/NetPanzer/Units/UnitBlackBoard.cpp	2008-09-09 16:30:13 UTC (rev 1050)
@@ -0,0 +1,52 @@
+/*
+Copyright (C) 1998 Pyrosoft Inc. (www.pyrosoftgames.com), Matthew Bogue
+ 
+This program is free software; you can redistribute it and/or modify
+it under the terms of the GNU General Public License as published by
+the Free Software Foundation; either version 2 of the License, or
+(at your option) any later version.
+ 
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+ 
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
+*/
+#include &lt;config.h&gt;
+#include &quot;Units/UnitBlackBoard.hpp&quot;
+
+#include &quot;Interfaces/MapInterface.hpp&quot;
+
+BitArray UnitBlackBoard::unit_loc_map;
+
+void UnitBlackBoard::initializeBlackBoard( void )
+{
+    unit_loc_map.initialize( MapInterface::getWidth(),
+                             MapInterface::getHeight() );
+
+    unit_loc_map.clear();
+}
+
+void UnitBlackBoard::resetBlackBoard()
+{
+    unit_loc_map.clear();
+}
+
+
+void UnitBlackBoard::updateUnitLocs( void )
+{
+    unsigned long i,k,x_limit,y_limit;
+
+    x_limit = unit_loc_map.x_size;
+    y_limit = unit_loc_map.y_size;
+
+    for( i = 0; i &lt; y_limit; i++ )
+        for ( k = 0; k &lt; x_limit; k++ ) {
+            if ( unit_loc_map.getBit( k, i ) == true )
+                MapInterface::markLocHack( iXY( k, i ) );
+        }
+
+}

Copied: trunk/netpanzer/src/NetPanzer/Units/UnitBlackBoard.hpp (from rev 1049, trunk/netpanzer/src/NetPanzer/Classes/UnitBlackBoard.hpp)

Copied: trunk/netpanzer/src/NetPanzer/Units/UnitBucketArray.cpp (from rev 1049, trunk/netpanzer/src/NetPanzer/Classes/UnitBucketArray.cpp)
===================================================================
--- trunk/netpanzer/src/NetPanzer/Classes/UnitBucketArray.cpp	2008-09-09 15:53:32 UTC (rev 1049)
+++ trunk/netpanzer/src/NetPanzer/Units/UnitBucketArray.cpp	2008-09-09 16:30:13 UTC (rev 1050)
@@ -0,0 +1,296 @@
+/*
+Copyright (C) 1998 Pyrosoft Inc. (www.pyrosoftgames.com), Matthew Bogue
+ 
+This program is free software; you can redistribute it and/or modify
+it under the terms of the GNU General Public License as published by
+the Free Software Foundation; either version 2 of the License, or
+(at your option) any later version.
+ 
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+ 
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
+*/
+#include &lt;config.h&gt;
+
+#include &quot;2D/Palette.hpp&quot;
+#include &quot;Units/UnitBucketArray.hpp&quot;
+
+UnitBucketArray::UnitBucketArray( )
+        : UnitBucketArrayTemplate( )
+{
+    map_x_sample_factor = 0;
+    map_y_sample_factor = 0;
+}
+
+UnitBucketArray::~UnitBucketArray( )
+{
+}
+
+void
+UnitBucketArray::initialize( iXY map_size, iXY tile_size )
+{
+    initialize( map_size, tile_size, 10, 10 );
+}
+
+void
+UnitBucketArray::initialize( iXY map_size, iXY tile_size,
+        long x_super_sample, long y_super_sample )
+{
+    unsigned long rows, columns;
+
+    assert( x_super_sample &gt;= 1 );
+    assert( y_super_sample &gt;= 1 );
+
+    UnitBucketArray::tile_size = tile_size;
+    UnitBucketArray::map_size = map_size;
+    UnitBucketArray::map_size_x = map_size.x;
+    UnitBucketArray::map_size_y = map_size.y;
+
+    map_x_sample_factor = x_super_sample;
+    map_y_sample_factor = y_super_sample;
+
+    while( (map_size.x % map_x_sample_factor) &gt; 0 ) {
+        map_x_sample_factor++;
+    }
+
+    while( (map_size.y % map_y_sample_factor) &gt; 0 ) {
+        map_y_sample_factor++;
+    }
+
+    pixel_x_sample_factor = tile_size.x * map_x_sample_factor;
+    pixel_y_sample_factor = tile_size.y * map_y_sample_factor;
+
+    rows = (unsigned long) map_size.y / map_y_sample_factor;
+    columns = (unsigned long) map_size.x / map_x_sample_factor;
+
+    UnitBucketArrayTemplate::initialize( rows, columns );
+}
+
+iRect
+UnitBucketArray::worldRectToBucketRectClip( iRect &amp;world_rect )
+{
+    long bucket_max_x;
+    long bucket_max_y;
+
+    bucket_max_x = world_rect.max.x / pixel_x_sample_factor;
+    if ( bucket_max_x &gt;= (long) column_size ) {
+        bucket_max_x = column_size - 1;
+    }
+
+    bucket_max_y = world_rect.max.y / pixel_y_sample_factor;
+    if ( bucket_max_y &gt;= (long) row_size ) {
+        bucket_max_y = row_size  - 1;
+    }
+
+    return( iRect( world_rect.min.x / pixel_x_sample_factor,
+                   world_rect.min.y / pixel_y_sample_factor,
+                   bucket_max_x,
+                   bucket_max_y
+                 )
+          );
+}
+
+UnitBucketList*
+UnitBucketArray::getBucketAssocWorldLoc( iXY world_loc )
+{
+    long bucket_index;
+
+    bucket_index = ((world_loc.y / pixel_y_sample_factor) * column_size) +
+                   (world_loc.x / pixel_x_sample_factor);
+
+    assert( bucket_index &lt; (long) size );
+
+    return( &amp;(array[ bucket_index ]) );
+}
+
+UnitBucketList*
+UnitBucketArray::getBucketAssocMapLoc( iXY map_loc )
+{
+    long bucket_index;
+
+    bucket_index = ((map_loc.y / map_y_sample_factor) * column_size) +
+                   (map_loc.x / map_x_sample_factor);
+
+    assert( bucket_index &lt; (long) size );
+
+    return( &amp;(array[ bucket_index ]) );
+}
+
+void
+UnitBucketArray::addUnit( UnitBase *unit )
+{
+    UnitBucketPointer *unit_bucket_ptr;
+    long bucket_index;
+
+    bucket_index = ((unit-&gt;unit_state.location.y / pixel_y_sample_factor) * column_size) +
+                   (unit-&gt;unit_state.location.x / pixel_x_sample_factor);
+
+    assert( bucket_index &lt; (long) size );
+
+    unit_bucket_ptr = new UnitBucketPointer(unit);
+
+    array[ bucket_index ].addFront( unit_bucket_ptr );
+}
+
+void
+UnitBucketArray::addUnit( UnitBucketPointer *unit_bucket_ptr )
+{
+    long bucket_index;
+    UnitBase *unit;
+
+    unit = unit_bucket_ptr-&gt;unit;
+
+    bucket_index = ((unit-&gt;unit_state.location.y / pixel_y_sample_factor) * column_size) +
+                   (unit-&gt;unit_state.location.x / pixel_x_sample_factor);
+
+    assert( bucket_index &lt; (long) size );
+
+    array[ bucket_index ].addFront( unit_bucket_ptr );
+}
+
+
+long
+UnitBucketArray::getUnitBucketIndex(UnitID unit_id)
+{
+    for( unsigned long bucket_index = 0; bucket_index &lt; size; bucket_index++ ) {
+        UnitBucketPointer *traversal_ptr;
+
+        traversal_ptr = array[ bucket_index ].getFront();
+
+        while( traversal_ptr != 0 ) {
+            if( traversal_ptr-&gt;unit-&gt;id == unit_id )
+                return (long) bucket_index;
+
+            traversal_ptr = traversal_ptr-&gt;next;
+        }
+
+    }
+
+    return -1;
+}
+
+UnitBase*
+UnitBucketArray::getUnit(UnitID unit_id, unsigned long bucket_index)
+{
+    UnitBucketPointer *traversal_ptr = array[bucket_index].getFront();
+
+    while( traversal_ptr != 0 ) {
+        if(traversal_ptr-&gt;unit-&gt;id == unit_id)
+            return traversal_ptr-&gt;unit;
+
+        traversal_ptr = traversal_ptr-&gt;next;
+    }
+
+    return 0;
+}
+
+UnitBase* UnitBucketArray::getUnitAtWorldLoc(UnitID unit_id, iXY world_loc)
+{
+    long bucket_index;
+
+    bucket_index = ((world_loc.y / pixel_y_sample_factor) * column_size) +
+                   (world_loc.x / pixel_x_sample_factor);
+
+    assert( bucket_index &lt; (long) size );
+
+    UnitBucketPointer *traversal_ptr;
+
+    traversal_ptr = array[ bucket_index ].getFront();
+
+    while( traversal_ptr != 0 ) {
+        if(traversal_ptr-&gt;unit-&gt;id == unit_id)
+            return traversal_ptr-&gt;unit;
+
+        traversal_ptr = traversal_ptr-&gt;next;
+    }
+
+    return 0;
+}
+
+UnitBase*
+UnitBucketArray::getUnitAtMapLoc(UnitID unit_id, iXY map_loc)
+{
+    long bucket_index;
+
+    bucket_index = ((map_loc.y / map_y_sample_factor) * column_size) +
+                   (map_loc.x / map_x_sample_factor);
+
+    assert( bucket_index &lt; (long) size );
+
+    UnitBucketPointer *traversal_ptr;
+
+    traversal_ptr = array[ bucket_index ].getFront();
+
+    while( traversal_ptr != 0 ) {
+        if(traversal_ptr-&gt;unit-&gt;id == unit_id)
+            return traversal_ptr-&gt;unit;
+
+        traversal_ptr = traversal_ptr-&gt;next;
+    }
+
+    return 0;
+}
+
+bool
+UnitBucketArray::moveUnit(UnitID unit_id, unsigned long from_bucket_index,
+			       unsigned long to_bucket_index )
+{
+    assert(from_bucket_index &lt; size);
+    assert(to_bucket_index &lt; size);
+    
+    bool found = false;
+    UnitBucketPointer *traversal_ptr;
+    UnitBucketPointer *move_ptr;
+
+    traversal_ptr = array[ from_bucket_index ].getFront();
+
+    while( (traversal_ptr != 0) &amp;&amp; (found == false) ) {
+        if(traversal_ptr-&gt;unit-&gt;id == unit_id) {
+            move_ptr = traversal_ptr;
+            traversal_ptr = traversal_ptr-&gt;next;
+            array[ from_bucket_index ].removeObject( move_ptr );
+            array[ to_bucket_index ].addFront( move_ptr );
+            found = true;
+        } else {
+            traversal_ptr = traversal_ptr-&gt;next;
+        }
+    }
+
+    if ( found == false ) {
+        long from_bucket_index = getUnitBucketIndex( unit_id );
+        if(from_bucket_index != -1) {
+            return( moveUnit( unit_id, from_bucket_index, to_bucket_index ) );
+        } else
+            return false;
+    }
+
+    return true;
+}
+
+bool
+UnitBucketArray::deleteUnitBucketPointer(UnitID unit_id, iXY world_loc)
+{
+    long bucket_index;
+
+    bucket_index = worldLocToBucketIndex( world_loc );
+
+    UnitBucketPointer *traversal_ptr;
+
+    traversal_ptr = array[ bucket_index ].getFront();
+
+    while( traversal_ptr != 0 ) {
+        if(traversal_ptr-&gt;unit-&gt;id == unit_id) {
+            array[ bucket_index ].deleteObject( traversal_ptr );
+            return true;
+        }
+
+        traversal_ptr = traversal_ptr-&gt;next;
+    }
+
+    return false;
+}

Copied: trunk/netpanzer/src/NetPanzer/Units/UnitBucketArray.hpp (from rev 1049, trunk/netpanzer/src/NetPanzer/Classes/UnitBucketArray.hpp)
===================================================================
--- trunk/netpanzer/src/NetPanzer/Classes/UnitBucketArray.hpp	2008-09-09 15:53:32 UTC (rev 1049)
+++ trunk/netpanzer/src/NetPanzer/Units/UnitBucketArray.hpp	2008-09-09 16:30:13 UTC (rev 1050)
@@ -0,0 +1,155 @@
+/*
+Copyright (C) 1998 Pyrosoft Inc. (www.pyrosoftgames.com), Matthew Bogue
+ 
+This program is free software; you can redistribute it and/or modify
+it under the terms of the GNU General Public License as published by
+the Free Software Foundation; either version 2 of the License, or
+(at your option) any later version.
+ 
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+ 
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
+*/
+#ifndef _UNIT_BUCKET_ARRAY_HPP
+#define _UNIT_BUCKET_ARRAY_HPP
+
+#include &quot;ArrayUtil/BucketArrayTemplate.hpp&quot;
+
+#include &quot;Units/UnitBase.hpp&quot;
+
+class UnitBucketPointer
+{
+public:
+    UnitBase *unit;
+
+    UnitBucketPointer()
+    {
+        unit = 0;
+        next = 0;
+        prev = 0;
+    }
+
+    UnitBucketPointer(UnitBase *unit)
+    {
+        UnitBucketPointer::unit = unit;
+        next = 0;
+        prev = 0;
+    }
+
+    UnitBucketPointer *next;
+    UnitBucketPointer *prev;
+};
+
+typedef BucketArrayTemplate&lt; UnitBucketPointer &gt; UnitBucketArrayTemplate;
+typedef LinkListDoubleTemplate&lt; UnitBucketPointer &gt; UnitBucketList;
+
+class UnitBucketArray : public UnitBucketArrayTemplate
+{
+protected:
+    long map_x_sample_factor;
+    long map_y_sample_factor;
+    long pixel_x_sample_factor;
+    long pixel_y_sample_factor;
+    iXY map_size;
+    long map_size_x;
+    long map_size_y;
+    iXY tile_size;
+
+public:
+
+    UnitBucketArray( );
+    ~UnitBucketArray( );
+
+    void initialize( iXY map_size, iXY tile_size);
+    void initialize( iXY map_size, iXY tile_size, long x_super_sample, long y_super_sample );
+
+    inline long getXSample( void )
+    {
+        return( map_x_sample_factor );
+    }
+
+    inline long getYSample( void )
+    {
+        return( map_y_sample_factor );
+    }
+
+    inline iXY getSample( void )
+    {
+        return( iXY( map_x_sample_factor, map_y_sample_factor) );
+    }
+
+    inline unsigned long mapLocToBucketIndex( iXY map_loc )
+    {
+        long bucket_index;
+
+        bucket_index = ((map_loc.y / map_y_sample_factor) * column_size) +
+                       (map_loc.x / map_x_sample_factor);
+
+        return( bucket_index );
+    }
+
+    inline unsigned long worldLocToBucketIndex( iXY world_loc )
+    {
+        long bucket_index;
+
+        bucket_index = ((world_loc.y / pixel_y_sample_factor) * column_size) +
+                       (world_loc.x / pixel_x_sample_factor);
+
+        return( bucket_index );
+    }
+
+    inline iXY mapLocToBucketLoc( iXY map_loc )
+    {
+        return( iXY( (map_loc.x / map_x_sample_factor), (map_loc.y / map_y_sample_factor) ) );
+    }
+
+    inline iXY worldLocToBucketLoc( iXY world_loc )
+    {
+        return( iXY(  (world_loc.x / pixel_x_sample_factor) , (world_loc.y / pixel_y_sample_factor) ) );
+    }
+
+    inline iRect worldRectToBucketRect( iRect &amp;world_rect )
+    {
+        return( iRect( world_rect.min.x / pixel_x_sample_factor,
+                       world_rect.min.y / pixel_y_sample_factor,
+                       world_rect.max.x / pixel_x_sample_factor,
+                       world_rect.max.y / pixel_y_sample_factor  )
+              );
+    }
+
+    iRect worldRectToBucketRectClip( iRect &amp;world_rect );
+
+
+    inline iRect mapRectToBucketRect( iRect &amp;map_rect )
+    {
+        return( iRect( map_rect.min.x / map_x_sample_factor,
+                       map_rect.min.y / map_y_sample_factor,
+                       map_rect.max.x / map_x_sample_factor,
+                       map_rect.max.y / map_y_sample_factor  )
+              );
+    }
+
+    UnitBucketList * getBucketAssocWorldLoc( iXY world_loc );
+    UnitBucketList * getBucketAssocMapLoc( iXY map_loc );
+
+    void addUnit( UnitBase *unit );
+    void addUnit( UnitBucketPointer *unit_bucket_ptr );
+
+    long getUnitBucketIndex( UnitID unit_id );
+
+    UnitBase * getUnit( UnitID unit_id, unsigned long bucket_index );
+    UnitBase * getUnitAtWorldLoc( UnitID unit_id, iXY world_loc );
+    UnitBase * getUnitAtMapLoc( UnitID unit_id, iXY map_loc );
+
+    bool moveUnit( UnitID unit_id, unsigned long from_bucket_index, unsigned long to_bucket_index );
+
+    bool deleteUnitBucketPointer( UnitID unit_id, iXY world_loc );
+};
+
+#endif // ** _UNIT_BUCKET_ARRAY_HPP
+

Copied: trunk/netpanzer/src/NetPanzer/Units/UnitInterface.cpp (from rev 1049, trunk/netpanzer/src/NetPanzer/Interfaces/UnitInterface.cpp)
===================================================================
--- trunk/netpanzer/src/NetPanzer/Interfaces/UnitInterface.cpp	2008-09-09 15:53:32 UTC (rev 1049)
+++ trunk/netpanzer/src/NetPanzer/Units/UnitInterface.cpp	2008-09-09 16:30:13 UTC (rev 1050)
@@ -0,0 +1,844 @@
+/*
+Copyright (C) 1998 Pyrosoft Inc. (www.pyrosoftgames.com), Matthew Bogue
+ 
+This program is free software; you can redistribute it and/or modify
+it under the terms of the GNU General Public License as published by
+the Free Software Foundation; either version 2 of the License, or
+(at your option) any later version.
+ 
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+ 
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
+*/
+#include &lt;config.h&gt;
+
+#include &lt;iostream&gt;
+
+#include &quot;Units/UnitInterface.hpp&quot;
+#include &quot;Units/UnitProfileInterface.hpp&quot;
+#include &quot;Interfaces/PlayerInterface.hpp&quot;
+#include &quot;Interfaces/MapInterface.hpp&quot;
+#include &quot;Interfaces/WorldViewInterface.hpp&quot;
+
+#include &quot;Units/Vehicle.hpp&quot;
+
+#include &quot;Types/iXY.hpp&quot;
+#include &quot;Util/Timer.hpp&quot;
+#include &quot;Classes/Network/NetworkServer.hpp&quot;
+#include &quot;Classes/Network/NetworkState.hpp&quot;
+#include &quot;Classes/Network/NetMessageEncoder.hpp&quot;
+#include &quot;Interfaces/Console.hpp&quot;
+#include &quot;Units/UnitOpcodeDecoder.hpp&quot;
+
+#include &quot;Classes/UnitMessageTypes.hpp&quot;
+#include &quot;Classes/Network/PlayerNetMessage.hpp&quot;
+#include &quot;Classes/Network/NetPacket.hpp&quot;
+#include &quot;Classes/Network/TerminalNetMesg.hpp&quot;
+
+#include &quot;System/Sound.hpp&quot;
+#include &quot;Particles/ParticleInterface.hpp&quot;
+#include &quot;Util/Log.hpp&quot;
+
+
+//UnitList * UnitInterface::unit_lists;
+UnitInterface::Units UnitInterface::units;
+UnitInterface::PlayerUnitList* UnitInterface::playerUnitLists = 0;
+UnitBucketArray UnitInterface::unit_bucket_array;
+
+unsigned short UnitInterface::max_players;
+PlacementMatrix UnitInterface::unit_placement_matrix;
+
+UnitID UnitInterface::lastUnitID;
+
+UnitOpcodeEncoder UnitInterface::opcode_encoder;
+
+Timer UnitInterface::message_timer;
+Timer UnitInterface::no_guarantee_message_timer;
+
+unsigned long   UnitInterface::sync_units_iterator;
+bool	        UnitInterface::sync_units_complete_flag;
+unsigned short  UnitInterface::sync_units_list_index;
+unsigned long   UnitInterface::sync_units_total_units;
+unsigned long   UnitInterface::sync_units_in_sync_count;
+unsigned long   UnitInterface::sync_units_in_sync_partial_count;
+size_t          UnitInterface::units_per_player;
+Timer		UnitInterface::sync_units_packet_timer;
+
+
+// ******************************************************************
+
+void UnitInterface::initialize( unsigned long max_units )
+{
+    max_players = PlayerInterface::getMaxPlayers();
+
+    //unit_lists = new UnitList [ max_players ];
+    playerUnitLists = new PlayerUnitList[max_players];
+
+    unit_bucket_array.initialize(MapInterface::getSize(), TileInterface::getTileSize() );
+
+    lastUnitID = 0;
+    message_timer.changeRate( 8 );
+    no_guarantee_message_timer.changeRate( 15 );
+
+    units_per_player = max_units;
+}
+
+// ******************************************************************
+
+void UnitInterface::cleanUp()
+{
+    // XXX why doesn't clean the unit_bucket_array?
+    delete[] playerUnitLists;
+    playerUnitLists = 0;
+
+    for(Units::iterator i = units.begin(); i != units.end(); ++i)
+        delete i-&gt;second;
+    units.clear();
+}
+
+void
+UnitInterface::reset()
+{
+    for(size_t i = 0; i &lt; max_players; i++ ) {
+        playerUnitLists[i].clear();
+    }
+
+    unit_bucket_array.initialize( MapInterface::getSize(), TileInterface::getTileSize() );
+
+    for(Units::iterator i = units.begin(); i != units.end(); ++i)
+        delete i-&gt;second;
+    units.clear();
+}
+
+void
+UnitInterface::processNetPacket(const NetPacket* packet)
+{
+    const NetMessage* message = packet-&gt;getNetMessage();
+    const TerminalUnitCmdRequest* terminal_command =
+        (const TerminalUnitCmdRequest*) message;
+
+    const PlayerState* player 
+        = PlayerInterface::getPlayer(packet-&gt;fromPlayer);
+    if(player == 0)
+    {
+        LOGGER.warning(&quot;UnitInterface: Player not found '%u'?!?&quot;,
+                packet-&gt;fromPlayer);
+        return;
+    }
+    
+    sendMessage(&amp;(terminal_command-&gt;comm_request) , player);
+}
+
+void
+UnitInterface::sendMessage(const UnitMessage* message,const PlayerState* player)
+{
+    if (message-&gt;isFlagged(_umesg_flag_unique)) {
+        UnitBase* unit = getUnit(message-&gt;getUnitID());
+        if(unit == 0)
+            return;
+        if(player &amp;&amp; unit-&gt;player != player) {
+            LOGGER.warning(
+                &quot;Terminal request for unit (%u) not owned by player (%u).\n&quot;,
+                unit-&gt;id, player-&gt;getID());
+            return;
+        }
+                    
+        unit-&gt;processMessage(message);
+    } else if (message-&gt;isFlagged( _umesg_flag_broadcast) ) {
+        if(message-&gt;message_id != _umesg_weapon_hit) {
+            LOGGER.warning(&quot;Broadcast flag only allowed for weapon hit.&quot;);
+            if(player) {
+                LOGGER.warning(&quot;from player %u.\n&quot;, player-&gt;getID());
+            }
+            return;
+        }
+            
+        for(Units::iterator i = units.begin(); i != units.end(); ++i) {
+            UnitBase* unit = i-&gt;second;
+            unit-&gt;processMessage(message);
+        }
+    } else if (message-&gt;isFlagged( _umesg_flag_manager_request) ) {
+        if(player) {
+            LOGGER.warning(
+                    &quot;UnitManagerMessage sent out by player %u not allowed.&quot;,
+                    player-&gt;getID());
+            return;
+        }
+  	processManagerMessage(message);
+    }
+}
+
+// ******************************************************************
+
+void UnitInterface::removeUnit(Units::iterator i)
+{
+    UnitBase* unit = i-&gt;second;
+    
+    // unit explosion particles
+    ParticleInterface::addHit(unit-&gt;unit_state);
+    
+    // unit explosion sound
+    sound-&gt;playAmbientSound(&quot;expl&quot;,                   
+            WorldViewInterface::getCameraDistance(
+                unit-&gt;unit_state.location ) );
+    
+    // delete the unit
+    unit_bucket_array.deleteUnitBucketPointer(unit-&gt;id, 
+            unit-&gt;unit_state.location );
+    PlayerUnitList&amp; plist =
+        playerUnitLists[unit-&gt;player-&gt;getID()];
+    
+    PlayerUnitList::iterator pi
+        = std::find(plist.begin(), plist.end(), unit);
+    assert(pi != plist.end());
+    if(pi != plist.end())
+        plist.erase(pi);
+
+    units.erase(i);
+    delete unit;
+}
+
+// ******************************************************************
+
+void UnitInterface::updateUnitStatus()
+{
+    for(Units::iterator i = units.begin(); i != units.end(); /*nothing*/ ) {
+        UnitBase* unit = i-&gt;second;
+	    
+        if (unit-&gt;unit_state.lifecycle_state == _UNIT_LIFECYCLE_INACTIVE) {
+            Units::iterator next = i;
+            ++next;
+            removeUnit(i);
+            i = next;
+            continue;
+        }
+	    
+        unsigned long pre_update_bucket_index;
+        unsigned long post_update_bucket_index;
+
+        pre_update_bucket_index 
+            = unit_bucket_array.worldLocToBucketIndex(
+                    unit-&gt;unit_state.location );
+        unit-&gt;updateState();
+
+        post_update_bucket_index 
+            = unit_bucket_array.worldLocToBucketIndex(
+                    unit-&gt;unit_state.location );
+
+        if ( post_update_bucket_index != pre_update_bucket_index ) {
+            unit_bucket_array.moveUnit(unit-&gt;id,
+                    pre_update_bucket_index, post_update_bucket_index );
+        }
+        ++i;
+    }
+
+    if ( NetworkState::status == _network_state_server ) {
+        if (message_timer.count()) {
+            opcode_encoder.send();
+        }
+    }
+}
+
+void UnitInterface::offloadGraphics(SpriteSorter&amp; sorter)
+{
+    iRect world_window_rect;
+    iRect bucket_rect;
+    UnitBucketList *bucket_list;
+
+    world_window_rect = sorter.getWorldWindow();
+    bucket_rect = unit_bucket_array.worldRectToBucketRectClip(world_window_rect);
+
+    for(long row_index = bucket_rect.min.y;
+            row_index &lt;= bucket_rect.max.y; row_index++ ) {
+        for(long column_index = bucket_rect.min.x;
+                column_index &lt;= bucket_rect.max.x; column_index++ ) {
+            bucket_list = unit_bucket_array.getBucket(row_index, column_index);
+
+            for(UnitBucketPointer* t = bucket_list-&gt;getFront();
+                    t != 0; t = t-&gt;next) {
+                t-&gt;unit-&gt;offloadGraphics(sorter);
+            }
+        }
+    }
+}
+
+// ******************************************************************
+
+UnitID UnitInterface::newUnitID()
+{
+    UnitID newID = lastUnitID++;
+    while(getUnit(newID) != 0)
+        newID = lastUnitID++;
+
+    return newID;
+}
+
+// ******************************************************************
+
+UnitBase * UnitInterface::newUnit( unsigned short unit_type,
+                                   const iXY &amp;location,
+                                   unsigned short player_index,
+                                   UnitID id)
+{
+    UnitBase* unit = 0;
+    bool color_flag;
+    unsigned char unit_flag;
+
+    if ( player_index == PlayerInterface::getLocalPlayerIndex() ) {
+        color_flag = true;
+    } else {
+        color_flag = false;
+    }
+
+    PlayerState* player = PlayerInterface::getPlayer( player_index );
+    unit_flag = player-&gt;getFlag();
+
+    if ( unit_type &lt; UnitProfileInterface::getNumUnitTypes() )
+    {
+        unit = new Vehicle(player, unit_type, id, location);        
+    }
+    else
+    {   // XXX change for a error window
+        assert(&quot;unknown unit_type&quot; == 0);        
+    }
+
+    return unit;
+}
+
+// ******************************************************************
+
+void UnitInterface::addNewUnit(UnitBase *unit)
+{
+    units.insert(std::make_pair(unit-&gt;id, unit));
+   
+    Uint16 player_index = unit-&gt;player-&gt;getID();
+    playerUnitLists[player_index].push_back(unit);
+
+    unit_bucket_array.addUnit(unit);
+}
+
+// ******************************************************************
+
+void UnitInterface::sortBucketArray()
+{
+    unsigned long bucket_count;
+    unsigned long bucket_index;
+    UnitBucketList *bucket_list;
+    UnitBucketPointer *traversal_ptr;
+
+    bucket_count = unit_bucket_array.getSize();
+
+    for( bucket_index = 0; bucket_index &lt; bucket_count; bucket_index++ ) {
+        bucket_list = unit_bucket_array.getBucket( bucket_index );
+
+        traversal_ptr = bucket_list-&gt;getFront();
+
+        while( traversal_ptr != 0 ) {
+            unsigned long unit_bucket_index;
+
+            unit_bucket_index = unit_bucket_array.worldLocToBucketIndex( traversal_ptr-&gt;unit-&gt;unit_state.location );
+
+            if( unit_bucket_index != bucket_index ) {
+                unit_bucket_array.moveUnit( traversal_ptr-&gt;unit-&gt;id,
+                        bucket_index, unit_bucket_index );
+            }
+
+            traversal_ptr = traversal_ptr-&gt;next;
+        } // ** while
+    }
+}
+
+// ******************************************************************
+
+UnitBase*
+UnitInterface::getUnit(UnitID id)
+{
+    Units::iterator i = units.find(id);
+    if(i == units.end()) {
+        return 0;
+    }
+
+    return i-&gt;second;
+}
+
+// ******************************************************************
+UnitBase* UnitInterface::createUnit( unsigned short unit_type,
+                                      const iXY &amp;location,
+                                      Uint16 player_id)
+{
+    if (playerUnitLists[player_id].size() &gt;= units_per_player)
+	return 0;
+
+    UnitBase* unit = newUnit(unit_type, location, player_id, newUnitID());
+    addNewUnit(unit);
+
+    return unit;
+}
+
+// ******************************************************************
+
+void UnitInterface::spawnPlayerUnits(const iXY &amp;location,
+                                     Uint16 player_id,
+                                     const PlayerUnitConfig &amp;unit_config)
+{
+    iXY next_loc;
+    UnitBase *unit;
+    unsigned long unit_type_index;
+    unsigned long unit_spawn_count;
+    unsigned long unit_spawn_index;
+
+    NetMessageEncoder encoder;
+
+    unit_placement_matrix.reset( location );
+
+    for ( unit_type_index = 0; unit_type_index &lt; UnitProfileInterface::getNumUnitTypes(); unit_type_index++ ) {
+
+        unit_spawn_count = unit_config.getSpawnUnitCount( unit_type_index );
+        for ( unit_spawn_index = 0; unit_spawn_index &lt; unit_spawn_count; unit_spawn_index++ ) {
+            unit_placement_matrix.getNextEmptyLoc( &amp;next_loc );
+            unit = createUnit(unit_type_index, next_loc, player_id);
+
+            assert(unit != 0);
+            UnitRemoteCreate create_mesg(unit-&gt;player-&gt;getID(), unit-&gt;id,
+                    next_loc.x, next_loc.y, unit-&gt;unit_state.unit_type);
+            encoder.encodeMessage(&amp;create_mesg, sizeof(create_mesg));
+        } // ** for unit_spawn_index
+    } // ** for unit_type_index
+
+    encoder.sendEncodedMessage();
+}
+
+// ******************************************************************
+
+void
+UnitInterface::queryUnitsAt(std::vector&lt;UnitID&gt;&amp; working_list,
+        const iXY&amp; point, Uint16 player_id, unsigned char search_flags)
+{
+    for(Units::iterator i = units.begin(); i != units.end(); ++i) {
+        UnitBase* unit = i-&gt;second;
+        if(!unit-&gt;unit_state.bounds(point))
+            continue;
+
+        if(search_flags == _search_exclude_player
+                &amp;&amp; unit-&gt;player-&gt;getID() == player_id)
+            continue;
+        if(search_flags == _search_player
+                &amp;&amp; unit-&gt;player-&gt;getID() != player_id)
+            continue;
+
+        working_list.push_back(unit-&gt;id);
+    }
+}
+
+// ******************************************************************
+
+void
+UnitInterface::queryUnitsAt(std::vector&lt;UnitID&gt;&amp; working_list,
+        const iRect&amp; rect, Uint16 player_id, unsigned char search_flags)
+{
+    for(Units::iterator i = units.begin(); i != units.end(); ++i) {
+        UnitBase* unit = i-&gt;second;
+        if(!rect.contains(unit-&gt;unit_state.location))
+            continue;
+
+        if(search_flags == _search_exclude_player
+                &amp;&amp; unit-&gt;player-&gt;getID() == player_id)
+            continue;
+        if(search_flags == _search_player
+                &amp;&amp; unit-&gt;player-&gt;getID() != player_id)
+            continue;
+
+        working_list.push_back(unit-&gt;id);
+    }
+}
+
+/****************************************************************************/
+
+bool UnitInterface::queryClosestUnit( UnitBase **closest_unit_ptr,
+                                       iXY &amp;loc, Uint16 player_id,
+                                       unsigned char search_flags )
+{
+    long closest_magnitude = 0;
+    UnitBase* closest_unit = 0;
+
+    for(Units::iterator i = units.begin(); i != units.end(); ++i) {
+        UnitBase* unit = i-&gt;second;
+
+        if(search_flags == _search_exclude_player
+                &amp;&amp; unit-&gt;player-&gt;getID() == player_id)
+            continue;
+        if(search_flags == _search_player
+                &amp;&amp; unit-&gt;player-&gt;getID() != player_id)
+            continue;
+
+        iXY delta;
+        long temp_mag;
+
+        if ( closest_unit == 0 ) {
+            closest_unit = unit;
+            delta  = loc - unit-&gt;unit_state.location;
+            closest_magnitude = long(delta.mag2());
+        } else {
+            delta  = loc - unit-&gt;unit_state.location;
+            temp_mag = long(delta.mag2());
+            
+            if ( closest_magnitude &gt; temp_mag ) {
+                closest_unit = unit;
+                closest_magnitude = temp_mag;
+            }
+        }
+    }
+
+    if(closest_unit != 0) {
+        *closest_unit_ptr = closest_unit;
+        return true;
+    }
+
+    *closest_unit_ptr = 0;
+    return false;
+}
+
+bool UnitInterface::queryClosestUnit( UnitBase **closest_unit_ptr, iRect &amp;bounding_rect, iXY &amp;loc )
+{
+    UnitBase *closest_unit = 0;
+    long closest_magnitude = 0;
+    iRect bucket_rect;
+    UnitBucketList *bucket_list;
+    UnitBucketPointer *traversal_ptr;
+
+    bucket_rect = unit_bucket_array.worldRectToBucketRect( bounding_rect );
+
+    for( long row_index = bucket_rect.min.y; row_index &lt;= bucket_rect.max.y; row_index++ ) {
+        for( long column_index = bucket_rect.min.x; column_index &lt;= bucket_rect.max.x; column_index++ ) {
+            bucket_list = unit_bucket_array.getBucket( row_index, column_index );
+
+            traversal_ptr = bucket_list-&gt;getFront();
+
+            while( traversal_ptr != 0 ) {
+                iXY delta;
+                long temp_mag;
+
+                if ( closest_unit == 0 ) {
+                    closest_unit = traversal_ptr-&gt;unit;
+                    delta  = loc - traversal_ptr-&gt;unit-&gt;unit_state.location;
+                    closest_magnitude = long(delta.mag2());
+                } else {
+                    delta  = loc - traversal_ptr-&gt;unit-&gt;unit_state.location;
+                    temp_mag = long(delta.mag2());
+
+                    if ( closest_magnitude &gt; temp_mag ) {
+                        closest_unit = traversal_ptr-&gt;unit;
+                        closest_magnitude = temp_mag;
+                    }
+                }
+
+                traversal_ptr = traversal_ptr-&gt;next;
+            }
+        }
+    }
+
+    if( closest_unit != 0 ) {
+        *closest_unit_ptr = closest_unit;
+        return true;
+    }
+
+    *closest_unit_ptr = 0;
+    return false;
+}
+
+// ******************************************************************
+
+bool UnitInterface::queryClosestEnemyUnit(UnitBase **closest_unit_ptr,
+        iXY &amp;loc, Uint16 player_index)
+{
+    UnitBase *closest_unit = 0;
+    long closest_magnitude = 0;
+
+    for(Units::iterator i = units.begin(); i != units.end(); ++i) {
+        UnitBase* unit = i-&gt;second;
+        Uint16 unitPlayerID = unit-&gt;player-&gt;getID();
+        
+        if(unitPlayerID == player_index
+                || PlayerInterface::isAllied(player_index, unitPlayerID))
+            continue;
+
+        iXY delta;
+        long temp_mag;
+
+        if ( closest_unit == 0 ) {
+            closest_unit = unit;
+            delta  = loc - unit-&gt;unit_state.location;
+            closest_magnitude = long(delta.mag2());
+        } else {
+            delta  = loc - unit-&gt;unit_state.location;
+            temp_mag = long(delta.mag2());
+            
+            if ( closest_magnitude &gt; temp_mag ) {
+                closest_unit = unit;
+                closest_magnitude = temp_mag;
+            }
+        }
+    }
+
+    if( closest_unit != 0 ) {
+        *closest_unit_ptr = closest_unit;
+        return true;
+    }
+
+    *closest_unit_ptr = 0;
+    return false;
+}
+
+// ******************************************************************
+
+unsigned char UnitInterface::queryUnitLocationStatus(iXY loc)
+{
+    Uint16 player_id = PlayerInterface::getLocalPlayerIndex();
+
+    std::vector&lt;UnitID&gt; locUnits;
+    queryUnitsAt(locUnits, loc, player_id, 0);
+    if(locUnits.size() == 0) {
+        return _no_unit_found;
+    }
+
+    UnitID id = locUnits[0];
+    UnitBase* unit = getUnit(id);
+    if(!unit) {
+        return _no_unit_found;
+    }
+    if(unit-&gt;player-&gt;getID() == player_id) {
+        return _unit_player;
+    }
+    if(PlayerInterface::isAllied(player_id, unit-&gt;player-&gt;getID())) {
+        return _unit_allied;
+    }
+
+    return _unit_enemy;
+}
+
+// ******************************************************************
+
+bool UnitInterface::queryUnitAtMapLoc(iXY map_loc, UnitID *queary_unit_id)
+{
+    iXY unit_map_loc;
+
+    for(Units::iterator i = units.begin(); i != units.end(); ++i) {
+        UnitBase* unit = i-&gt;second;
+        UnitState* unit_state = &amp; unit-&gt;unit_state;
+            
+        MapInterface::pointXYtoMapXY( unit_state-&gt;location, &amp;unit_map_loc );
+        if( map_loc == unit_map_loc ) {
+            *queary_unit_id = unit-&gt;id;
+            return true;
+        }
+    }
+
+    return false;
+}
+
+// ******************************************************************
+
+void UnitInterface::processManagerMessage(const UnitMessage* message)
+{
+    switch(message-&gt;message_id) {
+        case _umesg_end_lifecycle:
+            unitManagerMesgEndLifecycle(message);
+            break;
+        default:
+            LOGGER.warning(&quot;Unknown unit Manage Message type (%u).&quot;,
+                    message-&gt;message_id);
+#ifdef DEBUG
+            assert(false);
+#endif
+    }
+}
+
+// ******************************************************************
+
+void UnitInterface::unitManagerMesgEndLifecycle(const UnitMessage* message)
+{
+    const UMesgEndLifeCycleUpdate *lifecycle_update
+        = (const UMesgEndLifeCycleUpdate *) message;
+
+    UnitBase* unit1 = getUnit(lifecycle_update-&gt;getDestroyer());
+    UnitBase* unit2 = getUnit(lifecycle_update-&gt;getDestroyed());
+    if(unit1 == 0 || unit2 == 0) {
+        LOGGER.warning(
+                &quot;Unit in EndLifeCycle message doesn't exist anymore&quot;
+                &quot;(u1: %u u2: %u)&quot;, lifecycle_update-&gt;getDestroyer(),
+                lifecycle_update-&gt;getDestroyed());
+        return;
+    }
+    PlayerState* player1 = unit1-&gt;player;
+    PlayerState* player2 = unit2-&gt;player;
+
+    int unittype1 = unit1-&gt;unit_state.unit_type;
+    const std::string&amp; unitname1 = 
+        UnitProfileInterface::getUnitProfile(unittype1)-&gt;unitname;
+    int unittype2 = unit2-&gt;unit_state.unit_type;
+    const std::string&amp; unitname2 =
+        UnitProfileInterface::getUnitProfile(unittype2)-&gt;unitname;
+    if(Console::server) {
+        *Console::server &lt;&lt; &quot;'&quot; &lt;&lt; player1-&gt;getName() &lt;&lt; &quot;' killed a '&quot;
+            &lt;&lt; unitname2 &lt;&lt; &quot;' from '&quot; &lt;&lt; player2-&gt;getName() 
+            &lt;&lt; &quot;' with his '&quot; &lt;&lt; unitname1 &lt;&lt; &quot;'.&quot; &lt;&lt; std::endl;
+    }
+
+    // killing own units doesn't give score
+    if(player1 != player2) {
+        PlayerInterface::setKill(unit1-&gt;player, unit2-&gt;player,
+                (UnitType) lifecycle_update-&gt;unit_type);
+        
+        PlayerScoreUpdate score_update;
+        score_update.set(player1-&gt;getID(), player2-&gt;getID(),
+                (UnitType) lifecycle_update-&gt;unit_type);
+        SERVER-&gt;broadcastMessage(&amp;score_update, sizeof(PlayerScoreUpdate));
+    }
+}
+
+
+// ******************************************************************
+
+void UnitInterface::unitSyncMessage(const NetMessage *net_message)
+{
+    const UnitIniSyncMessage* sync_message 
+        = (const UnitIniSyncMessage *) net_message;
+
+    try {
+        std::map&lt;UnitID, UnitBase*&gt;::iterator uit = units.find(sync_message-&gt;getUnitID());
+        if ( uit != units.end() ) {
+            LOGGER.warning(&quot;UnitInterface::unitSyncMessage() Received an existing unit [%d]&quot;,
+                            sync_message-&gt;getUnitID());
+            return;
+        }
+        UnitBase* unit = newUnit(sync_message-&gt;unit_type,
+                iXY(sync_message-&gt;getLocX(), sync_message-&gt;getLocY()),
+                sync_message-&gt;getPlayerID(), sync_message-&gt;getUnitID());
+        unit-&gt;in_sync_flag = false;
+        addNewUnit(unit);
+    } catch(std::exception&amp; e) {
+        LOGGER.warning(&quot;UnitInterface::unitSyncMessage() Couldn't sync unit '%s'&quot;, e.what());
+    }
+}
+
+// ******************************************************************
+
+void UnitInterface::unitOpcodeMessage(const NetMessage *net_message)
+{
+    UnitOpcodeDecoder decoder;
+    decoder.setMessage(net_message);
+
+    UnitOpcode* opcode;
+    while(decoder.decode(&amp;opcode)) {
+        UnitBase* unit = getUnit(opcode-&gt;getUnitID());
+
+        if(!unit) {
+            LOGGER.debug(&quot;Update for non-existant unit: %d&quot;,
+                    opcode-&gt;getUnitID());
+            continue;
+        }
+        
+        unit-&gt;evalCommandOpcode(opcode);
+    }
+}
+
+// ******************************************************************
+
+void UnitInterface::unitDestroyMessage(const NetMessage *net_message)
+{
+    const UnitRemoteDestroy* remote_destroy 
+        = (const UnitRemoteDestroy *) net_message;
+
+    Units::iterator i = units.find(remote_destroy-&gt;getUnitToDestroy());
+    if(i != units.end()) {
+        removeUnit(i);
+    }
+}
+
+// ******************************************************************
+
+void UnitInterface::unitCreateMessage(const NetMessage* net_message)
+{
+    const UnitRemoteCreate* create_mesg 
+        = (const UnitRemoteCreate *) net_message;
+
+    Uint16 player_index = create_mesg-&gt;getPlayerID();
+
+    try {
+        std::map&lt;UnitID, UnitBase*&gt;::iterator uit = units.find(create_mesg-&gt;getUnitID());
+        if ( uit != units.end() ) {
+            LOGGER.warning(&quot;UnitInterface::unitCreateMessage() Received an existing unit [%d]&quot;,
+                            create_mesg-&gt;getUnitID());
+            return;
+        }
+        UnitBase* unit = newUnit(create_mesg-&gt;unit_type,
+                iXY(create_mesg-&gt;getLocX(), create_mesg-&gt;getLocY()),
+                player_index,
+                create_mesg-&gt;getUnitID());
+        addNewUnit(unit);
+    } catch(std::exception&amp; e) {
+        LOGGER.warning(&quot;UnitInterface::unitSyncMessage() Couldn't create new unit '%s'&quot;, e.what());
+    }
+}
+
+// ******************************************************************
+
+void UnitInterface::unitSyncIntegrityCheckMessage(const NetMessage* )
+{
+    sortBucketArray();
+}
+
+// ******************************************************************
+void UnitInterface::processNetMessage(const NetMessage* net_message)
+{
+    switch(net_message-&gt;message_id)  {
+        case _net_message_id_ini_sync_mesg:
+            unitSyncMessage(net_message);
+            break;
+
+        case _net_message_id_opcode_mesg:
+            unitOpcodeMessage(net_message);
+            break;
+
+        case _net_message_id_destroy_unit:
+            unitDestroyMessage(net_message);
+            break;
+
+        case _net_message_id_create_unit:
+            unitCreateMessage(net_message);
+            break;
+
+        case _net_message_id_unit_sync_integrity_check:
+            unitSyncIntegrityCheckMessage(net_message);
+            break;
+
+        default:
+            LOGGER.warning(&quot;Unknown message id in UnitMessage (%d)&quot;,
+                    net_message-&gt;message_id);
+#ifdef DEBUG
+            assert(false);
+#endif
+            break;
+    }
+}
+
+// ******************************************************************
+
+void UnitInterface::destroyPlayerUnits(Uint16 player_id)
+{
+    UMesgSelfDestruct self_destruct;
+    self_destruct.setHeader(0, _umesg_flag_unique);
+
+    PlayerUnitList&amp; unitlist = playerUnitLists[player_id];
+    for(PlayerUnitList::iterator i = unitlist.begin();
+            i != unitlist.end(); ++i) {
+        UnitBase* unit = *i;
+        unit-&gt;processMessage(&amp;self_destruct);
+    }
+}
+

Copied: trunk/netpanzer/src/NetPanzer/Units/UnitInterface.hpp (from rev 1049, trunk/netpanzer/src/NetPanzer/Interfaces/UnitInterface.hpp)
===================================================================
--- trunk/netpanzer/src/NetPanzer/Interfaces/UnitInterface.hpp	2008-09-09 15:53:32 UTC (rev 1049)
+++ trunk/netpanzer/src/NetPanzer/Units/UnitInterface.hpp	2008-09-09 16:30:13 UTC (rev 1050)
@@ -0,0 +1,186 @@
+/*
+Copyright (C) 1998 Pyrosoft Inc. (www.pyrosoftgames.com), Matthew Bogue
+ 
+This program is free software; you can redistribute it and/or modify
+it under the terms of the GNU General Public License as published by
+the Free Software Foundation; either version 2 of the License, or
+(at your option) any later version.
+ 
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+ 
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
+*/
+#ifndef _UNITINTERFACE_HPP
+#define _UNITINTERFACE_HPP
+
+#include &lt;vector&gt;
+#include &lt;map&gt;
+#include &quot;Units/UnitList.hpp&quot;
+#include &quot;Units/UnitBucketArray.hpp&quot;
+#include &quot;Classes/UnitMessage.hpp&quot;
+#include &quot;Classes/PlayerState.hpp&quot;
+#include &quot;Util/Timer.hpp&quot;
+#include &quot;Classes/PlacementMatrix.hpp&quot;
+
+#include &quot;Classes/Network/UnitNetMessage.hpp&quot;
+#include &quot;Units/UnitOpcodeEncoder.hpp&quot;
+
+enum { _search_all_players,
+       _search_player,
+       _search_exclude_player,
+       _search_enemy_only };
+
+enum { _no_unit_found, _unit_player, _unit_allied, _unit_enemy };
+
+class NetPacket;
+
+class UnitInterface
+{
+public:
+    typedef std::map&lt;UnitID, UnitBase*&gt; Units;
+    typedef std::vector&lt;UnitBase*&gt; PlayerUnitList;
+    
+private:
+    static Units units;
+    static PlayerUnitList* playerUnitLists;
+        
+    static UnitBucketArray unit_bucket_array;
+    static unsigned short max_players;
+    static size_t units_per_player;
+    static PlacementMatrix unit_placement_matrix;
+
+    static Uint16 lastUnitID;
+    static UnitID newUnitID();
+
+    static UnitBase* newUnit(unsigned short unit_type,
+                             const iXY &amp;location,
+                             unsigned short player_index,
+                             UnitID id);
+    static void addNewUnit(UnitBase *unit);
+    static void removeUnit(Units::iterator i);
+
+    static void sortBucketArray();
+
+public:
+    static void initialize( unsigned long max_units );
+    static void cleanUp();
+    static void reset();
+
+    static const Units&amp; getUnits()
+    {
+        return units;
+    }
+
+    static const PlayerUnitList&amp; getPlayerUnits(Uint16 player_id)
+    {
+        assert(player_id &lt; max_players);
+        return playerUnitLists[player_id];
+    }
+
+#if 0
+    static UnitList * getUnitList(size_t player)
+    {
+        assert( (player &lt; max_players) );
+        return ( &amp;unit_lists[ player ] );
+    }
+#endif
+
+    static size_t getUnitCount(unsigned short player_index)
+    {
+        assert( (player_index &lt; max_players) );
+        return playerUnitLists[player_index].size();
+    }
+
+    static size_t getTotalUnitCount()
+    {
+        return units.size();
+    }
+
+    static UnitBase* getUnit(UnitID unit_id);
+
+    static void processNetPacket(const NetPacket* packet);
+    static void sendMessage(const UnitMessage* message,
+            const PlayerState* player = 0);
+
+    static void updateUnitStatus();
+
+    static void offloadGraphics( SpriteSorter &amp;sorter );
+
+    static UnitBase* createUnit( unsigned short unit_type,
+                                  const iXY &amp;location,
+                                  Uint16 player_id);
+
+    static void spawnPlayerUnits( const iXY &amp;location,
+                                  Uint16 player_id,
+                                  const PlayerUnitConfig &amp;unit_config );
+
+    static void queryUnitsAt(std::vector&lt;UnitID&gt;&amp; working_list,
+                             const iXY&amp; point, Uint16 player_id,
+                             unsigned char search_flags);
+
+    static void queryUnitsAt(std::vector&lt;UnitID&gt;&amp; working_list,
+                            const iRect&amp; rect, Uint16 player_id,
+                            unsigned char search_flags);
+
+    static bool queryClosestUnit( UnitBase **closest_unit_ptr,
+                                   iXY &amp;loc,
+                                   Uint16 player_id,
+                                   unsigned char search_flags );
+
+    static bool queryClosestUnit( UnitBase **closest_unit_ptr,
+                                   iRect &amp;bounding_rect,
+                                   iXY &amp;loc );
+
+    static bool queryClosestEnemyUnit(UnitBase **closest_unit_ptr,
+                                      iXY &amp;loc,
+                                      Uint16 player_index);
+
+    static bool queryUnitAtMapLoc( iXY map_loc, UnitID *query_unit_id );
+
+    static unsigned char queryUnitLocationStatus( iXY loc );
+
+protected:
+    // Unit Message Handler Methods
+    static void processManagerMessage(const UnitMessage *message);
+    static void unitManagerMesgEndLifecycle(const UnitMessage *message);
+
+protected:
+    friend class Vehicle;
+    
+    // Network Message Handler Variables
+    static Timer message_timer;
+    static Timer no_guarantee_message_timer;
+    static UnitOpcodeEncoder opcode_encoder;
+
+    // Network Message Handler Methods
+    static void sendOpcode(const UnitOpcode* opcode)
+    {
+        opcode_encoder.encode(opcode);
+    }
+
+    static void unitSyncMessage(const NetMessage *net_message );
+    static void unitOpcodeMessage(const NetMessage *net_message );
+    static void unitDestroyMessage(const NetMessage *net_message );
+    static void unitCreateMessage(const NetMessage *net_message );
+    static void unitSyncIntegrityCheckMessage(const NetMessage *net_message );
+
+protected:
+    static unsigned long  sync_units_iterator;
+    static bool	      sync_units_complete_flag;
+    static unsigned short sync_units_list_index;
+    static Timer	  sync_units_packet_timer;
+    static unsigned long  sync_units_in_sync_count;
+    static unsigned long  sync_units_in_sync_partial_count;
+    static unsigned long  sync_units_total_units;
+
+public:
+    static void processNetMessage(const NetMessage *net_message );
+    static void destroyPlayerUnits(Uint16 player_id);
+};
+
+#endif // ** _UNITINTERFACE_HPP

Copied: trunk/netpanzer/src/NetPanzer/Units/UnitLifecycles.hpp (from rev 1049, trunk/netpanzer/src/NetPanzer/Classes/UnitLifecycles.hpp)

Copied: trunk/netpanzer/src/NetPanzer/Units/UnitList.hpp (from rev 1049, trunk/netpanzer/src/NetPanzer/Classes/UnitList.hpp)
===================================================================
--- trunk/netpanzer/src/NetPanzer/Classes/UnitList.hpp	2008-09-09 15:53:32 UTC (rev 1049)
+++ trunk/netpanzer/src/NetPanzer/Units/UnitList.hpp	2008-09-09 16:30:13 UTC (rev 1050)
@@ -0,0 +1,223 @@
+/*
+Copyright (C) 1998 Pyrosoft Inc. (www.pyrosoftgames.com), Matthew Bogue
+ 
+This program is free software; you can redistribute it and/or modify
+it under the terms of the GNU General Public License as published by
+the Free Software Foundation; either version 2 of the License, or
+(at your option) any later version.
+ 
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+ 
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
+*/
+#ifndef _UNITLIST_HPP
+#define _UNITLIST_HPP
+
+#include &lt;vector&gt;
+#include &lt;algorithm&gt;
+#include &lt;assert.h&gt;
+
+#include &quot;Units/UnitBase.hpp&quot;
+
+#if 0
+
+class UnitList
+{
+private:
+    class IdUnit
+    {
+    public:
+	IdUnit(UnitBase* newunit, size_t newid)
+	    : unit(newunit), id(newid)
+	{
+	}
+
+        bool operator&lt; (const IdUnit&amp; otherunitid) const
+        {
+            return id &lt; otherunitid.id;
+        }
+
+	bool operator&lt; (const size_t&amp; compareid) const
+	{
+	    return id &lt; compareid;
+	}
+
+	bool operator == (const size_t&amp; compareid) const
+	{
+	    return id == compareid;
+	}
+
+	UnitBase* unit;
+	size_t id;
+    };
+    
+    std::vector&lt;IdUnit&gt; unitlist;
+    size_t unitlistsize;
+    typedef std::vector&lt;IdUnit&gt;::iterator unititerator;
+    typedef std::vector&lt;IdUnit&gt;::const_iterator const_unititerator;
+    
+public:
+    class iterator
+    {
+    public:
+	iterator&amp; operator++ ()
+	{
+	    ++i;
+	    return *this;
+	}
+
+	UnitBase* operator*() const
+	{
+	    return i-&gt;unit;
+	}
+
+	UnitBase* operator-&gt;() const
+	{
+	    return i-&gt;unit;
+	}
+
+	bool operator!=(const iterator&amp; other) const
+	{
+	    return i != other.i;
+	}
+
+	bool operator== (const iterator&amp; other) const
+	{
+	    return i == other.i;
+	}
+	
+    private:
+	friend class UnitList;
+	iterator(unititerator newi)
+	    : i(newi)
+	{
+	}
+	unititerator i;
+    };
+
+    class AsyncIterator 
+    {
+    public:
+        UnitBase* next()
+        {
+            unititerator i
+                = std::lower_bound(unitlist-&gt;unitlist.begin(),
+                        unitlist-&gt;unitlist.end(), IdUnit(0, currentid));
+            if(i == unitlist-&gt;unitlist.end())
+                return 0;
+            UnitBase* unit = i-&gt;unit;
+
+            currentid = i-&gt;id + 1;
+	    
+            return unit;
+        }
+
+    private:
+        friend class UnitList;
+        AsyncIterator(UnitList* newunitlist, size_t startid)
+            : currentid(startid), unitlist(newunitlist)             
+        {
+        }
+        
+        size_t currentid;
+        UnitList* unitlist;
+    };
+    
+    UnitList()
+	: unitlistsize(0)
+    { }
+
+    iterator begin()
+    {
+	return iterator(unitlist.begin());
+    }
+
+    iterator end()
+    {
+	return iterator(unitlist.end());
+    }
+
+    AsyncIterator getAsyncIterator()
+    {
+        return AsyncIterator(this, 0);
+    }
+
+    UnitBase* operator[] (size_t index) const
+    {
+	const_unititerator i 
+	    = std::lower_bound(unitlist.begin(), unitlist.end(), index);
+	if(i == unitlist.end() || i-&gt;id != index)
+            return 0;
+        
+	return i-&gt;unit;
+    }
+
+    void insert(UnitBase *unit, size_t index)
+    {
+	unititerator i 
+            = std::lower_bound(unitlist.begin(), unitlist.end(), index);
+
+        unitlist.insert(i, IdUnit(unit, index));
+	++unitlistsize;
+    }
+
+    void insert(UnitBase *unit, const UnitID &amp;unitID)
+    {
+	insert(unit, unitID.getIndex());
+    }
+
+    /** remember that erasing invalidates all existing iterators over the
+     * list. The only valid iterator is the returned from this function (which
+     * points to the next elements after the one removed)
+     */
+    iterator erase(iterator i)
+    {
+	--unitlistsize;
+	return unitlist.erase(i.i);
+    }
+
+    bool contains(size_t index) const
+    {
+	const_unititerator i 
+	    = std::lower_bound(unitlist.begin(), unitlist.end(), index);
+
+	return i != unitlist.end();
+    }
+
+    bool contains(const UnitID &amp;unitID) const
+    {
+	return contains(unitID.getIndex());
+    }
+
+    iterator find(size_t index)
+    {
+	unititerator i
+	    = std::lower_bound(unitlist.begin(), unitlist.end(), index);
+	
+	if(i == unitlist.end() || i-&gt;id != index)
+	    i = unitlist.end();
+
+	return iterator(i);
+    }
+
+    void clear()
+    {
+	unitlist.clear();
+        unitlistsize = 0;
+    }
+
+    size_t size() const
+    {
+	return unitlistsize;
+    }
+};
+
+#endif
+
+#endif
+

Copied: trunk/netpanzer/src/NetPanzer/Units/UnitOpcodeDecoder.cpp (from rev 1049, trunk/netpanzer/src/NetPanzer/Classes/UnitOpcodeDecoder.cpp)

Copied: trunk/netpanzer/src/NetPanzer/Units/UnitOpcodeDecoder.hpp (from rev 1049, trunk/netpanzer/src/NetPanzer/Classes/UnitOpcodeDecoder.hpp)
===================================================================
--- trunk/netpanzer/src/NetPanzer/Classes/UnitOpcodeDecoder.hpp	2008-09-09 15:53:32 UTC (rev 1049)
+++ trunk/netpanzer/src/NetPanzer/Units/UnitOpcodeDecoder.hpp	2008-09-09 16:30:13 UTC (rev 1050)
@@ -0,0 +1,41 @@
+/*
+Copyright (C) 1998 Pyrosoft Inc. (www.pyrosoftgames.com), Matthew Bogue
+ 
+This program is free software; you can redistribute it and/or modify
+it under the terms of the GNU General Public License as published by
+the Free Software Foundation; either version 2 of the License, or
+(at your option) any later version.
+ 
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+ 
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
+*/
+#ifndef __UNITOPCODEDECODER_HPP__
+#define __UNITOPCODEDECODER_HPP__
+
+#include &quot;Units/UnitOpcodes.hpp&quot;
+#include &quot;Classes/Network/UnitNetMessage.hpp&quot;
+
+class UnitOpcodeDecoder
+{
+private:
+    UnitOpcodeMessage opcode_message;
+    size_t opcode_index;
+
+    void reset();
+    
+public:
+    UnitOpcodeDecoder();
+    ~UnitOpcodeDecoder();
+    
+    void setMessage(const NetMessage* message);
+    bool decode(UnitOpcode** opcode);
+};
+
+#endif
+

Copied: trunk/netpanzer/src/NetPanzer/Units/UnitOpcodeEncoder.cpp (from rev 1049, trunk/netpanzer/src/NetPanzer/Classes/UnitOpcodeEncoder.cpp)
===================================================================
--- trunk/netpanzer/src/NetPanzer/Classes/UnitOpcodeEncoder.cpp	2008-09-09 15:53:32 UTC (rev 1049)
+++ trunk/netpanzer/src/NetPanzer/Units/UnitOpcodeEncoder.cpp	2008-09-09 16:30:13 UTC (rev 1050)
@@ -0,0 +1,66 @@
+/*
+Copyright (C) 1998 Pyrosoft Inc. (www.pyrosoftgames.com), Matthew Bogue
+ 
+This program is free software; you can redistribute it and/or modify
+it under the terms of the GNU General Public License as published by
+the Free Software Foundation; either version 2 of the License, or
+(at your option) any later version.
+ 
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+ 
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
+*/
+#include &lt;config.h&gt;
+
+#include &quot;Units/UnitOpcodeEncoder.hpp&quot;
+#include &quot;Classes/Network/NetworkServer.hpp&quot;
+#include &quot;Classes/Network/NetworkState.hpp&quot;
+#include &quot;Interfaces/ConsoleInterface.hpp&quot;
+#include &quot;Classes/OpcodeDebugger.hpp&quot;
+#include &quot;Classes/Network/UnitNetMessage.hpp&quot;
+#include &quot;Util/Log.hpp&quot;
+
+UnitOpcodeEncoder::UnitOpcodeEncoder()
+{
+    reset();
+}
+
+UnitOpcodeEncoder::~UnitOpcodeEncoder()
+{
+}
+
+void
+UnitOpcodeEncoder::reset()
+{
+    opcode_index = 0;
+}
+
+void
+UnitOpcodeEncoder::encode(const UnitOpcode *opcode)
+{
+    if(opcode_index + UnitOpcode::getSize() &gt; sizeof(opcode_message.data)) {
+        send();
+    }
+   
+    memcpy(opcode_message.data + opcode_index, opcode, UnitOpcode::getSize());
+    opcode_index += UnitOpcode::getSize();
+}
+
+void
+UnitOpcodeEncoder::send()
+{
+    if (!opcode_index)
+        return;
+
+    size_t size = opcode_message.getHeaderSize() + opcode_index;
+    SERVER-&gt;broadcastMessage(&amp;opcode_message, size);
+
+    reset();
+    NetworkState::incOpcodesSent();
+}
+

Copied: trunk/netpanzer/src/NetPanzer/Units/UnitOpcodeEncoder.hpp (from rev 1049, trunk/netpanzer/src/NetPanzer/Classes/UnitOpcodeEncoder.hpp)
===================================================================
--- trunk/netpanzer/src/NetPanzer/Classes/UnitOpcodeEncoder.hpp	2008-09-09 15:53:32 UTC (rev 1049)
+++ trunk/netpanzer/src/NetPanzer/Units/UnitOpcodeEncoder.hpp	2008-09-09 16:30:13 UTC (rev 1050)
@@ -0,0 +1,40 @@
+/*
+Copyright (C) 1998 Pyrosoft Inc. (www.pyrosoftgames.com), Matthew Bogue
+ 
+This program is free software; you can redistribute it and/or modify
+it under the terms of the GNU General Public License as published by
+the Free Software Foundation; either version 2 of the License, or
+(at your option) any later version.
+ 
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+ 
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
+*/
+#ifndef _UNITOPCODEENCODER_HPP
+#define _UNITOPCODEENCODER_HPP
+
+#include &quot;Units/UnitOpcodes.hpp&quot;
+#include &quot;Classes/Network/UnitNetMessage.hpp&quot;
+
+class UnitOpcodeEncoder
+{
+private:
+    UnitOpcodeMessage opcode_message;
+    size_t opcode_index;
+
+    void reset();
+
+public:
+    UnitOpcodeEncoder();
+    ~UnitOpcodeEncoder();
+    
+    void encode(const UnitOpcode *opcode);
+    void send();
+};
+
+#endif

Copied: trunk/netpanzer/src/NetPanzer/Units/UnitOpcodes.hpp (from rev 1049, trunk/netpanzer/src/NetPanzer/Classes/UnitOpcodes.hpp)
===================================================================
--- trunk/netpanzer/src/NetPanzer/Classes/UnitOpcodes.hpp	2008-09-09 15:53:32 UTC (rev 1049)
+++ trunk/netpanzer/src/NetPanzer/Units/UnitOpcodes.hpp	2008-09-09 16:30:13 UTC (rev 1050)
@@ -0,0 +1,295 @@
+/*
+Copyright (C) 1998 Pyrosoft Inc. (www.pyrosoftgames.com), Matthew Bogue
+ 
+This program is free software; you can redistribute it and/or modify
+it under the terms of the GNU General Public License as published by
+the Free Software Foundation; either version 2 of the License, or
+(at your option) any later version.
+ 
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+ 
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
+*/
+#ifndef _UNITOPCODES_HPP
+#define _UNITOPCODES_HPP
+
+#include &quot;Units/UnitBase.hpp&quot;
+#include &lt;queue&gt;
+
+enum { _unit_opcode_flag_sync = 0x01 };
+
+/** The following is a tricky macro to ensure a struct has a specific size. THe
+ * check is done at compiletime. The trick is that C doesn't allow duplicate
+ * case labels...
+ */
+#define ASSERT_SIZE(mystruct, size)                                     \
+    namespace TRICKYTESTS { static inline void mystruct##_test() {      \
+        int i=0; switch(i) { case 0: ; case (sizeof(mystruct) == (size)): ; } \
+    } }
+
+#ifdef MSVC
+#pragma pack(1)
+#endif
+
+// do not use this directly, cast to 1 of the UnitOpcode classes...
+struct UnitOpcodeStruct
+{
+public:
+    Uint8 opcode;
+private:
+    Uint16 unit_index;
+public:
+    Uint8 flags;
+private:
+    Uint8 op_data[7];
+} __attribute__((packed));
+
+typedef std::queue&lt;UnitOpcodeStruct&gt; UnitOpcodeQueue;
+
+class UnitOpcode
+{
+public:
+    Uint8 opcode;
+    //Uint8 player_index;
+private:
+    Uint16 unit_id;
+public:
+    Uint8 flags;
+
+    static size_t getSize()
+    {
+        return sizeof(UnitOpcodeStruct);
+    }
+
+    void setUnitID(UnitID id)
+    {
+        unit_id = htol16(id);
+    }
+
+    UnitID getUnitID() const
+    {
+        return ltoh16(unit_id);
+    }
+} __attribute__((packed));
+
+ASSERT_SIZE(UnitOpcode, sizeof(UnitOpcodeStruct)-7)
+
+#define _UNIT_OPCODE_MOVE 1
+
+class MoveOpcode : public UnitOpcode
+{
+private:
+    Uint32 square;
+
+public:
+    Sint8 loc_x_offset;
+    Sint8 loc_y_offset;
+    Uint8 pad[1];
+
+    MoveOpcode( )
+    {
+        flags = 0;
+        opcode = _UNIT_OPCODE_MOVE;
+
+        square = 0;
+        loc_x_offset = 0;
+        loc_y_offset = 0;
+        pad[0] = 0;
+    }
+
+    void setSquare(Uint32 square)
+    {
+        this-&gt;square = htol32(square);
+    }
+
+    Uint32 getSquare() const
+    {
+        return ltoh32(square);
+    }
+} __attribute__((packed));
+
+ASSERT_SIZE(MoveOpcode, 7 + sizeof(UnitOpcode))
+
+#define _UNIT_OPCODE_TURRET_TRACK_POINT 2
+
+class TurretTrackPointOpcode : public UnitOpcode
+{
+private:
+    Uint16 target_x;
+    Uint16 target_y;
+
+public:
+    Uint8  activate;
+    Uint8 pad[2];
+
+    TurretTrackPointOpcode( )
+    {
+        flags = 0;
+        opcode = _UNIT_OPCODE_TURRET_TRACK_POINT;
+
+        target_x = target_y = 0;
+        activate = false;
+        pad[0] = pad[1] = 0;
+    }
+
+    void setTarget(iXY pos)
+    {
+        target_x = htol16(pos.x);
+        target_y = htol16(pos.y);
+    }
+
+    iXY getTarget() const
+    {
+        return iXY(ltoh16(target_x), ltoh16(target_y));
+    }
+} __attribute__((packed));
+
+ASSERT_SIZE(TurretTrackPointOpcode, 7 + sizeof(UnitOpcode))
+
+#define _UNIT_OPCODE_TURRET_TRACK_TARGET 3
+
+class TurretTrackTargetOpcode : public UnitOpcode
+{
+private:
+    Uint16 targetUnitID;
+public:
+    Uint8 activate;
+    Uint8 pad[4];
+
+    TurretTrackTargetOpcode( )
+    {
+        flags = 0;
+        opcode = _UNIT_OPCODE_TURRET_TRACK_TARGET;
+
+        targetUnitID = 0;
+        activate = false;
+        pad[0] = pad[1] = pad[2] = pad[3] = 0;
+    }
+
+    void setTargetUnitID(UnitID id)
+    {
+        targetUnitID = htol16(id);
+    }
+    
+    UnitID getTargetUnitID() const
+    {
+        return ltoh16(targetUnitID);
+    }
+} __attribute__((packed));
+
+ASSERT_SIZE(TurretTrackTargetOpcode, 7 + sizeof(UnitOpcode))
+
+#define _UNIT_OPCODE_FIRE_WEAPON 4
+
+class FireWeaponOpcode : public UnitOpcode
+{
+private:
+    Uint16 x;
+    Uint16 y;
+    Uint8 pad[3];
+    
+public:
+
+    FireWeaponOpcode( )
+    {
+        flags = 0;
+        opcode = _UNIT_OPCODE_FIRE_WEAPON;
+
+        x = y = 0;
+        pad[0] = pad[1] = pad[2] = 0;
+    }
+
+    void setTarget(iXY target)
+    {
+        x = htol16(target.x);
+        y = htol16(target.y);
+    }
+
+    iXY getTarget() const
+    {
+        return iXY(ltoh16(x), ltoh16(y));
+    }
+} __attribute__((packed));
+
+ASSERT_SIZE(FireWeaponOpcode, 7 + sizeof(UnitOpcode))
+
+#define _UNIT_OPCODE_SYNC_UNIT 5
+
+class SyncUnitOpcode : public UnitOpcode
+{
+public:
+    Uint8 pad[7];
+
+    SyncUnitOpcode( )
+    {
+        flags = 0;
+        opcode = _UNIT_OPCODE_SYNC_UNIT;
+
+        for(int i=0;i&lt;7;i++)
+            pad[i] = 0;
+    }
+
+} __attribute__((packed));
+
+ASSERT_SIZE(SyncUnitOpcode, 7 + sizeof(UnitOpcode))
+
+#define _UNIT_OPCODE_UPDATE_STATE 6
+
+class UpdateStateUnitOpcode : public UnitOpcode
+{
+private:
+    Sint16 hit_points;
+public:
+    Uint8 pad[5];
+
+    UpdateStateUnitOpcode( )
+    {
+        flags = 0;
+        opcode = _UNIT_OPCODE_UPDATE_STATE;
+
+        for(int i=0; i&lt;5; i++)
+            pad[i] = 0;
+    }
+
+    void setHitPoints(Sint16 newhitpoints)
+    {
+        hit_points = htol16(newhitpoints);
+    }
+
+    Sint16 getHitPoints() const
+    {
+        return ltoh16(hit_points);
+    }
+} __attribute__((packed));
+
+ASSERT_SIZE(UpdateStateUnitOpcode, 7 + sizeof(UnitOpcode))
+
+#define _UNIT_OPCODE_DESTRUCT 7
+
+class DestructUnitOpcode : public UnitOpcode
+{
+public:
+    unsigned char pad[7];
+
+    DestructUnitOpcode( )
+    {
+        flags = 0;
+        opcode = _UNIT_OPCODE_DESTRUCT;
+
+        for(int i=0; i&lt;7; i++)
+            pad[i] = 0;
+    }
+} __attribute__((packed));
+
+ASSERT_SIZE(DestructUnitOpcode, 7 + sizeof(UnitOpcode))
+
+#ifdef MSVC
+#pragma pack()
+#endif
+
+#endif

Copied: trunk/netpanzer/src/NetPanzer/Units/UnitProfileInterface.cpp (from rev 1049, trunk/netpanzer/src/NetPanzer/Interfaces/UnitProfileInterface.cpp)
===================================================================
--- trunk/netpanzer/src/NetPanzer/Interfaces/UnitProfileInterface.cpp	2008-09-09 15:53:32 UTC (rev 1049)
+++ trunk/netpanzer/src/NetPanzer/Units/UnitProfileInterface.cpp	2008-09-09 16:30:13 UTC (rev 1050)
@@ -0,0 +1,452 @@
+/*
+Copyright (C) 1998 Pyrosoft Inc. (www.pyrosoftgames.com), Matthew Bogue
+ 
+This program is free software; you can redistribute it and/or modify
+it under the terms of the GNU General Public License as published by
+the Free Software Foundation; either version 2 of the License, or
+(at your option) any later version.
+ 
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+ 
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
+*/
+#include &lt;config.h&gt;
+
+#include &quot;Units/UnitProfileInterface.hpp&quot;
+#include &quot;Util/Exception.hpp&quot;
+#include &quot;Util/FileSystem.hpp&quot;
+#include &quot;Util/Log.hpp&quot;
+#include &lt;ctype.h&gt;
+#include &lt;memory&gt;
+#include &lt;string.h&gt;
+
+typedef
+struct
+{
+    char params[32][128];
+    short param_count;
+}
+parameter_list;
+
+#define _MAX_KEY_LENGTH 64
+
+char field_headers[28][64] =
+{ 
+    &quot;[TURRET_PLACEMENT]&quot;, &quot;[MOVE_OFFSET]&quot;, &quot;HITPOINTS&quot;,
+    &quot;ATTACK_FACTOR&quot;, &quot;RELOAD_TIME&quot;, &quot;REACTION_TIME&quot;, &quot;RANGE_MAX&quot;, &quot;REGEN_TIME&quot;,
+    &quot;DEFEND_RANGE&quot;, &quot;SPEED_RATE&quot;, &quot;SPEED_FACTOR&quot;, &quot;REPATH_TIME&quot;, &quot;FUEL_CAPACITY&quot;,
+    &quot;TRACKING_RATE&quot;, &quot;JAMM_ABLE&quot;, &quot;JAMMING_TIME&quot;, &quot;JAMMING_RANGE&quot;, &quot;FUELING_RANGE&quot;,
+    &quot;IMAGE&quot;,&quot;BODYSPRITE&quot;, &quot;BODYSHADOW&quot;, &quot;TURRETSPRITE&quot;, &quot;TURRETSHADOW&quot;, &quot;SOUNDSELECTED&quot;,
+    &quot;FIRESOUND&quot;, &quot;WEAPON&quot;, &quot;BOUNDBOX&quot;, 
+    &quot;END&quot;
+};
+
+enum
+{ 
+    _turret_place, _move_offset, _hit_points, _attack_x, _reload_time,
+    _react_time, _range_max, _regen_time, _defend_range, _speed_rate, _speed_factor, _repath_time, _fuel_capacity,
+    _tracking_rate, _jamm_able, _jamming_time, _jamming_range, _fueling_range,
+    _image, _bodysprite, _bodyshadow, _turretsprite, _turretshadow, _soundselected,
+    _firesound, _weapontype, _boundbox,
+    _end
+};
+
+short max_field_key = 28;
+
+
+//****************************************************************************************
+
+char * extract_spaces(char *string,int index)
+
+{
+    int i=0;
+    char *stroffset;
+
+    stroffset = string+index;
+
+    while( *(stroffset+i) == ' ' )/* extract leading spaces just encase */
+        i++;
+
+    return(stroffset+i);
+}
+
+//****************************************************************************************
+
+void find_keyword(char *string, int *command, char *key_list, char max_key_list )
+{
+    int comindex;    /* index to config commands */
+    short int notfound=1;
+    char *str;
+
+    str = extract_spaces(string,0);
+
+    for(comindex=0; ( (comindex &lt; max_key_list )  &amp;&amp; notfound); comindex++ ) {
+        notfound = strncasecmp( str, &amp;key_list[ comindex * _MAX_KEY_LENGTH ], strlen( &amp;key_list[ comindex * _MAX_KEY_LENGTH ]) );
+    }
+
+    comindex = comindex-1;
+
+    if ( (comindex == max_key_list - 1 ) &amp;&amp; (notfound != 0) ) /* Checks if no commands found */
+        *command = max_key_list;
+    else
+        *command = comindex;
+
+}
+//****************************************************************************************
+
+short extract_token( char *token, char **string )
+{
+    char token_char = ' ';
+    char *str;
+    short index = 0;
+    short token_index = 0;
+
+    str = *string;
+
+    str = extract_spaces( str, 0 );
+
+    while( (str[index] != 0) &amp;&amp; (str[ index ] != token_char) ) {
+        if (str[index] == '&quot;')
+            token_char = '&quot;';
+        else
+            if ( (str[index] != '\n') &amp;&amp; (str[index] != '\r') ) {
+                token[ token_index ] = str[index];
+                token_index++;
+            }
+
+        index++;
+    }
+
+    token[ token_index ] = 0;
+
+    *string = (str+index);
+
+    if(str[index] == 0)
+        *string = 0;
+
+    if ( token_index == 0 )
+        return (false);
+
+    return (true);
+
+}
+
+void string_to_params( char *string, parameter_list *params )
+{
+    params-&gt;param_count = 0;
+
+    if( extract_token( params-&gt;params[ params-&gt;param_count ], &amp;string ) )
+        params-&gt;param_count++;
+
+
+    while ( string != 0 ) {
+        if( extract_token( params-&gt;params[ params-&gt;param_count ], &amp;string ) )
+            params-&gt;param_count++;
+    }
+
+}
+
+
+void read_vehicle_profile(const std::string&amp; unitName, UnitProfile *profile)
+{
+    int field;
+    char temp_str[256];
+    parameter_list param_list;
+    int temp_int;
+    short not_done = true;
+
+    std::string file_path = &quot;units/profiles/&quot;;
+    file_path += unitName;
+    file_path += &quot;.pfl&quot;;
+
+    profile-&gt;unitname = unitName;
+    
+    try {
+	std::auto_ptr&lt;filesystem::ReadFile&gt; file(
+                filesystem::openRead(file_path));
+
+	while( not_done ) {
+	    for(int i=0; i&lt;256; i++)
+        {
+            file-&gt;read(&amp;(temp_str[i]), 1, 1);
+            if(temp_str[i] == '\n')
+            {
+                temp_str[i] = 0;
+                break;
+            }
+	    }
+        
+	    string_to_params( temp_str, &amp;param_list );
+	    find_keyword( param_list.params[0], &amp;field, (char * ) field_headers, max_field_key );
+
+	    switch(field) {
+		case _hit_points:
+		    {
+ 			sscanf( param_list.params[1], &quot;%d&quot;, &amp;temp_int );
+			profile-&gt;hit_points = (short) temp_int;
+		    }
+		    break;
+
+		case _attack_x:
+		    {
+   			sscanf( param_list.params[1], &quot;%d&quot;, &amp;temp_int );
+			profile-&gt;attack_factor = (short) temp_int;
+		    }
+		    break;
+
+		case _reload_time:
+		    {
+			sscanf( param_list.params[1], &quot;%d&quot;, &amp;temp_int );
+			profile-&gt;reload_time = (char) temp_int;
+		    }
+		    break;
+
+		case _react_time :
+		    {
+			sscanf( param_list.params[1], &quot;%d&quot;, &amp;temp_int );
+			profile-&gt;reaction_time = (char) temp_int;
+		    }
+		    break;
+
+		case _range_max : 
+		    {
+			sscanf( param_list.params[1], &quot;%d&quot;, &amp;temp_int );
+			profile-&gt;attack_range = (long) temp_int;
+		    }
+		    break;
+
+		case _regen_time: 
+		    {
+			sscanf( param_list.params[1], &quot;%d&quot;, &amp;temp_int );
+			profile-&gt;regen_time = (short) temp_int;
+		    }
+		    break;
+
+		case _defend_range: 
+		    {
+			sscanf( param_list.params[1], &quot;%d&quot;, &amp;temp_int );
+			profile-&gt;defend_range = (long) temp_int;
+		    }
+		    break;
+
+		case _speed_rate: 
+		    {
+			sscanf( param_list.params[1], &quot;%d&quot;, &amp;temp_int );
+			profile-&gt;speed_rate = (char) temp_int;
+		    }
+		    break;
+
+		case _speed_factor:
+		    {
+			sscanf( param_list.params[1], &quot;%d&quot;, &amp;temp_int );
+			profile-&gt;speed_factor = (char) temp_int;
+		    }
+		    break;
+
+		case _repath_time: 
+		    {
+			sscanf( param_list.params[1], &quot;%d&quot;, &amp;temp_int );
+			profile-&gt;repath_time = (char) temp_int;
+		    }
+		    break;
+
+		case _fuel_capacity:
+		    {
+			sscanf( param_list.params[1], &quot;%d&quot;, &amp;temp_int );
+			profile-&gt;fuel_capacity = (short ) temp_int;
+		    }
+		    break;
+
+		case _tracking_rate:
+		    {
+			sscanf( param_list.params[1], &quot;%d&quot;, &amp;temp_int );
+			profile-&gt;tracking_rate = (char) temp_int;
+		    }
+		    break;
+
+		case _jamm_able:
+		    {
+			sscanf( param_list.params[1], &quot;%d&quot;, &amp;temp_int );
+			profile-&gt;jammable = (char) temp_int;
+		    }
+		    break;
+
+		case _jamming_time:
+		    {
+			sscanf( param_list.params[1], &quot;%d&quot;, &amp;temp_int );
+			profile-&gt;jamming_time = (char) temp_int;
+		    }
+		    break;
+
+		case _jamming_range:
+		    {
+			sscanf( param_list.params[1], &quot;%d&quot;, &amp;temp_int );
+			profile-&gt;jamming_range = (long) temp_int;
+		    }
+		    break;
+
+		case _fueling_range:
+		    {
+			sscanf( param_list.params[1], &quot;%d&quot;, &amp;temp_int );
+			profile-&gt;fueling_range = (long) temp_int;
+		    }
+		    break;
+        
+        case _image:
+            profile-&gt;imagefile = param_list.params[1];
+            break;
+        
+        case _bodysprite:
+            profile-&gt;bodySprite.load(param_list.params[1]);
+            break;
+
+        case _bodyshadow:
+            profile-&gt;bodyShadow.load(param_list.params[1]);
+            break;
+            
+        case _turretsprite:
+            profile-&gt;turretSprite.load(param_list.params[1]);
+            break;
+
+        case _turretshadow:
+            profile-&gt;turretShadow.load(param_list.params[1]);
+            break;
+                
+        case _soundselected:
+            profile-&gt;soundSelected = param_list.params[1];
+            break;
+
+        case _firesound:
+            profile-&gt;fireSound = param_list.params[1];
+            break;
+            
+        case _weapontype:
+            profile-&gt;weaponType = param_list.params[1];
+            break;
+                
+        case _boundbox:
+            sscanf( param_list.params[1], &quot;%d&quot;, &amp;temp_int );
+            profile-&gt;boundBox = (short) temp_int;
+            break;
+                
+		case _end :
+		    {
+			not_done = false;
+		    }
+		    break;
+	    } // ** switch
+	} // ** while ( !feof )
+    } catch(std::exception&amp; e) {
+	throw Exception(&quot;Error while reading unitprofile '%s': %s&quot;,
+		file_path.c_str(), e.what());
+    }
+} // function
+
+vector&lt;UnitProfile *&gt; UnitProfileInterface::profiles;
+
+void
+UnitProfileInterface::clearProfiles()
+{
+    vector&lt;UnitProfile *&gt;::iterator i = profiles.begin();
+    while ( i != profiles.end() )
+    {
+        delete *i;
+        i++;
+    }
+    profiles.clear();
+}
+
+void UnitProfileInterface::loadUnitProfiles( void )
+{
+    clearProfiles();
+    UnitProfile * p;
+    
+    p = new UnitProfile();
+    read_vehicle_profile(&quot;Manta&quot;, p);
+    p-&gt;unit_type = profiles.size();
+    profiles.push_back(p);
+    
+    p = new UnitProfile();
+    read_vehicle_profile(&quot;Panther1&quot;, p);
+    p-&gt;unit_type = profiles.size();
+    profiles.push_back(p);
+
+    p = new UnitProfile();
+    read_vehicle_profile(&quot;Titan&quot;, p);
+    p-&gt;unit_type = profiles.size();
+    profiles.push_back(p);
+
+    p = new UnitProfile();
+    read_vehicle_profile(&quot;Stinger&quot;, p);
+    p-&gt;unit_type = profiles.size();
+    profiles.push_back(p);
+    
+    p = new UnitProfile();
+    read_vehicle_profile(&quot;Bobcat&quot;, p);
+    p-&gt;unit_type = profiles.size();
+    profiles.push_back(p);
+    
+    p = new UnitProfile();
+    read_vehicle_profile(&quot;Bear&quot;, p);
+    p-&gt;unit_type = profiles.size();
+    profiles.push_back(p);
+
+    p = new UnitProfile();
+    read_vehicle_profile(&quot;Archer&quot;, p);
+    p-&gt;unit_type = profiles.size();
+    profiles.push_back(p);
+
+    p = new UnitProfile();
+    read_vehicle_profile(&quot;Wolf&quot;, p);
+    p-&gt;unit_type = profiles.size();
+    profiles.push_back(p);
+    
+    p = new UnitProfile();
+    read_vehicle_profile(&quot;Drake&quot;, p);
+    p-&gt;unit_type = profiles.size();
+    profiles.push_back(p);
+
+    p = new UnitProfile();
+    read_vehicle_profile(&quot;SPanzer&quot;, p); // should be scout or humvee?
+    p-&gt;unit_type = profiles.size();
+    profiles.push_back(p);
+}
+
+UnitProfile * UnitProfileInterface::getUnitProfile( unsigned short unit_type )
+{
+    if ( unit_type &lt; profiles.size() )
+        return profiles[unit_type];
+    return 0;
+}
+
+UnitProfile *
+UnitProfileInterface::getProfileByName( const std::string &amp;name )
+{
+    vector&lt;UnitProfile *&gt;::iterator i = profiles.begin();
+    while ( i != profiles.end() )
+    {
+        if ( name.length() != (*i)-&gt;unitname.length() )
+        {
+            i++;
+            continue; // continue if size !=
+        }
+
+        std::string::size_type s = 0;
+        while ( s &lt; name.length()
+               &amp;&amp; toupper(name[s]) == toupper((*i)-&gt;unitname[s]) )
+        {
+            s++;
+        }
+        
+        if ( s == name.length() )
+            return *i;
+        
+        i++;
+    }
+    return 0; // null pointer warning
+}

Copied: trunk/netpanzer/src/NetPanzer/Units/UnitProfileInterface.hpp (from rev 1049, trunk/netpanzer/src/NetPanzer/Interfaces/UnitProfileInterface.hpp)
===================================================================
--- trunk/netpanzer/src/NetPanzer/Interfaces/UnitProfileInterface.hpp	2008-09-09 15:53:32 UTC (rev 1049)
+++ trunk/netpanzer/src/NetPanzer/Units/UnitProfileInterface.hpp	2008-09-09 16:30:13 UTC (rev 1050)
@@ -0,0 +1,82 @@
+/*
+Copyright (C) 1998 Pyrosoft Inc. (www.pyrosoftgames.com), Matthew Bogue
+ 
+This program is free software; you can redistribute it and/or modify
+it under the terms of the GNU General Public License as published by
+the Free Software Foundation; either version 2 of the License, or
+(at your option) any later version.
+ 
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+ 
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
+*/
+#ifndef _UNITPROFILEINTERFACE_HPP
+#define _UNITPROFILEINTERFACE_HPP
+
+#include &lt;string&gt;
+#include &lt;vector&gt;
+
+using namespace std;
+
+#include &quot;Units/UnitTypes.hpp&quot;
+#include &quot;Units/UnitState.hpp&quot;
+#include &quot;2D/PackedSurface.hpp&quot;
+
+class UnitProfile
+{
+public:
+    std::string unitname;
+    unsigned short unit_type;
+
+    short hit_points;
+    short attack_factor;
+    long  attack_range;
+    long  defend_range;
+    char  reaction_time;
+    char  speed_factor;
+    char  speed_rate;
+    char  tracking_rate;
+    short fuel_capacity;
+    char  reload_time;
+    char  repath_time;
+    short regen_time;
+    char  jammable;
+    char  jamming_time;
+    // ** for fuel truck only
+    long  fueling_range;
+    // ** for ecm truck only **
+    long  jamming_range;
+    std::string imagefile;
+    PackedSurface bodySprite;
+    PackedSurface bodyShadow;
+    PackedSurface turretSprite;
+    PackedSurface turretShadow;
+    std::string soundSelected;
+    std::string fireSound;
+    std::string weaponType;
+    short boundBox;
+};
+
+class UnitProfileInterface
+{
+protected:
+    static vector&lt;UnitProfile *&gt; profiles;
+    static void clearProfiles();
+    
+public:
+    static void loadUnitProfiles( void );
+    static UnitProfile * getUnitProfile( unsigned short unit_type );
+    static UnitProfile * getProfileByName( const std::string &amp;name );
+    static unsigned short getNumUnitTypes()
+    {
+        return profiles.size();
+    }
+};
+
+
+#endif // ** _UNITPROFILEINTERFACE_HPP

Copied: trunk/netpanzer/src/NetPanzer/Units/UnitState.cpp (from rev 1049, trunk/netpanzer/src/NetPanzer/Classes/UnitState.cpp)
===================================================================
--- trunk/netpanzer/src/NetPanzer/Classes/UnitState.cpp	2008-09-09 15:53:32 UTC (rev 1049)
+++ trunk/netpanzer/src/NetPanzer/Units/UnitState.cpp	2008-09-09 16:30:13 UTC (rev 1050)
@@ -0,0 +1,123 @@
+/*
+Copyright (C) 1998 Pyrosoft Inc. (www.pyrosoftgames.com), Matthew Bogue
+ 
+This program is free software; you can redistribute it and/or modify
+it under the terms of the GNU General Public License as published by
+the Free Software Foundation; either version 2 of the License, or
+(at your option) any later version.
+ 
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+ 
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
+*/
+#include &lt;config.h&gt;
+#include &quot;Util/Endian.hpp&quot;
+#include &quot;Units/UnitState.hpp&quot;
+
+UnitState::UnitState()
+{
+    body_angle.set( 0, 10 );
+    turret_angle.set( 0, 10 );
+
+    // ** NOTE: TEMPORARY UNTIL UNIT PROPERITIES CODED
+
+    bbox.setBounds( iXY( -25, -15 ), iXY( 25, 35 ) );
+
+    select = false;
+    orientation = 0;
+    speed_rate = 20;
+    speed_factor = 2;
+
+    hit_points = 100;
+    damage_factor = 30;
+    weapon_range = 409600;
+    defend_range = 100;
+    reload_time = 45;
+
+    threat_level = _threat_level_all_clear;
+}
+
+int UnitState::percentDamageInt( void )
+{
+    int damage_percentage;
+
+    damage_percentage = (int)  ( (1 - ( ( (float) hit_points ) / ( (float) max_hit_points) ) ) * 100 );
+
+    return( damage_percentage );
+}
+
+float UnitState::percentDamageFloat( void )
+{
+    float damage_percentage;
+
+    damage_percentage = ( (1 - ( ( (float) hit_points ) / ( (float) max_hit_points) ) ) * 100 );
+
+    return( damage_percentage );
+}
+
+NetworkUnitState UnitState::getNetworkUnitState() const
+{
+    NetworkUnitState state;
+
+    state.unit_type = unit_type;
+    state.location_x = htol32(location.x);
+    state.location_y = htol32(location.y);
+    state.bbox_min_x = htol32(bbox.min.x);
+    state.bbox_min_y = htol32(bbox.min.y);
+    state.bbox_max_x = htol32(bbox.max.x);
+    state.bbox_max_y = htol32(bbox.max.y);
+
+    state.body_angle = body_angle.getNetworkAngleInt();
+    state.turret_angle = turret_angle.getNetworkAngleInt();
+    state.orientation = htol16(orientation);
+    state.speed_rate = htol16(speed_rate);
+    state.speed_factor = htol16(speed_factor);
+    
+    state.reload_time = htol16(reload_time);
+    state.max_hit_points = htol16(max_hit_points);
+    state.hit_points = htol16(hit_points);
+    state.damage_factor = htol16(damage_factor);
+    state.weapon_range = htol32(weapon_range);
+    state.defend_range = htol32(defend_range);
+    
+    state.threat_level = threat_level;
+    state.lifecycle_state = lifecycle_state;
+
+    return state;
+}
+
+void UnitState::setFromNetworkUnitState(const NetworkUnitState&amp; state)
+{
+    select = false;
+
+    unit_type = state.unit_type;
+    location.x = ltoh32(state.location_x);
+    location.y = ltoh32(state.location_y);
+    bbox.min.x = ltoh32(state.bbox_min_x);
+    bbox.min.y = ltoh32(state.bbox_min_y);
+    bbox.max.x = ltoh32(state.bbox_max_x);
+    bbox.max.y = ltoh32(state.bbox_max_y);
+
+    body_angle.setFromNetworkAngleInt(state.body_angle);
+    turret_angle.setFromNetworkAngleInt(state.turret_angle);
+
+    orientation = ltoh16(state.orientation);
+    speed_rate = ltoh16(state.speed_rate);
+    speed_factor = ltoh16(state.speed_factor);
+    
+    reload_time = ltoh16(state.reload_time);
+    max_hit_points = ltoh16(state.max_hit_points);
+    hit_points = ltoh16(state.hit_points);
+    damage_factor = ltoh16(state.damage_factor);
+    weapon_range = ltoh32(state.weapon_range);
+    defend_range = ltoh32(state.defend_range);
+
+    threat_level = state.threat_level;
+    lifecycle_state = state.lifecycle_state;
+}
+

Copied: trunk/netpanzer/src/NetPanzer/Units/UnitState.hpp (from rev 1049, trunk/netpanzer/src/NetPanzer/Classes/UnitState.hpp)

Copied: trunk/netpanzer/src/NetPanzer/Units/UnitTypes.hpp (from rev 1049, trunk/netpanzer/src/NetPanzer/Structs/UnitTypes.hpp)

Modified: trunk/netpanzer/src/NetPanzer/Units/Vehicle.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Classes/Units/Vehicle.cpp	2008-09-09 15:53:32 UTC (rev 1049)
+++ trunk/netpanzer/src/NetPanzer/Units/Vehicle.cpp	2008-09-09 16:30:13 UTC (rev 1050)
@@ -21,15 +21,15 @@
 
 #include &lt;string.h&gt;
 #include &quot;Util/Log.hpp&quot;
-#include &quot;Classes/UnitBlackBoard.hpp&quot;
-#include &quot;Classes/Units/Vehicle.hpp&quot;
-#include &quot;Classes/Units/UnitGlobals.hpp&quot;
+#include &quot;Units/UnitBlackBoard.hpp&quot;
+#include &quot;Units/Vehicle.hpp&quot;
+#include &quot;Units/UnitGlobals.hpp&quot;
 #include &quot;Classes/Network/NetworkState.hpp&quot;
 #include &quot;Interfaces/PathScheduler.hpp&quot;
 #include &quot;Interfaces/MapInterface.hpp&quot;
 #include &quot;Interfaces/ProjectileInterface.hpp&quot;
-#include &quot;Interfaces/UnitInterface.hpp&quot;
-#include &quot;Interfaces/UnitProfileInterface.hpp&quot;
+#include &quot;Units/UnitInterface.hpp&quot;
+#include &quot;Units/UnitProfileInterface.hpp&quot;
 #include &quot;System/Sound.hpp&quot;
 
 

Modified: trunk/netpanzer/src/NetPanzer/Units/Vehicle.hpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Classes/Units/Vehicle.hpp	2008-09-09 15:53:32 UTC (rev 1049)
+++ trunk/netpanzer/src/NetPanzer/Units/Vehicle.hpp	2008-09-09 16:30:13 UTC (rev 1050)
@@ -19,10 +19,10 @@
 #define _VEHICLE_HPP
 #include &lt;string&gt;
 
-#include &quot;Classes/UnitBase.hpp&quot;
+#include &quot;Units/UnitBase.hpp&quot;
 #include &quot;Util/Timer.hpp&quot;
 #include &quot;Classes/UnitMessageTypes.hpp&quot;
-#include &quot;Classes/UnitOpcodes.hpp&quot;
+#include &quot;Units/UnitOpcodes.hpp&quot;
 #include &quot;Classes/AI/PathList.hpp&quot;
 
 #include &quot;Classes/Sprite.hpp&quot;

Modified: trunk/netpanzer/src/NetPanzer/Views/Game/CodeStatsView.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Views/Game/CodeStatsView.cpp	2008-09-09 15:53:32 UTC (rev 1049)
+++ trunk/netpanzer/src/NetPanzer/Views/Game/CodeStatsView.cpp	2008-09-09 16:30:13 UTC (rev 1050)
@@ -25,7 +25,7 @@
 #include &quot;Interfaces/PathScheduler.hpp&quot;
 #include &quot;Interfaces/MiniMapInterface.hpp&quot;
 #include &quot;Interfaces/PlayerInterface.hpp&quot;
-#include &quot;Interfaces/UnitInterface.hpp&quot;
+#include &quot;Units/UnitInterface.hpp&quot;
 #include &quot;Classes/Network/NetworkInterface.hpp&quot;
 
 enum{ _display_mode_network_stats,

Modified: trunk/netpanzer/src/NetPanzer/Views/Game/GameInfoView.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Views/Game/GameInfoView.cpp	2008-09-09 15:53:32 UTC (rev 1049)
+++ trunk/netpanzer/src/NetPanzer/Views/Game/GameInfoView.cpp	2008-09-09 16:30:13 UTC (rev 1050)
@@ -23,7 +23,7 @@
 #include &quot;Views/Components/Desktop.hpp&quot;
 #include &quot;Interfaces/GameConfig.hpp&quot;
 #include &quot;Interfaces/GameManager.hpp&quot;
-#include &quot;Interfaces/UnitInterface.hpp&quot;
+#include &quot;Units/UnitInterface.hpp&quot;
 #include &quot;Interfaces/PlayerInterface.hpp&quot;
 #include &quot;Classes/Network/NetworkState.hpp&quot;
 #include &quot;Classes/ScreenSurface.hpp&quot;

Modified: trunk/netpanzer/src/NetPanzer/Views/Game/GameView.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Views/Game/GameView.cpp	2008-09-09 15:53:32 UTC (rev 1049)
+++ trunk/netpanzer/src/NetPanzer/Views/Game/GameView.cpp	2008-09-09 16:30:13 UTC (rev 1050)
@@ -20,7 +20,7 @@
 #include &quot;GameView.hpp&quot;
 #include &quot;Views/Components/Desktop.hpp&quot;
 #include &quot;Classes/TileEngine.hpp&quot;
-#include &quot;Interfaces/UnitInterface.hpp&quot;
+#include &quot;Units/UnitInterface.hpp&quot;
 #include &quot;Interfaces/ProjectileInterface.hpp&quot;
 #include &quot;Interfaces/MouseInterface.hpp&quot;
 #include &quot;Objectives/ObjectiveInterface.hpp&quot;

Modified: trunk/netpanzer/src/NetPanzer/Views/Game/VehicleSelectionView.cpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Views/Game/VehicleSelectionView.cpp	2008-09-09 15:53:32 UTC (rev 1049)
+++ trunk/netpanzer/src/NetPanzer/Views/Game/VehicleSelectionView.cpp	2008-09-09 16:30:13 UTC (rev 1050)
@@ -19,7 +19,7 @@
 
 #include &quot;Util/Exception.hpp&quot;
 #include &quot;VehicleSelectionView.hpp&quot;
-#include &quot;Structs/UnitTypes.hpp&quot;
+#include &quot;Units/UnitTypes.hpp&quot;
 #include &quot;Views/GameViewGlobals.hpp&quot;
 #include &quot;Classes/Network/TerminalNetMesg.hpp&quot;
 #include &quot;Classes/Network/NetworkClient.hpp&quot;
@@ -27,11 +27,10 @@
 #include &quot;Classes/WorldInputCmdProcessor.hpp&quot;
 #include &quot;Classes/ScreenSurface.hpp&quot;
 #include &quot;Util/Math.hpp&quot;
-#include &quot;Structs/UnitTypes.hpp&quot;
 #include &quot;Interfaces/WorldViewInterface.hpp&quot;
 #include &quot;Objectives/ObjectiveInterface.hpp&quot;
-#include &quot;Interfaces/UnitProfileInterface.hpp&quot;
-#include &quot;Interfaces/UnitInterface.hpp&quot;
+#include &quot;Units/UnitProfileInterface.hpp&quot;
+#include &quot;Units/UnitInterface.hpp&quot;
 #include &quot;Interfaces/PlayerInterface.hpp&quot;
 #include &quot;Interfaces/GameConfig.hpp&quot;
 #include &quot;Views/Components/Desktop.hpp&quot;

Modified: trunk/netpanzer/src/NetPanzer/Views/Game/VehicleSelectionView.hpp
===================================================================
--- trunk/netpanzer/src/NetPanzer/Views/Game/VehicleSelectionView.hpp	2008-09-09 15:53:32 UTC (rev 1049)
+++ trunk/netpanzer/src/NetPanzer/Views/Game/VehicleSelectionView.hpp	2008-09-09 16:30:13 UTC (rev 1050)
@@ -22,7 +22,7 @@
 #include &quot;2D/Surface.hpp&quot;
 #include &quot;Views/Components/View.hpp&quot;
 #include &quot;GameTemplateView.hpp&quot;
-#include &quot;Interfaces/UnitProfileInterface.hpp&quot;
+#include &quot;Units/UnitProfileInterface.hpp&quot;
 #include &quot;Views/Components/Component.hpp&quot;
 #include &quot;Views/Components/Button.hpp&quot;
 


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000088.html">[Netpanzer-cvs] r1049 - in trunk/netpanzer: nbproject	src/NetPanzer/Bot src/NetPanzer/Classes	src/NetPanzer/Classes/Network src/NetPanzer/Interfaces	src/NetPanzer/Objectives src/NetPanzer/Views/Game
</A></li>
	<LI>Next message: <A HREF="000090.html">[Netpanzer-cvs] r1051 - in trunk/netpanzer: nbproject src/NetPanzer	src/NetPanzer/Classes src/NetPanzer/Interfaces src/NetPanzer/Weapons
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#89">[ date ]</a>
              <a href="thread.html#89">[ thread ]</a>
              <a href="subject.html#89">[ subject ]</a>
              <a href="author.html#89">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/netpanzer-cvs">More information about the Netpanzer-cvs
mailing list</a><br>
</body></html>
